@&#MAIN-TITLE@&#A basis for the implicit representation of planar rational cubic Bézier curves

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We construct a basis for the implicit representation of planar rational cubic Bézier curves.


                        
                        
                           
                           We present an explicit formulation of the implicit polynomial coefficients.


                        
                        
                           
                           Barycentric formulas for the double point of the cubic curve are derived.


                        
                        
                           
                           A simple test for when unwanted branches occur is formulated.


                        
                        
                           
                           Conditions for the degeneration of cubics to conics are presented.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bézier curves

Rational cubic curves

Conic sections

Implicit representation

Singularity

Double point

@&#ABSTRACT@&#


               
               
                  We present an approach to finding the implicit equation of a planar rational parametric cubic curve, by defining a new basis for the representation. The basis, which contains only four cubic bivariate polynomials, is defined in terms of the Bézier control points of the curve. An explicit formula for the coefficients of the implicit curve is given. Moreover, these coefficients lead to simple expressions which describe aspects of the geometric behaviour of the curve. In particular, we present an explicit barycentric formula for the position of the double point, in terms of the Bézier control points of the curve. We also give conditions for when an unwanted singularity occurs in the region of interest. Special cases in which the method fails, such as when three of the control points are collinear, or when two points coincide, will be discussed separately.
               
            

@&#INTRODUCTION@&#

Parametric curves are widely used in CAGD applications, especially in the ubiquitous rational Bézier and B-spline forms, due to their natural geometric properties. It is well known that all planar rational parametric curves can be written in implicit form (Sederberg and Chen, 1995); that is, as the zero set of a single bivariate polynomial function. The availability of both the implicit and parametric representations, which have properties complementary to each other, is important for various applications in CAGD, such as intersection and surface trimming algorithms. The increase in the presence of GPUs in commodity computers has also led to renewed interest in implicit representations for rendering applications (Loop and Blinn, 2005; Pfeifle, 2012). Since traditionally the design phase takes place using the parametric representation, a great deal of research has focused on implicitization – the conversion from the rational parametric, to the implicit form.

Implicitization algorithms, both exact and approximate, have been investigated by many authors (e.g., Barrowclough and Dokken, 2012; Busé and Luu Ba, 2010; Chen and Wang, 2002; Corless et al., 2001; Dokken, 2001; Sederberg and Chen, 1995). The specific case of implicitization of planar rational cubic curves has also received particular attention. Sederberg et al. (1985) present a method which reduces the degrees of freedom in the implicit polynomial from nine to eight by introducing monoid curves. Floater (1995) makes a choice of basis that allows the implicit representation to be given in terms of only six basis functions – a reduction from the 10 basis functions required to represent all polynomials of total degree three. Floater also gives explicit formulas for the coefficients and conditions for when the curve degenerates to a conic.

Despite being motivated by methods for sparse implicitization (Emiris and Kotsireas, 2005), the techniques in this paper more closely resemble those of Sederberg et al. (1985, 1995) and Floater (1995). The method describes how, in most cases, the implicit form of the curve can be defined in terms of only four basis functions. The basis functions are constructed from the control points of a rational cubic curve given in Bernstein–Bézier form. In addition, the coefficients which describe the implicit representation are shown to contain a lot of information about the geometry of the curve. We present an explicit barycentric formula for the position of the double point of the curve in terms of its control points, along with criteria for when the double point is considered ‘unwanted’. The important case of degeneration to conic sections is also treated. In the special case when three of the control points are collinear, the method fails; potential remedies for this will also be discussed.

Although much of the paper will utilize a Cartesian system for describing and proving the results, the method is in fact independent of the coordinate system, and is stated in terms of purely geometric quantities. In addition, all of the formulas (except Eq. (16)), including the detection and location of singularities on the curve, can be implemented in exact rational arithmetic; that is, only the operations of addition, subtraction multiplication and division are required. This contrasts with other methods, which often require polynomial rootfinding to find the double point via the parametric representation (Floater, 1995; Loop and Blinn, 2005; Pfeifle, 2012; Thomassen, 2005). This is potentially useful in applications which require exact precision and also aids the speed of floating point implementations.

There are several applications of implicit representations of rational cubic curves. These include resolution independent curve rendering, as in Loop and Blinn (2005), Pfeifle (2012), and intersection algorithms, as in Sederberg et al. (1985, 1986), Thomassen (2005). We also envisage great potential for the use of the techniques in this paper in surface trimming algorithms. A piecewise implicit representation of cubic trimming curves in the parameter domain will give a simple and accurate test for whether a point lies inside or outside the trimming region. The geometric formulas presented in this paper are also interesting from a theoretical perspective.

The paper will proceed as follows. In Section 2 we present the construction of the basis we use for the cubic implicitization, and also present formulas for the coefficients which define the curve. Computation of the double point of the curve will be addressed in Section 3, and Section 4 will cover the case of cubics which degenerate to conic sections. The special case of collinear control points will be discussed in Section 5. Several examples will be presented in Section 6, which highlight the simplicity of the method. We conclude the paper with a discussion of the extension to higher degrees and further work in Section 7. Some extended proofs and basic geometric properties are deferred to the Appendices.

In this section we describe the implicit basis functions and prove some simple facts such as invariance of the coefficients under affine transformations. We begin with some definitions.

We assume that the planar rational cubic curve is given in Bernstein–Bézier form with control points 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        , and weights 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                        . That is, we have
                           
                              (1)
                              
                                 p
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       3
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       t
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       3
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       1
                                       −
                                       t
                                       )
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       t
                                       +
                                       3
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       1
                                       −
                                       t
                                       )
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         In the parametric form, rational Bézier curves are normally rendered within a region of interest corresponding to the parameter values 
                           t
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        . It is also common in the CAGD community to require that the weights are strictly positive. Although such a restriction is easier for us to work with, for the most part, it is not necessary; most of the methods we present also work with negative weights, zero weights and weights of mixed sign. However, due to the construction which follows, we do require that no three of the control points are collinear. It is important to note that this will be an assumption of all the results up to Section 5.

In the following definition, we assume the control points are given in a Cartesian system, 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 1
                              
                           
                           )
                        . 
                           Definition 1
                           We define the implicit equation of the line between 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                               to be given by 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 0
                              , where
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          |
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          |
                                       
                                       .
                                    
                                 
                              
                           

We may refer loosely to ‘the line 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                              
                           
                        ’, meaning ‘the line defined by the equation 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           =
                           0
                        ’. Note that the norm of the gradient of 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                              
                           
                         is equal to the Euclidean distance between the points 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                        
                        
                           1
                        
                        
                           1
                           The linear functions 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       j
                                    
                                 
                              , can in fact be characterized by the three conditions of vanishing at 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                              , and having constant gradient, proportional to the Euclidean distance between the points. However, for the sake of clarity, we proceed using the definition in the Cartesian system.
                        :
                           
                              
                                 
                                    
                                       ‖
                                       ∇
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     


                        
                           Definition 2
                           We define a quantity 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                               as follows:
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          |
                                       
                                       .
                                    
                                 
                               For compactness of notation we define 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       i
                                       +
                                       2
                                       ,
                                       i
                                       +
                                       3
                                    
                                 
                               where the indices 
                                 i
                                 +
                                 1
                              , 
                                 i
                                 +
                                 2
                               and 
                                 i
                                 +
                                 3
                               are taken modulo 4. That is,
                                 
                                    (2)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             321
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             230
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             103
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             012
                                          
                                       
                                       .
                                    
                                 
                               We also make the definition
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                    
                                 
                               for each of the weights 
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               of the rational cubic Bézier curve.

Clearly 
                           
                              
                                 λ
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           =
                           0
                         if any of the 
                           i
                           ,
                           j
                           ,
                           k
                        's are equal. The quantities 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         represent twice the signed areas of the triangles formed from the control points 
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                        , by omitting the point 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         (i.e., 
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 2
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 3
                              
                           
                        ). The areas, 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        , are pictured with the corresponding weights, 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                        , in Fig. 1
                        .

The following definition describes the basis functions we use for the implicit representation: 
                           Definition 3
                           We define four basis functions as follows:
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             12
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             13
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             02
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       .
                                    
                                 
                              
                           

A diagrammatic representation of these basis functions is shown in Fig. 2
                        . To gain some intuition on the construction of these basis functions, an extended discussion is presented in Appendix C.

The term ‘basis functions’ is used rather loosely in this context, since for any different collection of control points the ‘basis’ will be different. The function set provides a basis for any non-degenerate planar rational cubic Bézier curve with given control points, subject to no three points being collinear; that is, for any choice of weight combinations. Moreover, the basis functions are conceptually similar for all non-collinear collections of control points, although they do differ analytically. The proof of linear independence given in Theorem 16, together with the spanning property of Theorem 1, justifies the choice of the term ‘basis’ for this function set. However, the fact that the functions are dependent on the control points must be understood.

In the following theorem we establish an explicit formula for the implicit representation of the rational cubic Bézier curve 
                           p
                           (
                           t
                           )
                        , in terms of these basis functions. 
                           Theorem 1
                           
                              Suppose we are given a non-degenerate rational cubic Bézier curve, 
                              
                                 p
                                 (
                                 t
                                 )
                              
                              , such that no three of the control points are collinear. Then the curve has the following equation defining its implicit representation:
                              
                                 
                                    
                                       q
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          3
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                 
                               
                              where
                              
                                 
                                    (3)
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             U
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             Λ
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          U
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          Λ
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          U
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          Λ
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          U
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          Λ
                                          .
                                       
                                    
                                 
                               
                              and 
                              
                                 U
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                               
                              and 
                              
                                 Λ
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                              
                              .
                           

Due to its length, we defer the proof of this theorem to Appendix B. It is interesting to note that the degrees to which the 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                        s and 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        s appear in the coefficient formula (3), are closely related to the multiplicities of the basis functions 
                           
                              
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         at the vertices 
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 3
                              
                           
                        .


                        
                           Proposition 2
                           
                              The coefficients 
                              
                                 
                                    
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               
                              defined by 
                              
                                 (3)
                               
                              are invariant under affine transformations, up to a constant scaling.
                           


                        
                           Proof
                           Formally, suppose we are given a rational cubic Bézier curve 
                                 p
                                 (
                                 t
                                 )
                               with control points 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               and weights 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              , whose implicit coefficients 
                                 
                                    
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               are defined by (3). Then, for any affine map Φ, we claim that the implicit coefficients of the transformed curve 
                                 Φ
                                 (
                                 p
                                 (
                                 t
                                 )
                                 )
                               are given by 
                                 
                                    
                                       (
                                       α
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                              , for some non-zero constant α. Since affine transformations multiply areas by a non-zero constant, there exists a constant C such that 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 C
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                               where 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                               are the areas defined by control points 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              , after the affine transformation (i.e., 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 Φ
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              , for each 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              ). Now, since the weights 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                               are unchanged, and the 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                              s appear homogeneously of degree four in the definition (3), we have 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                              , for each i.  □

Since implicit representations are unchanged by non-zero scalar multiplication, we can clearly factor out the constant 
                           
                              
                                 C
                              
                              
                                 4
                              
                           
                        .

One potential disadvantage of the method described in this paper, is that when the implicit equation is evaluated, samples are taken at the six different lines in the set
                           
                              
                                 
                                    {
                                    
                                       
                                          L
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    :
                                    0
                                    ⩽
                                    i
                                    <
                                    j
                                    ⩽
                                    3
                                    }
                                 
                                 .
                              
                           
                         This can, however, be reduced to three evaluations by some simple relations between the lines. 
                           Proposition 3
                           
                              Suppose we are given any four points 
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                              
                              , with no three collinear. Then, using 
                              
                                 Definitions 1 and 2
                              
                              , we can write
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             l
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ≡
                                       0
                                       ,
                                    
                                 
                               
                              for any choice of 
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 l
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 }
                              
                              , with all indices distinct.
                           


                        
                           Proof
                           Let
                                 
                                    
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             l
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       .
                                    
                                 
                               Then
                                 
                                    
                                       f
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             l
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       =
                                       ±
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             l
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       0
                                       ,
                                    
                                 
                               since 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 0
                              , and 
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       λ
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                               must have opposite signs, which depend on the orientation of i, j, k and l. Similarly, 
                                 f
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 0
                               and 
                                 f
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 =
                                 0
                              . Thus, since f is a linear function which is zero at three non-collinear points, it must be identically zero.  □

This proposition gives us an alternative method to evaluate some of the functions 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                              
                           
                        . We assume that we are given the lines 
                           
                              
                                 L
                              
                              
                                 01
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 12
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 23
                              
                           
                        , corresponding to the lines in the control polygon. It can easily be shown, using (4), that
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             12
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         When using this method as a numerical technique, care should be taken to ensure a sufficient degree of numerical stability. For example, if the denominators become small, it may be better to choose a different set of three lines to evaluate on, or to compute each line evaluation explicitly. A similar method is used by Sederberg and Parry (1986), in order to simplify the symbolic expansion of the determinant required in their method.

In the following definition we give three quantities which can be used to determine several characteristics of the geometry of the curve, such as when the curve degenerates, and in what region the singularity lies.


                        
                           Definition 4
                           We define three quantities 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                               as follows:
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           

These quantities are based on the coefficients 
                           
                              
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         and we can write
                           
                              (5)
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    .
                                 
                              
                           
                         We thus have a compact form of the implicit equation
                           
                              (6)
                              
                                 q
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    )
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 .
                              
                           
                         There is also a relation between the three quantities given as follows: 
                           Proposition 4
                           
                              The following two equations hold:
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

The proof is a simple exercise in expanding polynomials after substituting the definitions 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                              . We therefore omit the details here.  □

Since the curve is rational, there always exists a single double point in the form of a crunode, an acnode or a cusp. It is a surprising fact that the double point of a rational cubic curve with rational coefficients is necessarily rational, despite the fact that the corresponding parameter values may be irrational or complex. This was apparently first noticed by Sederberg et al. (1985, Theorem 1): 
                        “Every rational cubic curve defined by polynomials with rational coefficients has a double point whose coordinates are real and rational”.
                     
                  

In this section we derive the equations of two lines which intersect at the double point, in terms of the coefficients we have already discussed. We give exact formulas for the location of the double point in terms of barycentric combinations of its control points. We also define a condition which detects when there is an ‘unwanted’ self-intersection in the region of interest.

We first give some identities for the gradient which will be needed in the proofs in this section. From Definition 1 it is clear that we have
                        
                           
                              
                                 ∂
                                 
                                    ∂
                                    x
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    i
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    c
                                 
                                 
                                    i
                                    1
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    j
                                    1
                                 
                              
                              ,
                           
                        
                      and
                        
                           
                              
                                 ∂
                                 
                                    ∂
                                    y
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    i
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    c
                                 
                                 
                                    j
                                    0
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    i
                                    0
                                 
                              
                              .
                           
                        
                      For compactness of notation we define 
                        
                           
                              c
                           
                           
                              i
                              j
                           
                           
                              ⊥
                           
                        
                        =
                        
                           (
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          j
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          j
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          0
                                       
                                    
                                 
                              
                           
                           )
                        
                     . Thus, using the product rule, we can write the gradients of the basis functions as follows:
                        
                           (7)
                           
                              
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       23
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       12
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       12
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       01
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       13
                                    
                                    
                                       ⊥
                                    
                                 
                                 2
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       01
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       02
                                    
                                    
                                       ⊥
                                    
                                 
                                 2
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       23
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       03
                                    
                                    
                                       ⊥
                                    
                                 
                                 3
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                      In addition, using (6), we can write the gradient function, ∇q, in the compact form
                        
                           (8)
                           
                              ∇
                              q
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 )
                              
                              +
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              ∇
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              +
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ∇
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              .
                           
                        
                     
                  

In this section we determine the location of the singularity in affine space. The following proposition deals with the case where the singularity occurs at one of the endpoints 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         or 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        . 
                           Proposition 5
                           
                              Let the control points and weights of a non-degenerate rational cubic Bézier curve be given, and assume that no three control points are collinear. Then the singularity occurs at the end point 
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               
                              if and only if 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               
                              or 
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              
                              . Similarly, the singularity occurs at the end point 
                              
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                               
                              if and only if 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               
                              or 
                              
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                              .
                           

Since the functions 
                                 
                                    
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             0
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                              , evaluated at the endpoint 
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               are all zero, we have 
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 ∇
                                 
                                    
                                       K
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                              . Thus
                                 
                                    
                                       ∇
                                       q
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                          
                                             ⊥
                                          
                                       
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                12
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          
                                             
                                                L
                                             
                                             
                                                23
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             Λ
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             U
                                             )
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                13
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             U
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             Λ
                                             )
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                          
                                             ⊥
                                          
                                       
                                       Λ
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                          
                                             ⊥
                                          
                                       
                                       Λ
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                               Clearly this is zero if and only if 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               or 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              , since 
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                               are distinct. Similarly, 
                                 ∇
                                 q
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 =
                                 0
                               if and only if 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               or 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              .  □

In non-degenerate cases, except for those with the conditions above, we can derive the equations of two lines, 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                        , which both intersect the singularity and either 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         or 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        .


                        
                           Proposition 6
                           
                              Suppose we have a planar rational cubic Bézier curve with no three control points collinear and non-zero weights. Suppose further that the double point of the curve is finite, and does not lie on either of the endpoints 
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               
                              or 
                              
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                              
                              . Define two equations as follows:
                              
                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                L
                                             
                                             
                                                02
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                03
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                L
                                             
                                             
                                                13
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                03
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                               
                              Eqs. 
                              
                                 (9)
                               
                              define two lines which intersect the end points of the Bézier curve, 
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                               
                              respectively. Moreover, the lines intersect each other at the unique double point of the curve. The lines are also determined by the alternative equations
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                L
                                             
                                             
                                                01
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                03
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                L
                                             
                                             
                                                23
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                03
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           

We can immediately see that 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                               since, by definition, it is a linear combination of 
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                 
                               and 
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                 
                              . Similarly, 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 =
                                 0
                              . It remains to show that both lines intersect at the double point of q.

We now use both Eqs. (9) and (10), which can easily be shown to be equivalent, using Proposition 3. We must prove that both the implicit polynomial q and its gradient ∇q, vanish when these equations are satisfied. From (9) and (10) we infer that
                                 
                                    (11)
                                    
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   03
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   03
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             L
                                          
                                          
                                             02
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   03
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             L
                                          
                                          
                                             13
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   03
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               and
                                 
                                    (12)
                                    
                                       
                                          
                                             L
                                          
                                          
                                             12
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   23
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   02
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                       
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               These are well defined since, by Proposition 5, we have 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 0
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0
                              , and the weights are non-zero. Thus, by (6), the formula for q becomes
                                 
                                    
                                       q
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          q
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          q
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                               by Proposition 4.

In order to prove that 
                                 ∇
                                 q
                                 =
                                 0
                               when 
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , we substitute Eqs. (11) into the gradient identities (7). After expanding the formula (8), we can group together the coefficients of 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       ⊥
                                    
                                 
                               to write
                                 
                                    
                                       ∇
                                       q
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ψ
                                             
                                             
                                                01
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                01
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                12
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                12
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                23
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                23
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                02
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                02
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                13
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                13
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                ψ
                                             
                                             
                                                03
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                03
                                             
                                             
                                                ⊥
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                               where
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             01
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             12
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             23
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             02
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             13
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             03
                                          
                                       
                                       =
                                       3
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       .
                                    
                                 
                               The quantities 
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                       j
                                    
                                 
                               can be verified by writing out the coefficients. Thus, we can factor out the common factor 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                              , to get
                                 
                                    
                                       ∇
                                       q
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                01
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                12
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                23
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                02
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                13
                                             
                                             
                                                ⊥
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                03
                                             
                                             
                                                ⊥
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Now, we can individually verify each of the following
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             01
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             02
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             03
                                          
                                          
                                             ⊥
                                          
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             23
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             13
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             03
                                          
                                          
                                             ⊥
                                          
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             12
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             02
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             13
                                          
                                          
                                             ⊥
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             03
                                          
                                          
                                             ⊥
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               Thus, summing the previous three equations, we must have 
                                 ∇
                                 q
                                 =
                                 0
                              , proving the statement.  □

The lines defined in Proposition 6 are shown in Fig. 3
                        . It can be seen that the segments of the curve limited to the quadrants defined by the lines 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                        , are non-singular. This is necessarily true due to rational cubic curves having only one singularity. The following theorem, which is a consequence of the previous proposition, gives the location of the singularity in the affine plane. 
                           Theorem 7
                           
                              Suppose that the double point 
                              s
                              , of a non-degenerate rational cubic curve, is not at infinity. Then the following barycentric combination of the four Bézier control points 
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               
                              determines its location exactly:
                              
                                 
                                    
                                       s
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               
                              The formula can be simplified in a number of different ways, using the identities provided in the previous sections. For example, in the barycentric coordinate system defined by 
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                              
                              , we have
                              
                                 
                                    (13)
                                    
                                       s
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               
                              or in the barycentric coordinate system defined by 
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 
                                    (14)
                                    
                                       s
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           The formulas can be found by solving the linear equations 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 0
                               and 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 0
                              , in a particular coordinate system. It is clear that all the formulas are barycentric combinations of the control points, by observing the coefficients in the numerator and denominator. In order to validate that s is the intersection of the two lines, we can simply evaluate the functions 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                               at s:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       s
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          (
                                          −
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                3
                                             
                                          
                                          )
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          (
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                03
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                02
                                             
                                          
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                3
                                             
                                          
                                          )
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               We can similarly show that 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                               vanishes at s, and thus, by Proposition 6, s is the unique double point of the curve.  □

Of course, describing the singularity in terms of the control points may not be optimal with respect to numerical stability if the double point lies far from the region of interest, due to the denominator becoming small. However, information about the singularity is normally required only when it interferes with the region of interest of the curve. In these cases, the method performs very well.

In complement to the previous section, it is also possible to derive formulas for the parameter values of the singularity in terms of the quantities 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 3
                              
                           
                        . For compactness of notation we first make the following definitions: 
                           Definition 5
                           
                              
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              Suppose we are given a non-degenerate rational cubic parametric curve with no three control points collinear. Then the parameter values of the double point are given by the solutions to the quadratic equation 
                              
                                 r
                                 (
                                 t
                                 )
                                 =
                                 0
                              
                              , where
                              
                                 
                                    (15)
                                    
                                       r
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             Φ
                                          
                                          
                                             3
                                          
                                       
                                       t
                                       (
                                       1
                                       −
                                       t
                                       )
                                       +
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           By inserting the parametric form 
                                 p
                                 (
                                 t
                                 )
                              , into 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               (and factoring out the denominator), we obtain a cubic polynomial whose three roots correspond to the two parameter values 
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                               of the double point, and the parameter 
                                 t
                                 =
                                 0
                              . After factoring out t from the polynomial we obtain 
                                 r
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 p
                                 (
                                 t
                                 )
                                 )
                                 /
                                 t
                              , as given above. In the case that 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                               degenerates, however, we can simply follow a similar proof, using 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                               instead.  □

The polynomial 
                           r
                           (
                           t
                           )
                         is strictly quadratic except in the case when 
                           
                              
                                 Φ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 Φ
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 Φ
                              
                              
                                 3
                              
                           
                           =
                           0
                        . In the non-degenerate case, this condition corresponds to when at least one of the parameter values of the singularity is infinite. When 
                           r
                           (
                           t
                           )
                         is quadratic, it can be solved explicitly, to give the parameters 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                         of the double point as
                           
                              (16)
                              
                                 
                                    
                                       2
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             Φ
                                          
                                          
                                             3
                                          
                                       
                                       ±
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             4
                                             
                                                
                                                   Φ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   Φ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             Φ
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                         In particular, we have the discriminant 
                           Δ
                           =
                           
                              
                                 Φ
                              
                              
                                 3
                              
                              
                                 2
                              
                           
                           −
                           4
                           
                              
                                 Φ
                              
                              
                                 1
                              
                           
                           
                              
                                 Φ
                              
                              
                                 2
                              
                           
                        , which defines whether the curve has a self-intersection (
                           Δ
                           >
                           0
                        ), a cusp (
                           Δ
                           =
                           0
                        ), or an acnode (
                           Δ
                           <
                           0
                        ). This appears to be similar to the discriminant described by Stone and DeRose (1989).

The lack of symmetry in formula (16) above is due to Bernstein polynomials being defined over the interval 
                           [
                           0
                           ,
                           1
                           ]
                        , as opposed to an interval which is symmetric about 0, such as 
                           [
                           −
                           1
                           ,
                           1
                           ]
                        .

The parameter values of the double point can occur in several ways. If the two parameters are real and distinct, then a self-intersection occurs; in the case that the two parameters are equal, we have a cusp; and parameter pairs which occur as complex conjugates give rise to isolated singular points, or acnodes.

When the curve is given in rational Bézier form, the region of interest is the parameter interval 
                           [
                           0
                           ,
                           1
                           ]
                        . If the parameters of the singularity both lie within the interval 
                           [
                           0
                           ,
                           1
                           ]
                        , the self-intersection is normally an intended product of the designer. If the parameters both lie outside the interval 
                           [
                           0
                           ,
                           1
                           ]
                        , this means there will be no singularities in the region of interest; again, this is normally intended by the designer. The case where one parameter lies within the interval and one lies outside is what we term an unwanted self-intersection or unwanted singularity. Fig. 4
                         shows the three cases. When the parametric representation is used the unwanted case is not normally distinguished, since the curve is only plotted in the region of interest in the parameter domain. However, using implicit representations, it is more difficult to avoid plotting the curve without the unwanted branch and self-intersection, since a 2D region of rendering must be chosen.

It is possible to detect the presence of unwanted singularities by directly analysing the coefficients 
                           
                              
                                 Φ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Φ
                              
                              
                                 2
                              
                           
                        . In Floater (1995), a method is presented to detect unwanted singularities in special cases, which essentially correspond rational cubic Bézier curves which form simple arches (Pfeifle, 2012). The following proposition gives a condition to detect unwanted singularities in all non-degenerate cases. We make the condition that a singularity with infinite parameter values is not classified as unwanted so that we can assume that 
                           
                              
                                 Φ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 Φ
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 Φ
                              
                              
                                 3
                              
                           
                           ≠
                           0
                        .


                        
                           Proposition 9
                           
                              Let the control points and non-zero weights of a non-degenerate rational cubic Bézier curve be given, such that no three control points are collinear. Then there exists an unwanted singularity in the region of interest if and only if 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                                 <
                                 0
                              
                              .
                           


                        
                           Proof
                           This can be proved by observing that 
                                 r
                                 (
                                 t
                                 )
                               is a quadratic polynomial in Bernstein form, with coefficients 
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       Φ
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 2
                               and 
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                              , and by the properties of Bernstein polynomials.

(⟸) Assume first that 
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                               have opposite signs. Then, by observing the discriminant, we always have two real roots. Since 
                                 r
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 r
                                 (
                                 1
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                              , we know there is a root in 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                               by the intermediate value theorem. We also know that there must be a root outside 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              , because, since it is quadratic, 
                                 r
                                 (
                                 t
                                 )
                               must have the same sign as 
                                 r
                                 (
                                 −
                                 t
                                 )
                               asymptotically. Thus an unwanted self-intersection occurs (cf. Fig. 4(c)).

Assume now that 
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                               have the same sign. Since we are only interested in cases of self-intersection, where we have two distinct real roots, we consider the two cases, 
                                 
                                    
                                       Φ
                                    
                                    
                                       3
                                    
                                 
                                 >
                                 
                                    
                                       4
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       Φ
                                    
                                    
                                       3
                                    
                                 
                                 <
                                 −
                                 
                                    
                                       4
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              . In one of the cases, all of the Bernstein coefficients of 
                                 r
                                 (
                                 t
                                 )
                               have the same sign, so, by the variation diminishing property, both roots must be outside 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              . In the other case, 
                                 
                                    
                                       Φ
                                    
                                    
                                       3
                                    
                                 
                               has opposite sign to 
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                              , so the derivatives of r at 
                                 t
                                 =
                                 0
                               and 
                                 t
                                 =
                                 1
                               must have opposite sign. Again, by the intermediate value theorem, 
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 0
                               for some 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              , thus both roots of 
                                 r
                                 (
                                 t
                                 )
                               must be in 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              . Thus either we have a singular or non-singular segment (cf. Fig. 4(a) and (b)).

(⟹) Assume first that 
                                 r
                                 (
                                 t
                                 )
                               has one root in 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                               and one outside 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              . Then clearly, 
                                 r
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                               must have opposite sign to 
                                 r
                                 (
                                 1
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                              .

Assume that both roots are in 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              . Then 
                                 r
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       2
                                    
                                 
                               must have the same sign as 
                                 r
                                 (
                                 1
                                 )
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                              . This is similarly the case if both roots are outside 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              .  □

Of course, in the standard case that all weights are positive, we can use the simplified condition 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           <
                           0
                         in Proposition 9.


                        Loop and Blinn (2005) use subdivision at the parameter values of the singularity in order to remove the unwanted branch. Their method involves solving a quadratic polynomial for the parameter values of the self-intersection and then running the de Casteljau algorithm for the subdivision. The results of this section suggest an alternative method to remove the singularity. If, according to Proposition 9, we detect an unwanted singularity, we can use the lines defined in Proposition 6 to render non-singular segments of the curve. Such an approach is pictured in Fig. 3 (right). This would appear to be advantageous since we avoid the necessity of dealing with two separate curves, and also avoid computing the parameter values of the singularity. Additionally, exact rational arithmetic can be used since we do not need to solve any polynomial equations.

In this section we describe necessary and sufficient conditions for the degeneration of the rational cubic curve to a conic section. Some of the results of this section are similar to those of Wang and Wang (1992) and we use Theorem 1 from that paper in the proof of Theorem 11 below.
                           2
                        
                        
                           2
                           In the notation of Wang and Wang (1992) the quantities 
                                 
                                    
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               are equivalent to the quantities 
                                 
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               in this paper. In addition, it should be noted that while the result of Theorem 2 in Wang and Wang (1992) is restricted to strictly positive weights, the results of Theorems 1 and 3 are general for any non-zero weights.
                         We first state a lemma which holds for any rational cubic Bézier curve p, including when it degenerates to a conic.


                        
                           Lemma 10
                           
                              Let 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              . Then for any rational cubic Bézier curve 
                              
                                 p
                                 (
                                 t
                                 )
                              
                              , given by 
                              
                                 (1)
                              
                              , we have
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          p
                                          (
                                          t
                                          )
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             w
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       r
                                       (
                                       t
                                       )
                                       ,
                                    
                                 
                               
                              where 
                              
                                 r
                                 (
                                 t
                                 )
                               
                              is given by 
                              
                                 (15)
                              
                              .
                           

We defer the proof of this lemma to Appendix B. The following theorem defines necessary and sufficient conditions for conic degeneration of the rational cubic curve.


                        
                           Theorem 11
                           
                              Suppose all the weights 
                              
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               
                              are non-zero and no three of the control points are collinear. Then the rational cubic Bézier curve degenerates to a conic if and only if 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               
                              and 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                              .
                           


                        
                           Proof
                           Assume that the rational cubic curve degenerates to a conic section. Then by Theorem 1 in Wang and Wang (1992) we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               By a simple rearrangement of these equations it is clear that we have 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              .

Assume now that 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              . Then, by Proposition 4, we have 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0
                               and therefore 
                                 r
                                 (
                                 t
                                 )
                                 ≡
                                 0
                               by definition. Therefore, by Lemma 10, we have 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 p
                                 (
                                 t
                                 )
                                 )
                                 ≡
                                 0
                              , which shows that 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                               is the implicit representation of p. Since 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                               is a quadratic function, the rational cubic curve must degenerate to a conic.  □

A consequence of the previous propositions, and the linear independency of the basis functions (see Appendix B), is as follows. 
                           Corollary 12
                           
                              Suppose that no three control points are collinear and the weights are non-zero. Then the following three statements are equivalent:
                              
                                 
                                    1.
                                    
                                       the rational cubic curve degenerates to a conic,
                                    


                                       the coefficients 
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                          
                                        
                                       are all zero,
                                    


                                       the implicit polynomial q vanishes identically.
                                    


                              
                                 (
                                 1
                                 )
                                 ⟹
                                 (
                                 2
                                 )
                              : By Theorem 11 we have 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , and thus 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0
                               by Proposition 4. Then, by definition 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                               for 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              .


                              
                                 (
                                 2
                                 )
                                 ⟹
                                 (
                                 3
                                 )
                              : Trivial.


                              
                                 (
                                 3
                                 )
                                 ⟹
                                 (
                                 1
                                 )
                              : By the linear independence of the basis functions, the coefficients must all be zero. Then, since the 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                              s and 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              s are non-zero, we have 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              . The result follows from Theorem 11.  □

Since the implicit polynomial q vanishes identically when the rational cubic curve degenerates to a conic, we need an alternative definition to represent this case implicitly. Another immediate consequence of Theorem 11 gives such a representation. 
                           Corollary 13
                           
                              If the rational cubic curve 
                              
                                 p
                                 (
                                 t
                                 )
                               
                              degenerates to a conic section then its implicit representation is given by the equation
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             03
                                          
                                       
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             01
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             23
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

The proof is immediate from Lemma 10 and Theorem 11.  □

Class conditions for when the conic section represents an elliptic, a parabolic or a hyperbolic segment, are described by Wang and Wang (1992, Theorem 3). For completion, we state the results of that theorem here. Define two quantities 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         such that
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             ⁎
                                          
                                       
                                       ‖
                                    
                                    
                                       ‖
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ‖
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             ⁎
                                          
                                       
                                       ‖
                                    
                                    
                                       ‖
                                       
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ‖
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 c
                              
                              
                                 ⁎
                              
                           
                         is the point of intersection of the lines 
                           
                              
                                 L
                              
                              
                                 01
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 32
                              
                           
                        . If 
                           
                              
                                 L
                              
                              
                                 01
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 32
                              
                           
                         are parallel, we take 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           =
                           ∞
                        . From these quantities we define a number 
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                         such that
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       4
                                       
                                          
                                             Y
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         The theorem then says that the curve is an ellipse when 
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           <
                           1
                        , a parabola when 
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           =
                           1
                         or a hyperbola when 
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           >
                           1
                        . The proof of that result requires only that no three control points are collinear, and is hence general enough to encompass the case of curves with non-convex polygons and negative weights.

As emphasised earlier, the method fails when any three of the four control points are collinear, including the case when two of the points are coincident. In the collinear case, the basis functions 
                           
                              
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         are no longer linearly independent, and thus do not provide a basis for the curve. One remedy for this is to subdivide the curve using the de Casteljau algorithm, and treat the two subdivided curves separately. In the case of coincident points, two subdivisions may be necessary to completely remove the collinearity.

So far, all the methods in this paper have been independent of the parametric form, and it would be nice to find a method of dealing with these cases without resorting to parametric subdivision. Unfortunately, explicit methods which incorporate all collinear configurations seem to be rather more complicated than the simple methods presented in this paper. It appears that different configurations of points require different basis functions and coefficients. For example, end point coincidence (
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        ), mid point coincidence (
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        ) and mixed point coincidence (
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        , or 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        , or 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        , or 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        ) all appear to require separate treatment. In addition, there are also several cases of collinearity to consider.

Experimentally, it appears that the following basis functions support all cases, including collinear and coincident control points.
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                 
                                 .
                              
                           
                         However, the explicit formula for the coefficients no longer holds, and the symmetries that were apparent earlier in this paper, appear to be lost. Due to the number of different cases and the comparative complexity of an explicit formula when trying to incorporate collinear points, we feel that parametric subdivision of the curve is currently the best option. However, this is the subject of ongoing research.

It may be noted that the test for cases of collinearity is not a difficult one. Since, during the implicitization we are using the 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        s as coefficients, if one is computed to be zero, we can instruct the algorithm to deal with that case appropriately. In the case of running the algorithm in floating point precision, we would specify collinearity to within given tolerance.

In the preceding sections we have mostly assumed that the weights are non-zero. In the CAGD community, it is fairly common to define rational Bézier curves as having non-zero, or positive weights. Indeed, if we allow some of the weights of a rational cubic curve to be zero, the curve often degenerates to a conic or a line. In such cases it would be better to model the curve as a lower degree parametric curve. However, if either 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           0
                         or 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           =
                           0
                         (but not both), then the curve does not degenerate to a conic section. These cases were treated in Proposition 5. The implicit representation given by Theorem 1, is still valid in these cases.

When the curve has control points which are close to collinear, or the curve is close to a degenerate conic, issues with numerical stability need to be considered. Heuristically, it seems that issues with numerical stability are not too great; the methods appear to work well even when these ‘close to degenerate’ cases occur. However, when implementing in a given floating point precision, the tolerances required to define when a case is considered degenerate should be investigated further.

In this section we consider several examples for which the computations can easily be done by hand. Fig. 5
                      shows five different curves with various properties. We also include cases which fail using the general method and need to be treated separately.

For simplicity, the control points of the first three examples of Fig. 5 are rearrangements of the points 
                           
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 (
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        . For each case we compute the quantities 
                           
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 3
                              
                           
                        , the coefficients 
                           
                              
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                        , the double point s, and whether or not the curve exhibits an unwanted singularity. In this section we describe the first example in detail.

We have
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                         The quantities 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         are thus all equal to ±1 and we have 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           =
                           1
                         and 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           =
                           3
                        . Using the formula (5), we obtain
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 −
                                 6
                                 ,
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 6
                                 
                                 and
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 −
                                 8
                              
                           
                         and thus
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 72
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 −
                                 18
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 18
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 8
                                 .
                              
                           
                         The double point of the curve can be computed from (13) as
                           
                              
                                 s
                                 =
                                 
                                    
                                       −
                                       324
                                       
                                          
                                             (
                                             1
                                             ,
                                             1
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       432
                                       
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                          
                                             T
                                          
                                       
                                    
                                    216
                                 
                                 =
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    ,
                                    −
                                    
                                       3
                                       2
                                    
                                    )
                                 
                                 .
                              
                           
                         Clearly the double point does not lie within the convex hull of the control points. For the implicit equation in a Cartesian system we can write
                           
                              
                                 q
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 72
                                 x
                                 (
                                 y
                                 −
                                 1
                                 )
                                 (
                                 x
                                 −
                                 1
                                 )
                                 −
                                 18
                                 x
                                 
                                    
                                       (
                                       1
                                       −
                                       x
                                       −
                                       y
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 18
                                 
                                    
                                       (
                                       x
                                       −
                                       y
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 −
                                 1
                                 )
                                 +
                                 8
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                         Since 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           >
                           0
                        , we know, by Proposition 9, that there is no unwanted branch in the region of interest.

We summarize the quantities for the five examples of Fig. 5, in Table 1
                        . Note that in the third example we have a double point at infinity. In this case, the denominator in the formula (13) vanishes, as expected.

This is the fourth example of Fig. 5. Having detected that both 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           =
                           0
                         and 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           =
                           0
                        , Theorem 11 tells us we have a conic section. We thus use the formula of Corollary 13 for the implicit representation. This gives,
                           
                              
                                 q
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       03
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    q
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 9
                                 (
                                 x
                                 −
                                 y
                                 /
                                 3
                                 )
                                 (
                                 x
                                 +
                                 y
                                 /
                                 3
                                 −
                                 1
                                 )
                                 .
                              
                           
                         Since we have a conic section the double point computations are not applicable.

Using the conic class conditions for this example we compute 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           =
                           1
                           /
                           2
                        , which gives 
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           =
                           1
                        . This shows that we have a parabola, which is consistent with the curve pictured in Example 4 of Fig. 5.

As mentioned previously, the result of Theorem 11 is not restricted to convex polygons with non-negative weights. Consider, for example, the curve pictured in Fig. 6
                        , which is given by the control points
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Using the results of Theorem 11, we can find a real conic section corresponding to these points. Without loss of generality, we can assume 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           =
                           1
                         (Farin, 2002). Using this assumption, we can solve the equations of Theorem 11 for the remaining weights. We thus obtain
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          3
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       (
                                       1
                                       /
                                       48
                                       )
                                    
                                    
                                       1
                                       /
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          3
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       (
                                       2
                                       /
                                       9
                                       )
                                    
                                    
                                       1
                                       /
                                       3
                                    
                                 
                                 .
                              
                           
                         The weights corresponding to the real cube roots of these quantities determine the conic pictured in Fig. 6. By construction, we have 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           =
                           0
                        . The implicit equation is given by
                           
                              
                                 q
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    1
                                    24
                                 
                                 
                                    (
                                    (
                                    −
                                    2
                                    x
                                    −
                                    y
                                    +
                                    1
                                    )
                                    (
                                    x
                                    −
                                    2
                                    y
                                    )
                                    +
                                    6
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         It should be noted that this construction can be used to determine a real conic section corresponding to any set of control points such that no three are collinear. The proof of the conic class conditions in Wang and Wang (1992) is also fully general to control polygons with no three collinear control points. In our example, we have
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 4
                                 /
                                 5
                                 ,
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 3
                                 /
                                 5
                                 ,
                                 
                                 
                                    
                                       η
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 25
                                 /
                                 48
                                 <
                                 1
                                 ,
                              
                           
                         thus confirming that we have an ellipse.

The disappearance of 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                         in the example pictured in Fig. 7
                         indicates that a collinearity occurs between 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        . For this example, the weights 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         are all assumed to be equal to 1. We see that there appears a linear dependency in the basis functions, between 
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 3
                              
                           
                        , and the coefficients 
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                         become zero. Following the suggestion of Section 5, we therefore subdivide the curve a single time, at the parameter value 
                           t
                           =
                           1
                           /
                           2
                        . This gives two curves with the following control points
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                             /
                                             8
                                          
                                       
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                       ,
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             5
                                             /
                                             16
                                          
                                       
                                       
                                          
                                             3
                                             /
                                             8
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       2
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             5
                                             /
                                             16
                                          
                                       
                                       
                                          
                                             3
                                             /
                                             8
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             1
                                             /
                                             4
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             3
                                             /
                                             4
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                       ,
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         These can each be treated in the same way as the previous examples, finding in both cases that 
                           s
                           =
                           
                              
                                 (
                                 −
                                 8
                                 ,
                                 36
                                 )
                              
                              
                                 T
                              
                           
                        ; an acnode.

It may be noted that although the implicit equation vanishes identically, the double point can still be computed without subdivision if we choose the correct formula; that is by choosing the barycentric formula (14), with respect to the three non-collinear points 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        . We then get
                           
                              
                                 s
                                 =
                                 
                                    
                                       −
                                       243
                                       /
                                       2
                                       
                                          
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       27
                                       (
                                       1
                                       ,
                                       0
                                       )
                                    
                                    
                                       −
                                       27
                                       /
                                       8
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             −
                                             8
                                          
                                       
                                       
                                          
                                             36
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

For this example we use the control points for the curve pictured in Fig. 3, given by
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                             /
                                             4
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             9
                                             /
                                             8
                                          
                                       
                                       
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             13
                                             /
                                             16
                                          
                                       
                                       
                                          
                                             3
                                             /
                                             4
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             17
                                             /
                                             32
                                          
                                       
                                       
                                          
                                             19
                                             /
                                             24
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           =
                           1
                        . Using the same computations as in the previous examples we get
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 11
                                 /
                                 192
                                 ,
                                 15
                                 /
                                 64
                                 ,
                                 53
                                 /
                                 96
                                 ,
                                 3
                                 /
                                 8
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 312
                                 
                                 435
                                 /
                                 4
                                 
                                 194
                                 
                                 304
                                 ,
                                 −
                                 66
                                 
                                 285
                                 /
                                 2
                                 
                                 097
                                 
                                 152
                                 ,
                                 220
                                 
                                 957
                                 /
                                 18
                                 
                                 874
                                 
                                 368
                                 ,
                                 1441
                                 /
                                 1
                                 
                                 048
                                 
                                 576
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 −
                                 491
                                 /
                                 4096
                                 ,
                                 379
                                 /
                                 3072
                                 ,
                                 131
                                 /
                                 2048
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 s
                                 =
                                 (
                                 363
                                 
                                 241
                                 /
                                 470
                                 
                                 596
                                 ,
                                 146
                                 
                                 294
                                 /
                                 352
                                 
                                 947
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 186
                                 
                                 089
                                 /
                                 12
                                 
                                 582
                                 
                                 912
                                 .
                              
                           
                         The negative value of 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         indicates that we have an unwanted singularity, the location of which is given by s. Since the curve exhibits an unwanted singularity, we compute the lines 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                        , which intersect the double point:
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 965
                                 /
                                 8192
                                 x
                                 −
                                 1215
                                 /
                                 8192
                                 y
                                 −
                                 965
                                 /
                                 32
                                 
                                 768
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 −
                                 12
                                 
                                 773
                                 /
                                 49
                                 
                                 152
                                 x
                                 −
                                 10
                                 
                                 865
                                 /
                                 65
                                 
                                 536
                                 y
                                 +
                                 17
                                 
                                 649
                                 /
                                 65
                                 
                                 536
                                 .
                              
                           
                         For a given point 
                           (
                           x
                           ,
                           y
                           )
                        , we can then use boolean operations on the signs of 
                           q
                           (
                           x
                           ,
                           y
                           )
                        , 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         in order to define which points lie ‘inside’ and ‘outside’ the curve.

@&#DISCUSSION AND CONCLUSION@&#

For the sake of brevity, we have omitted extended discussions of interesting features that arise in using this method in the previous sections. In this section we mention some of these features before concluding the paper.

An alternative representation for the implicit coefficients is to divide through by the non-zero factor 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        
                           
                              u
                           
                           
                              1
                           
                        
                        
                           
                              u
                           
                           
                              2
                           
                        
                        
                           
                              u
                           
                           
                              3
                           
                        
                        
                           
                              λ
                           
                           
                              0
                           
                        
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        
                           
                              λ
                           
                           
                              3
                           
                        
                     :
                        
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      This form highlights more clearly the symmetry between the 
                        
                           
                              u
                           
                           
                              i
                           
                        
                     s and the 
                        
                           
                              λ
                           
                           
                              i
                           
                        
                     s. It also appears that this approach aids the numerical stability of the implementation, being only quadratic in the numerators and denominators.

It is interesting to note that the exponents which appear in the formulas for the coefficients (3), are reminiscent of the exponents of the terms of the discriminant of a univariate cubic polynomial in monomial form.
                        3
                     
                     
                        3
                        There is a fifth term in the cubic discriminant that would correspond to 
                              
                                 
                                    b
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              ≡
                              0
                           .
                      The relationship between the coefficients and the cubic discriminant should be the subject of further research.

Experiments show that parts of the method appear to be extensible to higher degrees. In particular, it is not difficult to define basis functions for rational quartic curves using the same heuristic reasoning as in Section 2. However, the number of basis functions appears to increase exponentially, and attempts to find an explicit formula for the coefficients appear to be more difficult. An extension of the theory to surfaces also appears to be much more difficult due to the complicated limiting control surfaces involved. However, this could be a direction for future research.

@&#CONCLUSION@&#

This paper has shown that it is possible to represent the implicit form of all non-degenerate rational planar cubic Bézier curves as a linear combination of four basis functions, whenever no three control points are collinear. The method has been described in terms of purely geometric quantities and symmetries have been highlighted. The resulting coefficients of the implicit polynomial lead naturally to a geometric characterization of several aspects of the curve. The method has a compact representation and can easily be implemented on a GPU, as an alternative to the methods in Loop and Blinn (2005), Pfeifle (2012). Additionally, the formulas which aid in locating the singularity, and whether or not it is unwanted, are simple and computationally inexpensive.

@&#ACKNOWLEDGEMENTS@&#

I would like to thank Tor Dokken for reading through the manuscript and for helpful suggestions. I would also like to thank the anonymous reviewers for their comments and corrections. The research leading to these results has received funding from the European Community's Seventh Framework Programme FP7/2007-2013 under grant agreement n° PITN-GA-2008-214584 (SAGA), and from the Research Council of Norway (IS-TOPP, project number is 201280).

Here we state some simple geometric properties that are used in the proofs of the next section. 
                        Proposition 14
                        
                           For any four points 
                           
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                           
                           , 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                           , 
                           
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                            
                           and 
                           
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                            
                           we have the following:
                           
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        

This can be verified by simply writing out the expression using Definition 2, and checking that all terms cancel out.  □

This proposition shows that there is some degeneracy in the representation; that is, one of the 
                        
                           
                              λ
                           
                           
                              i
                           
                        
                     s can always be written as a combination of the other three. This is reflected in the simplified forms presented in the paper. However, for the sake of symmetry, we have proceeded for the most part, to use all four 
                        
                           
                              λ
                           
                           
                              i
                           
                        
                      values. 
                        Proposition 15
                        
                           Assume we are given four points 
                           
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    3
                                 
                              
                            
                           with no three collinear. Then, when the respective denominators are non-zero, we can define
                           
                              
                                 (A.1)
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                            
                           If any of these points do exist, they define the intersection of the lines 
                           
                              
                                 
                                    L
                                 
                                 
                                    01
                                 
                              
                            
                           and 
                           
                              
                                 
                                    L
                                 
                                 
                                    23
                                 
                              
                           
                           , 
                           
                              
                                 
                                    L
                                 
                                 
                                    02
                                 
                              
                            
                           and 
                           
                              
                                 
                                    L
                                 
                                 
                                    13
                                 
                              
                           
                           , or 
                           
                              
                                 
                                    L
                                 
                                 
                                    03
                                 
                              
                            
                           and 
                           
                              
                                 
                                    L
                                 
                                 
                                    12
                                 
                              
                            
                           respectively.
                           
                              4
                           
                           
                              4
                              At least one of these points exists in the affine plane, since if two of the denominators vanish, then the two pairs of corresponding lines are parallel; but then the third point will be the intersection of the two lines passing through opposite vertices of the parallelogram thus formed. These lines must necessarily be non-parallel, thus the point of intersection is finite.
                           
                        


                     
                        Proof
                        That the various equalities hold, when the denominators are non-zero, is a consequence of Proposition 14. The fact that they intersect at the respective lines is then a triviality, since each point can be written as a scaled linear combination of the points which define the line. For example, 
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                            must lie on the line 
                              
                                 
                                    L
                                 
                                 
                                    01
                                 
                              
                           , by the identity 
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           , and on the line 
                              
                                 
                                    L
                                 
                                 
                                    23
                                 
                              
                           , by 
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           .  □

In the following theorem we establish linear independence of the basis functions, in the applicable cases. 
                           Theorem 16
                           
                              Suppose no three of the points 
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                               
                              are collinear. Then the functions 
                              
                                 
                                    
                                       K
                                    
                                    
                                       0
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       K
                                    
                                    
                                       3
                                    
                                 
                               
                              are linearly independent.
                           

Assume that
                                 
                                    
                                       ρ
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          3
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       0
                                       ,
                                       
                                       for all 
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                               We prove linear independence by evaluating ρ at four distinct points. Assume that the points 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                               defined by (A.1) exist. Then we can evaluate ρ at 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                              , 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                              . For example, at 
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                               we have
                                 
                                    
                                       ρ
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                             
                                          
                                       
                                       .
                                    
                                 
                               After rearranging the rows to obtain a triangular matrix and dividing through by any common factors, we can set up the linear system with respect to evaluation at the four points as follows:
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   −
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   −
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               Now, the determinant of the matrix can be computed as
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                               which never vanishes since the control points are not collinear. Care needs to be taken in the case when 
                                 
                                    
                                       L
                                    
                                    
                                       01
                                    
                                 
                               and 
                                 
                                    
                                       L
                                    
                                    
                                       23
                                    
                                 
                               (resp. 
                                 
                                    
                                       L
                                    
                                    
                                       02
                                    
                                 
                               and 
                                 
                                    
                                       L
                                    
                                    
                                       13
                                    
                                 
                              ) are parallel, as the denominator of 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               (resp. 
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                              ) vanishes. However, a similar linear system can be set up by using homogeneous coordinates, in which case the vanishing denominator is not a problem. Thus, the proof holds in all cases.  □

The proof of Theorem 1 is essentially a long exercise in expanding the rational function 
                           q
                           ∘
                           p
                        , in order to show that it is identically zero. We assume the conditions of Theorem 1 for the entirety of this section (i.e., that the cubic is non-degenerate and no three control points are collinear). We know, by Theorem 16 that the basis functions 
                           
                              
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         are linearly independent, and by Proposition 11 that not all the coefficients 
                           
                              
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         are zero. Thus the polynomial q is not identically zero, and the theorem is proved if we can show that 
                           q
                           ∘
                           p
                         vanishes identically.

We first consider the composition of 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                              
                           
                           (
                           p
                           (
                           t
                           )
                           )
                         for all 
                           i
                           ≠
                           j
                        . 
                           Lemma 17
                           
                              The rational cubic function 
                              
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 p
                                 (
                                 t
                                 )
                                 )
                               
                              can be given in Bernstein form by
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          (
                                          p
                                          (
                                          t
                                          )
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             w
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   
                                                      k
                                                      =
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      k
                                                      ≠
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          3
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                    
                                 
                               
                              where 
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             k
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       t
                                       )
                                    
                                    
                                       3
                                       −
                                       k
                                    
                                 
                               
                              and 
                              
                                 w
                                 (
                                 t
                                 )
                               
                              denotes the denominator of 
                              
                                 (1)
                              
                              .
                           

We first note that by Definition 1,
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          (
                                          p
                                          (
                                          t
                                          )
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             w
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   w
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          |
                                       
                                       .
                                    
                                 
                               Now, by expanding the determinant, we have that
                                 
                                    (B.1)
                                    
                                       
                                          w
                                          (
                                          t
                                          )
                                          
                                             
                                                L
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             p
                                             (
                                             t
                                             )
                                             )
                                          
                                          =
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                j
                                                ,
                                                1
                                             
                                          
                                          )
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             3
                                          
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                j
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ,
                                                0
                                             
                                          
                                          )
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             3
                                          
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ,
                                                0
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                j
                                                ,
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                j
                                                ,
                                                0
                                             
                                          
                                          )
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             3
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             w
                                             (
                                             t
                                             )
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                p
                                                (
                                                t
                                                )
                                                )
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             3
                                          
                                          
                                             (
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                   0
                                                
                                             
                                             +
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             )
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   0
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             w
                                             (
                                             t
                                             )
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                p
                                                (
                                                t
                                                )
                                                )
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             3
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          .
                                       
                                    
                                 
                               Clearly, when 
                                 k
                                 =
                                 i
                               or 
                                 k
                                 =
                                 j
                              , the corresponding term in the sum is zero meaning we only need sum over 
                                 k
                                 ≠
                                 i
                                 ,
                                 j
                              .  □

A consequence of summing only over 
                           k
                           ≠
                           i
                           ,
                           j
                         is that we can remove factors of t and 
                           1
                           −
                           t
                         when certain coefficients disappear. That is, we can write
                           
                              (B.2)
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          01
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       1
                                       −
                                       t
                                       )
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       t
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          12
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          23
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       1
                                       −
                                       t
                                       )
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       t
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          02
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    −
                                    t
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          13
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    −
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    w
                                    (
                                    t
                                    )
                                    
                                       
                                          L
                                       
                                       
                                          03
                                       
                                    
                                    
                                       (
                                       p
                                       (
                                       t
                                       )
                                       )
                                    
                                    =
                                    t
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       1
                                       −
                                       t
                                       )
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       t
                                       )
                                    
                                    .
                                 
                              
                           
                         Thus by Lemma 17 and the above identities, we can express the compositions 
                           
                              
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 ∘
                                 p
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         as follows: 
                           Lemma 18
                           
                              For each 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                              , we can express 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 p
                                 (
                                 t
                                 )
                                 )
                               
                              in the form
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          p
                                          (
                                          t
                                          )
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             w
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                    
                                 
                               
                              where
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          1
                                          −
                                          t
                                          )
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                t
                                                )
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          1
                                          −
                                          t
                                          )
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          1
                                          −
                                          t
                                          )
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          t
                                          )
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          1
                                          −
                                          t
                                          )
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       t
                                       (
                                       1
                                       −
                                       t
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             1
                                             −
                                             t
                                             )
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             t
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       .
                                    
                                 
                              
                           

The common factor of 
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       t
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 w
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         can be ignored in showing that 
                           q
                           ∘
                           p
                           ≡
                           0
                        ; it is thus sufficient to show that
                           
                              (B.3)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 ≡
                                 0
                                 .
                              
                           
                         It is a simple, yet lengthy exercise to compute the coefficients of this polynomial in the degree five Bernstein basis, in order to show that they are all zero. We compute the coefficient of 
                           
                              
                                 B
                              
                              
                                 0
                              
                              
                                 5
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 (
                                 1
                                 −
                                 t
                                 )
                              
                              
                                 5
                              
                           
                         as an example. By observation, the coefficients 
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                         of 
                           
                              
                                 B
                              
                              
                                 0
                              
                              
                                 5
                              
                           
                           (
                           t
                           )
                         of each of the functions 
                           
                              
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 3
                              
                           
                         are as follows:
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       3
                                       ,
                                       0
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         Thus, the coefficient of 
                           
                              
                                 B
                              
                              
                                 0
                              
                              
                                 5
                              
                           
                           (
                           t
                           )
                         of (B.3), is given by
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         We can perform similar computations to show that the other coefficients (of 
                           
                              
                                 B
                              
                              
                                 j
                              
                              
                                 5
                              
                           
                           (
                           t
                           )
                           =
                           
                              (
                              
                                 
                                    
                                       5
                                    
                                 
                                 
                                    
                                       j
                                    
                                 
                              
                              )
                           
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           
                              
                                 (
                                 1
                                 −
                                 t
                                 )
                              
                              
                                 5
                                 −
                                 j
                              
                           
                        , 
                           j
                           =
                           0
                           ,
                           …
                           ,
                           5
                        ) are all zero, thus proving the theorem.


                        
                           Proof
                           Using (B.2) we can write
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          p
                                          (
                                          t
                                          )
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             w
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                t
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          t
                                          (
                                          1
                                          −
                                          t
                                          )
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                               where
                                 
                                    (B.4)
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                Φ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                Φ
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                Φ
                                             
                                             
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                               Thus, the terms inside the parentheses are given by 
                                 r
                                 (
                                 t
                                 )
                              .  □

Finally we provide a discussion of how the basis functions are constructed. The functions 
                        
                           
                              (
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              i
                              =
                              0
                           
                           
                              3
                           
                        
                      can be thought of as the implicit representations of various limiting configurations of non-negative weights 
                        
                           
                              w
                           
                           
                              0
                           
                        
                     , 
                        
                           
                              w
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              w
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              w
                           
                           
                              3
                           
                        
                     . The configurations for each of the functions are given in Table C.2
                     . We can use the theory developed earlier in the paper to show that these limits are valid.

That the basis functions are given by the limiting configurations can be seen by evaluating the coefficients with their respective weights. For example, consider the function 
                        
                           
                              K
                           
                           
                              1
                           
                        
                     , assuming that no three control points are collinear. The coefficients 
                        
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              i
                              =
                              0
                           
                           
                              3
                           
                        
                      for the weights corresponding to 
                        
                           
                              K
                           
                           
                              1
                           
                        
                      in Table C.2 are
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              =
                              −
                              
                                 (
                                 9
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 18
                                 Λ
                                 )
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              =
                              9
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                              
                              −
                              27
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              Λ
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              =
                              9
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                                 
                                    3
                                 
                              
                              −
                              27
                              /
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              Λ
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              =
                              9
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              −
                              Λ
                              .
                           
                        
                      We can divide all coefficients by 
                        
                           
                              w
                           
                           
                              4
                           
                        
                      and take the limit as 
                        w
                        →
                        ∞
                      to see that the limiting coefficients are
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              /
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              /
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              =
                              −
                              27
                              Λ
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              /
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              =
                              0
                              .
                           
                        
                      Clearly we can divide through by the non-zero constant 
                        −
                        27
                        Λ
                     , in order to normalize the coefficients. The other basis functions can be treated similarly.

Such limits are more difficult to treat using the parametric representation since there does not exist a single rational cubic Bézier representation which traverses the algebraic curves which define the basis functions. This is due to all of the functions being reducible products of linear forms. However, we can evaluate the parametric limit at certain parameters in order to generate some points along the basis functions. Once again we take 
                        
                           
                              K
                           
                           
                              1
                           
                        
                      as an example. For all 
                        t
                        ≠
                        0
                     , we have
                        
                           
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                    ,
                                    t
                                    ≠
                                    0
                                 
                              
                              
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    
                                       1
                                       w
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    3
                                    w
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    t
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       3
                                       w
                                    
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    w
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       1
                                       w
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    3
                                    w
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    t
                                    +
                                    
                                       3
                                       w
                                    
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    w
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    3
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    3
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      When 
                        t
                        =
                        0
                      we can evaluate the parametric description before taking limits. We then get
                        
                           
                              
                                 lim
                                 
                                    w
                                    →
                                    ∞
                                    ,
                                    t
                                    =
                                    0
                                 
                              
                              
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    
                                       1
                                       w
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    3
                                    w
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    t
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       3
                                       w
                                    
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    w
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       1
                                       w
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    3
                                    w
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    t
                                    +
                                    
                                       3
                                       w
                                    
                                    (
                                    1
                                    −
                                    t
                                    )
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    w
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              .
                           
                        
                      So we see that the points between 
                        
                           
                              c
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              c
                           
                           
                              3
                           
                        
                      are traversed with quadratic multiplicity for 
                        t
                        ∈
                        [
                        −
                        ∞
                        ,
                        ∞
                        ]
                        ∖
                        {
                        0
                        }
                     , while the point 
                        
                           
                              c
                           
                           
                              0
                           
                        
                      is included at 
                        t
                        =
                        0
                     . This justifies the representation given by 
                        
                           
                              K
                           
                           
                              1
                           
                        
                     . Once again, the other basis functions can be treated similarly.

@&#REFERENCES@&#

