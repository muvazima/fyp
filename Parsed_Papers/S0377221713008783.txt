@&#MAIN-TITLE@&#A semi-parametric approach for estimating critical fractiles under autocorrelated demand

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study forecasting the critical fractile of a lead time demand distribution when demand is autocorrelated.


                        
                        
                           
                           We propose a semi-parametric approach to estimate the critical fractile.


                        
                        
                           
                           The proposed approach uses empirical forecast errors to correct a possibly misspecified demand forecasting model.


                        
                        
                           
                           We provide conditions for its asymptotic validity and evaluate its small sample performance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Forecasting

Newsvendor model

Autocorrelated demand

Model misspecification

Forecast bias

Retail operations

@&#ABSTRACT@&#


               
               
                  Forecasting critical fractiles of the lead time demand distribution is an important problem for operations managers making newsvendor-type inventory decisions. In this paper, we propose a semi-parametric approach to forecasting the critical fractile when demand is serially correlated. Starting from a user-defined but potentially misspecified forecasting model, we use historical demand data to generate empirical forecast errors of this model. These errors are then used to (1) parametrically correct for any bias in the point forecast conditional on the recent demand history and (2) non-parametrically estimate the critical fractile of the demand distribution without imposing distributional assumptions. We present conditions under which this semi-parametric approach provides a consistent estimate of the critical fractile and evaluate its finite sample properties using simulation and real data for retail inventory planning.
               
            

@&#INTRODUCTION@&#

Forecasting critical fractiles of the lead time demand (LTD) distribution is an important problem for operations managers making newsvendor-type inventory decisions. It corresponds to finding a cost-minimizing order quantity that optimally balances the costs of understocking and the costs of overstocking in a single period. The critical fractile solution has found numerous applications in inventory theory (see review by Khouja (1999)), particularly in the management of highly perishable or seasonable goods. It can also be repeatedly applied when one takes a multi-period inventory model with a myopic order up-to-policy (e.g., Graves, 1999; Lee, So, & Tang, 2000), which is noted as an appropriate policy for major retail chains (Smith & Agrawal, 2000). In this paper, we consider the problem of forecasting critical fractiles when demand is serially correlated.

The standard parametric approach to this problem starts with a demand forecasting model and estimates the critical fractile as if the chosen model were correctly specified and estimated (Silver, Pyke, & Peterson, 1998). Specifically, this approach assumes that (1) the fitted forecasting model produces unbiased LTD forecasts and (2) the forecast error follows a Gaussian distribution. However, in most practical situations, it is not possible to know the correct demand generating process and satisfy these assumptions (Chatfield, 1995). There are several reasons why this is the case. First, managers will often have to produce simultaneous forecasts for a very large number of items. For example, a typical US grocery store carries anywhere between 15,000 and 60,000 SKUs (FMI, 2012). It is impractical to expect that one can specify the correct model for each individual SKU. Instead, simple forecasting models, such as exponential smoothing, are used in real-life scenarios, without testing for their validity (Taylor, 2007). Second, the choice of the demand forecasting model used for inventory management might not be under the control of the operations/inventory planning department. Instead, it is often dictated by the sales and marketing group, which may well provide biased (usually overoptimistic) forecasts due to incentive misalignment (Goodwin, 1996; Oliva & Watson, 2009). For instance, Manary and Willems (2008) report that at Intel, the sales and marketing group, which is responsible for feeding demand forecasts directly into the manufacturing resource planning system, consistently overestimates demand across virtually all SKUs. Third, forecast errors may not follow a Gaussian distribution (Bookbinder & Lordahl, 1989; Fricker & Goodhart, 2000).

Under model uncertainty, the parametric approach inevitably produces biased fractile estimates. It is important to understand and reduce the bias as the biased fractile estimate leads to increased inventory costs, as well as failure to meet required service levels (Badinelli, 1990; Kim & Ryan, 2003). Moreover, it can amplify the increase in demand variability as one moves up a supply chain, a phenomenon known as the bullwhip effect (Chen, Drezner, Ryan, & Simchi-Levi, 2000).

When we need to be concerned by the possibility that the forecasting model has been misspecified and/or the demand series is non-Gaussian, empirical approaches are widely used in practice as a useful alternative. The non-parametric approaches (e.g., Bookbinder & Lordahl, 1989; Levi, Roundy, & Shmoys, 2007) are established to negate the need to make any assumptions about the demand model and to use solely the observed samples of demand to forecast critical fractiles. However, they are limited to independent demand processes and cannot be applied to serially correlated demand processes. Alternatively, one can begin with a user-specified forecasting model that captures autocorrelation in the process and collect past LTD forecast errors of the chosen model. One then uses an empirical distribution of these forecast errors, together with a point forecast for an upcoming period, to construct a LTD distribution and thereby calculate a critical fractile non-parametrically. This traditional empirical approach, which is often used in practice (Manary & Willems, 2008) and cited in textbooks (Cachon & Terwiesch, 2006), avoids the assumption that the forecasts are unbiased by checking whether the mean of past forecast errors is zero. If the mean of errors is not equal to zero, then it is used to correct for the bias in the most recent point forecast when calculating a critical fractile. However, this empirical approach can only deal with the unconditional forecast bias (such as the forecast bias in unconditional mean) and is not valid under autocorrelated demand. When the underlying demand is serially correlated, the point forecasts we make are conditional on the recent demand history (e.g., when a first-order autoregressive model (AR(1)) is the chosen forecasting model, the point forecasts are calculated conditional on the most recent demand) and the bias in the point forecasts, if there is any, would also be conditional on the recent demand history. Note that demand autocorrelation is indeed found to be present in numerous practical settings, such as consumer goods, fuel, food and machine tools (Chopra & Meindl, 2001; Erkip, Hausman, & Nahmias, 1990; Nahimas, 1993) and failure to model demand autocorrelation can have negative effect on the stockout rate experienced by a firm (Charnes, Marmorstein, & Zinn, 1995).

In this paper, we present an approach that corrects for the conditional forecast bias prior to using an empirical distribution of past forecast errors to forecast critical fractiles. The proposed approach can be viewed as an extension of the traditional empirical approach, which is suited to an autocorrelated demand process. Using a sample of forecast errors of the chosen forecasting model, we first estimate a parametric (linear) bias-adjusting regression model, conditional on the recent demand history. We then use the empirical residuals of this bias-adjusting regression model to estimate the critical fractile non-parametrically. The framework is semi-parametric as we specify the parametric bias-adjusting model but use the empirical distribution of the model errors to calculate the critical fractile.

Using asymptotic theory, we show that if the demand process follows a stationary autoregressive (AR(p)) demand process, the semi-parametric approach provides consistent estimates of the critical fractile, independently of the user-specified forecasting model, as long as it is within the autoregressive integrated (ARI(
                        
                           
                              
                                 p
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                        
                     )) class. This is because if the user-specified model is misspecified, we can correct for the conditional forecast bias in constructing critical fractiles using the parametric bias-adjusting regression. No specific parametric assumptions about the forecast error distribution are necessary. The proposed approach therefore has practical relevance as it is applicable to forecasting models that are commonly used in practice (e.g., the autoregressive, random walk and independent demand models) and is robust against incorrectly specified error distributions. We also demonstrate that when the chosen forecasting model is correctly specified (i.e., the conditional bias is equal to zero), the semi-parametric approach collapses to the traditional empirical approach and the asymptotic variance of the critical fractile estimation is reduced. A smaller asymptotic variance is of practical importance as it implies lower inventory costs for a given sample size. The benefit of robustness against the unbiasedness of the forecasting model is traded off against the loss in efficiency resulting from a higher asymptotic variance.

To investigate the finite sample properties of the proposed framework we report on a simulation study. We demonstrate that, in comparison to the traditional parametric and empirical approaches, the proposed semi-parametric approach can significantly reduce inventory costs by correcting for a conditional forecast bias before estimating critical fractiles non-parametrically with empirical forecast errors. The cost reduction is increasing in sample size, lead time, and service level. Perhaps more importantly, our simulation results indicate that the proposed approach is a good heuristic for estimating critical fractiles under more general conditions than those specified by our asymptotic analysis. In particular, we show that the semi-parametric approach works well for the more general autoregressive moving average (ARMA) demand processes and under a broader class of user-specified forecasting models, which includes autoregressive integrated moving average (ARIMA) models. Finally, we illustrate the practical applicability of the proposed approach using real data in retailing. We find that the semi-parametric approach can significantly reduce inventory costs – by up to 57% – and also meet the required service levels better, compared to best-practice alternatives that fail to account for model uncertainty.

This paper is organized as follows: Section 2 introduces the critical fractile estimation problem when an arbitrary demand forecasting model is used; In Section 3, we describe the semi-parametric approach to estimating critical fractiles; Section 4 provides conditions for the asymptotic validity of the proposed approach; Section 5 provides numerical experiments to investigate the small sample properties of our asymptotic results; Section 6 shows the practical applicability of the proposed approach in retail inventory planning; and Section 7 concludes. All proofs are provided in the Supplementary material.

We study the critical fractile estimation problem with a fixed replenishment lead time L where demand 
                        
                           
                              
                                 Y
                              
                              
                                 t
                              
                           
                        
                      is serially correlated. Our main variable of interest is the lead time demand (LTD) in period 
                        
                           t
                           ,
                           
                              
                                 Y
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 τ
                                 =
                                 1
                              
                              
                                 L
                              
                           
                           
                              
                                 Y
                              
                              
                                 t
                                 +
                                 τ
                              
                           
                        
                     . We allow the LTD to be dependent on the demand history 
                        
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             w
                                          
                                          
                                             ̇
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 )
                              
                              
                                 ′
                              
                           
                        
                     , where 
                        
                           
                              
                                 w
                              
                              
                                 ̇
                              
                           
                        
                      denotes the time-invariate length of an observation window. The distribution of the LTD in period t, conditional on the demand history 
                        
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           =
                           x
                        
                     , is then defined as 
                        
                           
                              
                                 Ψ
                              
                              
                                 t
                              
                           
                           (
                           y
                           
                              
                                 
                                    x
                                 
                              
                           
                           )
                           =
                           Pr
                           (
                           
                              
                                 Y
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           ⩽
                           y
                           
                              
                                 
                                    
                                       X
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           x
                           )
                        
                     .

We assume that in period t, we first observe 
                        
                           
                              
                                 Y
                              
                              
                                 t
                              
                           
                        
                      and determine the inventory target 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                     . Note that the inventory target 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                      needs to be calculated conditional on 
                        
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           =
                           x
                        
                      because the underlying demand process is serially correlated (i.e., 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                      is state-dependent). We also adopt the standard assumption of linear overage and underage costs, which we denote by h and s, respectively. The inventory target 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                      is then given by the following well-known Newsboy-type result (Cachon & Terwiesch, 2006):
                        
                           (1)
                           
                              
                                 
                                    Q
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 min
                              
                              
                                 
                                    
                                       y
                                       :
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       y
                                       
                                          
                                             
                                                x
                                             
                                          
                                       
                                       )
                                       ⩾
                                       K
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           K
                           =
                           
                              
                                 s
                              
                              
                                 s
                                 +
                                 h
                              
                           
                        
                      is the targeted service level (i.e., the likelihood of being able to meet demand with inventory) that minimizes the expected cost by balancing the costs of understocking and the costs of overstocking. (1) implies that the optimal inventory target 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                      is given by the Kth quantile of the conditional LTD distribution and this is known as the critical fractile solution.

We note that the critical fractile solution can be repeatedly applied when one takes a multi-period inventory model with a myopic order-up-to policy, in which the inventory position is brought to a prescribed level at the beginning of each period (e.g., Graves, 1999; Lee et al., 2000). Denote the inventory at the beginning of period t before placing an order by 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                     . The myopic policy then implies that, the inventory position, after ordering in period t, is given by 
                        
                           max
                           {
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           }
                        
                     . Johnson and Thompson (1975) examine the optimality of the myopic policy for periodic inventory systems operating when no backorders are permitted and zero lead time is assumed. They show that under a stationary autoregressive (AR(p)) demand process, the myopic policy is optimal for any period in an infinite horizon.

Next we provide an expression for the conditional LTD distribution 
                        
                           
                              
                                 Ψ
                              
                              
                                 t
                              
                           
                        
                      and the critical fractile 
                        
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                        
                      when an arbitrary demand forecasting model is used. Note that the choice of the demand forecasting model used for inventory management might not be under control of the operations or inventory planning department and the model is often exogenously given (Manary & Willems, 2008; Oliva & Watson, 2009). We assume that the firm will make 
                        
                           τ
                        
                     -step-ahead point forecasts, 
                        
                           τ
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           Ł
                           }
                        
                     , using a demand forecasting model 
                        
                           g
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 L
                              
                           
                           )
                        
                     , where 
                        
                           
                              
                                 g
                              
                              
                                 τ
                              
                           
                        
                      is a function of past demand observations. Specifically, we denote these 
                        
                           τ
                        
                     -step-ahead point forecasts at time t by 
                        
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 t
                                 ,
                                 τ
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 τ
                              
                           
                           (
                           
                              
                                 Y
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Y
                              
                              
                                 t
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       ̃
                                    
                                 
                                 +
                                 1
                              
                           
                           )
                        
                     , where 
                        
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                           ⩽
                           
                              
                                 w
                              
                              
                                 ̇
                              
                           
                        
                      is the number of past observations used to make the forecast. For example, if AR(p) model is a chosen forecasting model, then we use the p lagged demand observations to generate the point forecasts and therefore 
                        
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                           =
                           p
                        
                     . The 
                        
                           τ
                        
                     -step-ahead forecasts are then used to calculate a point forecast of LTD in period t as the sum of the single period forecasts over the lead time: 
                        
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 τ
                                 =
                                 1
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 t
                                 ,
                                 τ
                              
                           
                        
                     .

The uncertainty in LTD, given the firm’s point forecasting model, is captured by the forecast error
                        
                           (2)
                           
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       τ
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                              [
                              
                                 
                                    Y
                                 
                                 
                                    t
                                    +
                                    τ
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                    ,
                                    τ
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       τ
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                              [
                              
                                 
                                    Y
                                 
                                 
                                    t
                                    +
                                    τ
                                 
                              
                              -
                              
                                 
                                    g
                                 
                                 
                                    τ
                                 
                              
                              (
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    t
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                    +
                                    1
                                 
                              
                              )
                              ]
                              .
                           
                        
                     
                  

Our main interest therefore lies in the estimation of the conditional forecast error distribution 
                        
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                           (
                           e
                           
                              
                                 
                                    x
                                 
                              
                           
                           )
                           =
                           Pr
                           (
                           
                              
                                 E
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           ⩽
                           e
                           
                              
                                 
                                    
                                       X
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           x
                           )
                        
                     . Note that conditional on 
                        
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           =
                           x
                        
                      the estimate 
                        
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                        
                      is non-random (recall that 
                        
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                           ⩽
                           
                              
                                 w
                              
                              
                                 ̇
                              
                           
                        
                     ). Therefore all uncertainty in the LTD is captured in the single random variable 
                        
                           
                              
                                 E
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                        
                     . Consequently, we can write 
                        
                           
                              
                                 Ψ
                              
                              
                                 t
                              
                           
                           (
                           y
                           
                              
                                 
                                    x
                                 
                              
                           
                           )
                           =
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                           (
                           y
                           -
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           
                              
                                 
                                    x
                                 
                              
                           
                           )
                        
                     .

If we denote by 
                        
                           
                              
                                 ξ
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                        
                      the Kth quantile of the LTD forecast-error conditional on 
                        
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                           =
                           x
                        
                     , which represents the safety stock level associated with the chosen forecasting model, then the critical fractile (1) in period t is the sum of the firm’s LTD point forecast and this safety stock level
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              +
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              .
                           
                        
                     
                  

The standard parametric approach to critical fractile estimation starts with a demand forecasting model and estimates the critical fractile as if the chosen model were correctly specified and estimated (Silver et al., 1998). Specifically, this approach makes the following three assumptions about the LTD forecast error distribution:
                           
                              1.
                              The conditional mean of the error distribution is zero, i.e., the fitted model produces unbiased LTD point forecasts.

The forecast error follows a Gaussian distribution.

The estimated standard deviation of the LTD forecast error in period t, denoted by 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                    
                                 , is computed analytically as a function of a single period forecast error 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             u
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ^
                                          
                                       
                                    
                                  is a positive constant derived from a fitted model (see, e.g., Gaur, Giloni, & Seshadri, 2005) and 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             u
                                          
                                       
                                    
                                  is the estimated standard deviation of the single period forecast error.

Under these assumptions, the parametric approach calculates the critical fractile as
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 z
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              z
                              =
                              
                                 
                                    Φ
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              K
                              )
                           
                        , in which 
                           
                              Φ
                           
                         is the c.d.f. of the standard normal distribution; z is known as the safety factor.

If the forecasting model is correctly specified, its parameters are correctly estimated, and the demand process is indeed Gaussian, (3) estimates the correct critical fractile. However, the approach is flawed if the demand model is misspecified or parameter estimates are incorrect as the point forecast made by an incorrect model is biased, i.e. 
                           
                              E
                              [
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              ]
                              
                              ≠
                              
                              0
                           
                        , and the use of analytical formulae to calculate the standard deviation of the errors becomes invalid. Furthermore, the Gaussian distribution assumption might be invalid.

When there are doubts about the chosen forecasting model and demand distribution, the empirical approach is widely used as a useful alternative (e.g., Cachon & Terwiesch, 2006; Manary & Willems, 2008). Here the Kth quantile of the LTD forecast error is calculated using a sample of empirical LTD forecast errors, which are generated by iteratively applying the firm’s forecasting model g to subsamples of past observations and recording the deviations of the model predictions over the lead time horizon from the known out-of-sample realizations. Given n observed demand realizations, we start the process in period 
                           
                              t
                              =
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                           
                        . For every 
                           
                              t
                              =
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              …
                              ,
                              n
                              -
                              L
                           
                        , we produce the point forecast of L period demands using the firm’s model g based on the past 
                           
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                           
                         demand realization, and then compute the corresponding empirical forecast error for LTD as 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    1
                                 
                                 
                                    L
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                    +
                                    τ
                                 
                              
                              -
                              
                                 
                                    g
                                 
                                 
                                    τ
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                    +
                                    1
                                 
                              
                              )
                              )
                           
                        . In this way we obtain a sample of 
                           
                              n
                              -
                              L
                              -
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                              +
                              1
                           
                         empirical LTD forecast errors. If the forecasting model g is not exogenously given, then one could use all/part of the observed data to estimate the model. Note that the collected empirical errors would then become in-sample errors (the differences between the in-sample observations that are included in the fitting process and fitted values of the model) rather than out-of-sample errors (the differences between the out-of-sample observations that are not included in the fitting process and the predictions of the model).

The empirical distribution of the past LTD forecast errors is given by 
                           
                              
                                 
                                    F
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    (
                                    n
                                    -
                                    L
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                    +
                                    1
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    n
                                    -
                                    L
                                 
                              
                              I
                              (
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              ⩽
                              z
                              )
                           
                         where 
                           
                              I
                           
                         is an indicator function. The empirical approach then calculates the critical fractile as
                           
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 
                                    min
                                 
                                 
                                    
                                       
                                          z
                                          :
                                          
                                             
                                                F
                                             
                                             
                                                ^
                                             
                                          
                                          (
                                          e
                                          )
                                          ⩾
                                          K
                                       
                                    
                                 
                                 .
                              
                           
                        If the chosen forecasting model produces a forecast bias in unconditional mean, the mean of the forecast error is not zero but equal to the unconditional forecast bias. In this case, the Kth quantile estimated from the empirical distribution of the forecast error 
                           
                              
                                 
                                    F
                                 
                                 
                                    ^
                                 
                              
                           
                         would take account of this unconditional forecast bias (Lee & Scholtes, 2013). However, the resulting Kth quantile is not conditioned on 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              x
                           
                         and fails to correct for the conditional bias under autocorrelated demand series.

In this section we propose an alternative semi-parametric approach which does not require that the point forecasting model used is correctly specified and does not rely on specific distributional assumptions on the forecast error. The proposed approach can be viewed as an extension of the traditional empirical approach by adding an on-line check for the conditional forecast bias.

Our proposed approach assumes that the LTD forecast error depends on the recent demand history 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                           
                         via a parametric function 
                           
                              η
                           
                        :
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 η
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 β
                                 )
                                 +
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              β
                           
                         is the unknown bias-correction parameter vector, and 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                           
                         is a residual error with zero mean, which we assume to be independent of 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                           
                        . In order to operationalize our approach, we will assume that the conditional LTD forecast bias is a linear function of the recent demand history. With this assumption it is natural to specify a linear regression model to estimate the bias adjustment conditional on past demand realizations of 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          w
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    ′
                                 
                              
                           
                        :
                           
                              (4)
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          w
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                       -
                                       i
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 β
                                 +
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    ′
                                 
                              
                           
                        . The parameter 
                           
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                              
                           
                         captures the unconditional bias and 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                         captures the bias conditional on the recent demand history due to the incorrect assumption on the demand autocorrelation structure. The total bias in the LTD forecast conditional on 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              x
                           
                         is then 
                           
                              E
                              [
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       x
                                    
                                 
                              
                              ]
                              =
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              β
                           
                        , where 
                           
                              x
                              =
                              
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    ′
                                 
                              
                           
                        ; the regression error 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                           
                         captures the intrinsic stochasticity of LTD.

The linearity assumption on 
                           
                              η
                           
                        , as per (4), requires justification. First, as we will show in Lemma 2, Section 4, if the underlying demand model follows an AR(p) process with 
                           
                              p
                              ⩽
                              w
                           
                         and an arbitrary ARI
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         demand forecasting model is employed with 
                           
                              max
                              (
                              
                                 
                                    p
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    ̃
                                 
                              
                              )
                              =
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                              ⩽
                              w
                           
                        , the LTD forecast bias is indeed linear in the recent demand history and (4) is exact. However, even if the demand process is not linear in the current history, the linear specification can be thought of as a first order linear approximation, which, as we show in Section 6, works well with real data in practice. Note that if 
                           
                              η
                              =
                              E
                              [
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       x
                                    
                                 
                              
                              ]
                           
                         is a nonlinear function of x, then the linear least square estimator is the best linear approximation to the bias in the mean squared error sense, i.e. the estimate 
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                         solves 
                           
                              
                                 
                                    min
                                 
                                 
                                    β
                                 
                              
                              E
                              [
                              E
                              [
                              
                                 
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          t
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             x
                                          
                                       
                                    
                                    ]
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    β
                                    )
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                         (see Angrist & Pischke, 2008, Theorem 3.1.6).

If we denote the unknown cumulative distribution function of the regression error 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                           
                         by 
                           
                              H
                              (
                              z
                              )
                              =
                              Pr
                              (
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              z
                              )
                           
                         and its Kth quantile by 
                           
                              κ
                           
                        , then the Kth quantile of the LTD forecast error, conditional on 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              =
                              x
                           
                        , is 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              β
                              +
                              κ
                           
                         and the critical fractile (1) becomes
                           
                              (5)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 β
                                 +
                                 κ
                                 .
                              
                           
                        In order to avoid distributional assumptions on demand, we adopt a semi-parametric approach: the bias-adjusting equation is parametric, while the estimation of the distribution H is non-parametric. It is important to note that the term 
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              β
                           
                         is introduced in the critical fractile calculation in order to correct for the conditional LTD forecast bias arising from the selected point forecasting model. This is in contrast to the traditional empirical approach in Section 2.2, which can only account for the unconditional bias using the mean of past forecast errors.

Since 
                           
                              (
                              β
                              ,
                              κ
                              )
                           
                         are unknown, they must be estimated in order to calculate the critical fractile (5). We estimate these parameters by fitting the bias-adjusting model in (4) to a sample of empirical LTD forecast errors, which can be generated similarly to the empirical approach as described in Section 2.2. The main difference here is that we start the process of collecting empirical errors in period 
                           
                              t
                              =
                              w
                           
                        , where 
                           
                              w
                              ⩾
                              
                                 
                                    w
                                 
                                 
                                    ̃
                                 
                              
                           
                         is the chosen window size for the bias-adjusting regression fitting in (4). This is to check for any bias conditional on at least the past demand observations that are used to make forecasts and also to check for any potential bias conditional on the higher lag orders that is not captured by the chosen forecasting model. As a result, we collect a sample of 
                           
                              n
                              -
                              L
                              -
                              w
                              +
                              1
                           
                         empirical LTD forecast errors.

These realizations of LTD forecast errors are used as dependent variables in the linear regression model (4):
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         w
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         w
                                                         +
                                                         1
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         n
                                                         -
                                                         L
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Using the past demand observations, we have the observed data on 
                           
                              (
                              1
                              +
                              w
                              )
                           
                         predictors as independent variables in (4), which are contained in the 
                           
                              (
                              n
                              -
                              L
                              -
                              w
                              +
                              1
                              )
                              ×
                              (
                              1
                              +
                              w
                              )
                           
                         matrix:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         w
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         w
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         n
                                                         -
                                                         L
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         n
                                                         -
                                                         L
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         n
                                                         -
                                                         L
                                                         -
                                                         w
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Given (6) and (7), we fit the bias-adjusting model (4) and estimate the model parameters 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                         by 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         using least squares. Note that the forecast errors generated by iteratively applying the chosen forecasting model to subsamples of past data are serially correlated. This serial correlation, however, does not affect the consistency of the parameter estimates as an asymptotic property of least square estimates is preserved for the autocorrelated dependent variable (see White, 2001, Theorem 3.37).

We also need to estimate the critical fractile 
                           
                              κ
                           
                         of the regression-error distribution. The estimates of the regression error 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                           
                         are 
                           
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , where 
                           
                              w
                              ⩽
                              t
                              ⩽
                              (
                              n
                              -
                              L
                              )
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is the least squares estimator. To find the Kth quantile of 
                           
                              
                                 
                                    H
                                 
                                 
                                    ^
                                 
                              
                           
                         we use the empirical distribution of the regression errors, 
                           
                              
                                 
                                    H
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    (
                                    n
                                    -
                                    L
                                    -
                                    w
                                    +
                                    1
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    w
                                 
                                 
                                    n
                                    -
                                    L
                                 
                              
                              I
                              (
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              z
                              )
                           
                        , where 
                           
                              I
                           
                         is an indicator function; the estimated Kth quantile becomes 
                           
                              
                                 
                                    κ
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              min
                              
                                 
                                    
                                       z
                                       :
                                       
                                          
                                             H
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       z
                                       )
                                       ⩾
                                       K
                                    
                                 
                              
                           
                        . The empirically estimated parameters, 
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    κ
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , are then used to correct for the conditional forecast bias and to estimate non-parametrically the critical fractile of the regression-error distribution, respectively. The semi-parametric critical fractile given n historical demand data is thus calculated by
                           
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       L
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ˆ
                                    
                                 
                                 +
                                 
                                    
                                       κ
                                    
                                    
                                       ˆ
                                    
                                 
                                 .
                              
                           
                        
                     

In this section, we provide sufficient conditions for the large-sample validity of the proposed semi-parametric approach. In Lemma 2 we identify for which demand processes and forecasting models the linear bias-adjusting model defined in (4) is exact. We then present the main theorem to demonstrate that under a stationary AR(p) demand process, the critical fractile is consistently estimated by the semi-parametric approach for any (possibly misspecified) forecasting model g within the general class of ARI(
                        
                           
                              
                                 p
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                        
                     ) models (Theorem 1). Let 
                        
                           (
                           β
                           ,
                           κ
                           ,
                           
                              
                                 ξ
                              
                              
                                 t
                              
                              
                                 L
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 t
                              
                           
                           )
                        
                      denote generic values of the parameters and let 
                        
                           (
                           
                              
                                 β
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 κ
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           )
                        
                      denote the unknown true values.
                        Assumption 1
                        Demand process: The underlying demand process is an autoregressive process AR(p):
                              
                                 (8)
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    μ
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          i
                                       
                                    
                                    -
                                    μ
                                    )
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                           
                              
                                 (i)
                                 The order p is smaller than or equal to the window size w of the bias-adjusting regression model (i.e., 
                                       
                                          p
                                          ⩽
                                          w
                                       
                                    ).


                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                       
                                     is a stationary process, i.e., all roots of the characteristic equation 
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          z
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          ⋯
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                p
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                p
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                     exceed unity in modulus, where 
                                       
                                          {
                                          
                                             
                                                ϕ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                ϕ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ϕ
                                             
                                             
                                                p
                                             
                                          
                                          }
                                       
                                     are defined in (8).

The residual errors 
                                       
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                       
                                     are independent and identically distributed and 
                                       
                                          E
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                    .


                                    
                                       
                                          E
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                    .


                                    
                                       
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         t
                                                         +
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          <
                                          ∞
                                       
                                     for 
                                       
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          L
                                       
                                    , where 
                                       
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      t
                                                      -
                                                      w
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    .


                                    
                                       
                                          E
                                          ∣
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                ∣
                                             
                                             
                                                2
                                             
                                          
                                          <
                                          ∞
                                       
                                    .


                                    
                                       
                                          E
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                     is positive definite (of full rank).


                                    
                                       
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                r
                                             
                                          
                                          ⩽
                                          C
                                       
                                     for some 
                                       
                                          C
                                          <
                                          ∞
                                       
                                    , and 
                                       
                                          r
                                          >
                                          1
                                       
                                     that is arbitrarily close to unity.


                     Assumptions 1(ii)–(viii) describe a set of general regularity conditions that ensure good asymptotic behavior of the least squares estimates of a stationary ergodic sequence (White, 2001). Note that Assumption 1(ii) requires that the average demand of the underlying demand process is adjusted for seasonality and product life cycles prior to applying the semi-parametric approach. The following linear representation result of the underlying AR(p) process follows immediately from Gaur et al. (2005), Eq. (2).
                        Lemma 1
                        
                           Under 
                           
                              Assumption 1
                           , the LTD is a linear function of the recent demand history 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                             -
                                             w
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                              
                            
                           and the vector of future residual errors 
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             t
                                             +
                                             L
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           :
                           
                              
                                 (9)
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                       
                                          L
                                       
                                    
                                    ≔
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          +
                                          τ
                                       
                                    
                                    =
                                    c
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             w
                                          
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          i
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          t
                                          +
                                          i
                                       
                                    
                                    .
                                 
                              
                           
                        


                           If the forecasting model 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           is correct, then the LTD point forecast is given by
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    c
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             w
                                          
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                           and the LTD forecast error 
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       t
                                       +
                                       i
                                    
                                 
                              
                            
                           has zero mean and a standard deviation of the form 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Et
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 A
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                              
                           
                           , where A is a positive constant independent of t and 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                              
                            
                           is the standard deviation of the single period forecast error.
                        

Demand forecasting model: The prespecified demand forecasting model 
                              
                                 g
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       L
                                    
                                 
                                 )
                              
                            produces 
                              
                                 τ
                              
                           -step-ahead LTD point forecasts in period t by
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          ,
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          τ
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          τ
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                          -
                                          i
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       w
                                    
                                    
                                       ̃
                                    
                                 
                                 ⩽
                                 w
                              
                           .


                     Assumption 2 covers demand forecasting models within the ARI(
                        
                           
                              
                                 p
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                        
                     ) class with 
                        
                           max
                           (
                           
                              
                                 p
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                           )
                           =
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                        
                     , where point forecasts are generated by the conditional expectation of the demand forecasts made by the chosen ARI model. This class includes many models that are frequently used in practice, such as the autoregressive model, the random walk model and the independent demand model. For a chosen ARI class demand model, one can derive 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 τ
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 τ
                              
                           
                        
                      in (11) by calculating the constant term and autoregressive parameters of the model to be used to make 
                        
                           τ
                        
                     -step ahead point forecasts.

Using (9) and (11), we can write the LTD forecast error associated with the chosen model g in period t as
                        
                           (12)
                           
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    L
                                 
                              
                              =
                              (
                              c
                              -
                              
                                 
                                    c
                                 
                                 
                                    ̃
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       w
                                    
                                 
                              
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    Y
                                 
                                 
                                    t
                                    -
                                    i
                                    +
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    t
                                    +
                                    i
                                 
                              
                              ,
                           
                        
                     which can be written in the form of the bias-adjusting regression equation given by (4), where 
                        
                           
                              
                                 β
                              
                              
                                 0
                              
                           
                           =
                           c
                           -
                           
                              
                                 c
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           -
                           
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 ∊
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 L
                              
                           
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                           
                              
                                 u
                              
                              
                                 t
                                 +
                                 i
                              
                           
                        
                     . We summarize this fact in the following Lemma for future reference.
                        Lemma 2
                        
                           Under 
                           
                              Assumptions 1 and 2
                           , the LTD forecast error of the chosen forecasting model g is equal to 
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 β
                                 +
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           , where 
                           
                              
                                 β
                              
                            
                           is a bias correction parameter vector and 
                           
                              
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       t
                                       +
                                       i
                                    
                                 
                              
                            
                           for some coefficients 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           .
                        


                     Lemma 2 shows that the LTD forecast error of any arbitrary ARI forecasting model is linearly dependent on the current state of the system when the demand follows an AR process. The following final assumption is on the distribution of LTD forecast errors.
                        Assumption 3
                        Distribution of LTD forecast errors: The LTD forecast errors 
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            of the correct forecasting model 
                              
                                 
                                    
                                       g
                                    
                                    
                                       ∗
                                    
                                 
                              
                            have a marginal distribution function 
                              
                                 D
                                 (
                                 z
                                 )
                              
                           , which is continuously differentiable in z with bounded density 
                              
                                 0
                                 <
                                 d
                                 (
                                 z
                                 )
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       ¯
                                    
                                 
                                 <
                                 ∞
                              
                           .


                           Under Assumptions 
                           1–3
                           ,
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          Q
                                       
                                       
                                          n
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    
                                       
                                          →
                                       
                                       
                                          d
                                       
                                    
                                    N
                                    (
                                    0
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           and
                           
                              
                                 (13)
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          I
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                κ
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                          -
                                          K
                                       
                                       
                                          d
                                          (
                                          
                                             
                                                κ
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                    -
                                    
                                       
                                          (
                                          x
                                          -
                                          E
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          (
                                          E
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                              
                            
                           is the true critical fractile and 
                           
                              
                                 
                                    
                                       →
                                    
                                    
                                       d
                                    
                                 
                              
                            
                           denotes convergence in distribution.
                        

The assumptions for the large-sample consistency of the proposed semi-parametric approach include the linearity conditions on the true demand process and point forecasting model (Assumptions 1 and 2) and the mild conditions on the LTD forecast error distribution (Assumption 3). Therefore, the prespecified point forecasting model can be arbitrary within the general class of ARI models and no specific parametric assumptions on the demand distribution are necessary.

If the specified assumptions are satisfied, the conditional forecast bias 
                        
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           β
                        
                      and the non-parametric error quantile 
                        
                           κ
                        
                      are consistently estimated and, consequently, the semi-parametric critical fractile produces an asymptotically correct service level. The asymptotic variance of the semi-parametric critical fractile in (13) has two components: the first results from the non-parametric estimation of 
                        
                           κ
                        
                     , and the second comes from the parametric estimation of the bias correction parameters 
                        
                           β
                        
                     . Next, we look at an special case, where we make one additional assumption that in turn reduces the asymptotic variance.
                        Assumption 4
                        The prespecified forecasting model g produces unbiased LTD point forecasts.


                           Under Assumptions 1, 3 and 4,
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          Q
                                       
                                       
                                          n
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    
                                       
                                          →
                                       
                                       
                                          d
                                       
                                    
                                    N
                                    (
                                    0
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           and
                           
                              
                                 (14)
                                 
                                    
                                       
                                          o
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          I
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                κ
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                          -
                                          K
                                       
                                       
                                          d
                                          (
                                          
                                             
                                                κ
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        


                     Corollary 1 shows that if the chosen point forecasting model is correctly specified and estimated then the second component of the asymptotic variance in (13) becomes zero (see (14)); there is no longer any need to estimate and correct for the bias in the LTD point forecast. If the same point forecasting model is used and 
                        
                           w
                           =
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                        
                     , the semi-parametric approach collapses to the traditional empirical approach in Section 2.2 as both approaches use the same set of empirical forecast errors to calculate the critical fractile. This reduction in the asymptotic variance is important from a practical standpoint and it highlights a second advantage of the semi-parametric approach: If the user-specified model g is the correct model (as per Assumption 4), the semi-parametric critical fractiles will have a smaller asymptotic variance, which for any given sample size n implies lower inventory costs. If the choice of g is poor and leads to biased forecasts, the method will correct for this bias but the poor choice of forecasting method will increase the asymptotic variance of the overall method. Therefore if one can have a control over choosing a forecasting model, it is best to improve the forecasting model prior to applying a semi-parametric approach as this way we can reduce asymptotic variance compared to the case with a misspecified model. Note that the rate of convergence is equal to 
                        
                           
                              
                                 n
                              
                           
                        
                     , independent of the choice of g.

This section presents a numerical analysis which aims to illustrate the finite sample performance of the semi-parametric approach, particularly when we face model uncertainty in the classical newsvendor problem with a fixed lead time L. Given n demand observations, a correct demand forecasting model is not known with certainty, but one chooses (or is given) a forecasting model and estimates the critical fractile 
                        
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 n
                              
                           
                        
                      to minimize mismatch costs during the lead time (
                        
                           t
                           =
                           n
                           +
                           1
                           ,
                           n
                           +
                           2
                           ,
                           …
                           ,
                           n
                           +
                           L
                        
                     ). To test the proposed approach we use the following autoregressive integrated moving average (ARIMA) models to describe the true demand processes:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          Model
                                          
                                          1
                                          -
                                          AR
                                          (
                                          1
                                          )
                                          :
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          μ
                                          +
                                          0.8
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          -
                                          μ
                                          )
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          Model
                                          
                                          2
                                          -
                                          AR
                                          (
                                          3
                                          )
                                          :
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          μ
                                          +
                                          0.8
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          -
                                          μ
                                          )
                                          -
                                          0.4
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                2
                                             
                                          
                                          -
                                          μ
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          +
                                          0.2
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                3
                                             
                                          
                                          -
                                          μ
                                          )
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          Model
                                          
                                          3
                                          -
                                          ARMA
                                          (
                                          1
                                          ,
                                          1
                                          )
                                          :
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          μ
                                          +
                                          0.5
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          -
                                          μ
                                          )
                                          +
                                          0.2
                                          
                                             
                                                u
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          Model
                                          
                                          4
                                          -
                                          ARIMA
                                          (
                                          0
                                          ,
                                          1
                                          ,
                                          1
                                          )
                                          :
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          -
                                          0.8
                                          
                                             
                                                u
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           μ
                        
                      is the unconditional mean of the demand process and 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      is the i.i.d. residual error with mean zero and standard deviation 
                        
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                        
                     . The AR(1) demand process described by Model 1 with Gaussian residual errors 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      is commonly used for describing settings with serial correlation (e.g., Aviv, 2002; Chen et al., 2000; Lee et al., 2000). The ARMA(1,1) and ARIMA(0,1,1) demand processes described by Models 3 and 4 are studied in Gaur et al. (2005) and Graves (1999). Note that Models 1–2 satisfy the conditions of the underlying demand process for the asymptotic validity of the semi-parametric approach (Assumption 1). For a robustness check, we included an ARMA process (Model 3) and an ARIMA process (Model 4).

The first source of model uncertainty we consider is the specification of the point forecasting model. We consider two cases where the decision-maker (i) knows the correct model specification but faces parameter estimation uncertainty and (ii) “naively” employs one of two forecasting models commonly used in practice: simple exponential smoothing or the i.i.d. demand model (Makridakis, Wheelwright, & Hyndman, 1998). In the second case we assume that the parameter values of the chosen forecasting model (exponential smoothing or i.i.d.) are estimated in order to minimize the mean square forecast error. We note that exponential smoothing provides the minimum mean square error forecasts only when the demand follows an ARIMA(0,1,1) demand process and the i.i.d. demand model gives unbiased forecasts only when the demand process is indeed i.i.d. Using exponential smoothing or i.i.d. demand models under the demand processes described by Models 1–4 represents using misspecified forecasting models, except in the case where exponential smoothing is used for Model 4.

The second source of model uncertainty we consider comes from the error distribution. We examine three error distributions for the residual errors 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                     : the normal, gamma and student-t distributions, which represent the symmetric, positive skewed and fat-tailed alternatives, respectively. Each distribution has been centered to have zero mean and scaled to have the same standard deviation 
                        
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                        
                     .

Under the semi-parametric approach, we fix the order size of the bias-adjusting regression model (4) at 
                        
                           w
                           =
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                        
                      (i.e. we check for the bias conditional on the past demand observations that are used to make forecasts).
                        1
                        In theory, one can increase the size of w (i.e., 
                              
                                 w
                                 >
                                 
                                    
                                       w
                                    
                                    
                                       ̃
                                    
                                 
                              
                           ) to check if there is any conditional bias in the higher lag order. Fitting a bias-adjusting model with 
                              
                                 w
                                 >
                                 
                                    
                                       w
                                    
                                    
                                       ̃
                                    
                                 
                              
                            predictors will generally result in a small estimated (in-sample) variance in 
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                    
                                       L
                                    
                                 
                              
                           , but substantial out of sample variance due to errors arising from the parameter estimation. When w is large, in order to select the appropriate number of regression coefficients 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            that are nonzero in the biased-adjusting model, it is practical to use a model selection method that balances goodness of fit with parsimony. One possibility is to use the information criterion, e.g., Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) (see Miller, 1990 for more details as well as alternative model selection methods). In the Supplementary material, we report the performance of the semi-parametric approach for different values of w. This sensitivity analysis is based on using the retail data in Section 6 and shows that the semi-parametric approach with w
                           =5 or 6 makes a good performance.
                     
                     
                        1
                      To assess the quality of the semi-parametric approach, we use the parametric, empirical and non-parametric approaches as benchmarks. The parametric approach and empirical approach employed in the simulation study are described in Sections 2.1 and 2.2, respectively. The purely non-parametric approach we consider is a simple sampling-based approach which assumes an i.i.d. demand process.
                        2
                        More specifically, given n demand observations, we generate 1000 samples for 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       n
                                       +
                                       τ
                                    
                                 
                              
                            for each 
                              
                                 τ
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 L
                              
                            independently, denoted by 
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       τ
                                    
                                 
                              
                           , by sampling with replacement and assigning probability mass 
                              
                                 1
                                 /
                                 n
                              
                            to each realized demand observation, 
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           . This allows us to construct 1000 samples of the LTD: 
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       τ
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       τ
                                    
                                 
                              
                           . The empirical distribution of these samples is used to calculate the non-parametric critical fractiles. When 
                              
                                 L
                                 =
                                 1
                              
                           , this non-parametric approach is equivalent to the bootstrap approach examined by Bookbinder and Lordahl (1989).
                     
                     
                        2
                     
                  

The performance of each approach is evaluated in terms of how far the estimated critical fractiles and inventory costs are from the optimal value 
                        
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                        
                      and its cost 
                        
                           C
                           (
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                           )
                        
                     , which are calculated using the true underlying demand model (Models 1–4). We consider both the high-margin and low-margin conditions; in the high-margin condition, we set the unit underage cost 
                        
                           s
                           =
                           9
                        
                      and overage cost 
                        
                           h
                           =
                           3
                        
                      to obtain the desired service level 
                        
                           K
                           =
                           0.75
                        
                     . In the low-margin condition, we set 
                        
                           s
                           =
                           3
                        
                      and 
                        
                           h
                           =
                           9
                        
                      to obtain 
                        
                           K
                           =
                           0.25
                        
                     . In the case of symmetric error distributions (e.g., normal and student-t distributions), the results for the two profit conditions are symmetric. In this case, we report the results only for the high profit condition.

The parameters we use across all simulations are 
                        
                           μ
                           =
                           100
                           ,
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                           =
                           4
                           ,
                           n
                           =
                           300
                        
                      and 
                        
                           L
                           =
                           5
                        
                     . Given these parameters, the simulation experiment is designed as follows: For each simulation run we generate the demand for n consecutive time periods using the true demand generating model (Models 1–4). Based on the generated history, the critical fractiles for the lead time L are calculated using each estimation approach (parametric, empirical, semi-parametric, non-parametric). We then generate 1000 realized out-of-sample demand observations for each post sample period, 
                        
                           n
                           +
                           1
                           ,
                           n
                           +
                           2
                           ,
                           …
                           ,
                           n
                           +
                           L
                        
                     , conditional on the last n observations. Based on the LTD realizations, we calculate the critical fractile bias 
                        
                           (
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 n
                              
                           
                           -
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                           )
                           /
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                        
                      and cost error 
                        
                           (
                           C
                           (
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 n
                              
                           
                           )
                           -
                           C
                           (
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                           )
                           )
                           /
                           C
                           (
                           
                              
                                 Q
                              
                              
                                 n
                              
                              
                                 ∗
                              
                           
                           )
                        
                      of each estimation approach. We report the average critical fractile bias and average cost error with their standard errors, which are calculated over 1000 simulation runs. The outlined simulation experiment has been carried out in the R (version 2.13.1) statistical package and the R code used in this study can be provided on request. The average computational time to estimate the semi-parametric critical fractile was 0.15seconds per simulation on a 2.3Gigahertz Intel Core i5 machine with 6Gigabyte RAM.

@&#RESULTS@&#

We first consider the case of model uncertainty due to using a misspecified point forecasting model. Tables 1 and 2
                        
                         compare the average bias and cost errors of each approach with their standard errors when the correct model specification is known (Row 1 of each demand model) and when a misspecified point forecasting model, such as exponential smoothing (ES) and i.i.d., is used (Rows 2 and 3 of each demand model). Note that under the non-stationary demand process given by Model 4, the use of exponential smoothing is optimal. In order to focus on the impact of point forecasting model specification error all simulations presented in Tables 1 and 2 use Gaussian errors 
                           
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                           
                        .

As one would expect, the parametric critical fractile based on the correctly specified model is a good approximation of a true optimal level. The sub-optimality of the parametric critical fractile stems from the model parameter estimation error given n demand observations. Table 1 suggests that the parametric approach is particularly biased due to parameter uncertainty when the underlying demand model is first-order autoregressive (Model 1). This results from the large bias in the estimation of autoregressive parameter in small samples, especially for highly autocorrelated processes (Phillips, 1979). Under the stationary demand processes (Models 1–3), the parametric approach with the exponential smoothing overestimates critical fractiles (positive bias) as discussed in Graves (1999). Furthermore, if the i.i.d. demand model is used inappropriately under autocorrelated demand processes, the parametric approach underestimates critical fractiles (negative bias), as was also the case in multi-echelon inventory systems observed in Erkip et al. (1990). The parametric approach results in biased critical fractiles as it makes false assumptions about the mean and variance of the LTD forecast error distribution (see Section 2.1).

In contrast to the parametric approach, the semi-parametric approach is very close to optimal and almost unbiased independently of the chosen point forecasting model. The results indicate that the proposed approach is a good heuristic for broader demand processes such as ARMA and forecasting models such as exponential smoothing, which are not included in the assumptions of Theorem 1. The improvement of the semi-parametric method over the parametric results is demonstrated by the significant reduction in costs it generates (9.0–241.0%). However, its performance deteriorates for the non-stationary demand process (Model 4). The semi-parametric approach also outperforms the empirical approach when a chosen point forecasting is biased and this comes from using the bias-correction regression as a way to correct for the conditional forecast bias under autocorrelated demand series.

The fully non-parametric approach estimates asymptotically correct critical fractiles only for i.i.d. demand processes. As indicated by Tables 1 and 2, when the underlying demand process is highly autocorrelated, the non-parametric approach calculates significantly biased critical fractiles that are pulled towards the mean of LTD and leads to significantly increased inventory costs.

Next, we study the robustness of each approach against different error distributions. To isolate the effect of model uncertainty that arises from assuming the incorrect error distribution as opposed to that which arises from using a misspecified point forecasting model, we consider the case in which the correctly specified point forecasting model is employed. Table 3
                         presents the average cost errors when the error distributions are normal, gamma and t-distributions (with the same mean and standard deviation) under the demand process of Model 1. Since the gamma distribution is not symmetric, we consider both the high-margin condition 
                           
                              (
                              K
                              =
                              0.75
                              )
                           
                         and low-margin condition 
                           
                              (
                              K
                              =
                              0.25
                              )
                           
                        . We observe that the performance of the parametric approach generally worsens for alternative error distributions as it falsely makes the Gaussian assumption in the errors. In contrast, the performance of the empirical and semi-parametric approach is less affected by alternative distributional assumptions. The non-parametric approach continues to not perform well as it cannot deal with serially correlated demand.

In this section we examine the performance of the semi-parametric approach for different values of sample size, lead time and service level, relative to the performance of the parametric approach and empirical approach. We also demonstrate that the performance of the semi-parametric approach improves when the point-forecasting model used 
                           
                              
                                 
                                    g
                                 
                                 
                                    τ
                                 
                              
                           
                         is (nearly) correct (Corollary 1). For illustrative purposes, we focus on the AR(1) demand model described by Model 1 and Gaussian errors, and the cases where the correct, exponential smoothing and i.i.d. point forecasting models are used. Other results are qualitatively similar.


                        Fig. 1
                         shows the evolution of the cost error of the semi-parametric approach as a function of sample size compared with the parametric approach. When the forecasting model is correctly specified (Fig. 2
                        a), the effect of parameter estimation error on the performance of the parametric approach becomes negligible as the sample size increases. Also, in this case the empirical approach can consistently estimate critical fractiles using past forecast errors. However, in the face of model misspecification, (Fig. 2a and b) the cost error of the parametric and empirical approaches may be substantial and is largely insensitive to the increase in sample sizes. In contrast, we observe that the cost error of the semi-parametric approach decreases to zero, independently of a chosen forecasting model, as Theorem 1 indicates.


                        Figs. 2 and 3
                         demonstrate the impact of lead time and service level on inventory cost errors. Both the lead time and the service level have little effect on the cost error of either approach when the correct model is specified (Figs. 3a and 4
                        a). However, in the case of model misspecification we observe that, unlike the semi-parametric approach, the parametric and empirical approaches are sensitive to changes in lead time and service level. In the face of model uncertainty, the semi-parametric approach leads to substantially lower inventory cost, especially for the longer lead times (Fig. 3b) and higher service levels (Fig. 4b and c).

Next, we examine the sensitivity of the semi-parametric approach to the point forecasting model 
                           
                              
                                 
                                    g
                                 
                                 
                                    τ
                                 
                              
                           
                         used. Theorem 1 and Corollary 1 show that when the user-specified forecasting model is unbiased, the semi-parametric approach has a smaller asymptotic variance and thus lower inventory costs for any given sample size n. To illustrate this asymptotic property empirically we test two point forecasting models. The first is the true forecasting model 
                           
                              
                                 
                                    g
                                 
                                 
                                    ∗
                                 
                              
                           
                         and the second is the model that produces point forecasts that are equal to zero, i.e., 
                           
                              g
                              =
                              0
                           
                        . Fig. 4 shows that the convergence rates are similar for the two forecasting models. However, the cost error at any given sample size n is lower when the true model 
                           
                              
                                 
                                    g
                                 
                                 
                                    ∗
                                 
                              
                           
                         is used. We also examine the average cost errors when the point forecasting model is correctly specified as AR(1), but there is still parameter estimation uncertainty (parameter values for the unconditional mean of the demand process 
                           
                              μ
                           
                         and the autoregressive coefficient 
                           
                              ϕ
                           
                        ). For a given sample size 
                           
                              n
                              =
                              150
                           
                        , Fig. 5
                         illustrates that the cost error is low around the correct parameter values in Model 1 (
                           
                              μ
                              =
                              100
                           
                         and 
                           
                              ϕ
                              =
                              0.8
                           
                        ), but increases as the parameter estimation errors increase. These results outline the practical importance of improving the initial point-forecasting models, even when the semi-parametric approach is employed.

In this section we use real data in the setting of retail inventory forecasting problem, which is modeled as a single-period newsvendor problem. We use daily sales data of different items from an outlet of a large UK supermarket chain (Taylor, 2007). Since we use this data as actual demand realizations, we restrict the study to 14 time series (out of 216) where the percentage of zero sales is less than 0.5%. For simplicity, we assume that there is no stockout in these products or we need to apply a methodology that makes the data uncensored. The 14 time series contain 1414–1436 daily observations. Prior to the critical fractile estimation, we assumed multiplicative seasonality and deseasonalized the data using the decomposition method based on ratio-to-moving averages and made adjustments to the data during the winter holiday season.

We compare the parametric, empirical, semi-parametric and non-parametric estimations of critical fractiles in terms of the average single-period inventory cost and service level. As in the simulation study, we set the window size of the bias-adjusting model 
                        
                           w
                           =
                           
                              
                                 w
                              
                              
                                 ̃
                              
                           
                        
                      and the lead time 
                        
                           L
                           =
                           5
                        
                     , which is close to the actual lead time of the retailer in question. In addition, the sales distribution is not generally symmetric but positively skewed and therefore we consider both the low-margin 
                        
                           (
                           s
                           =
                           3
                           ,
                           h
                           =
                           9
                           ,
                           K
                           =
                           0.25
                           )
                        
                      and high-margin 
                        
                           (
                           s
                           =
                           9
                           ,
                           h
                           =
                           3
                           ,
                           K
                           =
                           0.75
                           )
                        
                      conditions. For each sales series, we use the first 
                        
                           n
                           =
                           300
                        
                      observations to estimate critical fractiles for the following 
                        
                           L
                           =
                           5
                        
                      periods to meet the prespecified service level K. The resultant critical fractiles are reseasonalized and compared with the actual sales observations over the lead time. This process is repeated for 1000 such iterations based on a rolling sampling scheme, with the origin of the sample shifted by 1-day increments. We then calculate the average single-period inventory cost with 1000 samples of single-period inventory costs. The average service level is estimated as the percentage of iterations where the LTD realizations fall below the estimated critical fractiles.

With this real data, we never know the correct forecasting model. In order to demonstrate the robustness of each estimation approach under model uncertainty, we consider the case where four different forecasting models are employed to conduct inventory planning. The four forecasting models are: (1) AR(1), (2) random walk (RW), (3) exponential smoothing (ES), (4) i.i.d. Tables 4 and 5
                     
                      report the average single-period inventory cost and service level for one of the 14 items we study. The results for the other items are qualitatively similar and are provided in the Supplementary material. Table 4 suggests that, as in the simulation study, the semi-parametric approach is robust against the choice of forecasting model. In contrast, the performance of the parametric approach is sensitive to the chosen forecasting model. As a result, we observe that the robustness of the semi-parametric approach leads to the reduction of inventory costs by up to 57% as compared to the parametric approach. While the average inventory costs of the two approaches are similar when exponential smoothing is used (on average 4% cost reduction in the low-margin condition and 1% cost reduction in the high-margin condition), the semi-parametric approach nearly always generates a service level closer to the nominal value K. The empirical approach has lower inventory costs than the parametric approach in general by avoiding a distributional assumption, but its performance deteriorates when the chosen forecasting model is poor. The non-parametric approach leads to substantially increased inventory costs as it ignores demand autocorrelation (which varies between 0.4 and 0.8).

@&#CONCLUSION@&#

This paper proposes a semi-parametric approach for forecasting the critical fractiles under autocorrelated demand processes, which effectively deals with two possible sources of model uncertainty: incorrect functional form of the user-specified point forecasting model and wrong parametric assumption on the forecast error distribution. As in a standard industrial practice, the proposed approach takes as given a demand forecasting model, which produces point forecasts for the required lead time. Given historical demand observations, we then systematically collect the empirical LTD forecast errors of the chosen model. We use these empirical errors first to correct for any bias in point forecasts conditional on the recent demand history and second to estimate the critical fractile non-parametrically.

Our main asymptotic result demonstrates that if the demand follows an AR(p) process, the proposed empirical approach consistently estimates the required critical fractile, independently of the prespecified forecasting model within the general class of ARI(
                        
                           
                              
                                 p
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                        
                     ) time series models, and no specific parametric assumptions on the demand distribution are necessary. Note that the ARI class of forecasting models includes a number of models commonly used in practice, e.g., the autoregressive, random walk and i.i.d. demand models. We also show in our simulation studies that the semi-parametric approach is a good heuristic for a more general class of demand processes (ARMA) and forecasting models (ARIMA). Furthermore, the simulation results illustrate that the proposed approach can significantly reduce inventory costs and that these cost reductions are generally increasing in the sample size, lead time and service level requirement. In general, the sample size of 
                        
                           n
                           ⩾
                           150
                        
                      is recommended to achieve credible accuracy. Finally, we illustrate the practical applicability of the proposed approach in the retail operations setting.

Our findings provide a valuable tool for managers who are facing newsvendor-type tradeoffs in real-life situations. Our approach allows the inventory manager to fully deploy the user-specified forecasting model, which due to estimation, scale and organizational complexities may be incorrectly specified. If this forecasting model produces (nearly) correct LTD forecasts, the proposed approach makes good use of them by reducing the asymptotic variance of the critical fractile estimator. If, on the other hand, the model consistently produces biased LTD forecasts, the proposed approach still calculates asymptotically correct critical fractiles by exploiting the empirical LTD forecast error distribution. Our proposed approach also has the added advantage of not requiring any distributional assumption about the forecast errors. In view of the present rate of technological development, we feel that the computational intensity of the approach (0.15seconds on average) is unlikely to be significant constraint.

There are a number of directions in which it would be of interest to extend the semi-parametric approach. These could include extensions to a multi-period setting, dealing effectively with censored demand data and accounting for structural breaks in the demand process. We leave them all as topics for further research.

@&#ACKNOWLEDGEMENTS@&#

The author thanks editor Immanuel Bomze and an anonymous referee for their thoughtful, clear, and constructive feedback. She is also thankful for many valuable comments made by Stefan Scholtes, Nicos Savva, Danny Ralph and James Taylor.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2013.10.055, and may be obtained from the author upon request.


                     
                        
                           Supplementary material
                           
                        
                     
                  

@&#REFERENCES@&#

