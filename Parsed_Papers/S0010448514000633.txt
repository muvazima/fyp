@&#MAIN-TITLE@&#Polynomial spline interpolation of incompatible boundary conditions with a single degenerate surface

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Propose a method to interpolate a four-sided region with incompatible boundary.


                        
                        
                           
                           Achieve 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                               continuity with the boundary except for incompatible corner points.


                        
                        
                           
                           Utilize the property of multi-valued normal vectors at degenerate points.


                        
                        
                           
                           The proposed method is constructive and straightforward.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Interpolation

Degenerate

Polynomial spline




                     




                        




                           




                              G




                           




                           




                              1




                           




                        




                      continuity

@&#ABSTRACT@&#


               
               
                  Coons’ construction generates a surface patch that interpolates four groups of specified boundary curves and the corresponding cross-boundary derivative curves. This constructive method is simple and widely used in computer aided design. However, at the corner points, it requires compatibility of the boundary conditions, which is usually difficult to satisfy in practice. In order to handle the incompatible case where the normal directions respectively indicated by two adjacent boundaries do not agree with each other at the common corner point, we utilize the property of degenerate parametric surfaces that the normal directions can converge to multiple values at degenerate points, and therefore the local degenerate geometry can satisfy conflicting conditions simultaneously. Following this idea, we use a single patch of 
                        
                           (
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                           ,
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                           )
                        
                     -degree polynomial spline surface with four degenerate corners to interpolate incompatible boundary conditions, which are represented by 
                        p
                     -degree polynomial spline curves with 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity. This method is based on symbolic operations and polynomial reparameterizations for polynomial splines, and without introducing any theoretical errors, it achieves 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity on the boundary except for the four corner points.
               
            

@&#INTRODUCTION@&#

Coons’  [1] construction is a fundamental method to generate smooth transition surfaces. With four specified boundary curves and the cross-boundary derivative curves respectively corresponding to them, Coons’ method generates a surface patch that interpolates all boundary conditions (see Fig. 1
                     (a)). The generated surface is a Boolean sum of the convex combinations of two opposite boundary conditions and a correction patch spanned by the derivative conditions at the four corner points. Thanks to this simple and elegant formulation, Coons surfaces have been widely studied and used in both industry and academia during the past decades [2,3]. However, the well-known compatibility conditions   [4–6] require that the given boundary constraints agree with each other at the corner points. These conditions usually induce extra difficulty in geometric construction as they may be too “strong” to satisfy in practice, especially in free-form surface design. For example, in Fig. 1(a), at the corner between the 
                        i
                     th and the 
                        j
                     th boundaries, the derivative of the 
                        j
                     th boundary curve needs to agree with the cross-boundary derivative of the 
                        i
                     th boundary. For some special incompatible cases, we can adjust the boundary condition curves to make them compatible, and the generated Coons surface can be 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuous with the boundary instead of 
                        
                           
                              C
                           
                           
                              1
                           
                        
                        [7–10]. Nevertheless, this does not apply to all bad cases in practice. Fig. 1(b) is an example: the two groups of boundary conditions give different normal directions at the corner point, so the Coons surface should agree with both of them simultaneously if it interpolates all boundary conditions exactly. Generally, for a non-degenerate point on a surface, this conflicts with the uniqueness property of normal direction. However, Peters  [11] and Reif  [12] observed that the non-zero second-order derivatives define the normal direction of a point if the Jacobian matrix is zero. This property provides the possibility to satisfy conflicting boundary conditions since we can construct a degenerate corner where the normal directions converge to different values.

In this paper, we propose a method to interpolate incompatible boundary conditions represented by 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuous polynomial splines curves. With 
                        p
                     -degree input curves, the method generates a single 
                        
                           (
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                           ,
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                           )
                        
                     -degree polynomial spline surface patch, which has 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity with the original condition on the boundary except for the four incompatible corner points. The method first transforms and reparameterizes all input curves to ensure that the derivatives at the end points of them are exactly zero. Then, it adjusts the magnitude of the cross-boundary derivative curves by multiplying a crescent-shaped function so that the values at the end points of these curves are zero. This reformation of the boundary conditions guarantees 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity on the boundary edge except for the two end-points, and the reformed boundary conditions fully satisfy tangent and twist compatibilities  [4]. After that, it constructs the result surface according to the Boolean-sum formula of Coons’ strategy. The generated surface has four degenerate corner points and exactly interpolates the specified boundary conditions except for the incompatible corner points. Our method has the following features and advantages.
                        
                           –
                           The method preserves piecewise polynomial forms. The output surface is a polynomial spline if all input curves are polynomial splines.

Without introducing any theoretical errors, we achieve 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                               continuity with the original boundary conditions on the boundary except for the four corner points.

The algorithm is constructive and straightforward. No iteration or large-scale matrix solving are required.

The organization of the rest paper is as follows. After reviewing related work in Section  2, we give a formal definition of the problem and the local properties of degenerate points in Section  3. Section  4 then presents the framework of our constructive method by giving the three steps to reform the boundary conditions. As this method is presented algebraically, Section  5 explains the geometric meaning of it. We give examples, comparisons and discussions in Section  6 and conclude the paper in Section  7.

@&#RELATED WORK@&#

Many boundary interpolation methods with piecewise polynomials were classified into single-patch approaches, blending approaches and splitting approaches in  [13]. The compatibility problems with interpolation involve many challenges on error prevention and geometric beautification in computer aided design [14]. The difficulties of the compatibility problems were reviewed in  [15]. In order to solve these problems, Gregory  [4] proposed a construction method which introduces additional rational terms to prevent compatibility restrictions on the specified boundary conditions. After this method, many other interpolation schemes, for example  [16–19], were proposed to adapt to different boundary conditions. For the common issue of 
                        n
                     -sided region filling, which is a generalization of the four-sided interpolation problem, subdivision and non-polynomial blending schemes, for example,[20–23], can permit incompatible corner points as well. However, these methods only achieve smooth and visual-pleasing shapes and cannot preserve the polynomial form of the result surface. This is one of the major limitations in practice, especially for data exchange and further geometric manipulation in CAD systems.

According to the study in  [24], incompatible corners can be classified into three categories. Formally, at the corner which is the common point of the 
                        i
                     th and the 
                        j
                     th boundary (
                        j
                        =
                        
                           (
                           i
                           +
                           1
                           )
                        
                        
                        
                           mod
                        
                        
                        4
                     ), we represent these three categories by the following four derivative vectors: 
                        
                           
                              D
                           
                           
                              u
                           
                           
                              i
                           
                        
                        
                           (
                           1
                           )
                        
                     , 
                        
                           
                              D
                           
                           
                              v
                           
                           
                              i
                           
                        
                        
                           (
                           1
                           )
                        
                     , 
                        
                           
                              D
                           
                           
                              u
                           
                           
                              j
                           
                        
                        
                           (
                           0
                           )
                        
                      and 
                        
                           
                              D
                           
                           
                              v
                           
                           
                              j
                           
                        
                        
                           (
                           0
                           )
                        
                      (see Fig. 1(a)).
                        
                           -
                           
                              Category I:
                              
                                 
                                    
                                       D
                                    
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                               are linearly dependent, and 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                               are linearly dependent as well.


                              Category II: The four derivative vectors are coplanar however cannot satisfy Category I, and the reformed boundary conditions (see the following explanation) can satisfy twist compatibility   [1].


                              Category III: As shown in Fig. 1(b), the four derivative vectors do not satisfy either Category I or Category II. Usually, the tangent plane spanned by 
                                 
                                    
                                       D
                                    
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                               does not share the same normal direction with the tangent plane spanned by 
                                 
                                    
                                       D
                                    
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              . In other words, the two group of boundary conditions indicate different normal directions, respectively.

The interpolation method in this paper aims to construct a single polynomial spline surface patch that interpolates four specified boundary curves and also satisfy 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity conditions with the corresponding cross-boundary derivative curves on the boundary except for the four corner points. These boundary conditions are derived from boundary surfaces or specified independently. We denote the boundary curves by 
                        
                           
                              D
                           
                           
                              o
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                      and the corresponding cross-boundary derivatives by 
                        
                           
                              D
                           
                           
                              v
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                     , where 
                        k
                        =
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                     . Without loss of generality, we assume that 
                        t
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     . We also denote the derivative of 
                        
                           
                              D
                           
                           
                              o
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                      by 
                        
                           
                              D
                           
                           
                              u
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                      and the derivative of 
                        
                           
                              D
                           
                           
                              v
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                      by 
                        
                           
                              D
                           
                           
                              u
                              v
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                     . All of these parametric curves are non-degenerate and 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuous polynomial spline curves and the boundary curves are connected in order with anticlockwise positive parametric directions as shown in Fig. 1(a).

On a parametric surface 
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     , we denote the derivatives at a point 
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                      by 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                                …
                                                u
                                             
                                             ︸
                                          
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                                …
                                                v
                                             
                                             ︸
                                          
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   a
                                                   +
                                                   b
                                                
                                             
                                             S
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   a
                                                
                                             
                                             ∂
                                             
                                                
                                                   v
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       
                                          u
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          v
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                      This paper involves the degenerate case where 
                        
                           
                              S
                           
                           
                              u
                           
                        
                        =
                        
                           
                              S
                           
                           
                              v
                           
                        
                        =
                        0
                     , and 
                        
                           
                              S
                           
                           
                              u
                              u
                           
                        
                     , 
                        
                           
                              S
                           
                           
                              u
                              v
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              v
                              v
                           
                        
                      are linearly independent. Evidently, the classical formula of normal direction: 
                        N
                        =
                        
                           (
                           
                              
                                 S
                              
                              
                                 u
                              
                           
                           ×
                           
                              
                                 S
                              
                              
                                 v
                              
                           
                           )
                        
                        /
                        
                           ‖
                           
                              
                                 S
                              
                              
                                 u
                              
                           
                           ×
                           
                              
                                 S
                              
                              
                                 v
                              
                           
                           ‖
                        
                      fails at these points as the denominator vanishes. Instead, according to the study of the degenerate case  [11,12], the normal directions can converge to different values from different directions to this point. We denote the direction on the parametric space by 
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      (
                        
                           
                              α
                           
                           
                              2
                           
                        
                        +
                        
                           
                              β
                           
                           
                              2
                           
                        
                        ≠
                        0
                     ), and in this direction, we create a radial curve 
                        
                           
                              C
                           
                           
                              α
                              ,
                              β
                           
                        
                        
                           (
                           t
                           )
                        
                        =
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           +
                           α
                           t
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           +
                           β
                           t
                           )
                        
                      as shown in Fig. 2
                     . Its tangent vector 
                        T
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      at point 
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                      can be formulated by 
                        
                           
                              T
                              
                                 (
                                 α
                                 ,
                                 β
                                 )
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    α
                                    ,
                                    β
                                 
                                 
                                    ″
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    u
                                    u
                                 
                              
                              +
                              2
                              α
                              β
                              
                                 
                                    S
                                 
                                 
                                    u
                                    v
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    v
                                    v
                                 
                              
                              ,
                           
                        
                      since the first-order derivative of 
                        
                           
                              C
                           
                           
                              α
                              ,
                              β
                           
                        
                        
                           (
                           t
                           )
                        
                      is zero. Without loss of generality, we assume that 
                        T
                        
                           (
                           τ
                           )
                        
                        =
                        T
                        
                           (
                           1
                           −
                           τ
                           ,
                           τ
                           )
                        
                      in the first quadrant of the parametric space. When 
                        τ
                      changes, the tangent vector sweeps and forms a local tangent plane (see Fig. 2), and according to the geometric definition of normal vectors, we have the formula of the limit of the normal direction 
                        
                           (2)
                           
                              N
                              
                                 (
                                 τ
                                 )
                              
                              =
                              
                                 (
                                 T
                                 
                                    (
                                    τ
                                    )
                                 
                                 ×
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 )
                              
                              /
                              
                                 ‖
                                 T
                                 
                                    (
                                    τ
                                    )
                                 
                                 ×
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 ‖
                              
                              .
                           
                        
                      It can be proved that the assumption “
                        
                           
                              S
                           
                           
                              u
                              u
                           
                        
                     , 
                        
                           
                              S
                           
                           
                              u
                              v
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              v
                              v
                           
                        
                      are linearly independent” guarantees that the denominator will not vanish.

The following algorithm aims at solving Category III of incompatible corners. First, we transform the cross-boundary derivative curves so that any two adjacent cross-boundary derivative curves can share the same derivative vector at the common corner. Second, we reparameterize all boundary condition curves to ensure that their derivatives vanish at the end points. Then, we adjust the magnitude of each cross-boundary derivative curve to ensure that the value of the curve vanishes at the two end points. After this three-step reformation, the boundary will fully satisfy 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      compatibility conditions of Coons’ construction. The constructed Coons surface using these reformed boundary conditions achieves 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      continuity with the original boundary except for the four corner points. The following subsections focus on the details of these three steps, respectively.

The transformation in this subsection aims at bending the end-point values of a cross-boundary derivative curve to the common derivative vectors of the corresponding corners. This transformation has the same form with (1) however the boundary conditions are different. As shown in Fig. 1(b), the common derivative vector 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         of the corner between the 
                           i
                        th and the 
                           j
                        th boundaries is a vector that lies on both the plane spanned by 
                           
                              
                                 D
                              
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         and 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         and the plane spanned by 
                           
                              
                                 D
                              
                              
                                 u
                              
                              
                                 j
                              
                           
                           
                              (
                              0
                              )
                           
                         and 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 j
                              
                           
                           
                              (
                              0
                              )
                           
                        . We choose the bisector of the corner as the direction of 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         if the two planes coincide. Otherwise, the direction of 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         should be consistent with the intersection line of the two planes, and the positive direction of 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         should point to the center of the four-sided region. We estimate the magnitude of 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         by the following empirical formula


                        
                           
                              
                                 
                                    ‖
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ‖
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          D
                                       
                                       
                                          o
                                       
                                       
                                          s
                                       
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    −
                                    
                                       
                                          D
                                       
                                       
                                          o
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    ‖
                                 
                                 .
                              
                           
                        
                     

After that, we apply the transformation (1) to each cross-boundary derivative curve combining with 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 T
                              
                              
                                 k
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                        . It follows that 
                           
                              (3)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             α
                                             
                                                (
                                                0
                                                )
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             +
                                             β
                                             
                                                (
                                                0
                                                )
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             α
                                             
                                                (
                                                1
                                                )
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                             +
                                             β
                                             
                                                (
                                                1
                                                )
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         In (3), 
                           
                              
                                 T
                              
                              
                                 k
                                 i
                              
                           
                        , 
                           
                              
                                 D
                              
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                         and 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                         are always coplanar, 
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           
                              
                                 D
                              
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         and 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         are coplanar as well. Thus, this linear system has a solution. We construct the linear functions 
                           α
                           
                              (
                              t
                              )
                           
                         and 
                           β
                           
                              (
                              t
                              )
                           
                         using the boundary conditions solved from (3), apply them to the original boundary condition curves according to (1) by symbolic operators for polynomial splines (e.g., see  [33] for Bézier and B-spline curves), and finally generate the reformed cross-boundary derivative curves 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         (
                           i
                           =
                           0
                           ,
                           1
                           ,
                           2
                           ,
                           3
                        ). The degree of the new cross-boundary derivative curve is greater than the original curve by one. In the following subsections, we denote these new curves by 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         (let 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                           ⇐
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        ) since they are considered as the input of the next step.

All the boundary conditions from the previous step are polynomial spline curves. The goal of this step is to reparameterize these curves to ensure that the first-order derivative vectors of these curves vanish at the end points.

For input curve 
                           C
                           
                              (
                              t
                              )
                           
                        , a parameterization that ensures the zero derivative at one end point is 
                           
                              
                                 C
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              τ
                              )
                           
                           =
                           C
                           
                              (
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , where we assume that 
                           
                              
                                 τ
                              
                              
                                 2
                              
                           
                           =
                           t
                        . Under this definition, 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              τ
                              )
                           
                           =
                           
                              
                                 C
                              
                              
                                 ′
                              
                           
                           
                              (
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           2
                           τ
                           
                              
                                 C
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                        , and therefore 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              τ
                              )
                           
                           
                              
                                 |
                              
                              
                                 τ
                                 =
                                 0
                              
                           
                           =
                           0
                        . This square parameterization will double the degree of the input curve.

Especially, if 
                           C
                           
                              (
                              t
                              )
                           
                         is a 
                           p
                        -degree Bézier curve with control points 
                           P
                           
                              [
                              i
                              ]
                           
                         (
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           p
                        ), the control points 
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           
                              [
                              j
                              ]
                           
                         (
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           2
                           p
                        ) of the result Bézier curve 
                           
                              
                                 C
                              
                              
                                 ′
                              
                           
                           
                              (
                              τ
                              )
                           
                         can be computed as follows. 
                           
                              (4)
                              
                                 
                                    
                                       
                                          {
                                          
                                             
                                                P
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             [
                                             0
                                             ]
                                          
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             [
                                             1
                                             ]
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             [
                                             2
                                             p
                                             ]
                                          
                                          }
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       p
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       R
                                    
                                    
                                       p
                                    
                                 
                                 ⋅
                                 
                                    
                                       M
                                    
                                    
                                       p
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          {
                                          P
                                          
                                             [
                                             0
                                             ]
                                          
                                          ,
                                          P
                                          
                                             [
                                             1
                                             ]
                                          
                                          ,
                                          …
                                          ,
                                          P
                                          
                                             [
                                             p
                                             ]
                                          
                                          }
                                       
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                         In the formula, 
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                         is the transition matrix from Bernstein basis to power basis, and the element of the 
                           i
                        th column and the 
                           j
                        th row can be formulated as follows. 
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                p
                                             
                                          
                                          )
                                       
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                         −
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                         −
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   j
                                                   −
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             j
                                             ≥
                                             i
                                             ;
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                             
                                          
                                          
                                             j
                                             <
                                             i
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         Since all diagonal elements of the lower triangular matrix 
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                         are non-zero values, 
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                         is non-singular and has a determined inverse matrix as follows. 
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                p
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                         −
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                         −
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             j
                                             ≥
                                             i
                                             ;
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             j
                                             <
                                             i
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 R
                              
                              
                                 p
                              
                           
                         is a 
                           
                              (
                              2
                              p
                              +
                              1
                              )
                           
                           ×
                           
                              (
                              p
                              +
                              1
                              )
                           
                         matrix, and the element of 
                           
                              
                                 R
                              
                              
                                 p
                              
                           
                         satisfies that 
                           
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                                 k
                                 ,
                                 k
                              
                           
                           =
                           1
                         (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           p
                        ), otherwise 0. If 
                           C
                           
                              (
                              t
                              )
                           
                         is a piecewise polynomial curve that has more than one segment, we decompose it into polynomial segments (e.g., see  [3] for B-splines), reparameterize each one and join all reparameterized segments. One segment, denoted by 
                           
                              
                                 C
                              
                              
                                 
                                    [
                                    a
                                    ,
                                    b
                                    ]
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         (
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                         is a non-zero knot interval), is actually after a linear reparameterization from the original spline curve, so according to the definition, we have the parameterized segment 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              (
                              τ
                              )
                           
                           =
                           
                              
                                 C
                              
                              
                                 
                                    [
                                    a
                                    ,
                                    b
                                    ]
                                 
                              
                           
                           
                              (
                              f
                              τ
                              +
                              g
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         where 
                           f
                           =
                           2
                           
                              
                                 a
                              
                           
                           /
                           
                              (
                              
                                 
                                    a
                                 
                              
                              +
                              
                                 
                                    b
                                 
                              
                              )
                           
                         and 
                           g
                           =
                           
                              (
                              
                                 
                                    b
                                 
                              
                              −
                              
                                 
                                    a
                                 
                              
                              )
                           
                           /
                           
                              (
                              
                                 
                                    a
                                 
                              
                              +
                              
                                 
                                    b
                                 
                              
                              )
                           
                        . For the Bézier form of each segment, we can still use (4), only replacing 
                           
                              
                                 R
                              
                              
                                 p
                              
                           
                         with the following new definition.


                        
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                p
                                             
                                          
                                          )
                                       
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                         −
                                                         i
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                   i
                                                   −
                                                   j
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   j
                                                   −
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             ≤
                                             j
                                             ≤
                                             2
                                             i
                                             ;
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As to the reparameterization to achieve two-sided zero derivatives, our strategy is to split the original polynomial spline curve into two parts (e.g., see  [3] for B-splines) and apply the square reparameterization above to both parts, respectively. Then join the two reparameterized parts into a single result curve. We call this method the two-sided square reparameterization. After this operation, the degree of the polynomial spline curve is doubled and the result curve has zero derivatives at the two end points (see Fig. 3
                        ). After applying this reparameterization to all boundary condition curves, we denote the result curves by 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        , which are the input of the next step.

The third step is to adjust the magnitude of the cross-boundary derivative curves so that after the adjustment, the values of these curves are zero at end points, respectively. That is, 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           0
                        . As follows, we obtain this goal by multiplying a scalar function 
                           λ
                           
                              (
                              t
                              )
                           
                         to all cross-boundary derivative curves. 
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 λ
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                 where
                                 
                                 λ
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 λ
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                         The lowest degree of 
                           λ
                           
                              (
                              t
                              )
                           
                         is two, which ensures that 
                           λ
                           
                              (
                              t
                              )
                           
                         is not a zero function. So we choose the quadratic polynomial function 
                           λ
                           
                              (
                              t
                              )
                           
                           =
                           2
                           λ
                           
                              (
                              1
                              −
                              λ
                              )
                           
                        . The multiplication by this quadratic curve elevates the degree of the input cross-boundary derivative curves by two.

Formally, the second and the third step can be formulated as follows. 
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 λ
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    σ
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         is the input of the second step, 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         is the output of the third step and we denote the two-sided square reparameterization by 
                           σ
                        . It follows that 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           0
                        . So the reformed boundary conditions satisfy tangent compatibility  [3,25]. Then, for twist compatibility, we analyze the derivative of a cross-boundary derivative curve:
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    σ
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 +
                                 λ
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                D
                                             
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    σ
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 .
                              
                           
                         At the two end points, we have 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 λ
                              
                              
                                 ′
                              
                           
                           
                              (
                              1
                              )
                           
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         and 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 λ
                              
                              
                                 ′
                              
                           
                           
                              (
                              0
                              )
                           
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 j
                              
                           
                           
                              (
                              0
                              )
                           
                        . In these two equations, we note that 
                           
                              
                                 λ
                              
                              
                                 ′
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           2
                        , 
                           
                              
                                 λ
                              
                              
                                 ′
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           −
                           2
                         and 
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 j
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 D
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 T
                              
                              
                                 i
                                 j
                              
                           
                         after the first step. Finally, we have 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              1
                              )
                           
                           +
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           0
                        , and this is the condition of twist compatibility. So, after the three-step reformation, the boundary condition curves satisfy all compatibility conditions of 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         Coons’ construction. The degree of them are elevated to 
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                         if the input curves are all 
                           p
                        -degree polynomial splines. After that, we only need to construct the final Coons surface using the result of the third step as the four boundary conditions of the construction process. The degree of the final surface is also 
                           2
                           
                              (
                              p
                              +
                              2
                              )
                           
                         for each coordinate. Furthermore, for compatible corners, we do not need to construct zero derivatives. So in these cases, we only use one-side square reparameterization or traditional methods.

As discussed in the previous sections, the key to solve the conflicting boundary conditions in geometry is to construct a degenerate corner where the multi-valued normal directions can satisfy different normal demands simultaneously. However, our algebraic constructive algorithm, which consists of symbolic operations, appears to be irrelevant to the construction process of degenerate corners. So why does this algorithm work? The answer is the two-sided square reparameterization. After this operation, the input curves are actually degenerate at the end points. So the result surface 
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      constructed from these curves preserves degenerate corners. Furthermore, taking parametric point 
                        
                           (
                           0
                           ,
                           0
                           )
                        
                      for example, 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        
                           
                              u
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        
                           
                              v
                           
                           
                              2
                           
                        
                      are equal to the second-order derivative of the corresponding boundary curves. As shown in Fig. 4
                     , these second-order derivatives are derived from the first-order derivatives of the original input boundary curves, and therefore the two edges of the corner agree with the specified boundary edges locally. For the other second-order partial derivative 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        u
                        ∂
                        v
                     , it is actually in the same direction with 
                        
                           
                              T
                           
                           
                              i
                              j
                           
                        
                      (where 
                        i
                        j
                      indicates the corner 
                        S
                        
                           (
                           0
                           ,
                           0
                           )
                        
                     ). According to the conclusion of Section  3, the radial directions of the corner is spanned by the three second-order partial derivatives 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        
                           
                              u
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        u
                        ∂
                        v
                      and 
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        S
                        /
                        ∂
                        
                           
                              v
                           
                           
                              2
                           
                        
                     , and therefore, they are actually spanned by 
                        −
                        
                           
                              D
                           
                           
                              u
                           
                           
                              i
                           
                        
                        
                           (
                           1
                           )
                        
                     , 
                        
                           
                              D
                           
                           
                              u
                           
                           
                              j
                           
                        
                        
                           (
                           0
                           )
                        
                      and 
                        
                           
                              T
                           
                           
                              i
                              j
                           
                        
                     . Thus, the multi-valued normal direction of this corner point is consistent with the specified boundary conditions.

This section demonstrates examples with incompatible boundary conditions which fall into Category III discussed in Section  4. In Fig. 5
                     , we present such an example in which the input boundary curves are all quadratic polynomial curves. These boundary conditions are freely specified. In Fig. 5(a) we can see that the local tangent plane spanned by the zeroth boundary is not consistent with the one of the first boundary. As shown in Fig. 5(b), after the three-step reformation of the boundary curves (see Section  4), the cross-boundary derivative curves are eight-degree polynomial spline curves with 16 control points in B-spline form, respectively. So the final Coons surface, as shown in Fig. 5(d), is an (8, 8)-degree polynomial spline surface with 16 by 16 control points in B-spline form. As discussed in Section  3, the first-order derivatives of the surface vanish at the corners. Fig. 6
                      shows another example with incompatible boundary conditions. In this example, all the specified boundary curves are cubic polynomial splines with five control points in B-spline form, and the cross-boundary derivatives curves are quadratic polynomial splines. The final Coons surface is an (8, 8)-degree polynomial spline surface with 16 by 16 control points in B-spline form.


                     Fig. 7
                      presents a “more incompatible” case. Note that the boundary conditions are derived from a regular quadrangular prism, so each corner is actually the end point of an edge of the prism. On the two sides of the edge, as well as the corner point corresponding it, we have two different normal directions (see 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              N
                           
                           
                              1
                           
                        
                      in Fig. 7 (a)) and these two directions are orthogonal. Our interpolation algorithm generates a polynomial spline surface with four degenerate corners. Surrounding these degenerate points, we can see that the surface presents a smooth transition from the rounded top to the sharp corners. As we use quadratic polynomial curves to represent the boundary conditions in this example, the final result is also an (8, 8)-degree polynomial spline surface patch. If we use linear curves as input, the degree of the result surface can be reduced to (6, 6). Furthermore, we note that the specified cross-boundary derivative curves are consistent with each other on the end points, so the first step of the reformation algorithm is no longer required in this case. Thus, we can even reduce the degree of the result surface to (4, 4) so that the number of the control points of the corresponding B-spline form can be 8 by 8.


                     Fig. 8
                      gives comparisons with two mainstream CAD systems: CATIA and SolidWorks, as well as with the algorithm proposed in  [24]. The bad shape in Fig. 8(e) shows that SolidWorks 2007 is incompetent to interpolate such an incompatible case. The result by CATIA V5 in Fig. 8(d) is better however we can still note the defeats near the four corners. The algorithm proposed in  [24] is able to generate a correct shape as shown in Fig. 8(f) however the price is that the algorithm splits the four-sided region into eight subregions and for each of them, the algorithm creates a B-spline surface patch. The eight B-spline surface patches cost 1120 control points, the number of which is much larger than our algorithm.

@&#CONCLUSION@&#

This paper proposes an algorithm to interpolate the boundary curves and the cross-boundary derivatives of a four-sided region. This algorithm overcomes the tangent and twist compatibility problems with Coons’ construction so that the algorithm can adapt to freely specified input without any restrictions. Since we utilize a special local differential feature of degenerate parametric surfaces, our method can handle the incompatible cases that cannot be solved by a Gregory patch or a single patch of non-degenerate surface. In geometry, this feature indicates that at a degenerate point like the apex of a cone, the limit of the normal directions of the surface can be multi-valued. So we use this feature to construct degenerate corners to satisfy conflicting normal directions corresponding to two adjacent boundaries, respectively. The constructive algorithm only depends on symbolic operations and reparameterizations for polynomial splines.

@&#ACKNOWLEDGMENT@&#

The research was supported by Chinese 973 Program (2010CB328001) and International Science & Technology Cooperation Program of China (2013DFE13120). The first author was supported by the open funding project of State Key Laboratory of Virtual Reality Technology and Systems, Beihang University (Grant No. BUAA-VR-14KF-05). The second author was supported by the NSFC (61035002, 61272235). The fourth author was supported by the NSFC (91315302, 61173077).

@&#REFERENCES@&#

