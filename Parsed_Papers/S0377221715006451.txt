@&#MAIN-TITLE@&#Production phase and ultimate pit limit design under commodity price uncertainty

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An innovative application of OR in open pit mine planning and design is proposed.


                        
                        
                           
                           It implements minimum cut algorithm for pit design considering price uncertainty.


                        
                        
                           
                           A new smoothing splines algorithm models the price uncertainty.


                        
                        
                           
                           A case study demonstrates the application of the proposed stochastic framework.


                        
                        
                           
                           A comparison with existing methods confirms improved economic value.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Uncertainty modelling

Production planning

Open pit mine

Minimum cut algorithm

Smoothing spline

@&#ABSTRACT@&#


               
               
                  Open pit mine design optimization under uncertainty is one of the most critical and challenging tasks in the mine planning process. This paper describes the implementation of a minimum cut network flow algorithm for the optimal production phase and ultimate pit limit design under commodity price or market uncertainty. A new smoothing splines algorithm with sequential Gaussian simulation generates multiple commodity price scenarios, and a computationally efficient stochastic framework accommodates the joint representation and processing of the mining block economic values that result from these commodity price scenarios. A case study at an existing iron mining operation demonstrates the performance of the proposed method, and a comparison with conventional deterministic approach shows a higher cumulative metal production coupled with a 48% increase in the net present value (NPV) of the operation.
               
            

@&#BACKGROUND@&#

The definition of an optimal production-phase design and ultimate pit limit is critical initial activity for long-term production planning of the open pit mining operations. The qualitative (metal content or grade) and quantitative (tonnes of material) information describing the thousands of mining blocks in an ore body model, along with relevant economic parameters (commodity/metal price, operating costs, etc.) are the basic inputs for long-term pit production planning (Hustrulid & Kuchta, 2006; Lamghari & Dimitrakopoulos, 2012; Ramazan, 2007). A production-phase design sets the sequence of extraction in terms of manageable pit-phases leading to the ultimate pit limit or the extent of extraction (Asad & Dimirakopoulos, 2013). More specifically, an ultimate pit limit analysis satisfies the mining block precedence constraint for a decision if a mining block is inside the pit or otherwise, and the production-phase design satisfies precedence as well as resource (production capacity) constraints for providing a macro-level sequence of extraction within the ultimate pit limit (Hustrulid & Kuchta, 2006; Shishvan & Sattarvand, 2015). Production-phase design and the ultimate pit limit determinations establish the tonnages of mineable reserves, ore and waste, the production scale of the operation, and size and location of other surface facilities such as ore stockpiles, waste dumps, etc. Given the scale or number of mining blocks within the ore body models, they also reduce the size of the pit optimization problem for subsequent production scheduling (Marcotte & Caron, 2013).

In general practice, referred to herein as the conventional approach, a graph theory based Lerchs–Grossman (LG) algorithm solves the ultimate pit limit problem (Lerchs & Grossmann, 1965), and then a parametric implementation of the algorithm generates a number of production phases within the ultimate pit limit (Bongarcon & Guibal, 1983; Whittle, 1999). Alternatively, realizing that the development of an ultimate pit limit may be categorized as a maximum closure problem (Johnson, 1968), a minimum cut algorithm applied on a related graph efficiently solves the ultimate pit limit problem (Hochbaum & Chen, 2000; Picard, 1976). Hochbaum (2001) provides a comprehensive overview of both LG and maximum flow algorithms, and demonstrates that the LG algorithm is substantially more complex than the maximum flow algorithm. However, these conventional methods not only ignore resource constraints, but also disregard any uncertainty associated with the input parameters.

With the development of stochastic modelling and optimization in mine planning, it has been established that ignoring inherent economic or geological uncertainties may lead to unrealistic assessments and decisions (Abdel Sabour & Poulin, 2006; 2010; Dimitrakopoulos & Abdel-Sabour, 2007; Dimitrakopoulos, Farrelly, & Godoy, 2002; Marcotte & Caron, 2013). Over recent years, substantial efforts have been made to integrate uncertainty into mine planning. In this context, models based on stochastic integer programming (SIP) incorporate geological uncertainty through a set of equally probable ore body models (Albor & Dimitrakopoulos, 2010; Ramazan & Dimitrakopoulos, 2007; 2013). However, the SIP approach is computationally demanding, which creates a need for a more efficient approach to heuristics implementation (Godoy & Dimitrakopoulos, 2004; Leite & Dimitrakopoulos, 2007) that requires the labour-intensive preparation of input data (Albor & Dimitrakopoulos, 2010). To this end, Meagher, Abdel Sabour, and Dimitrakopoulos (2010) outline the theoretical constraints of using a minimum cut algorithm (Goldberg & Tarjan, 1988) for the optimal ultimate pit limit with commodity price and geological uncertainties. Similarly, Asad and Dimirakopoulos (2013) employ the Lagrangian relaxation of resource constraints for production-phase design and ultimate pit limit under commodity price and geological uncertainties.

The majority of the stochastic optimization approaches discussed so far consider the geological uncertainty, but consider the price or value of the commodity to be constant over the life of the mine. Given the impact of the economic downturns on mining operations, this constant commodity value assumption becomes unrealistic (Abdel Sabour & Poulin, 2006; 2010). While Meagher et al. (2010) and Asad and Dimirakopoulos (2013) consider this economic uncertainty, both rely on a mean reverting price or value model (Schwartz, 1997) for generating price simulations, which follows Markov properties and considers the present value as a basis for calculation of the conditional probability of the future commodity price. However, like other time series methods, the future price also depends on a past set of commodity price values (Azadeh, Moghaddam, Khahzad, & Ebrahimipour, 2012).

As distinct from previous studies, in this paper, we propose new smoothing splines and geostatistical sequential simulation based procedure for forecasting the commodity price scenarios, implement a minimum cut algorithm for production-phase and ultimate pit limit design under commodity price uncertainty, and share an application of these procedures to an iron mining operation. More specifically, in the following sections, we discuss: (i) a mathematical formulation for production-phase and ultimate pit limit design in a stochastic framework; (ii) a procedure to generate commodity price scenarios using smoothing splines and geostatistical simulation; (iii) the structure of the graph in a stochastic framework, (iv) a parameterization based strategy to solve the graph in the proposed stochastic framework; and (v) an implementation of the proposed methods in an existing iron mining operation.

The mathematical formulation (1)–(4) presents the stochastic framework for the production-phase design under commodity price uncertainty (Ramazan, 2007; Ramazan & Dimitrakopoulos, 2007; 2013):

                        
                           (1)
                           
                              
                                 max
                                 
                                 
                                    ∑
                                    
                                       γ
                                       ∈
                                       Γ
                                    
                                 
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       B
                                    
                                 
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 
                                    x
                                    b
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    x
                                    b
                                 
                                 −
                                 
                                    x
                                    
                                       b
                                       ′
                                    
                                 
                                 ⩽
                                 0
                                 ,
                                 
                                 
                                    b
                                    ′
                                 
                                 ∈
                                 
                                    ξ
                                    b
                                 
                                 ,
                                 
                                 b
                                 ∈
                                 B
                                 .
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       B
                                    
                                 
                                 
                                    a
                                    
                                       k
                                       γ
                                       b
                                    
                                 
                                 
                                    x
                                    b
                                 
                                 ⩽
                                 
                                    H
                                    k
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 
                                 and
                                 
                                 γ
                                 ∈
                                 Γ
                                 .
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    x
                                    b
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 ,
                                 
                                 b
                                 ∈
                                 B
                                 .
                              
                           
                        
                     where, vγb
                      is the economic value of mining block b under the commodity price scenario γ, the binary variable xb
                      is 1, if mining block b is inside the pit, 0 otherwise, ξb
                      is the set of mining blocks with extraction precedence over mining block b, akγb
                      is the quantity of material k in mining block b under commodity price scenario γ, and Hk
                      is the production capacity of material k. In addition, B, Γ, K describe the number of mining blocks, number of commodity price scenarios, and number of production capacity constraints, respectively.

Similarly, objective (1) maximizes the economic value (profit) of the mining operation subject to the mining block precedence (2) and production capacity (3) constraints. An elimination of the production capacity constraints (3) defines the stochastic framework for the ultimate pit limit problem.

The economic value vγb
                      of mining block b under commodity price scenario γ is calculated as:

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          v
                                          
                                             γ
                                             b
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             [
                                             
                                                (
                                                
                                                   P
                                                   γ
                                                
                                                −
                                                r
                                                )
                                             
                                             
                                                g
                                                b
                                             
                                             y
                                             −
                                             m
                                             −
                                             c
                                             ]
                                          
                                          
                                             Q
                                             b
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          v
                                          
                                             γ
                                             b
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      v
                                                      
                                                         γ
                                                         b
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         (
                                                         
                                                            P
                                                            γ
                                                         
                                                         −
                                                         r
                                                         )
                                                      
                                                      
                                                         g
                                                         b
                                                      
                                                      y
                                                      >
                                                      c
                                                      ,
                                                      i.e.
                                                      ,
                                                      b
                                                      
                                                      is
                                                      
                                                      an
                                                      
                                                      ore
                                                      
                                                      block
                                                      
                                                      under
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      price
                                                      
                                                      scenario
                                                      
                                                      γ
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      m
                                                      
                                                         Q
                                                         b
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         (
                                                         
                                                            P
                                                            γ
                                                         
                                                         −
                                                         r
                                                         )
                                                      
                                                      
                                                         g
                                                         b
                                                      
                                                      y
                                                      ≤
                                                      c
                                                      ,
                                                      i.e.
                                                      ,
                                                      b
                                                      
                                                      is
                                                      
                                                      a
                                                      
                                                      waste
                                                      
                                                      block
                                                      
                                                      under
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      price
                                                      
                                                      scenario
                                                      
                                                      γ
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where, Pγ
                      is the commodity price under scenario γ, r is the marketing or selling cost, gb
                      is the grade (metal content) of mining block b, y is the metallurgical recovery, m is the mining cost, c is the processing cost, and Qb
                      is the quantity of material in mining block b.

Previously, a number of commodity price simulation models have been developed. Pindyck (2004) examines the role of volatility in short-run commodity using a dynamic model that describes the joint dynamics of inventories, spot and futures commodity prices, and volatility. He and Westerhoff (2005) develop a commodity price model that characterizes the nature of commodity price fluctuations and explores the effectiveness of price stabilization schemes using nonlinear interactions. Reitz and Westerhoff (2007) propose an empirical commodity price model with heterogeneous speculators. They used time series data for various commodities and developed a STARGARCH model. Doran and Ronn (2008) present a model using quasi-Monte Carlo simulation that demonstrates the need for a negative market price of volatility risk for commodity price simulation. Serra (2011) proposes a semiparametric GARCH model on volatility links between food and energy prices. Gardebroek and Hernandez (2013) develop a multivariate GARCH that examines the volatility transmission in multiple commodities. Cavalcanti, Mohaddes, and Raissi (2014) present a hybrid algorithm using generalized methods of moments and dynamic correlation of cross-country heterogeneity, cross-sectional dependence and feedback effects on volatility of commodity price. Cortazar, Gravet, and Urzua (2008) propose a multidimensional real option commodity price model based on a simulation method for valuing a financial option. Serra (2013) develops time-series econometrics models that analyze the volatility interactions between different commodities.

In this paper, we are considering the commodity price as time series data and proposed a hybrid algorithm using smoothing spline algorithm and sequential Gaussian simulation. In smoothing spline algorithm, the curve estimator is a natural cubic spline (Green & Silverman, 1994; Reinsch, 1967). A reason for using natural cubic spline in the smoothing spline algorithm is that the second and the third derivatives of natural cubic spline are zero, so the curve estimator will be linear on the two extreme intervals; therefore the extrapolation will be linear which minimizes the errors due to the extrapolation beyond the data limits. The advantage of smoothing spline over cubic, quadratic, and b-spline algorithms is that unlike minimizing the residual error while fitting the curve, it balances between the residual error and local variation by using the smoothing parameters. This approach helps improve the generalization ability of the fitted curve, i.e. it even performs well with the unseen data that did not participate in curve fitting procedure. The poor generalization ability in spline and polynomial interpolation functions tends to minimize residual errors, which ultimately over-fits the noisy training data and performs poorly with unseen data. The smoothing spline helps overcome this problem by penalizing the residual errors.

For forecasting the commodity price Pt
                         in period t, it is assumed that commodity prices are time series data, and the Gaussian process model generates the commodity price values Pγt
                         in period t for scenario γ.

Let 
                           
                              (
                              t
                              ,
                              
                                 P
                                 t
                              
                              )
                              ;
                              t
                              =
                              −
                              n
                              <
                              t
                              =
                              −
                              n
                              +
                              1
                              <
                              ⋯
                              <
                              t
                              =
                              0
                           
                         be a sequence of 
                           
                              n
                              +
                              1
                           
                         number of commodity price observations at an equal time step, and 
                           
                              t
                              =
                              0
                           
                         refers to the current or present time period with an associated commodity price of P
                        0. In addition, let 
                           
                              P
                              =
                              [
                              
                                 P
                                 
                                    −
                                    n
                                 
                              
                              ,
                              
                                 P
                                 
                                    −
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 P
                                 0
                              
                              ]
                           
                         be the time series commodity price data observed up to time period 
                           
                              t
                              =
                              0
                              ,
                           
                         i.e. the current or present time. Then, the future commodity price Pt
                         at 
                           
                              t
                              =
                              1
                              :
                              T
                           
                         is simulated using the Gaussian process model (Seeger, 2004).

If μt
                         is the mean value and zt
                         is the Gaussian process with 
                           
                              E
                              
                                 (
                                 
                                    z
                                    t
                                 
                                 )
                              
                              =
                              0
                              ,
                              V
                              a
                              r
                              
                                 (
                                 
                                    z
                                    t
                                 
                                 )
                              
                              =
                              
                                 σ
                                 2
                              
                              ,
                              C
                              o
                              v
                              
                                 (
                                 
                                    z
                                    t
                                 
                                 ,
                                 
                                    z
                                    
                                       t
                                       ′
                                    
                                 
                                 )
                              
                              =
                              
                                 σ
                                 2
                              
                              
                                 R
                                 
                                    t
                                    
                                       t
                                       ′
                                    
                                 
                              
                           
                         (R is the correlation matrix which represents the degree of dependency between t and t′ based on observed price values), then the price Pt
                         for period t is modeled as:

                           
                              (6)
                              
                                 
                                    
                                       P
                                       t
                                    
                                    =
                                    
                                       μ
                                       t
                                    
                                    +
                                    
                                       z
                                       t
                                    
                                 
                              
                           
                        
                     

A price trend model using the smoothing splines algorithm (De Boor, 2001) estimates the mean value μt
                        . If Pt
                         is the price value at time period t, specified smoothing parameter q ≥ 0, and weights w, then the smoothing splines estimate 
                           
                              μ
                              ^
                           
                         of the function μ is constructed by minimizing (Green & Silverman, 1994):

                           
                              (7)
                              
                                 
                                    q
                                    
                                       ∑
                                       t
                                    
                                    
                                       w
                                       t
                                    
                                    
                                       
                                          (
                                          
                                             P
                                             t
                                          
                                          −
                                          
                                             
                                                μ
                                                t
                                             
                                             ^
                                          
                                          )
                                       
                                       2
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       q
                                       )
                                    
                                    ∫
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   d
                                                   2
                                                
                                                μ
                                             
                                             
                                                d
                                                
                                                   t
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       2
                                    
                                    d
                                    t
                                    .
                                 
                              
                           
                        
                     

Here, fitting a smoothing spline is a two steps process. In the first step, the function μ is calculated using 
                           
                              
                                 μ
                                 ^
                              
                              =
                              
                                 ∑
                                 t
                              
                              
                                 
                                    μ
                                    t
                                 
                                 ^
                              
                              
                                 f
                                 t
                              
                              ,
                           
                         where ft
                         is a set of spline basis function (Wang, 2011). In the second step, the value of 
                           
                              ∫
                              
                                 
                                    [
                                    
                                       
                                          
                                             d
                                             2
                                          
                                          μ
                                       
                                       
                                          d
                                          
                                             t
                                             2
                                          
                                       
                                    
                                    ]
                                 
                                 2
                              
                              d
                              t
                           
                         is calculated by evaluating 
                           
                              
                                 m
                                 T
                              
                              Am
                              ,
                           
                         where 
                           
                              m
                              =
                              
                                 
                                    (
                                    
                                       
                                          μ
                                          t
                                       
                                       ^
                                    
                                    
                                       (
                                       t
                                       =
                                       −
                                       n
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          μ
                                          t
                                       
                                       ^
                                    
                                    
                                       (
                                       t
                                       =
                                       0
                                       )
                                    
                                    )
                                 
                                 T
                              
                           
                         and the elements of matrix A are calculated as 
                           
                              ∫
                              
                                 f
                                 
                                    t
                                 
                                 
                                    ′
                                    ′
                                 
                              
                              
                                 f
                                 
                                    
                                       t
                                       ′
                                    
                                 
                                 
                                    ′
                                    ′
                                 
                              
                              d
                              t
                           
                        . After minimizing Eq. (7) the vector m is estimated as 
                           
                              m
                              =
                              
                                 
                                    (
                                    I
                                    +
                                    q
                                    A
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              P
                           
                         (Wang, 2011). The fitted smooth spline 
                           
                              μ
                              ^
                           
                         is then used to calculate μt
                         at any specific time period t (Nagahara & Martin, 2012).

Similarly, the residual values zt
                         are calculated as 
                           
                              
                                 P
                                 t
                              
                              −
                              
                                 μ
                                 t
                              
                           
                        . Again, the residual values are simulated using the Gaussian process model. Finally, the simulated residual value is added to the estimated trend component of price simulation at a specific time step t. For simulating the price for multiple time periods, the trend and residual values are calculated sequentially, and then assumed for each time step. The residual value is simulated by random sampling from the Gaussian conditional probability function calculated from the past residual data values.

The Sequential Gaussian simulation model (Deutsch & Journel, 1998) is applied to simulate the residual values, where conditional probability is calculated by assuming that the residual distribution is multivariate Gaussian. The sequential Gaussian simulation algorithm simulates residual values sequentially in the time domain, and uses simulated values as conditioning data. A simple Kriging algorithm calculates the conditional mean and variance, and the random sample is taken from the developed Gaussian distribution at an unknown time step. The basic steps involved in sequential Gaussian simulations include: (i) transforming the residual data into Gaussian space if the residual data is not Gaussian; (ii) calculating the experimental variogram of Gaussian data; (iii) fitting the experimental variogram to the theoretical variogram function; (iv) calculating the conditioning mean and variance through a simple Kriging algorithm for an unknown time step employing the available Gaussian transformed residual data values; (v) drawing a random value from the Gaussian distribution with the estimated mean and variance; (vi) simulating other time steps sequentially; and (vii) back transforming the simulated values.

The experimental variogram is calculated from the Gaussian transformed residual data values, and then the theoretical variogram function from the experimental variogram. The structural correlation between price residuals in the time series is determined by fitting a model to the data, which is then used to simulate future price residuals. The simple Kriging mean and variance of the Gaussian probability distribution in each time step were calculated using transformed data and the fitted variogram model. A random value drawn from the Gaussian probability distribution is represented as simulated residual value at each time step. Thus, by implementing steps (i) to (vii), one can generate a number of different simulated residual values zγt
                         at a different time period t and scenario γ.

A spherical model is the theoretical semi-variogram function that fits the experimental data, and its formulation is presented as 
                           
                              C
                              
                                 [
                                 
                                    
                                       3
                                       h
                                    
                                    
                                       2
                                       a
                                    
                                 
                                 −
                                 
                                    
                                       h
                                       3
                                    
                                    
                                       2
                                       
                                          a
                                          3
                                       
                                    
                                 
                                 ]
                              
                              +
                              
                                 C
                                 0
                              
                              ,
                           
                         where, C is the sill or a positive variance of the commodity prices minus the nugget effect, a is the range of continuity and regularity, h is the time separation or lag at which the semi-variogram reaches a sill, and C
                        0 is the nugget effect equal to the semi-variogram function at a lag of 
                           
                              h
                              =
                              0
                           
                        . The pseudo-code for price simulation is presented as:

                           
                              1.
                              Read 
                                    
                                       P
                                       =
                                       [
                                       
                                          P
                                          
                                             −
                                             n
                                          
                                       
                                       ,
                                       
                                          P
                                          
                                             −
                                             n
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          P
                                          0
                                       
                                       ]
                                    
                                 .

Estimate smoothing spline 
                                    
                                       μ
                                       ^
                                    
                                  using P.

Calculate residuals 
                                    
                                       
                                          z
                                          
                                             −
                                             n
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             −
                                             n
                                             +
                                             1
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          z
                                          0
                                       
                                    
                                  using 
                                    
                                       z
                                       =
                                       P
                                       −
                                       μ
                                    
                                 .

Initialize t to 1.


                                 While 
                                 t ≤ T.
                                    
                                       (a)
                                       Estimate μt
                                           using an estimated smoothing spline function.


                                          Repeat 
                                          γ times.
                                             
                                                (i)
                                                Simulate zγt
                                                    by sequential Gaussian simulation using residual values.

Simulate 
                                                      
                                                         
                                                            P
                                                            
                                                               γ
                                                               t
                                                            
                                                         
                                                         =
                                                         
                                                            μ
                                                            t
                                                         
                                                         +
                                                         
                                                            z
                                                            
                                                               γ
                                                               t
                                                            
                                                         
                                                      
                                                   .

End Repeat.

End While.

Stop.

The production-phase design formulation (1)–(4) without production capacity constraints (Eq. (3)) is presented as a graph problem, and an application of the maximum flow or minimum cut algorithm provides an optimal solution to this graph problem (Hochbaum, 2001; Hochbaum & Chen, 2000; Picard, 1976). Fig. 1
                         present the basic graph structure considering multiple commodity price scenarios. As shown in Fig. 1 apart from the repesentation of a mining block b as a node under each commodity price scenario γ, the graph is augmented with source and sink nodes. A mining block b takes an equally probable economic value vγb
                         under a commodity price scenario γ, and consequently, if vγb
                         > 0, the corresponding node representing the mining block b in commodity price scenario γ is connected to the source node, otherwise, if vγb
                         ≤ 0, the corresponding node representing the mining block b in commodity price scenario γ is connected to the sink node. The capacity of an arc connecting the source node to a positive-valued nodes is equal to vγb
                        . Similarly, the capacity of an arc connecting a negative-valued node to the sink node is equal to |vγb
                        |. Moreover, for ensuring extraction precedence, an infinite (∞) capacity arc exists from a node representing a mining block b in commodity price scenario γ to the corresponding set of nodes in ξb
                        . Finally, for Eq. (4), infinite (∞) capacity arcs exist among the nodes representing a mining block b over all commodity price scenarios. These infinite (∞) capacity arcs guarantee that upon achieving the optimal solution to this graph problem, a mining block b represented over Γ number of commodity price scenarios, will remain on the same side of the minimum cut over all scenarios, resulting in a valid optimal pit (Asad & Dimirakopoulos, 2013; Meagher et al., 2010).

Knowing that a mining block b remains on the same side of the minimum cut over all commodity price scenarios, the nodes representing a mining block b over these commodity price scenarios are merged into a single node (Meagher et al., 2010), such that, the arc capacity from source node to the single merged node is updated as 
                           
                              
                                 [
                                 
                                    
                                       v
                                       ˜
                                    
                                    b
                                 
                                 =
                                 
                                    ∑
                                    
                                       γ
                                    
                                    Γ
                                 
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 ;
                                 
                                 if
                                 
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 >
                                 0
                                 ]
                              
                              ,
                           
                         and the arc capacity from the single merged node to the sink node is updated as 
                           
                              [
                              
                                 
                                    
                                       v
                                       
                                          ′
                                          ′
                                       
                                    
                                    ^
                                 
                                 b
                              
                              =
                              
                                 |
                                 
                                    ∑
                                    
                                       γ
                                    
                                    Γ
                                 
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 |
                              
                              ;
                              if
                              
                              
                                 v
                                 
                                    γ
                                    b
                                 
                              
                              ≤
                              0
                              ]
                           
                        . Asad and Dimirakopoulos (2013, 2014) discuss the procedural aspects of the simplified graph structure presented in Fig. 2
                        .

The commodity price simulation model generates multiple simulated price values over a number of time periods, and if t represents the time period, then Pγ
                         is replaced with Pγt
                         in Eq. (5). Consequently, a realistic update in the stochastic framework shown in Fig. 2 incorpoates the discounted economic values of mining blocks over multiple time periods. If d represents the discount rate, the discounted value of a mining block b over T number of time periods is calculated as 
                           
                              
                                 ∑
                                 
                                    γ
                                 
                                 Γ
                              
                              
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       d
                                       )
                                    
                                    t
                                 
                              
                           
                         if vγb
                         > 0, and 
                           
                              
                                 |
                              
                              
                                 ∑
                                 
                                    γ
                                 
                                 Γ
                              
                              
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       d
                                       )
                                    
                                    t
                                 
                              
                              
                                 |
                              
                           
                         if vγb
                         ≤ 0. Given this, the modified structure of the graph represents a mining block b as a node in each time period t. Accordingly, the capacity of arcs from source node to the node with a positive discounted value is 
                           
                              
                                 
                                    v
                                    ˜
                                 
                                 
                                    b
                                    t
                                 
                              
                              =
                              
                                 ∑
                                 
                                    γ
                                 
                                 Γ
                              
                              
                                 
                                    v
                                    
                                       γ
                                       b
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       d
                                       )
                                    
                                    t
                                 
                              
                              ,
                           
                         and the capacity of arcs from a node with negative discounted value to the sink node is 
                           
                              
                                 
                                    
                                       v
                                       
                                          ′
                                          ′
                                       
                                    
                                    ^
                                 
                                 
                                    b
                                    t
                                 
                              
                              =
                              
                                 |
                                 
                                    ∑
                                    
                                       γ
                                    
                                    Γ
                                 
                                 
                                    
                                       v
                                       
                                          γ
                                          b
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          +
                                          d
                                          )
                                       
                                       t
                                    
                                 
                                 |
                              
                           
                        . Similarly, apart from the infinite capacity arcs for extraction precedence of mining block b, infinite capacity arcs among the nodes representing a mining block b over time periods T ensures that a mining block inside the valid pit is mined only once over T number of time periods. Fig. 3
                         presents the structre of this modified graph.

The stochastic framework for production-phase design in Fig. 3 does no account for any production capacity constraints. Clearly, while a realistic production-phase design requires an imposition of production capacity constraints, using the minimum cut algorithm (Goldberg, 1985; Goldberg & Tarjan, 1988) for an optimal solution to the stochastic framework in Fig. 3 becomes impossible. However, although Lagrangian relaxation of the production capacity constraints removes this bottleneck (Asad & Dimirakopoulos, 2013), a feasible solution or convergence of the algorithm is not guaranteed, because of its sensitivity to a number of parameters (Tachefine & Soumis, 1997). Another possible solution approach is the linear programming (LP) relaxation of Eq. (4), which obtains solution to the LP problem, and rounds the solution to an integer one. However, a violation of constraints during the rounding operation is possible, i.e. a feasible solution is not guaranteed. Given these limitations of the Lagrangian and LP-relaxation approaches, a parameterized application of the maximum flow algorithm is the most widely used and well-documented approach in the mining industry (Bongarcon & Guibal, 1983; Seymour, 1995; Whittle, 1999). According to this approach, a multiplier λ scales the mining block economic values, resulting in a series of nested pits and production phases over a number of iterations until production capacity constraints are respected. It is noted that commercial mining software implement graph closure (Lerchs & Grossmann, 1965) and maximum flow algorithm (Picard, 1976). However, these software are limited to the conventional (deterministic) approach to open pit optimization, i.e. they consider deterministic values for commodity price as well as orebody models. Unlike commercially available mining software, this paper presents an innovative application of maximum flow algorithm in a stochastic framework that considers multiple commodity price simulations.

In this paper, as a strategy to solve the stochastic framework for production-phase design, we employ the parameterization approach because of its acceptance in the mining industry and suitability to application of the minimum cut algorithm. If λ is defined as the parameterization factor, the formulation for the stochastic framework in Fig. 3 is:

                           
                              (8)
                              
                                 
                                    Φ
                                    
                                       (
                                       λ
                                       )
                                    
                                    =
                                    max
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          B
                                       
                                    
                                    λ
                                    
                                       |
                                       
                                          ∑
                                          
                                             γ
                                          
                                          Γ
                                       
                                       
                                          v
                                          
                                             γ
                                             b
                                             t
                                          
                                       
                                       |
                                    
                                    
                                       x
                                       
                                          b
                                          t
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       x
                                       
                                          b
                                          t
                                       
                                    
                                    −
                                    
                                       x
                                       
                                          
                                             b
                                             ′
                                          
                                          t
                                       
                                    
                                    ⩽
                                    0
                                    ,
                                    ∀
                                    t
                                    ,
                                    
                                       b
                                       ′
                                    
                                    ∈
                                    
                                       ξ
                                       b
                                    
                                    ,
                                    
                                    b
                                    ∈
                                    B
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       x
                                       
                                          b
                                          t
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    ,
                                    b
                                    ∈
                                    B
                                    ,
                                    
                                    and
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       x
                                       
                                          b
                                          t
                                       
                                    
                                    ⩽
                                    1
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    and
                                    
                                    λ
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         ∑
                                                         
                                                            γ
                                                         
                                                         Γ
                                                      
                                                      
                                                         v
                                                         
                                                            γ
                                                            b
                                                            t
                                                         
                                                      
                                                      >
                                                      0
                                                      ;
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

While, λ is bounded with (0, 1], its value is changed to 
                           
                              λ
                              =
                              λ
                              +
                              ∇
                              λ
                           
                         over each iteration, which updates the capacity of arcs from source to positive discounted value nodes, resulting in consistent size phases within the ultimate pit limit. The step size ∇λ is important for convergence and computational time. A smaller value for ∇λ increases the computational time to convergence. Similarly, a higher value for ∇λ results in inconsistent size phases with undesirable gaps. If 
                           ϵ
                         is a very small positive number, we propose a monotonically decreasing function for updating the value of λ as follows:

                           
                              (12)
                              
                                 
                                    ∇
                                    λ
                                    =
                                    
                                       [
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          ∑
                                          
                                             γ
                                             ∈
                                             Γ
                                          
                                       
                                       
                                          w
                                          
                                             k
                                             γ
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   H
                                                   k
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      b
                                                      ∈
                                                      B
                                                   
                                                
                                                
                                                   a
                                                   
                                                      k
                                                      γ
                                                      b
                                                   
                                                
                                             
                                             
                                                H
                                                k
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    ϵ
                                 
                              
                           
                        
                     

It is worth considering that commercially available mining software (Whittle 1999) implement the concept of λ values for nested pit shell (small pits within the ultimate pit limit) generation. However, the selection of λ values in these software follows an arbitrary procedure, and given that the commodity price uncertainty is ignored, by using λ values greater than 1, these software arbitrarily capture the possible volatility (increase) in commodity price. In this paper, we consider multiple price simulations on a period-by-period basis to capture the market volatility. Therefore, realistically, while the algorithm generates multiple pits, the values of λ are kept within the range of 0–1. The algorithm implements following pseudo-code for stochastic production-phase design (Asad & Dimirakopoulos, 2013; 2014):

                           
                              1.
                              Define a variable λ, such that 0 < λ < 1.

Initialize 
                                    
                                       λ
                                       =
                                       0
                                    
                                 
                              

Set 
                                    
                                       
                                          δ
                                          
                                             k
                                             γ
                                          
                                       
                                       =
                                       0
                                       
                                       at
                                       
                                       λ
                                       =
                                       0
                                    
                                  for all production capacity constraints k for scenario γ.

Increment λ by a small value ∇λ, i.e. 
                                    
                                       λ
                                       =
                                       λ
                                       +
                                       ∇
                                       λ
                                    
                                 .

Solve for Φ(λ).

Update 
                                    
                                       λ
                                       =
                                       λ
                                       +
                                       ∇
                                       λ
                                       ,
                                    
                                  if 
                                    
                                       [
                                       
                                          [
                                          
                                             δ
                                             
                                                k
                                                γ
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                B
                                             
                                          
                                          
                                             a
                                             
                                                k
                                                γ
                                                b
                                             
                                          
                                          
                                             x
                                             b
                                          
                                          ]
                                       
                                       ≤
                                       
                                          H
                                          k
                                       
                                       ∀
                                       γ
                                       ,
                                       k
                                       ]
                                    
                                  from Φ(λ).

Go to step 5.

End.

An application of the proposed method is presented using data from an iron ore mining operation in south-eastern India. The deposit underlies highly undulating ground contours and maintains a pit slope angle at 45° along all azimuths. The deposit encompasses seven different lithologies, namely steel grey hematite (SGH), blue hematite (BH), laminated hematite (LH), laterite (L), blue dust (BD), shale (SHL), and banded hematite quartzite (BHQ). Most of the high grade iron ore exists in SGH, BH and LH members. This study utilizes the data from 77 boreholes located in a gridded pattern with a variable spacing from 200 to 250 meters and average depth of approximately 100 meter with core samples composited at 5 meter length, the ordinary Kriging method estimates the grade of iron ore. Similarly, at an estimated block size of 50m × 50m × 10m, the orebody model constitutes 77,452 mining blocks. The specific gravity of iron is assumed at 2.86 tonne per m3. Similarly, the economic parameters including the marketing or selling cost (r), mining cost (m), processing cost (c), metallurgical recovery (y), and the discount rate (d) are fixed at $3.60 per tonne of metal, $0.60 per tonne of material, $6.00 per tonne of ore, 90 percent, and 10 percent, respectively. The operation maintains a pit production capacity of 37.2 million tonnes per year.

The sequential Gaussian simulation algorithm is used to generate the iron price simulations. Figs. 4
                         and 5
                         present the historical data (Mundi Commodity Price index, 2012) for iron ore prices from 1982 to 2011 and the corresponding histogram. Given this data, the next step is to fit the smooth splines for modelling the price trend. Using a natural cubic spline as a basis function, the challenge remains in selecting the smoothing parameter, which is decided heuristically. The smoothing parameter influences the fluctuations of the output, i.e. a smaller value of the smoothing parameter results in a smoother fit farther from the data, and a higher value of the smoothing parameter results in a rough fit closer to the data. Therefore, a careful selection of this parameter generates a robust fit, which is not influenced by noise whilst simultaneously minimizing the error of estimation. Consequently, in this study, a validation procedure was used to assist in selecting the smoothing parameters, where 72 (20 percent) out of 360 randomly selected price values exclusively become validation data (i.e. these values do not participate in fitting the splines family). This validation procedure derives an optimum smoothing parameter value of 0.42. Table 1
                         presents the error statistics of the training anvalidation data. High R
                        2 value coupled with a low root mean squared error demonstrates that the variability of the data is well captured through the fitted model. The closely matched values of R
                        2 and root mean squared error for both the training and test data sets reflect that the fitted model is generalized and that it will perform equally well with other unseen data.

A paired-sample t-test is performed with a null hypothesis that the means of the two populations (actual and model predicted) are different is used as a basis of a statistical comparison between the actual- and smoothed model-predicted values. The t-statistics of the comparison show that the null hypothesis can be rejected at the significance level of 0.05. Therefore, it is concluded that there is no significant difference between the means of the actual- and smoothed model-predicted data. Fig. 6
                         illustrates the actual price data (both training and validation) along with fitted smoothing splines.


                        Fig. 7
                         shows te residuals from the actual and smoothed model-predicted data. The residuals data form the input for error simulation using a sequential Gaussian simulation algorithm. An evaluation of the normality of the residual values reveals that the residual distribution is Gaussian. However, the variance of the residual data is not equal to 1. This requires normalizing the residual values with a zero mean and one standard deviation, i.e. transferring the residual values in to standard Gaussian space. The normalized residual data then becomes the source for calculating the experimental variogram, which is then fitted with the spherical model. The nugget, sill, and range values of the fitted variogram are 0, 1, and 62, respectively. Fig. 8
                         present the experimental and fitted variogram values.

A grid is defined for estimating the monthly iron price over 10 years, i.e., from 2012 to 2021. Procedurally, the trend values are estimated using the smoothing splines model for all gridded points, and a simulation is performed using a Gaussian distribution for 100 realizations of the residual values at each grid point. The validation of the simulation results is achieved through analysis of the experimental variograms of iron price and the simulated price data (trend added with residuals). Fig. 9 present these variograms. It is observed that the variograms of the simulated price data are well matched with the variogram of iron price data, which leads to a conclusion that the two-point statistics of iron price data is well reproduced by the simulated data. Finally, a simulated annual price value is determined from the average of 12 months simulated price values.

Using multiple simulated realizations of the iron price and other economic parameters, together with the estimated iron grade of a mining block, Eq. (5) provides the economic value of a mining block under each price scenario. A graph is then constructed using the procedure explained in Section 2.2.

An implementation of the proposed parameterization algorithm discussed in Section 2.3 solves this graph, such that, the size of individual production-phases is controlled by maintaining the mine production rate per year within the defined pit production capacity of 37.2 million tonnes per year. This is achieved through a monotonic decrease in ∇λ over a number of iterations. The proposed algorithm generates 10 production-phases within the ultimate pit limit, taking a nominal computational time of 28 minutes, reflecting its capability for potential applications in relatively large data sets. Fig. 10 presents East-West and North-South sections views of the sequence of production-phases for this iron mining operation.


                        Table 2
                        
                        
                         present the number of blocks, the quantity of material, and the life of each production-phase. While, the number of blocks inside the ultimate pit remains 46,941, it is observed that the proposed method generates production-phases with more or less consistent size and life, and the production capacity constraint is respected for all phases. Given that the life of each phase is approximately equivalent to one year, we can calculate the discounted cash flow considering that phases 1 and 10 will be extracted during periods 1 and 10, respectively. Table 2 also presents the rsk profile in terms of the year-wise minimum, maximum, and average discounted cash flows.


                        Fig. 11
                         present the risk profile of stripping ratio or the ratio of the quantity of waste to ore within each phase. It is evident that the operation requires the removal of significantly less waste per unit of ore during initial phases/periods, which then increases exponentially during later phases/periods, ensuring higher returns during the initial production-phases or as a sound investment strategy.

A comparison between the conventional (deterministic) and stochastic approaches for production-phase and ultimate pit limit design is presented. The stochastic framework incorporates multiple simulated realizations of the iron price, whilst the conventional framework takes a single iron price value as an input. The single iron price for a conventional approach is calculated by averaging the stochastically-derived simulated price realizations. For a valid comparison based on iron price uncertainty, all other inputs to Eq. (5) and slope angle requirements remain similar to the stochastic framework solved in the previous section. An implementation of the algorithm on the graph in conventional approach (Asad & Dimirakopoulos, 2013) generates 10 phases within the ultimate pit limit. The number of phases inside the ultimate pit limit remains similar to the stochastic approach, but the orientation and the number of mining blocks inside the ultimate pit limit are different. Table 3
                         present the details of production-phase design and ultimate pit limit in conventional approach. As shown in Table 3 the number of mining blocks inside the ultimate pit is equal to 44,232, which is 6 percent less than the stochastic approach. Similarly, the difference in orientation of the phases leads to significantly lower discounted cash flows (48 percent less) as compared to the stochastic approach. Fig. 12
                         demonstrates this difference in the net present value between the conventional and stochastic approaches. This is mainly attributed to the preference of the stochastic approach to extract mining blocks with higher economic values that are more likely to be ore, leading to more secure and higher cash flows during early production-phases or periods.

@&#CONCLUSIONS@&#

This paper presented an uncertainty-based production-phase design and ultimate pit limit method that implements maximum flow algorithm. As distinct from a single constant metal price value over the life of an operation, as used in conventional pit optimization, multiple price scenarios, applicable to different production periods, were integrated into the stochastic framework. The proposed method shows that integrating commodity price uncertainty within the context of a minimum cut network flow model is relatively simple to both develop and solve. This work also contributes a method for generating the simulated realizations of iron price values. This was achieved by estimating the trend using a smoothing splines model and simulating the residual values using a sequential Gaussian simulation algorithm. The computational efficiency of the proposed method encourages the incorporation of commodity price uncertainties into the optimization process for large scale operations. An application of this innovative approach at an iron ore mining operation generated consistently- sized phases within the ultimate pit limit, a 6 percent larger pit, and critically, a 48 percent higher net present value as compared to the conventional methods for production-phase and ultimate pit limit design.

@&#ACKNOWLEDGMENTS@&#

The authors would like to acknowledge the valuable comments of the reviewers.

@&#REFERENCES@&#

