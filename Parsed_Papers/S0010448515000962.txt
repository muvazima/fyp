@&#MAIN-TITLE@&#Analytic methods for geometric modeling via spherical decomposition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a grid-free discretization scheme for analytic geometric modeling.


                        
                        
                           
                           Solids are approximated with countable unions of 3D balls cut from 4D cones.


                        
                        
                           
                           The unions turn into 3D slices of 4D Minkowski sums of knots and a template cone.


                        
                        
                           
                           The Minkowski formulation embeds well into cross-correlations between solids.


                        
                        
                           
                           The analytic formulation follows using convolution algebra and Fourier Transform.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Analytic methods

Shape correlation

Spherical sampling

Fourier transform

Collision detection

@&#ABSTRACT@&#


               
               
                  Analytic methods are emerging in solid and configuration modeling, while providing new insights into a variety of shape and motion related problems by exploiting tools from group morphology, convolution algebras, and harmonic analysis. However, most convolution-based methods have used uniform grid-based sampling to take advantage of the fast Fourier transform (FFT) algorithm. We propose a new paradigm for more efficient computation of analytic correlations that relies on a grid-free discretization of arbitrary shapes as countable unions of balls, in turn described as sublevel sets of summations of smooth radial kernels at adaptively sampled ‘knots’. Using a simple geometric lifting trick, we interpret this combination as a convolution of an impulsive skeletal density and primitive kernels with conical support, which faithfully embeds into the convolution formulation of interactions across different objects. Our approach enables fusion of search-efficient combinatorial data structures prevalent in time-critical collision and proximity queries with analytic methods popular in path planning and protein docking, and outperforms uniform grid-based FFT methods by leveraging nonequispaced FFTs. We provide example applications in formulating holonomic collision constraints, shape complementarity metrics, and morphological operations, unified within a single analytic framework.
               
            

@&#INTRODUCTION@&#

Analytic modeling relies on describing shape and configuration pointsets as sublevel sets of functions and formulating fundamental operations (e.g., pertaining to detecting collisions, similarity, complementarity, or symmetry) in terms of correlations between those functions. For example, Minkowski operations [1] that are central to mathematical morphology are formalized as convolutions of constituent functions and computed efficiently in the Fourier domain  [2]. Minkowski operations have been used extensively to formulate important problems in robot path planning  [3], mechanism workspace design  [4], virtual reality (graphics/haptics)  [5,6], protein docking  [7], packaging and nesting  [8], and more. Unfortunately, their combinatorial computation even for 3D polyhedral objects quickly becomes impractical with increasing number of polygons  [2]. This can be alleviated using classical FFTs  [9] for numerical implementation of convolutions, which take advantage of uniform spatial sampling. However, this and several related correlation-based problems can be solved more efficiently by using a spherical decomposition of the shape and nonuniform FFTs  [10]. Here we briefly review the roots of the main ideas, with a focus on collision detection (CD) and shape complementarity (SC) literature.

@&#BACKGROUND@&#

At one end of the research spectrum are combinatorial techniques that use surface meshes or higher-order algebraic parametrizations to resolve collisions or identify matching features. Examples are polyhedral CD methods based on Voronoi-clipping/marching  [19] and oriented bounding box (OBB) trees  [12], or spatial enumeration-based techniques such as the Voxmap PointShell (VPS)  [11]. VPS works by a pairwise test between a shell of vertices for the moving object against a map of voxels that discretizes the stationary obstacle, and is popular in physically-based modeling in virtual environments  [20]. Others have identified more efficient techniques for time-critical CD by using hierarchical bounding spheres sampled on octrees  [13] or on the medial axes (MA)  [14,15], and interior sphere packing guided by distance fields  [16] (Fig. 1
                        (a)–(e)). These ‘sphere-tree’ based methods have been shown to outperform voxmap or OBB-tree based techniques in real-time applications  [16]–particularly because primitive collision predicates are simplified to center-distance tests as a result of the orientational symmetry of balls–and are considered state-of-the-art in practice. For a more complete survey on CD methods, we refer the reader to  [21].

On the other end of the spectrum are analytic methods that have been more popular in robotics  [3]. Unlike the combinatorial approach that searches for a collision certificate point (or lack thereof) in the intersection of the objects, the analytic approach treats the collision predicate as a Boolean combination of inequalities over some configuration space of the objects  [22]. The obstacle avoidance in path planning is, for example, treated as an optimization problem subjected to holonomic collision constraints formulated analytically as a convolution of the robot and its workspace  [17]. Most convolution-based methods have so far focused on generating uniformly sampled configuration bitmaps for all spatial positions and orientations simultaneously, which can be cumulatively computed with asymptotically optimal FFTs  [9]. However, a complete description of the configuration obstacle is overkill for real-time CD. A recent work  [22], also reliant on uniform grid-based sampling, formally reframes the approach for time-critical CD (Fig. 1(f)), but has not yet been compared with sphere-tree methods, nor applied to real-time applications.

In an independent line of research, numerous analytic methods for molecular surface analysis and SC-based protein docking have been developed, whose outcomes are platforms that use grid-based occupancy enumeration and leverage classical FFTs  [9] such as ZDock  [18], or more recent grid-free techniques that rely on nonuniform FFTs  [10], such as 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 2
                              
                           
                           
                              Dock
                           
                           [7] (Fig. 1(g), (h)). The latter exploits the spherical shape of the atomic building blocks and implicitly represents the proteins as summations of radial kernels centered around atoms, assigning different weights to core and skin atoms. The SC score is obtained by cross-correlating these functions from different proteins, which turns into a convolution discretized over the center points. It has been shown that grid-free methods outperform uniform grid-based methods  [7] by taking advantage of the spherical geometry. A comprehensive survey on advances in protein docking is available in  [23].

Although objects of arbitrary shape, unlike molecules, cannot be represented exactly as finite unions of balls, the sphere-tree methods for time-critical CD were shown to be more successful in progressively approximating the shape, when compared to uniform grid- or octree-based voxelization, with a faster convergence and a better use of computational resources  [14]. Motivated by this observation, we present a generic framework for representing arbitrary shapes with finite (or countably infinite, in the limit) radial kernels, formulated as a convolution of a discrete pointset and the primitive kernel in a higher-dimensional space. The latter is described as a geometric lifting trick in Section  2.2, and is deemed necessary due to the inevitable size difference between primitive balls, unlike the simpler case for the proteins. We show that this approach offers ‘the best of both worlds’ by combining the computational efficiency of the sphere-tree techniques for time-critical applications (i.e., with a single configuration query) with that of the analytic methods for cumulative configuration space constructions (i.e., requiring a complete map for all spatial relations), unified under a single paradigm with analytic formalism that applies to a multitude of applications.

The main contributions of this paper are to (1) present an analytic shape correlation paradigm centered around a nonuniform discretization scheme
                           1
                        
                        
                           1
                           What we mean by a ‘discretization scheme’ is not a particular decomposition algorithm or approximation method, but a generic formalism for reconciling such a nonuniform discretization (in contrast to the extensively used uniform sampling) to analytic modeling, using Minkowski sums and convolutions. We do present one new algorithm in Appendix A; nevertheless, other methods  [13–16] are also applicable under the same scheme.
                         that relies on progressive spherical approximations with balls of different sizes; and (2) a uniform and efficient approach to solving a variety of problems that deal with detecting collisions, shape similarity/complementarity, and shape morphing, examples of which we describe in Section  4.

Moreover, we show that the spherical discretization offers an algebraic structure that is closed under Minkowski sum/product operations, and at the same time offers more appealing properties than uniform grid- or octree-based discretizations. As the continuous geometry (of both shapes and configurations) is abstracted away by the balls, the computational implementation solely relies on convolution algebra over discrete sets specified completely by ball center coordinates and radii, allowing the use of the efficient nonequispaced FFT (NFFT) algorithm  [10] on the highly parallel graphics processing units (GPU)  [24].

Unlike combinatorial methods whose complexities typically depend on the syntactic size of the representation (e.g., polygon count) fixed upfront, our method allows for a choice of complexity in real-time based on the affordable resources, by proceeding deep enough down the sphere-tree—which can be constructed using any algorithm of choice, such as  [13–16] or our own presented in Appendix A. On the other hand, unlike grid-based analytic methods whose arithmetic complexities scale with object size and grid resolution, our method enables filling large regions with large balls and efficiently allocating more primitives to capture features of smaller size with higher fidelity.

Finally, by working in the Fourier domain, aside from converting convolutions to simple pointwise products and differentiations to simple multipliers, the method allows for ‘graceful’ degradation of the accuracy by truncating the frequency domain representations, enabling another trade-off mechanism between running time and precision.

In Section  2 we present the formalism for discretization of an arbitrary shape as a countable union of balls, its interpretation as a Minkowski sum, and its analytic description as a convolution. In Section  3 we formulate correlation predicates in terms of Minkowski sums across multiple shapes relatively positioned and oriented in arbitrary ‘poses’ together with their convolution forms, and use the results from the previous section to carry the discretization into the configuration space. In Section  4 we provide examples of applying these tools to solving fundamental problems, whose efficient GPU implementations are shown to outperform some of the state-of-the-art methods in those areas as demonstrated in Section  5. A more detailed outline of the subsections is provided at the beginning of each section.

In this section, we present what we mean by ‘analytic modeling’ in 2.1. We define a discretization scheme in 2.2 as a 3D slice of a 4D Minkowski sum of a countable set of ‘knots’
                        2
                     
                     
                        2
                        The terminology is borrowed from Potts et al.  [25], where convolution with radial kernels at ‘nonequispaced knots’ (which underlies our development) is carried out using the nonequispaced FFT  [10].
                      and a primitive cone that represents balls of all permissible sizes stacked along the 4th dimension. In 2.3, we briefly introduce the sampling approaches that generate such discretizations from arbitrary representations. We incorporate motions in 2.4 and show the advantages of spherical symmetry in the presence of rotations. In 2.5, we present the Fourier expansion of the spherical sampling that facilitates development of fast algorithms.

As usual, we assume solids to be ‘r-sets’, defined by Requicha  [26] as compact (i.e., bounded and closed) regular semianalytic subsets of the Euclidean 3-space 
                           S
                           ⊂
                           P
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        .
                           3
                        
                        
                           3
                           The collection 
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                                 =
                                 
                                    {
                                    B
                                    ∣
                                    B
                                    ⊂
                                    A
                                    }
                                 
                               denotes the ‘power set’ of a set 
                                 A
                              , i.e., the set of all subsets of 
                                 A
                              .
                         The regularity condition (i.e., 
                           S
                           =
                           r
                           S
                        ) ensures continuous homogeneity,
                           4
                        
                        
                           4
                           
                              
                                 r
                                 S
                                 =
                                 κ
                                 ı
                                 S
                               denotes the ‘regularized’ (i.e., closure of interior of) 
                                 S
                              . The ‘boundary’ 
                                 ∂
                                 S
                                 =
                                 κ
                                 S
                                 ∩
                                 κ
                                 c
                                 S
                               is homogeneously 2D for a 3D r-set, separating the open ‘interior’ 
                                 ı
                                 S
                              , from the open ‘exterior’ 
                                 c
                                 S
                                 [27].
                          while the semianalytic requirement guarantees finite describability of the set  [26], as well as its medial axis (MA) and medial axis transform (MAT)  [28]. The latter is defined as an embedding of the MA in the 4D space with the radius of the maximal ball conceptualized as a new coordinate, and contains enough information to reconstruct the solid 
                           S
                        , hence can be used to develop a discretization/sampling scheme in Section  2.2.

To enable an analytic formulation of the geometric modeling operators in Section  3, a solid 
                           S
                           ∈
                           S
                         can be implicitly described as a sublevel set of a real-valued function 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           R
                         (called the ‘defining function’ of 
                           S
                        ), first introduced by Comba  [29] for CD between convex objects, and used later by Ricci  [30] to implement Boolean combinations. By restricting to compactly supported nonnegative functions 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           
                              [
                              0
                              ,
                              ∞
                              )
                           
                        , and using regularized 0-sublevels, i.e., 
                           S
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    S
                                 
                              
                              )
                           
                           =
                           r
                           
                              
                                 U
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    S
                                 
                              
                              )
                           
                        , where
                           
                              (1)
                              
                                 
                                    
                                       U
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 ≔
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    domain of
                                    
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    ∣
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    >
                                    t
                                    }
                                 
                                 ,
                              
                           
                         the regularized set operations are supported by the analytic expressions 
                           
                              
                                 (2)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          ∪
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          0
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    i.e.,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∪
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          0
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    i.e.,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ∩
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         A popular choice for the defining function is the ‘indicator function’ 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ≔
                           
                              
                                 
                                    1
                                 
                              
                              
                                 S
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           
                              {
                              0
                              ,
                              1
                              }
                           
                        , where 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           1
                         if 
                           
                              x
                           
                           ∈
                           S
                         and 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         otherwise. However, the discontinuity of the indicator function makes it difficult to compute the gradients of correlation functions between solids. Lysenko  [22] circumvented this problem in his collision constraint formulation by employing ‘bump functions’ 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 ∞
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         instead, which are compactly supported nonnegative functions that are also smooth, offering more appealing differential properties than the discontinuous indicator functions  [17], the 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                           −
                         (but not 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                           −
                        ) distance fields  [30], and the rather complex R-functions  [31]. Fig. 2
                         illustrates indicator and bump functions, and their discretizations introduced in Section  2.2.

A useful result that underlies the collision predicate formulation in Section  4.1 is the null-volume lemma   [22], which relies on the regularity (hence 3D homogeneity): 
                           Lemma 1
                           
                              For every r-set 
                              
                                 S
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                               
                              with a nonnegative defining function 
                              
                                 
                                    
                                       f
                                    
                                    
                                       S
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    [
                                    0
                                    ,
                                    ∞
                                    )
                                 
                              
                              ,
                              
                                 
                                    (4)
                                    
                                       S
                                       ≠
                                       0̸
                                       ⇌
                                       v
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                S
                                             
                                          
                                          )
                                       
                                       ≔
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             S
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       
                                       d
                                       
                                          x
                                       
                                       >
                                       0
                                       .
                                    
                                 
                              
                           

In particular, if 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ≔
                           
                              
                                 
                                    1
                                 
                              
                              
                                 S
                              
                           
                         then 
                           v
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    S
                                 
                              
                              )
                           
                         exactly gives the volume of 
                           S
                        . Letting 
                           S
                           ≔
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 ∩
                              
                              
                                 ∗
                              
                           
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         in (4) and applying (3), i.e., 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , yields the collision predicate in terms of the inner product of functions 
                           
                              (5)
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0̸
                                 ⇌
                                 v
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 >
                                 0
                                 ,
                              
                           
                         which underlies generalized correlation predicates for a range of applications discussed in Section  4.

It is rarely the case in practical applications with arbitrarily complex shapes to have the defining function in closed form. However, one can always decompose the solid into a finite number of simpler primitives, as an immediate consequence of its finite describability  [26], and apply (2) to combine the primitive defining functions—to which we refer as ‘discretization’. However, obtaining exact discretizations (e.g., curvilinear cell decompositions) from the popular constructive solid geometry (CSG) or boundary representation (B-rep) schemes  [32] is not trivial.
                           5
                        
                        
                           5
                           An r-set 
                                 S
                                 ∈
                                 S
                               is a ‘tame’ embedding of a polyhedron 
                                 Δ
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                               under a homeomorphism 
                                 γ
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 [26], i.e., 
                                 S
                                 =
                                 γ
                                 
                                    (
                                    Δ
                                    )
                                 
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 γ
                                 
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              , and 
                                 
                                    
                                       f
                                    
                                    
                                       S
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          γ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                               due to (2). Although coming up with a closed form for 
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               for a tetrahedron 
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                               is trivial, finding 
                                 γ
                               from CSG or B-rep is not.
                         An alternative is to use approximate discretizations (e.g., spatial enumerations via uniform grids or octrees) which converge to the r-set in the limit. Next, we introduce a more general discretization scheme that subsumes these enumeration methods with non-intersecting cubic primitives (i.e., voxelization) as special cases, and enables other types of (possibly intersecting) primitives.

Consider the case when an r-set can be decomposed as a finite union 
                           S
                           =
                           
                              
                                 ⋃
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         hence 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         due to (2). The following two cases are of prime significance for our purposes:


                        Equiradius decomposition. First, let 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              1
                              ≤
                              i
                              ≤
                              n
                              )
                           
                         be relocated instances of the same base shape 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           ∈
                           S
                         instantiated by the different translations 
                           
                              x
                           
                           ↦
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              x
                           
                        , i.e., 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 x
                              
                              ∣
                              
                                 x
                              
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              }
                           
                        . Each such translation can be abstracted by a 3D point 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , hence the discrete pointset 
                           P
                           ≔
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         (of cardinality 
                           
                              |
                              P
                              |
                           
                           =
                           n
                        ) and the base primitive 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                         contain all the information to reconstruct the solid. We can use the notation 
                           S
                           =
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              P
                              )
                           
                        , as if 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                                 n
                              
                           
                           →
                           P
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         is a mapping from the discrete space to the shape space, illustrated in Fig. 3
                        (a), (b). A crucial observation is that this mapping can be viewed as a Minkowski sum 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              P
                              )
                           
                           =
                           P
                           ⊕
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                        .

To construct an analytic model, let 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         hence a defining function for each primitive instance can be obtained as 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≔
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              −
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           >
                           0
                         are weight coefficients (arbitrarily assigned, for now). The Boolean summation of the balls from (2) takes the form
                           
                              (6)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         which can be viewed as a discrete convolution. To make it compatible with continuous convolutions to be introduced in Section  3, let us rewrite (6) as an integral 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    [
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                         in which the integration variable is 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , and 
                           d
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           =
                           d
                           
                              
                                 x
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           d
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           d
                           
                              
                                 x
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                         is the infinitesimal volume element. 
                           
                              
                                 δ
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           =
                           δ
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           δ
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           δ
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         is the 3D Dirac delta function. If we assume a density function of the form 
                           
                              (7)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       P
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ς
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ς
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              
                                 δ
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 x
                              
                              −
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , to represent the discrete pointset 
                           P
                         as a collection of spatial impulses of intensities 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         at positions 
                           
                              x
                           
                           =
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         (i.e., each point carrying a ‘lumped mass’ of 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        ), the Minkowski sum can be analytically expressed as a convolution 
                           
                              (8)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       P
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i.e.,
                                 
                                 P
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          P
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         A particularly favorable choice for the primitive shape (for reasons to be explained in Section  2.4) is a closed 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -ball, i.e., 
                           
                              (9)
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 B
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    r
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    ∣
                                    
                                       
                                          
                                             ‖
                                             
                                                x
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≤
                                    r
                                    }
                                 
                              
                           
                         are balls of constant radius 
                           r
                           >
                           0
                         centered at 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           P
                        . Let 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              r
                              )
                           
                         where the function 
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           :
                           R
                           →
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         is a generic cut-off kernel (also referred to as the ‘mollifier’ or the ‘bump’) with the closed form 
                           
                              (10)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               
                                                                  
                                                                     |
                                                                     x
                                                                     |
                                                                  
                                                               
                                                               
                                                                  −
                                                                  α
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if
                                             
                                             
                                                |
                                                x
                                                |
                                             
                                             <
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise ,
                                          
                                       
                                    
                                 
                              
                           
                         which can be thought of as a smoothed extension of the discontinuous cut-off function 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 
                                    (
                                    −
                                    1
                                    ,
                                    +
                                    1
                                    )
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              
                                 lim
                              
                              
                                 α
                                 →
                                 ∞
                              
                           
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              x
                              )
                           
                        , and the resulting 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    p
                                 
                              
                              /
                              r
                              )
                           
                         is a mollified extension of the binary indicator 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 1
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              
                                 lim
                              
                              
                                 α
                                 →
                                 ∞
                              
                           
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        .

The spatial enumeration schemes over uniform grids–ranging from bitmap encoding for path planning  [17] to rasterized density functions for protein docking  [18], illustrated in Fig. 1(f), (g)–can be viewed as special cases of this scheme with cubic primitives (i.e., 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                        - instead of 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -balls in (9)) with an additional disjointness condition that is unnecessary for our purposes. Grid-free molecular modeling based on Gaussian densities for protein surface reconstruction  [33] and protein docking  [7] (Fig. 1(h)) are more closely related to the scheme proposed here, as they use spherical primitives.
                           6
                        
                        
                           6
                           Except that these methods use Gaussian kernels rather than compactly supported cut-off kernels such as the one in (10), and use the 
                                 1
                              –(instead of the 
                                 0
                              –) isolevel to define the molecular surface.
                        
                     

Generalizing this grid-free discretization to solid objects of arbitrary geometric complexity would enable more efficient use of the computational resources by adaptively approximating the shape, filling large interior regions with fewer primitives, and allocating resources to capture the details of surface features. A simple solution is to use a recursive decomposition (e.g., an octree) and take the leaf cells (or balls enclosed by their bounding spheres) as primitives (Fig. 1(c)), collected into groups of constant radii according to their level in the tree, for (8) to apply. Hubbard  [14] showed that octree-based spherical approximation is nonoptimal in terms of Hausdorff convergence, and compares poorly with sampling the centers of primitive balls over the MA (Fig. 1(d)). However, the latter requires a generalization of (8) that supports different sizes for the balls, which we address next.


                        Nonequiradius decomposition. The generalization is enabled by a simple geometric lifting trick. This time, let 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              1
                              ≤
                              i
                              ≤
                              n
                              )
                           
                         be translated and scaled instances of the base shape 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           ∈
                           S
                        , i.e., instantiated by the affine transformation 
                           
                              x
                           
                           ↦
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              
                                 x
                              
                              )
                           
                        , i.e., 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 
                                    x
                                 
                                 )
                              
                              ∣
                              
                                 x
                              
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              }
                           
                        . Each such transformation can be abstracted by a 4D point 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 i
                              
                           
                           ≔
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        . The discrete pointset 
                           A
                           ≔
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                         (of cardinality 
                           
                              |
                              A
                              |
                           
                           =
                           n
                        ) contains all the information to reconstruct the solid, and 
                           S
                           =
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         can be viewed as a Minkowski product  [1] of the form 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊗
                           
                              
                                 γ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , defined over the group of the aforementioned instance transformations 
                           G
                           ≅
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        , where 
                           
                              
                                 γ
                              
                              
                                 r
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           ↪
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 γ
                              
                              
                                 r
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              (
                              
                                 x
                              
                              ,
                              r
                              )
                           
                        , and 
                           
                              
                                 γ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           =
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           ×
                           
                              {
                              0
                              }
                           
                         is a trivial embedding in 
                           G
                        .

A more helpful way of looking at this formulation is to think of each primitive 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         as a cross-section (i.e., a 3D ‘slice’ orthogonal to the 
                           r
                        -axis at 
                           r
                           =
                           0
                        ) through a hypothetical hypercone 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                         whose apex is located at 
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ∈
                           A
                        , illustrated in Fig. 3(c), (d). To ensure compactness of the 4D objects, let us replace the unbounded cones 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         with trimmed half-cones 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        :
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    C
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          r
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       ∣
                                       
                                          
                                             
                                                ‖
                                                
                                                   x
                                                
                                                −
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ≤
                                       
                                          |
                                          r
                                          −
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                       }
                                    
                                    ,
                                 
                              
                              
                                 (11)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    C
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ∩
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       ×
                                       
                                          [
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          L
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ]
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           L
                           >
                           
                              
                                 max
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                         to guarantee that all displaced half-cones will intersect the 
                           r
                           =
                           0
                         hyperplane. If we define 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           ≔
                           
                              
                                 ⋃
                              
                              
                                 1
                                 ≤
                                 i
                                 ≤
                                 n
                              
                           
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        , the 3D solid 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         becomes a slice of the 4D solid 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         at 
                           r
                           =
                           0
                        , where 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 4
                                 n
                              
                           
                           →
                           P
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    4
                                 
                              
                              )
                           
                         is the discretization mapping illustrated in Fig. 3(d), (e). Unlike the scaled primitives 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                         that have different sizes, their cones 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         are all translated instances of the same base shapes 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        , respectively, whose apexes are at the origin. Their union can thus be viewed as a Minkowski sum 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        . The 3D solid is then obtained as a 3D slice 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                           ≔
                           
                              
                                 γ
                              
                              
                                 0
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 
                                    K
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              )
                           
                        ,
                           7
                        
                        
                           7
                           For a set 
                                 K
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                              , we use the simplified notation 
                                 K
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               for its 
                                 r
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                               slice projected to 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              , i.e., 
                                 K
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ≔
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    K
                                    ∩
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    )
                                 
                              , where 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ↪
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                               is defined as 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    r
                                    )
                                 
                               hence 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    r
                                    )
                                 
                                 =
                                 
                                    x
                                 
                              .
                          illustrated in Fig. 3(e), (f).

To obtain an analytic form for the 4D geometry similar to (8), let 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                        , hence a defining function for each compact cone can be obtained as 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 a
                              
                              −
                              
                                 
                                    
                                       a
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , where 
                           
                              a
                           
                           =
                           
                              (
                              
                                 x
                              
                              ,
                              r
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        . If we form an impulsive density function similar to (7)
                        
                           
                              (12)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       A
                                    
                                 
                                 
                                    (
                                    
                                       a
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ς
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       a
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       a
                                    
                                    −
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 δ
                              
                              
                                 4
                              
                           
                           
                              (
                              
                                 a
                              
                              )
                           
                           =
                           
                              
                                 δ
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           δ
                           
                              (
                              r
                              )
                           
                        , the convolution in (8) generalizes to the 4-space as 
                           
                              (13)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             K
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          A
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       A
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i.e.,
                                 
                                 A
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          A
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         whose domain restriction to the 
                           r
                           =
                           0
                         hyperplane gives a bump function for the 3D solid as 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        ,
                           8
                        
                        
                           8
                           For a function 
                                 
                                    
                                       f
                                    
                                    
                                       K
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                                 →
                                 R
                              , we use the notation 
                                 
                                    
                                       f
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 R
                               to denote the restriction (and trivial projection) of its domain to the 
                                 r
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                               hyperplane, i.e., 
                                 
                                    
                                       f
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       K
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              .
                          therefore 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       A
                                       )
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    r
                                    =
                                    0
                                 
                              
                              )
                           
                        . As before, we can let 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              ,
                              r
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    p
                                 
                              
                              /
                              r
                              )
                           
                         whose unbounded support is smoothly trimmed along the 4th dimension to 
                           r
                           ∈
                           
                              (
                              −
                              L
                              ,
                              0
                              )
                           
                         as 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              ,
                              r
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    p
                                 
                              
                              /
                              r
                              )
                           
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              1
                              −
                              2
                              r
                              /
                              L
                              )
                           
                        .

Clearly, a solid 
                           S
                           ∈
                           S
                         of arbitrary shape cannot in general be exactly constructed as a finite union of balls 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊗
                           
                              
                                 γ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , i.e., a 3D slice of 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        . However, a similar construction is possible by replacing the finite set of ball centers 
                           P
                         and its radius-lift 
                           A
                        , with the MA (denoted by 
                           M
                           
                              [
                              ı
                              S
                              ]
                           
                        ) and the MAT (denoted by 
                           T
                           
                              [
                              ı
                              S
                              ]
                           
                        ), respectively. In fact 
                           S
                           =
                           T
                           
                              [
                              ı
                              S
                              ]
                           
                           
                              
                                 ⊗
                              
                              
                                 ∗
                              
                           
                           
                              
                                 γ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , which is a 3D slice of 
                           K
                           =
                           T
                           
                              [
                              ı
                              S
                              ]
                           
                           
                              
                                 ⊕
                              
                              
                                 ∗
                              
                           
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        .
                           9
                        
                        
                           9
                           The MA/MAT of an r-set are not necessarily closed, and neither are their Minkowski sums with a closed ball/cone, which is why the regularized Minkowski sum/product (denoted by 
                                 
                                    
                                       ⊕
                                    
                                    
                                       ∗
                                    
                                 
                                 /
                                 
                                    
                                       ⊗
                                    
                                    
                                       ∗
                                    
                                 
                              ) need to be used.
                         This construction can be thought of as sweeping a resizeable ball along the MA (with prespecified scaling for the balls along the MA trajectory), or equivalently, sweeping a rigid cone along the MAT in 4D followed by a 3D slicing. Unfortunately, the convolution formulation is not as simple in this case, because MA and MAT are not homogeneous, but are in general made of 2-, 1- or 0-dimensional subanalytic components for 3D solids  [28]. We conjecture that it is possible to generalize the density function 
                           
                              
                                 ρ
                              
                              
                                 A
                              
                           
                         defined in (12) to 
                           
                              
                                 ρ
                              
                              
                                 T
                                 
                                    [
                                    ı
                                    S
                                    ]
                                 
                              
                           
                        , by using Dirac delta functions of various orders over different regions of 
                           T
                           
                              [
                              ı
                              S
                              ]
                           
                         depending on their dimensionalities, whose formal treatment we postpone to a follow-up study on skeletal density functions (SDF).

Here we take a simpler approach, by assuming sequences of finite samples 
                           A
                           ⊂
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                         of different sizes 
                           
                              |
                              A
                              |
                           
                           =
                           1
                           ,
                           2
                           ,
                           …
                         that progressively approximate the shape. The set 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         is called an 
                           ϵ
                        -approximation of 
                           S
                         if 
                           
                              
                                 d
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                              ,
                              S
                              )
                           
                           ≤
                           ϵ
                        , where 
                           
                              
                                 d
                              
                              
                                 H
                              
                           
                         denotes the Hausdorff 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -metric. It is important to emphasize that our formulation in 2.2 does not impose any theoretical restriction on the sampling algorithm, as long as it guarantees that as 
                           n
                           →
                           ∞
                        , 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         converges to 
                           S
                         (i.e., 
                           
                              
                                 lim
                              
                              
                                 
                                    |
                                    A
                                    |
                                 
                                 →
                                 ∞
                              
                           
                           
                              
                                 d
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                              ,
                              S
                              )
                           
                           =
                           0
                        ), and the convolution in (13) holds in the limit for the countably infinite set of knots 
                           A
                        . A variety of methods that have been in use in the CD literature  [13–16] (Fig. 1(c)–(e)) can be used, two of which are briefly reviewed here due to their theoretical significance and computational relationship with our algorithm in Appendix A.

Hubbard  [14] proposed an algorithm that populates the maximal balls over the MA (Fig. 1(d)), obtained from pruning the Voronoi diagram of a dense sampling over the boundary, and follows a principle of conservative coverage to create a bounding sphere-tree. In terms of our formulation, this is equivalent to selecting 
                           A
                           ⊂
                           T
                           
                              (
                              S
                              )
                           
                         and has been shown in  [14] to converge to the shape faster than octree-based sampling (Fig. 1(c)). However, MA and MAT are unstable with respect to 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                        –and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        –perturbations of the boundary  [28], making their computations extremely difficult in the presence of noise/errors. Weller and Zachmann  [16] proposed the inner-sphere tree (IST) method that precomputes the distance function over a uniform grid and uses a greedy algorithm to pack the interior of the solid, giving priority to the largest ball that fits at each step. This approach has been proven effective for real-time applications  [16], but leaves out void spaces in the interior of the set that are undesirable for analytic modeling, and is nonoptimal for thin objects.

We use a similar greedy algorithm that is guided by the SDF field  [34], which creates spherical samples that are similar to the outcomes of MA-based algorithms  [14,15], without the need to compute and prune the MA, and is capable of producing better approximations than distance-based sphere packing  [16] with fewer number of balls. Our algorithm guarantees bounds on the Hausdorff distance from the original shape that are proportional to the SDF grid resolution. This property is used in Section  5 as a basis for time complexity comparisons between operations on uniform samples versus spherical samples generated with the same input grid resolution. To prevent distraction from this article’s main focus on Minkowski discretizations and their Fourier reconciliations, the details of our spherical decomposition algorithm along with its topological properties and approximation error bounds are postponed to Appendix A.

The motion of rigid bodies can be abstracted as trajectories of points in the so-called ‘configuration space’ (commonly abbreviated as the 
                           C
                        -space), first introduced to the field of robotics by Lozano-Perez  [3]. Every rigid motion in 3D can be parameterized by a tuple
                           
                              (14)
                              
                                 M
                                 =
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 ∈
                                 S
                                 E
                                 
                                    (
                                    3
                                    )
                                 
                                 ,
                                 
                                 S
                                 E
                                 
                                    (
                                    3
                                    )
                                 
                                 ≅
                                 S
                                 O
                                 
                                    (
                                    3
                                    )
                                 
                                 ⋉
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ,
                              
                           
                         where 
                           R
                           ∈
                           S
                           O
                           
                              (
                              3
                              )
                           
                         is a rotation described by a 3×3 special orthogonal matrix (i.e., 
                           
                              
                                 R
                              
                              
                                 
                                    T
                                 
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 −
                                 1
                              
                           
                         and 
                           
                              det
                           
                           
                              (
                              R
                              )
                           
                           =
                           +
                           1
                        ) and 
                           
                              t
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is a translation described by a 3-vector. See Appendix B for the definition, properties, and terminology of the motion group and its action on r-sets.

The advantage of using primitives with spherical symmetry becomes evident in the light of the isometric property of 
                           S
                           E
                           
                              (
                              3
                              )
                           
                        . A 3D ball 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           ≔
                           B
                           
                              (
                              
                                 0
                              
                              ,
                              r
                              )
                           
                         is invariant under 3D rotations, i.e., 
                           R
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                         hence 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           B
                           
                              (
                              
                                 t
                              
                              ,
                              r
                              )
                           
                        . The same invariance property can be asserted for 4D cones 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         whose axes stay parallel to the 
                           r
                        -axis after 3D translations and rotations. Accordingly, the transformation of 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         and 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                         amounts only to a relocation of the center and apex positions. For the equiradius case, the Minkowski sum in (8) for the transformed solid is given by 
                           
                              (15)
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    P
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    P
                                    )
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         whose analytic expression is given by the bump function 
                           
                              (16)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       P
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          ρ
                                       
                                       
                                          P
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             (
                                             R
                                             ,
                                             
                                                t
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ]
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the lumped density 
                           
                              (17)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       P
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         is an implicit representation of the transformed set of 3D knots 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           P
                           =
                           
                              {
                              
                                 (
                                 R
                                 ,
                                 
                                    t
                                 
                                 )
                              
                              
                                 x
                              
                              ∣
                              
                                 x
                              
                              ∈
                              P
                              }
                           
                        . In a similar fashion, for nonequiradius case the Minkowski sum in (13) for the transformed lifted geometry is given by
                           
                              (18)
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    
                                       K
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    A
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    A
                                    )
                                 
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         whose analytic expression is given by the bump function 
                           
                              (19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       
                                          
                                             K
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          A
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       A
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          ρ
                                       
                                       
                                          A
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             (
                                             R
                                             ,
                                             
                                                t
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ]
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the lumped density 
                           
                              (20)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       A
                                    
                                 
                                 
                                    (
                                    
                                       a
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       a
                                    
                                    −
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         is an implicit representation of the transformed set of 4D knots 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           A
                           =
                           
                              {
                              
                                 (
                                 R
                                 ,
                                 
                                    t
                                 
                                 )
                              
                              
                                 a
                              
                              ∣
                              
                                 a
                              
                              ∈
                              A
                              }
                           
                        , using the trivial extension 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           
                              a
                           
                           =
                           
                              (
                              
                                 (
                                 R
                                 ,
                                 
                                    t
                                 
                                 )
                              
                              
                                 x
                              
                              ,
                              r
                              )
                           
                         for 
                           
                              a
                           
                           =
                           
                              (
                              
                                 x
                              
                              ,
                              r
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        .

The strength of the discretization schemes that transform according to (15) through (20) lies in the rotation invariance of the primitive sets 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                         or 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         and their radial kernels 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         or 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        , which appear in the same form in all equations before and after motion. We show in Section  3 that the same form is conserved across Minkowski sums and related cross-correlations between pairs of discretized objects. The practical implication is that the primitives do not need to take an explicit role in the computations, and numerical algorithms deal only with the discrete sets 
                           P
                         or 
                           A
                         or their density functions 
                           
                              
                                 ρ
                              
                              
                                 P
                              
                           
                         or 
                           
                              
                                 ρ
                              
                              
                                 A
                              
                           
                        .

A major motivation behind using analytic methods is the efficient tractability of convolutions and differentiations via Fourier transforms. Using the orthonormal basis of the form 
                           
                              
                                 e
                              
                              
                                 2
                                 π
                                 
                                    i
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    ⋅
                                    
                                       x
                                    
                                    )
                                 
                              
                           
                         (where 
                           
                              
                                 
                                    i
                                 
                              
                              
                                 2
                              
                           
                           =
                           −
                           1
                        ), every r-set’s bump function 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         can be expanded into its components given by 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 S
                              
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , using the continuous Fourier transform (CFT)
                           10
                        
                        
                           10
                           Bump functions are square-integrable, i.e., 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ⊂
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              .
                        : 
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          +
                                          2
                                          π
                                          
                                             i
                                          
                                          
                                             (
                                             
                                                ω
                                             
                                             ⋅
                                             
                                                x
                                             
                                             )
                                          
                                       
                                    
                                    〉
                                 
                                 ⇌
                                 
                                    
                                       f
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          S
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          2
                                          π
                                          
                                             i
                                          
                                          
                                             (
                                             
                                                ω
                                             
                                             ⋅
                                             
                                                x
                                             
                                             )
                                          
                                       
                                    
                                    〉
                                 
                                 .
                              
                           
                         For most applications such as the ones discussed in Section  4, the current analytic methods rely on discretizing the defining functions over a dense sample of points in the interior  [17,18,22], which turns the CFT into a discrete Fourier transform (DFT). If the sampling is over a uniform grid, the DFT can be implemented very efficiently using the well-known fast Fourier transform (FFT) algorithm, first discovered by Cooley and Tukey  [9]. The rotations are handled by an interpolation over the frequency grid and translations are embedded into convolutions. However, when the objects are discretized with spherical primitives whose centers form a nonuniform set of points, the CFT interpolates a nonequispaced DFT (NDFT), to which the classical FFT algorithms do not apply. Potts et al.  [10] developed a nonequispaced FFT (NFFT) algorithm for efficient implementation of NDFT sums in asymptotically similar running times with the classical FFT. See Appendix C for the definition, properties, and complexity of Fourier transforms.

If an r-set 
                           S
                           ∈
                           S
                         moves via 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           ∈
                           S
                           E
                           
                              (
                              3
                              )
                           
                        , its transformed bump function changes in the frequency domain as 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 S
                              
                           
                           =
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 R
                                 S
                              
                           
                           =
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              ∘
                              
                                 
                                    R
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 ς
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≔
                           δ
                           
                              (
                              
                                 x
                              
                              −
                              
                                 t
                              
                              )
                           
                         denotes a shifted Dirac delta function that transfers to 
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 ω
                              
                              )
                           
                           =
                           
                              
                                 e
                              
                              
                                 −
                                 2
                                 π
                                 
                                    i
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    ⋅
                                    
                                       t
                                    
                                    )
                                 
                              
                           
                        . For an equiradius discretization 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              P
                              )
                           
                           =
                           P
                           ⊕
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                         the Fourier expansion of 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    P
                                    )
                                 
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 P
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         is a simple product 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    P
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 P
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . Applying the CFT to (16) gives 
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          P
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       R
                                       P
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          P
                                       
                                    
                                    ∘
                                    
                                       
                                          R
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the density function given in (7) is transferred to 
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       P
                                    
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       2
                                       π
                                       
                                          i
                                       
                                       
                                          (
                                          
                                             ω
                                          
                                          ⋅
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         The evaluation of (23) from a nonuniform set of 3D knots to a uniform 3D frequency grid amounts to a one-sided 3D NDFT computation.

For nonequiradius discretization 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                         where 
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        , we have 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 A
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         hence 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 A
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . Applying the CFT to (19) gives 
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                       
                                          
                                             K
                                          
                                          
                                             n
                                          
                                       
                                       
                                          (
                                          A
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          a
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       R
                                       A
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          a
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          A
                                       
                                    
                                    ∘
                                    
                                       
                                          R
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              a
                           
                           =
                           
                              (
                              
                                 t
                              
                              ,
                              r
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                         represents a lifted translation, and the density function given in (12) is transferred to 
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       A
                                    
                                 
                                 
                                    (
                                    
                                       υ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       υ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       2
                                       π
                                       
                                          i
                                       
                                       
                                          (
                                          
                                             υ
                                          
                                          ⋅
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         in which 
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    a
                                 
                              
                           
                           
                              (
                              
                                 υ
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 ω
                              
                              )
                           
                           
                              
                                 e
                              
                              
                                 −
                                 2
                                 π
                                 
                                    i
                                 
                                 
                                    (
                                    η
                                    r
                                    )
                                 
                              
                           
                         for the lifted physical domain 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ∈
                           A
                         is obtained in a similar fashion to (23) using NDFTs, except that the frequency domain is also lifted to 4D as 
                           
                              υ
                           
                           =
                           
                              (
                              
                                 ω
                              
                              ,
                              η
                              )
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        .

Having defined a spherical sampling in terms of a Minkowski sum of discrete knots and balls/cones alongside their analytic formulation in Section  2, we now investigate how they embed into cross-correlations between pairs of objects. In 3.1, we show that spherical discretization structure is preserved and carried into configuration pointsets, whose Fourier formulation is given in 3.2.

Given two r-sets 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ∈
                           S
                        , we define their ‘correlation function’ as 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           :
                           S
                           E
                           
                              (
                              3
                              )
                           
                           ×
                           S
                           E
                           
                              (
                              3
                              )
                           
                           →
                           R
                         where 
                           
                              (26)
                              
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 ,
                              
                           
                         accumulates the pointwise multiplication of the overlapped shape descriptor functions of 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         moved using 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                           =
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                           =
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , respectively. The function in (26) can formulate, for example, a holonomic collision constraint (Section  4.1), a shape complementarity metric (Section  4.2), or a morphological operator (Section  4.3). For instance, comparing (26) with (4) shows that if 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                        , then 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         defines a collision predicate for the moved solids, i.e., 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 ∩
                              
                              
                                 ∗
                              
                           
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ≠
                           0̸
                         iff 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           >
                           0
                        . It is easy to show that the correlation function only depends on the relative configuration 
                           M
                           ≔
                           
                              
                                 M
                              
                              
                                 1
                              
                              
                                 −
                                 1
                              
                           
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                        , i.e., the motion of 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         observed from a coordinate frame attached to 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        . Letting 
                           M
                           =
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              )
                           
                        , the alternative formulation 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           :
                           S
                           E
                           
                              (
                              3
                              )
                           
                           →
                           R
                         becomes
                           
                              (27)
                              
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             R
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ∘
                                       
                                          
                                             T
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    〉
                                 
                                 ,
                              
                           
                         noting that 
                           
                              
                                 f
                              
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 S
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 R
                                 S
                              
                           
                           ∘
                           
                              
                                 T
                              
                              
                                 −
                                 1
                              
                           
                           =
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    S
                                 
                              
                              ∘
                              
                                 
                                    R
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                           ∘
                           
                              
                                 T
                              
                              
                                 −
                                 1
                              
                           
                         where 
                           T
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , 
                           T
                           
                              x
                           
                           =
                           
                              x
                           
                           +
                           
                              t
                           
                        . The inner product in (27) can be viewed as a 6D noncommutative convolution over 
                           S
                           E
                           
                              (
                              3
                              )
                           
                           [2]. For numerical tractability, we decompose the motion into rotational and translational parts, and view the latter as a 3D commutative convolution: 
                           
                              (28)
                              
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ⋆
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          −
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           −
                           S
                           =
                           
                              {
                              −
                              
                                 x
                              
                              ∣
                              
                                 x
                              
                              ∈
                              S
                              }
                           
                         denotes a reflection with respect to the origin. This defines a relative collision predicate, i.e., 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 ∩
                              
                              
                                 ∗
                              
                           
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ≠
                           0̸
                         iff 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           >
                           0
                        , and brings us to the important concept of a ‘configuration obstacle’ (or the 
                           C
                        -obstacle for short) in robotics  [3], defined as 
                           
                              (29)
                              
                                 
                                    
                                       O
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    ∈
                                    S
                                    E
                                    
                                       (
                                       3
                                       )
                                    
                                    ∣
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    >
                                    0
                                    }
                                 
                                 ,
                              
                           
                         whose complement 
                           c
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is the ‘free space’. The obstacle space does not contain the contact space by definition, i.e., is an open set, whose closure 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           ≔
                           κ
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is a 6D r-set  [22]. For a fixed rotation 
                           R
                           ∈
                           S
                           O
                           
                              (
                              3
                              )
                           
                         the translational obstacle defined by 
                           
                              (30)
                              
                                 
                                    
                                       O
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 ≔
                                 
                                    {
                                    
                                       t
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    ∣
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    >
                                    0
                                    }
                                 
                              
                           
                         is a 3D slice through the 6D obstacle, whose closure is obtained by offsetting 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         with 
                           −
                           R
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         given by a Minkowski sum 
                           
                              (31)
                              
                                 
                                    
                                       O
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    (
                                    −
                                    R
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          −
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         As a result of the definition in (29), 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                         serves as a defining function of the regularized 
                           C
                        -obstacle as a 0-sublevel set 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                        , referred to as the ‘gap function’  [3]. Similarly, the restriction of the gap function to a fixed 
                           R
                           ∈
                           S
                           O
                           
                              (
                              3
                              )
                           
                         is a defining function for the 3D slice 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    R
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 −
                                 R
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . Next we investigate the discretization of the 
                           C
                        -obstacle (and the Minkowski sums in general) when spherical sampling is used for the constituent parts.


                        Equiradius correlations. First, let 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         be composed of instances of balls denoted by 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ≔
                           B
                           
                              (
                              
                                 0
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ≔
                           B
                           
                              (
                              
                                 0
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , respectively. Substituting from (15) in (31), and noting the invariance of the balls to reflection and rotation (i.e., 
                           −
                           R
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        ) and the commutativity of Minkowski sums, we obtain 
                           
                              
                                 (32)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ⊕
                                    
                                       (
                                       
                                          (
                                          −
                                          R
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ⊕
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (33)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       
                                          (
                                          −
                                          R
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ⊕
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (34)
                                 
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          O
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    ⊕
                                    
                                       
                                          B
                                       
                                       
                                          O
                                       
                                    
                                    .
                                 
                              
                           
                         The first term 
                           
                              
                                 P
                              
                              
                                 O
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           ≔
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              (
                              −
                              R
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         is a finite set of 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         points in the 3D translation space obtained from pairwise summations of ball centers in 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           −
                           R
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        . It represents the discrete translational obstacle 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                        , a 3D slice through 
                           
                              
                                 P
                              
                              
                                 O
                              
                           
                           ≔
                           
                              
                                 O
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ⊂
                           S
                           E
                           
                              (
                              3
                              )
                           
                         defining a collection of 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         curves. The second term 
                           
                              
                                 B
                              
                              
                                 O
                              
                           
                           ≔
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           =
                           B
                           
                              (
                              
                                 0
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    O
                                 
                              
                              )
                           
                         is a ball of radius 
                           
                              
                                 r
                              
                              
                                 O
                              
                           
                           =
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                         in the translational space, representing the ‘primitive obstacle’ 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                        , which is a 3D slice of 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ⊂
                           S
                           E
                           
                              (
                              3
                              )
                           
                        . Therefore, the total obstacle itself is a finite union of balls, i.e., discretized with the same scheme as the original objects: 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    O
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    R
                                 
                              
                              )
                           
                        . An illustration is given in Fig. 4
                        (a)–(c). The analytic formulation in (28) develops in parallel as 
                           
                              
                                 (35)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ∗
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             −
                                             R
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (36)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             ρ
                                          
                                          
                                             −
                                             R
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ∗
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (37)
                                 
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                O
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       O
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           ≔
                           
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ∗
                              
                                 
                                    ρ
                                 
                                 
                                    −
                                    R
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         is the impulsive density function of the discrete pointset 
                           
                              
                                 P
                              
                              
                                 O
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                         made of 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         impulses corresponding to pairwise cross-correlation of Dirac delta terms from the constituents,
                           11
                        
                        
                           11
                           Note that if 
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              , 
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              , and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 ρ
                                 
                                    (
                                    −
                                    
                                       x
                                    
                                    )
                                 
                              , then 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    ⋆
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    ∗
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    )
                                 
                              .
                          while 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           ≔
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is a cross-correlation of two radial bumps of radii 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        , leading to another radial bump of radius 
                           
                              
                                 r
                              
                              
                                 O
                              
                           
                           =
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                         that defines the obstacle ball 
                           
                              
                                 B
                              
                              
                                 O
                              
                           
                        . Note that if we choose 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         using the form in (10), their convolution does not take the same form, i.e., 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≠
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    r
                                 
                                 
                                    O
                                 
                              
                              )
                           
                        . However, the latter can be safely replaced for the last term in (37) without changing the obstacle 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    R
                                 
                              
                              )
                           
                        , since the bump form choice is arbitrary as long as 
                           
                              
                                 B
                              
                              
                                 O
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          O
                                       
                                    
                                 
                              
                              )
                           
                        .


                        Nonequiradius correlations. The generalization to 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         made of primitive balls of different sizes is not straightforward. This is because the commutativity of the Minkowski sum 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              P
                              )
                           
                           =
                           P
                           ⊕
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                         that led from (32) to (33) does not hold for the product 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           
                              (
                              A
                              )
                           
                           =
                           A
                           ⊗
                           
                              
                                 γ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . In terms of the lifted geometry, this manifests as the observation that the 3D Minkowski sum of the cross-sections is not equal to the cross-section of the 4D Minkowski sum; or in other words, a collision between 
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         does not necessarily imply a collision between the cross-sections 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        . At the primitive level, this is because the 4D half-cones, despite being invariant under 3D rotations and reflections, are not invariant under 4D reflections, hence 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           ≠
                           −
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         and the sum 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           ⊕
                           
                              (
                              −
                              
                                 
                                    D
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         (that appears in 
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              (
                              −
                              R
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        ) does not give a half-cone in the 
                           C
                        -space. Fortunately, this can be solved by a pre-reflection with respect to the 
                           r
                           =
                           0
                         hyperplane of one of the two lifted shapes. If we let 
                           
                              (38)
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       −
                                       r
                                       )
                                    
                                    ∣
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       r
                                       )
                                    
                                    ∈
                                    K
                                    }
                                 
                                 ,
                                 
                                 
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ̆
                                       
                                    
                                    ⊂
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              
                           
                         denote the 
                           r
                        -mirror image of the 4D set 
                           K
                        , the 3D set can be retrieved from both of them as 
                           S
                           =
                           K
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 K
                              
                              
                                 ̆
                              
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        . Then the nonequiradius discretization scheme in (18) gives 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 n
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    ̆
                                 
                              
                              )
                           
                           =
                           
                              
                                 A
                              
                              
                                 ̆
                              
                           
                           ⊕
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 0
                              
                           
                         and 
                           −
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 n
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    ̆
                                 
                              
                              )
                           
                           =
                           
                              (
                              −
                              
                                 
                                    A
                                 
                                 
                                    ̆
                                 
                              
                              )
                           
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        , noting that 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           =
                           −
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 0
                              
                           
                         and the sum 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           ⊕
                           
                              (
                              −
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ̆
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         (that appears in 
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              (
                              −
                              R
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ̆
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        ) is a half-cone of double the size in the 
                           C
                        -space. Furthermore, it is easy to prove that in this case, for two collections of half-cones of opposite directions that intersect the 
                           r
                           =
                           0
                         hyperplane, a collision between the 4D solids does in fact imply a collision between the 3D slices: 
                           Lemma 2
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0̸
                                 ⇌
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0̸
                              
                              .
                           


                        
                           Proof
                           The proof is straightforward, by noting that for every pair of 4D cones 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 ≔
                                 D
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 ≔
                                 D
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               corresponding to 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                              , respectively, they intersect after flipping one of them upside down (i.e., 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0̸
                              ) if and only if their 3D slices intersect (i.e., 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       ∩
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       r
                                       =
                                       0
                                    
                                 
                                 ≠
                                 0̸
                              ). The assertion is very easy to picture for 3D cones whose slices are 2D disks.□

As a direct corollary, we can define a 4D translational 
                           C
                        -obstacle that is discretized with the same scheme as 
                           
                              
                                 (39)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    ⊕
                                    
                                       (
                                       
                                          (
                                          −
                                          R
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ⊕
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (40)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       
                                          (
                                          −
                                          R
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ⊕
                                    
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       ⊕
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (41)
                                 
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          O
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    ⊕
                                    
                                       
                                          D
                                       
                                       
                                          O
                                       
                                    
                                    ,
                                 
                              
                           
                         and the 3D obstacle is a slice 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    ]
                                 
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        . The first term 
                           
                              
                                 A
                              
                              
                                 O
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           ≔
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              (
                              −
                              R
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ̆
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         is a finite set of 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         points in the 4D translation space obtained from pairwise summations of cone apexes in 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         and 
                           −
                           R
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 2
                              
                           
                        , which is the same as 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                        . In this case, the primitive obstacle 
                           
                              
                                 D
                              
                              
                                 O
                              
                           
                           ≔
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         is a larger half-cone with a height of 
                           2
                           L
                        , which is equal to 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                        . Therefore, the 
                           C
                        -obstacle is discretized with the same scheme as 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    O
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    R
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          K
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             O
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             R
                                          
                                       
                                       )
                                    
                                    ]
                                 
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        . An illustration is given in Fig. 4(d)–(f). The analytic formulation in (28) develops in parallel as 
                           
                              
                                 (42)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ∗
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             −
                                             R
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ̆
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (43)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             ρ
                                          
                                          
                                             −
                                             R
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ̆
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ∗
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ∗
                                       
                                          
                                             f
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (44)
                                 
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                O
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         whose restriction to 
                           r
                           =
                           0
                         gives 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    ]
                                 
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        . Similar to the equiradius case, 
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       O
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           ≔
                           
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ∗
                              
                                 
                                    ρ
                                 
                                 
                                    −
                                    R
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ̆
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         is the impulsive density function of the discrete pointset 
                           
                              
                                 A
                              
                              
                                 O
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                         made of 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                        impulses corresponding to cross-correlation of pairs of shifted Dirac delta functions, while 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           ≔
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ∗
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         is an auto-correlation, which can be arbitrarily modified from the original convolved form to 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           
                              (
                              
                                 t
                              
                              ,
                              r
                              )
                           
                           ≔
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    
                                       ‖
                                       
                                          t
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              r
                              )
                           
                           
                              
                                 ψ
                              
                              
                                 α
                              
                           
                           
                              (
                              1
                              −
                              r
                              /
                              L
                              )
                           
                         without changing the obstacle 
                           
                              
                                 O
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ̆
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    r
                                    =
                                    0
                                 
                              
                              )
                           
                        .

Although one only needs the 
                           r
                           =
                           0
                         slice to retrieve the 
                           C
                        -obstacle, the other slices carry useful information. In fact, any 
                           r
                           ≠
                           0
                         slice corresponding to 
                           r
                           ∈
                           
                              (
                              −
                              L
                              ,
                              +
                              L
                              )
                           
                         gives the obstacle for a pair of offset 3D solids defined as 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                        -slice of 
                           
                              
                                 K
                              
                              
                                 1
                              
                           
                         (i.e., shrinking 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        ’s primitives by 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                        ) and 
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        -slice of 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 2
                              
                           
                         (i.e., expanding 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        ’s primitives by 
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        ) giving a total offset of 
                           −
                           r
                           =
                           −
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . These ‘offset obstacles’ can be used, for example, to incorporate tolerances for machine tooling, guarantee safety margins for path planning, or construct skin layers for protein shape complementarity modeling (Section  4).

To take advantage of the convolution theorem for a significantly faster computation of correlation functions, we present an analysis of the gap function in the Fourier domain. For two r-sets 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ∈
                           S
                        , applying CFT to (28) yields the Fourier correlation function as 
                           
                              (45)
                              
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       R
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ∘
                                    
                                       
                                          R
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         noting that 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 −
                                 R
                                 S
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 R
                                 S
                              
                           
                         for real defining functions, i.e., CFT converts reflection (in both physical and frequency domains) to conjugation in the frequency domain, a property known as Hermitian symmetry (see Appendix C). 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           F
                           
                              {
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    R
                                 
                              
                              }
                           
                         is the CFT of 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                         only with respect to translation at a fixed 
                           R
                           ∈
                           S
                           O
                           
                              (
                              3
                              )
                           
                        .

For the equiradius discretizations 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           =
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ⊕
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         with Fourier representations 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , respectively, their Fourier correlation is obtained by substituting (22) in (45), or directly applying the CFT to (37) as 
                           
                              
                                 (46)
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             R
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (47)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             R
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                O
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         noting that 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                         hence 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                         (i.e., are both real-valued), and so is 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . As expected, 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       O
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 R
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is computed from a pointwise multiplication of the NDFTs over the knots 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

Analogously, for the nonequiradius discretizations 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           =
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ̆
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           
                              
                                 |
                              
                              
                                 r
                                 =
                                 0
                              
                           
                        , where 
                           
                              
                                 K
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ⊕
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ̆
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 2
                              
                           
                           ⊕
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 0
                              
                           
                         with 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ̆
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        , respectively, their Fourier correlation is obtained by substituting (24) in (45), or directly applying CFT to (44) as 
                           
                              
                                 (48)
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ̆
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             R
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ̆
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         ̆
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (49)
                                 
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             R
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ̆
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                O
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 2
                              
                           
                        , noting that 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         as a result of the reflective duality 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 −
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        . In a similar fashion, 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       O
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 R
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is computed from a pointwise multiplication of the NDFTs over the knots 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       ̆
                                    
                                 
                              
                              
                                 2
                              
                           
                        .

A critical observation is that the computational implementation relies only on the discrete knots 
                           P
                         and 
                           A
                         (or 
                           
                              
                                 A
                              
                              
                                 ̆
                              
                           
                        ), expressed in the Fourier domain by the NDFTs 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 P
                              
                           
                         in (23) and 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 A
                              
                           
                         (or 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       ̆
                                    
                                 
                              
                           
                        ) in (25), respectively. The continuous geometry is completely embodied by the primitives implicit in 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         or 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 2
                              
                           
                        . However, despite appearing in equations, they do not explicitly participate into the numerical algorithms, and that reflects the true power of this particular discretization scheme.

Next, we show how the tools developed in Sections  2 and 3 can be applied to collision detection in 4.1, shape complementarity in 4.2, and configuration products in 4.3, and identify future research opportunities in each area.

Analytic collision detection (CD) can be traced to the work by Comba  [29] on convex sets. Kavraki  [17] discovered the interpretation of the translational 
                           C
                        -obstacle as a convolution of the objects–the robot and its workspace in the context of path planning  [3]–along with the application of the FFT. Both objects 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ∈
                           S
                         are represented by binary indicators 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           
                              {
                              0
                              ,
                              1
                              }
                           
                        , discretized as bitmaps, and the integer map of the translational 
                           C
                        -obstacle obtained as 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ∗
                              
                                 
                                    
                                       1
                                    
                                 
                                 
                                    −
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                         simply counts the number of grid cells that overlap at a relative translation 
                           
                              t
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . The algorithm performs two forward FFTs to obtain 
                           
                              
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , a pairwise multiplication to obtain 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , and an inverse FFT to retrieve the obstacle map in 
                           O
                           
                              (
                              m
                              log
                              m
                              )
                           
                         time, where 
                           m
                         is the grid size. Although the algorithm is asymptotically optimal to obtain a complete description of the obstacle for all possible translations in a given discretized domain, it is rarely useful for time-critical CD (e.g., in real-time simulations and physically-based modeling  [16]) where a single configuration is queried.

Lysenko  [22] recently generalized the approach by using bump functions to facilitate differentiation, and proposed techniques to enable time-critical CD for a single-configuration query via truncated Fourier expansions, along with an analytic groundwork for early-hit/miss tests. Noting that the inner product structure is preserved by the CFT according to Parseval’s theorem (See Appendix C), the collision predicate in (28) for a single relative configuration 
                           
                              (
                              R
                              ,
                              
                                 t
                              
                              )
                           
                           ∈
                           S
                           E
                           
                              (
                              3
                              )
                           
                         can be obtained as 
                           
                              (50)
                              
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             R
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ∘
                                       
                                          
                                             T
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    〉
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ς
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 ,
                              
                           
                         noting that 
                           
                              
                                 f
                              
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 S
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 R
                                 S
                              
                           
                           ∘
                           
                              
                                 T
                              
                              
                                 −
                                 1
                              
                           
                           =
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    S
                                 
                              
                              ∘
                              
                                 
                                    R
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                           ∘
                           
                              
                                 T
                              
                              
                                 −
                                 1
                              
                           
                         which transforms to 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 S
                              
                           
                           =
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 R
                                 S
                              
                           
                           =
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              ∘
                              
                                 
                                    R
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                        . As mentioned earlier, 
                           
                              
                                 T
                              
                              
                                 −
                                 1
                              
                           
                           
                              x
                           
                           ≔
                           
                              x
                           
                           −
                           
                              t
                           
                         is the shift function whose Fourier operator 
                           
                              
                                 
                                    
                                       ς
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 ω
                              
                              )
                           
                           =
                           
                              
                                 e
                              
                              
                                 −
                                 2
                                 π
                                 
                                    i
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    ⋅
                                    
                                       t
                                    
                                    )
                                 
                              
                           
                         is the CFT of the shifted Dirac Delta 
                           
                              
                                 ς
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    3
                                 
                              
                              ∘
                              
                                 
                                    T
                                 
                                 
                                    −
                                    1
                                 
                              
                              )
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              
                                 δ
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 x
                              
                              −
                              
                                 t
                              
                              )
                           
                        .

If a grid-based discretization is used, the rotation can be incorporated by a trilinear interpolation in either domain. Although a brute-force computation of the physical domain inner product over a grid of size 
                           m
                         takes 
                           O
                           
                              (
                              m
                              )
                           
                        –without a simple way of reducing the complexity once the grid resolution is fixed upfront–the frequency domain integral can be computed in 
                           O
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         over a truncated grid of much smaller size 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ≪
                           m
                         specified on-the-fly. This provides a mechanism for trading off accuracy with time, by a spiral traversal of the frequency grid starting from the dominant modes until the available time is over. On the other hand, the numerous combinatorial CD methods developed over the years (reviewed in  [21]) exploit a variety of data structures to avoid brute-force testing in the physical domain, the likes of which are not available in the frequency domain. The sphere-tree methods  [13–16] are among the most efficient, which enable another trade-off mechanism by descending down the tree until the time allocated to CD is consumed. Our framework enables exploiting the existing combinatorial techniques alongside the recent analytic methods in both domains. The details pertaining to the following are beyond the scope of this article and will be presented elsewhere: (1) early-hit test by limiting the integration of (50) to an intersection with a ball, which is a simple multiplication in the physical domain via (3); (2) early-miss test by offsetting (i.e., Minkowski sum) with a single ball, which is a simple multiplication in the frequency domain; and (3) differentiation of (50) for contact force/torque computation, using pairwise spherical primitive interactions.

Surface shape complementarity (SC) is a predominant determinant of successful binding of protein molecules, and is critical in early-stage lead compound generation for rational drug design. The numerous FFT-based correlation techniques developed over the years (reviewed in  [23]) use the same principles as analytic CD or path planning, except that they quantify SC by overlapping skin-layers. The so-called ‘double-skin layer’ approach  [7] integrates the skin–skin intersections to obtain a SC ‘score function’ and subtracts core–core collisions as penalty, which add up to a convolution of ‘affinity functions’ of individual molecules (analogous to defining functions for CD, except with different complex-valued weights for skin/core atoms). Chen and Weng  [18] described successful heuristics for weight assignment rasterized on a uniform grid along with the use of FFT. Bajaj et al.  [7] proposed a faster grid-free method along with the use of NFFT, which has been highly influential in the development of our ideas.

For SC analysis of arbitrary shapes with important applications in assembly automation, packaging and nesting, and path planning in narrow environments, in addition to protein docking, we propose a reformulation of the double-skin layer approach by defining the complex affinity function 
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           →
                           C
                         for an arbitrary r-set 
                           S
                           ∈
                           S
                         as 
                           
                              (51)
                              
                                 
                                    
                                       F
                                    
                                    
                                       S
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    i
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          S
                                          ⊕
                                          
                                             
                                                B
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    −
                                    λ
                                    
                                       
                                          f
                                       
                                       
                                          S
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 S
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 ∞
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are bump functions of the shape and its offset by the ball 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           B
                           
                              (
                              
                                 0
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . The offset 
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                           >
                           0
                         is decided depending on the feature size (e.g., set to the size of a water molecule (1.4 Å) for protein docking  [7], or to MA-based local/weak feature size  [28] for other applications), and 
                           λ
                           >
                           0
                         defines the ‘penalty factor’. For two shapes 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ∈
                           S
                        , the cross-correlation of their affinity functions gives the SC score as 
                           
                              (52)
                              
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ⋆
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ∗
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          −
                                          R
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 .
                              
                           
                         Substituting for 
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                         and noting that 
                           
                              
                                 f
                              
                              
                                 S
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 S
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        : 
                           
                              (53)
                              
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 −
                                 2
                                 λ
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       R
                                    
                                 
                                 ∗
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             O
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where the terms 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 R
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ⋆
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 −
                                 R
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       O
                                    
                                 
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ∗
                           
                              
                                 f
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         were studied earlier. If 
                           λ
                           >
                           1
                         is large enough, the first term on the right-hand side of (53) takes interior–interior collisions into account with a penalty of 
                           ∝
                           −
                           O
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , the second term includes offset–interior overlaps with a reward of 
                           ∝
                           +
                           O
                           
                              (
                              λ
                              )
                           
                        , while the third term adds a smaller penalty of 
                           ∝
                           −
                           O
                           
                              (
                              1
                              )
                           
                         for offset–offset overlaps. An important observation is that for spherical sampling, the offsets correspond to an increase of radii in the primitive balls, which in turn corresponds to a 3D slice of elevated cones in 4D (i.e., translation of the knots 
                           A
                           ∈
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                         along the 
                           r
                        -axis). The different terms in (53) thus become 3D slices of 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                         corresponding to 
                           r
                           =
                           0
                           ,
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                        , and 
                           2
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                        , all of which can be cumulatively obtained from a single 4D NDFT. The time-critical query in (50) for CD can also be extended to SC formulation, useful in real-time energy computations for interactive assembly or protein docking. More elaboration on these and other possibilities are left to a follow-up publication, including a study of offset sensitivity defined as differentiation of 
                           
                              
                                 g
                              
                              
                                 
                                    
                                       K
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ̆
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 R
                              
                           
                         with respect to 
                           r
                         and its implications for SC analysis—think of the infinitesimal overlaps in (53) when 
                           λ
                           =
                           1
                         and 
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                           →
                           
                              
                                 0
                              
                              
                                 +
                              
                           
                        .

Roerdink  [1] generalized the concept of Minkowski sums/differences to Minkowski products/quotients over general groups, whose noncommutative convolutional formulation was presented by Lysenko et al.  [2]. Nelaturi and Shapiro  [4] applied the concept to 
                           S
                           E
                           
                              (
                              3
                              )
                           
                         (in this context referred to as ‘configuration products/quotients’) and showed its applicability to direct and inverse 
                           C
                        -space problems ranging from computing general sweeps to solving for maximal shapes and motions subject to containment constraints. The method embeds the solids in 
                           S
                           E
                           
                              (
                              3
                              )
                           
                        , and uses a uniform sampling over translations and rotations followed by pairwise matrix multiplications across the two samples to compute the 
                           C
                        -products and quotients. Our discretization scheme can readily be applied to more efficiently sample the translation space for different rotational sections through the 6D domain, as will be demonstrated in Section  5.1.

An interesting extension of the method would be to formulate 6D spherical sampling of the subsets of the Riemannian manifold 
                           S
                           E
                           
                              (
                              3
                              )
                           
                         based on geodesic distances (see Appendix B for more details). One possible application is in machine tool path planning in the presence of tolerances  [35], where the embedded workpiece complements the configuration product of the motion trajectory and tool profile. The tolerances can be introduced into either set by Minkowski operations between the ‘nominal’ geometry and primitive tolerance sets, e.g., Euclidean (for translational tolerances) and geodesic (for rotational tolerances) disks, cylinders, balls, or tori, all of which can be more efficiently discretized via spherical primitives than uniform samples. In a similar fashion to the constructions in Section  3.1, the tool’s swept volume is then given by a 3D projection of the 6D Minkowski product of the embedded tool profile and its motion, each of which are described by a Minkowski product of sample points on their nominal sets with the primitive tolerance sets. Rearranging the terms (similar to (32) through (34)) abstracts the tolerances away into a 6D configuration space tolerance set, and allows working with lower-dimensional nominal sets only. Unfortunately, the corresponding Fourier analysis in this case becomes quite tedious, whose potential benefits are unclear at this stage. See the example in  [35] for an elaborate discussion.

A more important research question remains regarding the extension of spherical sampling to dual operations, i.e., Minkowski differences or quotients, which would open up the opportunity to extend the benefits of this approach to inverse problems in configuration modeling.

In this section we demonstrate how spherical sampling outperforms uniform sampling for Minkowski computations that are central to the range of applications discussed in Section  4, and validate the additional performance improvement by using FFT algorithms. We implemented the method as a C++ API that reads triangular meshes, generates spherical decompositions (using Algorithm 1 in Appendix A), converts the geometry to an analytic representation in the physical and/or frequency domains, and computes the correlations in either domain. We report on both CPU- and GPU-parallel computing, implemented using C++ Boost  [36] and CUDA-C libraries, respectively. Our numerical experiments were conducted on a desktop computer with Intel Xeon E5-2687W CPU (32 cores, 3.10 GHz clock-rate, 64 GB host memory) and NVIDIA Tesla K20c GPU (2496 CUDA cores, 5 GB device memory).


                        Fig. 5
                         illustrates the 
                           C
                        -obstacle construction discussed in Section  3.1 for a pair of objects discretized via nonequiradius spherical sampling developed in Section  2.2. We repeat Algorithm 1 with different grid sizes 
                           m
                        , and compare the arithmetic complexity of the result with that of the uniform sampling of the same grid dimensions used in  [4]. As described in Appendix A, this guarantees that the Hausdorff metric-based approximation error of the spherical discretization is upperbounded by that of the uniform sample, which is 
                           ϵ
                           =
                           
                              
                                 3
                              
                           
                           
                              (
                              L
                              /
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              )
                           
                        . Therefore, the ‘initial grid size’ 
                           m
                         will be used as a measure of resolution for both methods for the purpose of comparison.

As reported in Table 1
                        , our method offers a clear advantage, decreasing the complexity by several orders of magnitude. Fig. 6
                        (a), (b) plots the memory requirement and running times, respectively, for Minkowski sum computation (viewed as a translational cross-section of the configuration product, as described in Section  4.3) by pairwise summations in the nonuniform 4D sample space, compared to pairwise summations in the uniform 3D sample space used in  [4]. The speed-ups of our method scale significantly with resolution, and reaches the range 
                           400
                           –
                           600
                           ×
                         (on both CPU and GPU)
                           12
                        
                        
                           12
                           In each individual scenario, the GPU runs are only slightly faster than CPU runs (
                                 1
                                 –
                                 3
                                 ×
                              ) due to extensive global memory references, but can be improved in future versions by memory optimization.
                         for a grid size of 
                           m
                           ≔
                           
                              
                                 2
                              
                              
                                 18
                              
                           
                           =
                           262144
                        , decreasing the CPU/GPU running times from 
                           28
                           /
                           48
                           
                           
                              s
                           
                         to 
                           104
                           /
                           47
                           
                           
                              ms
                           
                        . For larger initial grid sizes such as 
                           m
                           ≔
                           
                              
                                 2
                              
                              
                                 21
                              
                           
                           =
                           2097152
                        , the memory cannot accommodate the Minkowski sum of uniform samples, while our method succeeds and carries out the sum in less than a second.

We next consider the computational performance of the analytic method, using both uniform and nonuniform sampling. Given the spherical decomposition of the two solids, their bump functions as a sum of radial kernels can be rasterized on uniform grids in the physical domain. The gap function representation of the Minkowski sum can then be computed by two forward FFTs, a pointwise multiplication over the frequency grids, and an inverse FFT to retrieve the result, whose running times are separately plotted in Fig. 7
                        (g). The GPU implementation in this case offers significant speed-ups of 
                           400
                           –
                           800
                           ×
                         over its CPU counterpart.
                           13
                        
                        
                           13
                           The FFT is implemented using FFTW  [37] on the CPU and using cuFFT(W) on the GPU. With the exception of FFTW, all other CPU and GPU routines were written in parallel.
                         Comparing the results with Fig. 6(b) shows an improvement of 
                           30
                           –
                           80
                           ×
                         over the pairwise computations in the physical domain. For a grid size of 
                           m
                           ≔
                           
                              
                                 2
                              
                              
                                 21
                              
                           
                           =
                           2097152
                        , accurate computation of the convolution takes less than 80 ms on the GPU.

It appears that the pointwise multiplication step is the bottleneck in the FFT-based convolutions. However, by performing this step (and the following inverse FFT) over a small subset of size 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ≪
                           m
                         of the frequency grid in the neighborhood of the dominant modes, one could decide on the amount of computation time to spend in a trade-off with accuracy depicted in Fig. 7(a)–(f). It is clear that small gap function errors do not necessarily imply small geometric discrepancies of the 0-sublevel set in terms of Hausdorff metric. However, it was shown by Lysenko  [22] that it is also possible to impose upperbounds on the Hausdorff distance-based error as a function of the number of retained frequencies.

As depicted in Sections  2.5 and 3.2, the uniform 3D grid-based FFT can be replaced with a nonuniform 4D grid-free NFFT. As the difference between the number of sample points in each method grows according to Table 1, even a cascade 4D NDFT over the spherical discretization can be faster, with the additional flexibility it offers in choosing the frequency domain grid size on-the-fly independently of the physical domain sample size. The NDFT does not require the additional step of bump function rasterization over the uniform grid, which is basically a cascade computation of the convolution of the knots and the conical kernel in (13). It rather incorporates that step as a pointwise multiplication with the kernel’s frequency domain representation in (24) which can be precomputed to full precision. The comparison is shown in Fig. 8
                         for different number of modes 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                         over the 4D frequency grid, which demonstrates an advantage to NDFT for 
                           m
                           >
                           
                              
                                 2
                              
                              
                                 15
                              
                           
                           =
                           32768
                         and 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 2
                              
                              
                                 16
                              
                           
                           =
                           65536
                         on the CPU, and for 
                           m
                           >
                           
                              
                                 2
                              
                              
                                 18
                              
                           
                           =
                           262144
                         and 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 2
                              
                              
                                 12
                              
                           
                           =
                           4096
                         on the GPU. This can be further improved using the optimal NFFT  [10]. Unfortunately, NFFTs have been implemented on the GPU  [24] for 1, 2, and 3D, while at present the 4D NFFT is available only on the CPU  [38].

Lastly, we test the performance for time-critical computation of the correlation predicate for a single configuration, using the method presented in Section  4.1 based on  [22] via truncated frequency grid integration in (50). Fig. 9
                         shows sequential integration time on the CPU for different choices of the number of retained modes 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ≤
                           m
                        . An almost linear speed-up of 
                           m
                           /
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                         (as expected from the theory) is achieved, and the collision predicate is computed in less than a millisecond for 
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 2
                              
                              
                                 12
                              
                           
                           =
                           4096
                        . This enables fast physically-based modeling and multibody dynamics simulations in real-time applications that require a refresh rate of 1 kHz for graphics and haptics feedback  [16]. An important research question concerns the development of a hybrid method that further improves the performance by using this method alongside a sphere-tree traversal used in  [13–16], and limits the integration over the NDFT of fewer primitives at the tree leaves.

@&#CONCLUSION@&#

Analytic methods for geometric modeling have shown great promise in formulating and solving important problems in terms of convolutions, typically implemented by uniform grid-based sampling to enable the use of the efficient FFT. We proposed a versatile analytic paradigm built around a nonuniform discretization scheme that approximates the shape with a union of 3D balls, equivalent to a nonuniform sample of 4D knots in an elevated space. We showed that this can be conceptualized as a 4D Minkowski sum, analytically represented by a convolution of the knots with a conical kernel. As a result of the spherical symmetry, the discretization structure is closed under rigid motions and Minkowski sums, hence the ball/cone geometry and its defining kernel abstract the continuous geometry away in a consistent manner across configuration space correlations, allowing the numerical algorithms to operate on the discrete set alone.

Among the important applications we referred to collision detection, shape complementarity, and morphological operations, which are central to important problems in motion/path planning, physically-based modeling, manufacturing automation, protein docking, and more. We showed that the spherical discretization allows for an efficient allocation of time and memory resources to capturing the details of geometric features, by rapidly filling the large interior regions of both shape and configuration pointsets. The CPU and GPU implementations were presented, demonstrating speed-ups up to several orders of magnitude.

This research opens up promising theoretical and computational directions for future studies on analytic methods that are emerging in solid and physical modeling.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Saigopal Nelaturi from Palo Alto Research Center for the helpful discussions and constructive feedback. This work was supported in part by the National Science Foundation grants CMMI-1200089, CMMI-0927105, and CNS-0927105. The responsibility for any errors and omissions lies solely with the authors.

Although the main focus of this article is on how to work with given spherical decompositions in the analytic realm regardless of the method used for their generation  [13–16], a ‘good’ spherical sampling algorithm is essential to gain practical advantage over uniform sampling. Here we present the details of our new algorithm used to generate the decomposition in Table 1 and Figs. 5 and 6 of Section  5, along with its topological properties and geometric error bounds (Propositions 1–3). We compare our algorithm, in terms of these qualitative properties as well as arithmetic complexity, to the sphere-packing algorithm by Weller and Zachmann  [16] (hereon abbreviated as W&Z), which is considered state-of-the-art for collision detection and proximity queries, and is successfully applied to real-time physically-based modeling and virtual reality (graphics/haptics)  [16].

The following lemma from  [22] will be central to put the approximation error bounds into perspective: 
                        Lemma 3
                        
                           Given arbitrary sets 
                           
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            
                           and 
                           
                              ϵ
                              ≥
                              0
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⊆
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊕
                                                B
                                                
                                                   (
                                                   
                                                      0
                                                   
                                                   ,
                                                   ϵ
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊆
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⊕
                                                B
                                                
                                                   (
                                                   
                                                      0
                                                   
                                                   ,
                                                   ϵ
                                                   )
                                                
                                             
                                          
                                       
                                       }
                                    
                                    ⇌
                                    
                                       
                                          d
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            
                           is the symmetrical (i.e., the maximum of left and right) Hausdorff 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                           -metric.
                           
                              14
                           
                           
                              14
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          
                                             sup
                                          
                                          
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       d
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             sup
                                          
                                          
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       d
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       }
                                    
                                 .
                           
                        

To approximate an arbitrary r-set 
                        S
                        ∈
                        S
                      with a finite union of 
                        n
                      (possibly overlapping) nonequiradius spherical balls 
                        
                           
                              S
                           
                           
                              n
                           
                        
                        
                           (
                           A
                           )
                        
                        =
                        
                           
                              ⋃
                           
                           
                              1
                              ≤
                              i
                              ≤
                              n
                           
                        
                        B
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           )
                        
                     , where the balls are encoded by 
                        A
                        =
                        
                           
                              
                                 {
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 }
                              
                           
                           
                              1
                              ≤
                              i
                              ≤
                              n
                           
                        
                        ⊂
                        
                           
                              R
                           
                           
                              4
                           
                        
                     , we use a greedy algorithm similar to W&Z   [16]. One of the main differences is that W&Z uses the distance field as the greedy criterion, while our algorithm employs the SDF  [34] to create superior decompositions similar to the outcomes of MA-based methods  [14,15] without the need to explicitly compute the numerically unstable MA/MAT. The SDF is a real-valued function that can be thought of as a ‘dissipated’ continuous extension of the indicator function of the MA (Fig. A.10
                     
                     (b)), whose ridges constitute the interior regions with extensive approximate nearest neighbors on the boundary 
                        ∂
                        S
                     , and is computed directly from the distance field  [34].


                     
                        
                           
                        
                     
                  


                     Step 0: Precomputations. First, the algorithm precomputes the distance function and SDF over a uniform grid of 
                        m
                      nodes sampled to cover the r-set’s bounding volume. Without loss of generality, we assume a bounding box of edge length 
                        2
                        L
                        >
                        0
                      and a grid resolution of 
                        2
                        L
                        /
                        
                           
                              m
                           
                           
                              
                                 
                                    1
                                 
                                 
                                    3
                                 
                              
                           
                        
                     . Let 
                        G
                        =
                        
                           (
                           2
                           L
                           /
                           
                              
                                 m
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                        
                           
                              Z
                           
                           
                              3
                           
                        
                        ∩
                        
                           
                              
                                 [
                                 −
                                 L
                                 ,
                                 +
                                 L
                                 )
                              
                           
                           
                              3
                           
                        
                      with 
                        
                           |
                           G
                           |
                        
                        =
                        m
                      be the collection of grid nodes, and 
                        X
                        =
                        G
                        ∩
                        S
                      be the subset of the nodes that encodes a bitmap approximation of the r-set. The sample 
                        X
                      is said to be an 
                        ϵ
                     
                     -covering of 
                        S
                      where 
                        ϵ
                        =
                        
                           
                              3
                           
                        
                        
                           (
                           L
                           /
                           
                              
                                 m
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                      is the diagonal half-length of a grid cell, since for every point 
                        
                           
                              
                                 x
                              
                           
                           
                              ′
                           
                        
                        ∈
                        S
                      there exists a node 
                        
                           x
                        
                        ∈
                        X
                      such that 
                        
                           
                              
                                 ‖
                                 
                                    x
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                        ≤
                        ϵ
                        [4], which implies 
                        Lemma 4
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 S
                                 )
                              
                              ≤
                              ϵ
                           
                           , where 
                           
                              X
                              =
                              G
                              ∩
                              S
                           
                           .
                        


                     
                        Proof
                        By definition 
                              X
                              ⊂
                              S
                              ⊂
                              S
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . Additionally, 
                              
                                 
                                    
                                       ‖
                                       
                                          x
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              ≤
                              ϵ
                            for all 
                              
                                 x
                              
                              ∈
                              X
                            and 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              S
                           , hence 
                              S
                              ⊂
                              X
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . Applying Lemma 3 yields the result. The equality holds (i.e., 
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 S
                                 )
                              
                              =
                              ϵ
                           ) unless none of the grid cell centers in between the nodes belongs to 
                              S
                           .□

We will show that the same error bound holds for the spherical decomposition, which forms a basis of comparison in Section  5 between the uniform sample and spherical sample, in terms of their deviation from the original solid measured by 
                        ϵ
                      (or equivalently, 
                        m
                     ).


                     Step 1: Decomposition. The algorithm sorts 
                        X
                      with respect to the SDF values and arranges the nodes into a priority queue, followed by 
                        n
                      rounds of selection. At each round, the grid node 
                        
                           x
                        
                        ∈
                        X
                      with maximal SDF is selected, and a ball 
                        B
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                      is generated, i.e., the 4-tuple 
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                      is added to the (initially empty) output set 
                        
                           
                              A
                           
                           
                              1
                           
                        
                     , where 
                        r
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        d
                        
                           (
                           
                              x
                           
                           ,
                           ∂
                           S
                           )
                        
                        =
                        
                           
                              min
                           
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              ∂
                              S
                           
                        
                        
                           
                              
                                 ‖
                                 
                                    x
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                      is the distance function. A subset of the grid points inside this new ball are identified with the following condition, and eliminated from the SDF-sorted queue for the next rounds: 
                        
                           (A.1)
                           
                              Q
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 μ
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 X
                                 ∣
                                 
                                    
                                       
                                          ‖
                                          
                                             x
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    |
                                    r
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    −
                                    r
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 ≤
                                 μ
                                 r
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 }
                              
                              .
                           
                        
                      The left-hand side of the inequality gives a measure of how 
                        B
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           r
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           )
                        
                      protrudes outside 
                        B
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                     , which is normalized by the smaller radius 
                        r
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           )
                        
                      and compared to the ‘protrusion factor’ 
                        0
                        ≤
                        μ
                        ≤
                        1
                     . On the one end, 
                        Q
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                      includes only the grid nodes 
                        
                           
                              
                                 x
                              
                           
                           
                              ′
                           
                        
                        ∈
                        X
                        ∩
                        B
                        
                           (
                           
                              x
                           
                           ,
                           
                              x
                           
                           
                              (
                              r
                              )
                           
                           )
                        
                      with 
                        B
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           r
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           )
                        
                        ⊂
                        B
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                     , i.e., nodes that would contribute redundant balls already covered. On the other end, 
                        Q
                        
                           (
                           
                              x
                           
                           ;
                           1
                           )
                        
                      includes the entire 
                        X
                        ∩
                        B
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                      and eliminates all covered points from the future rounds. The former gives a more conservative coverage and creates better approximations to the original shape in terms of topology (e.g., fewer void spaces) and geometry (e.g., similar surface curvature) in practice. However, it generates a larger number of balls than the latter–especially over the thinner features of the shape–thus takes longer to finish. More importantly, a too small choice (e.g., 
                        μ
                        <
                        0.1
                     ) might defeat the advantage of spherical sampling with 
                        
                           |
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           |
                        
                        =
                        
                           
                              n
                           
                           
                              1
                           
                        
                      over uniform sampling with 
                        
                           |
                           X
                           |
                        
                        =
                        O
                        
                           (
                           m
                           )
                        
                      reliant on the assumption 
                        
                           
                              n
                           
                           
                              1
                           
                        
                        ≪
                        m
                     . Our experiments suggest a choice of 
                        μ
                        =
                        0.25
                        –
                        0.30
                      to be a good trade-off (see Table A.2).

At each round of the algorithm, all 
                        
                           
                              
                                 x
                              
                           
                           
                              ′
                           
                        
                        ∈
                        B
                        
                           (
                           
                              x
                           
                           ,
                           r
                           
                              (
                              
                                 x
                              
                              )
                           
                           )
                        
                      are marked by Boolean flags that indicate their containment in at least one ball. The algorithm repeats this process until all points in the uniform sample 
                        X
                      are covered by the balls, i.e., until 
                        Y
                        =
                        X
                      where 
                        Y
                        =
                        G
                        ∩
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                      is the set of grid nodes covered so far. 
                        Proposition 1
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                                 S
                                 )
                              
                              ≤
                              ϵ
                           
                           .
                        


                     
                        Proof
                        At the end of step 1, 
                              X
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            hence for every point 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              S
                              ,
                              
                              d
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 )
                              
                              ≤
                              d
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 X
                                 )
                              
                           , and since 
                              d
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 X
                                 )
                              
                              ≤
                              ϵ
                              ,
                              
                              S
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . On the other hand, choosing the minimum distance to the boundary as ball radii guarantees 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              S
                              ⊂
                              S
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . Applying Lemma 3 yields the result.□

It is worthwhile noting that the above proof only makes use of 
                        G
                        ⊂
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                        ⊂
                        S
                     , hence Proposition 1 is valid for the W&Z algorithm  [16] as well, providing a basis of comparison between the two (see Table A.2).

An inevitable difficulty with this approach, regardless of the greedy criterion (e.g., distance-based  [16] or SDF-based) are topological discrepancies between the solid and its spherical approximation due to the possible void spaces (of feature sizes no larger than 
                        2
                        ϵ
                     ) left in between covered grid nodes. Although letting 
                        m
                        ≫
                        1
                      and 
                        μ
                        ≪
                        1
                      can alleviate the problem, it does not necessarily eliminate it especially near the boundary. In addition to the trapped internal cavities, the algorithm generates numerous small disconnected balls near the boundary where 
                        r
                        
                           (
                           
                              x
                           
                           )
                        
                        <
                        ϵ
                      as it approaches the final rounds. The next two steps are meant to solve these problems.


                     Step 2: Expansion. The previous step generates a decomposition that is strictly contained in the original solid, which is unnecessary for our purposes. In the next step, the algorithm expands all the balls by increasing their radii with 
                        ϵ
                        =
                        
                           
                              3
                           
                        
                        
                           (
                           L
                           /
                           
                              
                                 m
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                     , which gives 
                        
                           (A.2)
                           
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ϵ
                                    )
                                 
                                 ∣
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 }
                              
                              ,
                           
                        
                      i.e., 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                        =
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                        ⊕
                        B
                        
                           (
                           
                              0
                           
                           ,
                           ϵ
                           )
                        
                     . It is easy to show that 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      is in fact as good of an approximation as 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                      in terms of Hausdorff error measure. 
                        Proposition 2
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                                 S
                                 )
                              
                              ≤
                              ϵ
                           
                           .
                        


                     
                        Proof
                        On the one hand, 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              S
                              ⊂
                              S
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . On the other hand, 
                              S
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . Applying Lemma 3 yields the result.□

Moreover, the 
                        ϵ
                     -expansion ‘repairs’ the inter-cellular cavities and disconnected balls, noting that the distance between every pair of balls corresponding to 
                        
                           
                              A
                           
                           
                              1
                           
                        
                      is upperbounded by 
                        2
                        ϵ
                     . Therefore, although the algorithm cannot guarantee topological equivalence (i.e., homeomorphism) between 
                        S
                      and any decomposition, simply because it only relies on the incomplete shape representation provided by the discrete set 
                        X
                     –which fails to capture topological information of the features that are smaller than the sampling resolution–
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      does guarantee a weaker equivalence, i.e., homeomorphism with a voxelization implied by the uniform sample 
                        X
                     , while 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                      does not.


                     Step 3: Reduction. Although 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      exhibits relatively more desirable topological properties than 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                     , they both have the same complexity 
                        
                           
                              n
                           
                           
                              1
                           
                        
                        =
                        
                           
                              n
                           
                           
                              2
                           
                        
                     . The former satisfies ‘conservative coverage’ (
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                        ⊃
                        S
                     ) while the latter fulfills ‘strict containment’ (
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                        ⊂
                        S
                     ). The main purpose of the expansion, however, was to eliminate the small balls at the grid nodes near the surface with 
                        r
                        
                           (
                           
                              x
                           
                           )
                        
                        <
                        ϵ
                      that could not be covered by any other ball in 
                        
                           
                              A
                           
                           
                              1
                           
                        
                     . These artifacts can comprise a significant fraction of all balls, adding to the numerical complexity with little contribution to the volume, while they adversely affect the quality of discretization by introducing high local curvatures. The question is whether we can obtain a third discretization in between the two, i.e., a sample 
                        
                           
                              A
                           
                           
                              3
                           
                        
                      such that 
                        
                           (A.3)
                           
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      which retains the desired topological properties, eliminates the undesired small balls, guarantees the same error bounds, and is smaller in size (
                        
                           |
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           |
                        
                        =
                        
                           
                              n
                           
                           
                              3
                           
                        
                        <
                        
                           
                              n
                           
                           
                              1
                              ,
                              2
                           
                        
                     ).

The next step of the algorithm reduces 
                        
                           
                              A
                           
                           
                              2
                           
                        
                      into 
                        
                           
                              A
                           
                           
                              3
                           
                        
                      by eliminating the sample points whose corresponding original (i.e., not expanded) balls encoded by 
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           )
                        
                        ∈
                        
                           
                              A
                           
                           
                              1
                           
                        
                      were contained in some other expanded ball corresponding to 
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           +
                           ϵ
                           )
                        
                        ∈
                        
                           
                              A
                           
                           
                              2
                           
                        
                        ,
                        
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           )
                        
                        ≠
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           )
                        
                     : 
                        
                           (A.4)
                           
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ϵ
                                    )
                                 
                                 ∣
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 B
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ⊄
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       {
                                       
                                          
                                             
                                                a
                                             
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                    )
                                 
                                 }
                              
                              .
                           
                        
                      A significant number of small balls in 
                        
                           
                              A
                           
                           
                              1
                           
                        
                      near the surface are thus ‘engulfed’ by the expanded neighbor balls in 
                        
                           
                              A
                           
                           
                              2
                           
                        
                     –e.g., constituting %75–%85 of all balls for the Stanford Bunny in Fig. A.11
                      with 
                        μ
                        =
                        0.25
                        –
                        1.00
                     , which grows by decreasing 
                        μ
                     . Although the new decomposition neither contains nor is contained in the original solid, the approximation error bound still holds. 
                        Proposition 3
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    H
                                 
                              
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ,
                                 S
                                 )
                              
                              ≤
                              ϵ
                           
                           .
                        


                     
                        Proof
                        By definitions in (A.2) and (A.4), 
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                              ⊂
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                            hence 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ⊂
                              S
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . On the other hand, every ball encoded by 
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                            is contained in at least one ball corresponding to 
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                           . If this is realized only by 
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ≔
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , noting that always 
                              B
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              B
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                           , then its 
                              ϵ
                           -expansion is included in 
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                            by definition in (A.4). Otherwise, there exists at least another ball represented by 
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ≠
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            whose 
                              ϵ
                           -expansion is included in 
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                           , i.e., 
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                           , and 
                              B
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              B
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                           . In either case, 
                              B
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            is included in 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           , hence 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           . Therefore, 
                              S
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                            implies 
                              S
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ⊕
                              B
                              
                                 (
                                 
                                    0
                                 
                                 ,
                                 ϵ
                                 )
                              
                           . Applying Lemma 3 yields the result.□

All aforementioned steps are summarized in Algorithm 1. Fig. A.10 illustrates the different geometric objects involved in the algorithm, including the output decompositions of each step. Once the decomposition is generated, a variety of methods can be used to create sphere-tree hierarchies—e.g., the simple bottom-up merging algorithm in  [14] that groups and merges a pre-specified number of balls that are near each other in 
                        
                           
                              A
                           
                           
                              3
                           
                        
                      (i.e., the children) into their smallest enclosing ball (i.e., the parent).


                     Table A.2 compares the numerical complexity of each decomposition 
                        
                           |
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           |
                        
                        =
                        
                           |
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           |
                        
                     , and 
                        
                           |
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           |
                        
                      with that of W&Z   [16] for the Stanford Bunny in Fig. 5(a) using different grid resolutions and protrusion factors. We observe that unlike the case for 
                        
                           
                              n
                           
                           
                              1
                           
                        
                        =
                        
                           
                              n
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              n
                           
                           
                              3
                           
                        
                      decreases with more conservative choices of 
                        μ
                     , making the smaller value of 
                        μ
                        =
                        0.25
                      even more favorable. The same value was used to generate the results in Table 1 and Figs. 5 and 6 of Section  5. After this reduction, the output of our algorithm contains fewer balls than W&Z   [16] by an order of magnitude, allowing faster termination—in a few minutes for the slowest case. Fig. A.11 illustrates 
                        
                           
                              S
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    3
                                 
                              
                           
                        
                        
                           (
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           )
                        
                      corresponding to the parameters in Table A.2.

According to Requicha  [26], a ‘rigid body’ 
                        
                           [
                           S
                           ]
                        
                      is an equivalence class of congruent r-sets related by the elements in 
                        C
                        ≔
                        S
                        E
                        
                           (
                           3
                           )
                        
                     , i.e., 
                        
                           [
                           S
                           ]
                        
                        =
                        
                           {
                           M
                           S
                           ∣
                           M
                           ∈
                           S
                           E
                           
                              (
                              3
                              )
                           
                           }
                        
                        ⊂
                        S
                     . The special Euclidean group 
                        S
                        E
                        
                           (
                           3
                           )
                        
                        ≅
                        S
                        O
                        
                           (
                           3
                           )
                        
                        ⋉
                        
                           
                              R
                           
                           
                              3
                           
                        
                      represents the configuration space of all rigid motions (i.e., distance and orientation preserving affine maps). It extends the special orthogonal group 
                        S
                        O
                        
                           (
                           3
                           )
                        
                     , which contains all proper rotations (i.e., distance and orientation preserving linear maps) over its action on 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     : 
                        
                           (B.1)
                           
                              S
                              O
                              
                                 (
                                 3
                                 )
                              
                              =
                              
                                 {
                                 R
                                 ∈
                                 M
                                 
                                    (
                                    3
                                    )
                                 
                                 ∣
                                 R
                                 
                                    
                                       R
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 R
                                 =
                                 I
                                 ,
                                 
                                    det
                                 
                                 
                                    (
                                    R
                                    )
                                 
                                 =
                                 +
                                 1
                                 }
                              
                              ,
                           
                        
                      with matrix multiplication used as the group operation. 
                        M
                        
                           (
                           3
                           )
                        
                        ≅
                        
                           
                              R
                           
                           
                              9
                           
                        
                      is the space of all 3×3 matrices, and 
                        I
                        =
                        i
                        
                           
                              d
                           
                           
                              M
                              
                                 (
                                 3
                                 )
                              
                           
                        
                      is the identity matrix.

As a result of the semidirect product, every rigid motion can be parameterized by a tuple 
                        M
                        =
                        
                           (
                           R
                           ,
                           
                              t
                           
                           )
                        
                        ∈
                        S
                        E
                        
                           (
                           3
                           )
                        
                      with the following properties: 
                        
                           •
                           The group operation is defined as 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              .

The inversion is defined as 
                                 
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    ,
                                    −
                                    
                                       
                                          R
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       t
                                    
                                    )
                                 
                              .

The action on 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               is defined as 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    x
                                 
                                 =
                                 
                                    (
                                    R
                                    
                                       x
                                    
                                    )
                                 
                                 +
                                 
                                    t
                                 
                               for all 
                                 
                                    x
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               (i.e., a noncommutative sequence of a rotation 
                                 
                                    x
                                 
                                 ↦
                                 R
                                 
                                    x
                                 
                               followed by a translation 
                                 
                                    x
                                 
                                 ↦
                                 
                                    x
                                 
                                 +
                                 
                                    t
                                 
                              ), hence 
                                 
                                    
                                       
                                          (
                                          R
                                          ,
                                          
                                             t
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    x
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       t
                                    
                                    )
                                 
                              .

Noting that 
                                 S
                                 E
                                 
                                    (
                                    3
                                    )
                                 
                               is a subgroup of 
                                 S
                                 E
                                 
                                    (
                                    4
                                    )
                                 
                              , we can define the action of 
                                 S
                                 E
                                 
                                    (
                                    3
                                    )
                                 
                               on 4D geometry simply as 
                                 
                                    (
                                    R
                                    ,
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    r
                                    )
                                 
                                 ≔
                                 
                                    (
                                    
                                       (
                                       R
                                       ,
                                       
                                          t
                                       
                                       )
                                    
                                    
                                       x
                                    
                                    ,
                                    r
                                    )
                                 
                               for 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    r
                                    )
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                              .

Since 
                        S
                        E
                        
                           (
                           3
                           )
                        
                      is a Riemannian manifold, any pair of configurations can be joined along a curve that minimizes the geodesic distance, defined as the Riemannian metric 
                        
                           (B.2)
                           
                              d
                              
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ≔
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ‖
                                                ln
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where the logarithmic term can be viewed as the geodesic 
                        d
                        
                           (
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           )
                        
                      over the manifold 
                        S
                        O
                        
                           (
                           3
                           )
                        
                     , which is in a 1:2 homeomorphism with a unit 3-sphere embedded in 
                        
                           
                              R
                           
                           
                              4
                           
                        
                     , 
                        ln
                        
                           (
                           ⋅
                           )
                        
                      is the matrix logarithm, and 
                        
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                           
                           
                              2
                           
                        
                      is the Frobenius norm, which is the same as the Euclidean 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm of a 9-vector formed from the elements of a 3×3 matrix  [4]. Using (B.2), 
                        S
                        E
                        
                           (
                           3
                           )
                        
                      also forms a metric (hence a topological) space.

A function 
                        f
                        :
                        
                           
                              R
                           
                           
                              3
                           
                        
                        →
                        C
                      is square-integrable (i.e., 
                        f
                        ∈
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                     ) if 
                        v
                        
                           (
                           
                              
                                 
                                    |
                                    f
                                    |
                                 
                              
                              
                                 2
                              
                           
                           )
                        
                        =
                        v
                        
                           (
                           f
                           
                              
                                 f
                              
                              
                                 ̄
                              
                           
                           )
                        
                      defined by the integral in (4) converges, i.e., if its 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm 
                        
                           
                              
                                 ‖
                                 f
                                 ‖
                              
                           
                           
                              2
                           
                        
                        ≔
                        
                           
                              
                                 〈
                                 f
                                 ,
                                 f
                                 〉
                              
                           
                        
                      exists, where the function inner product 
                        
                           〈
                           ⋅
                           ,
                           ⋅
                           〉
                        
                        :
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                        ×
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                        →
                        C
                      is 
                        
                           (C.1)
                           
                              
                                 〈
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 〉
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                              d
                              
                                 x
                              
                           
                        
                      in which 
                        
                           
                              f
                           
                           
                              ̄
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        
                           
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                           
                           ¯
                        
                      denotes conjugation. Also related are the cross-correlation and convolution operators 
                        ⋆
                        ,
                        ∗
                        :
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                        ×
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                        →
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                     : 
                        
                           
                              (C.2)
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ⋆
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    +
                                    
                                       t
                                    
                                    )
                                 
                                 
                                 d
                                 
                                    x
                                 
                                 ,
                              
                           
                           
                              (C.3)
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ∗
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       t
                                    
                                    )
                                 
                                 
                                 d
                                 
                                    x
                                 
                                 ,
                              
                           
                        
                      in which 
                        
                           
                              f
                           
                           
                              ̃
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        f
                        
                           (
                           −
                           
                              x
                           
                           )
                        
                      denotes reflection. It can be verified by a simple change of variables that 
                        
                           〈
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           ,
                           
                              (
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∘
                              
                                 
                                    T
                                 
                                 
                                    −
                                    1
                                 
                              
                              )
                           
                           〉
                        
                        =
                        
                           (
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 2
                              
                           
                           ⋆
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           )
                        
                        
                           (
                           
                              t
                           
                           )
                        
                        =
                        
                           (
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           ∗
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 2
                              
                           
                           )
                        
                        
                           (
                           
                              t
                           
                           )
                        
                      where 
                        
                           
                              T
                           
                           
                              −
                              1
                           
                        
                        
                           x
                        
                        =
                        
                           x
                        
                        −
                        
                           t
                        
                      is a shift.

The continuous Fourier transform (CFT) often denoted by 
                        F
                        :
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                        →
                        
                           
                              L
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                        
                      is defined as 
                        
                           (C.4)
                           
                              F
                              
                                 {
                                 f
                                 }
                              
                              
                                 (
                                 
                                    ω
                                 
                                 )
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    2
                                    π
                                    
                                       i
                                    
                                    
                                       (
                                       
                                          ω
                                       
                                       ⋅
                                       
                                          x
                                       
                                       )
                                    
                                 
                              
                              
                              d
                              
                                 x
                              
                              ,
                           
                        
                      which can be conceptualized as a decomposition of the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     - function along orthogonal basis 
                        
                           
                              e
                           
                           
                              2
                              π
                              
                                 i
                              
                              
                                 (
                                 
                                    ω
                                 
                                 ⋅
                                 
                                    x
                                 
                                 )
                              
                           
                        
                      (see (21)). Using the notations 
                        
                           
                              f
                           
                           
                              ˆ
                           
                        
                        =
                        F
                        
                           {
                           f
                           }
                        
                      and 
                        f
                        =
                        
                           
                              F
                           
                           
                              −
                              1
                           
                        
                        
                           {
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           }
                        
                     , the following properties are easily verified: 
                        
                           •
                           Translation in the physical domain converts to a multiplier in the frequency domain, i.e., 
                                 
                                    (C.5)
                                    
                                       F
                                       
                                          {
                                          
                                             (
                                             f
                                             ∘
                                             
                                                
                                                   T
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          }
                                       
                                       =
                                       F
                                       
                                          {
                                          
                                             
                                                ς
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          }
                                       
                                       F
                                       
                                          {
                                          f
                                          }
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ς
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       ς
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          3
                                       
                                    
                                    ∘
                                    
                                       
                                          T
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       t
                                    
                                    )
                                 
                               whose CFT is the sinusoidal basis function 
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 
                                    (
                                    
                                       ω
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       2
                                       π
                                       
                                          i
                                       
                                       
                                          (
                                          
                                             ω
                                          
                                          ⋅
                                          
                                             t
                                          
                                          )
                                       
                                    
                                 
                              .

As a result of the linearity of (C.4), linear maps (e.g., reflections and rotations) are preserved under the CFT, e.g., 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                               and 
                                 
                                    (C.6)
                                    
                                       F
                                       
                                          {
                                          
                                             (
                                             f
                                             ∘
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             )
                                          
                                          }
                                       
                                       =
                                       F
                                       
                                          {
                                          f
                                          }
                                       
                                       ∘
                                       
                                          
                                             R
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                       ∘
                                       
                                          
                                             R
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           

If 
                                 f
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̄
                                    
                                 
                               (i.e., 
                                 f
                               is real-valued), one obtains 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              , i.e., the CFT converts reflection to conjugation. Substituting from the previous property results in 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              , a property known as the Hermitian symmetry.

The inner product structure is preserved under the CFT, i.e., 
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    〉
                                 
                              , an important result known as Parseval’s theorem.

The convolution in physical domain converts to pointwise multiplication in the Fourier domain, i.e., 
                                 
                                    (C.7)
                                    
                                       F
                                       
                                          {
                                          
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                             
                                             ∗
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          }
                                       
                                       =
                                       F
                                       
                                          {
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                       F
                                       
                                          {
                                          
                                             
                                                f
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                               a crucial result known as the convolution theorem.

By discretizing the function’s domain into a finite set of knots, the integral in (C.4) can be approximated by a Riemann sum, which can be expressed in terms of the discrete Fourier transform (DFT): 
                        
                           (C.8)
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    2
                                    π
                                    
                                       i
                                    
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                              
                              
                                 (
                                 1
                                 ≤
                                 j
                                 ≤
                                 n
                                 )
                              
                              .
                           
                        
                      If both physical and frequency sample points are equispaced, (C.8) can be computed for all sample points in 
                        O
                        
                           (
                           n
                           log
                           n
                           )
                        
                      time (in contrast to 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           )
                        
                      time for cascade computation) using the radix-2 fast Fourier transform (FFT)  [9]. If either (or both) of the samples are nonequispaced, the so-call nonequispaced FFT (NFFT)  [10] can be used, which takes 
                        O
                        
                           (
                           
                              (
                              α
                              n
                              )
                           
                           log
                           
                              (
                              α
                              n
                              )
                           
                           )
                        
                      time with an ‘over-sampling factor’ of 
                        α
                        =
                        O
                        
                           (
                           1
                           )
                        
                     . The latter is advantageous over the former if the nonuniform sampling is sparse.

On a final note, the extension of the aforementioned 3D definitions to 4D is trivial. The reader is referred to  [39] for an in-depth study of harmonic analysis.

@&#REFERENCES@&#

