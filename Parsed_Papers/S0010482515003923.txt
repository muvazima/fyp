@&#MAIN-TITLE@&#A denoising algorithm for projection measurements in cone-beam computed tomography

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We develop a new denoising algorithm for CT projections.


                        
                        
                           
                           The proposed algorithms includes regularizations in terms of gradient and Hessian.


                        
                        
                           
                           We suggest solving the problem using a split Bregman iteration.


                        
                        
                           
                           We apply the proposed algorithm on simulated and real noisy CT projections.


                        
                        
                           
                           Our algorithm effectively suppresses noise and improves spatial resolution.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Low-dose computed tomography

Sinogram denoising

Sparsity-based denoising

Cone-beam

Bregman method

Total variation denoising

@&#ABSTRACT@&#


               
               
                  The ability to reduce the radiation dose in computed tomography (CT) is limited by the excessive quantum noise present in the projection measurements. Sinogram denoising is, therefore, an essential step towards reconstructing high-quality images, especially in low-dose CT. Effective denoising requires accurate modeling of the photon statistics and of the prior knowledge about the characteristics of the projection measurements. This paper proposes an algorithm for denoising low-dose sinograms in cone-beam CT. The proposed algorithm is based on minimizing a cost function that includes a measurement consistency term and two regularizations in terms of the gradient and the Hessian of the sinogram. This choice of the regularization is motivated by the nature of CT projections. We use a split Bregman algorithm to minimize the proposed cost function. We apply the algorithm on simulated and real cone-beam projections and compare the results with another algorithm based on bilateral filtering. Our experiments with simulated and real data demonstrate the effectiveness of the proposed algorithm. Denoising of the projections with the proposed algorithm leads to a significant reduction of the noise in the reconstructed images without oversmoothing the edges or introducing artifacts.
               
            

@&#INTRODUCTION@&#

There is always a great desire to reduce the amount of the radiation dose in x-ray computed tomography (CT) because of the health risks. Many methods have been proposed to address this problem. While many of these methods aim at improving the system hardware and imaging protocols [29,30], in recent years there has been an increased interest in the statistical and iterative reconstruction algorithms [40]. The major driving force behind this trend is the steady increase in the available computational power, commonly known as Moore׳s law, that can lead to clinically acceptable reconstruction times even for large volume reconstructions at high resolution. An optimal approach to reducing the radiation dose could include a combination of modifications to the system hardware and settings along with effective image reconstruction algorithms. To reconstruct images of high quality from a smaller number of measurements in the presence of significant noise, these algorithms should rely on accurate models of the imaging process and state-of-the-art signal processing tools.

The statistical reconstruction algorithms for CT can be divided into three broad categories [22,2]. The first category of these algorithms is the pre-processing algorithms. These are algorithms that try to denoise or restore the projection measurements that can be then used by analytical or iterative reconstruction algorithms to produce an image. The second category includes the post-processing methods, which work in the image domain. In other words, they aim at improving the reconstructed image via denoising, removing artifacts, etc. The third category includes iterative reconstruction algorithms. They start with a usually poor initial estimate of the image and improve the image estimate in an iterative fashion. In each iteration, these iterative reconstruction algorithms compute the line integrals of the current image estimate (via forward projections) and compare the computed line integrals with the actual measurements. The difference between the computed line integrals and actual measurements is used to improve the image estimate. Each of the above three categories of algorithms have their own pros and cons. For instance, the third category (iterative reconstruction algorithms) is more powerful and is known to outperform the pre-processing and post-processing methods, but it requires substantially more computation. Between the first two categories of methods, the pre-processing algorithms require access to the raw projection measurements, which are not always available on commercial scanners. Moreover, it is usually more difficult to preserve the edges by pre-processing algorithms because sharp edges in the image domain are somewhat smoothed in the projection measurements. On the other hand, pre-processing algorithms can rely on more accurate noise models [21]. This is because it is much easier to accurately model the noise in the projection measurements, whereas the noise in the reconstructed image is much more complex and difficult to model because it is spatially varying and depends on the reconstruction algorithm used to produce the image. Furthermore, projections that are denoised/restored by the pre-processing algorithms can be used by any analytical or iterative reconstruction algorithm. Therefore, pre-processing algorithms are independent of the reconstruction algorithm used to produce the final image. The focus of this paper is on the pre-processing methods, specifically sinogram denoising algorithms.

The denoising of the projection measurements, known as the sinogram in the CT community, can be a very effective approach to exploiting the knowledge of the physics of the imaging process to improve the quality of the images reconstructed from low-dose measurements. Sinogram denoising methods are of two types. The first type do not explicitly use the photon statistics. These algorithms can be as simple as that of using a shift-invariant low-pass filter that treats all measurements equally [21,31]. Considering that the noise in the sinogram is signal-dependent, this is clearly a sub-optimal approach. Therefore, improved performance has been reported when filter parameters are changed adaptively based on the characteristics of the signal and the noise [18,20,42,47]. Multiresolution denoising methods have also been proposed for sinogram denosing [19,37]. In these methods, the noisy signal is transformed into a wavelet of short-time Fourier domain, where the difference in the statistical distribution of the coefficients of the noise and the signal are used to remove or reduce the noise. Instead of using standard bases such as wavelets, another approach is to learn an overcomplete dictionary from a set of low-noise measurements [39]. A set of low-noise sinograms are used to learn an overcomplete dictionary, which can later be used for sparse representation of patches of noisy sinograms acquired under low dose. The idea is that the signal part of the noisy sinogram has a sparse representation in the learned dictionary, whereas the noise part does not have such a representation. Therefore, sparse approximation of the patches in the overcomplete dictionary will automatically lead to denoising.

The second type of sinogram denoising algorithms include those that explicitly model the noise via the probability distribution function of the measurements. These algorithms find an estimate of the true measurements by maximizing the data likelihood. However, since the resulting problem is ill-posed, a regularization term is usually added to the data likelihood term [14,23,25,28,41]. There are many different choices of the regularization terms and optimization methods that can lead to quite different algorithms. Examples of regularization functions that have been previously used in sinogram denoising include the weighted sum of the squared differences between neighboring pixel values [49,23] or a Gaussian function thereof [28], splines [13], and Markov random fields characterized by a Gibbs distribution [25]. Moreover, the data likelihood term may have one of two forms: in the original raw data domain, the measurements are the photon counts that follow a Poisson or compound Poisson distribution [10,11], whereas in the Radon space (i.e., after the logarithm transformation) the measurements have an approximately Gaussian distribution [27,43]. These variations suggest that the resulting algorithms can be very different in terms of complexity and performance.

In this paper, we propose a sinogram denoising algorithm for cone-beam CT. The proposed algorithm is based on minimizing a cost function that is composed of a data likelihood term and two regularization terms. The data likelihood term is based on the Poisson distribution of the photon counts, while the regularization terms reflect the assumption that the sinograms are piecewise-smooth. We will use an iterative split Bregman algorithm [16,48] for minimizing the cost function. We will apply the suggested algorithm on simulated and real cone-beam CT data and compare it with a recently published sinogram denoising algorithm based on bilateral filtering [28].

Our focus in this study is on cone-beam CT, where the sinogram is composed of a set of 2D images, each corresponding to one rotation angle of the x-ray source and detector panel around the object. We denote a true and noisy projection with u and v, respectively, and assume that they are of size 
                        m
                        ×
                        n
                     . Individual pixels of a projection, for example for u, is denoted as 
                        u
                        (
                        i
                        ,
                        j
                        )
                        ,
                        i
                        =
                        1
                        
                        to
                        
                        m
                        ,
                        
                        j
                        =
                        1
                        
                        to
                        
                        n
                     .

In a variational denoising formulation, the denoised image, u, is estimated from the noisy measurement, v, by minimizing a functional of the following form:
                        
                           (1)
                           
                              E
                              (
                              u
                              )
                              =
                              Ψ
                              (
                              u
                              ,
                              v
                              )
                              +
                              R
                              (
                              u
                              )
                           
                        
                     where 
                        Ψ
                        (
                        u
                        ,
                        v
                        )
                      is a measure of the distance between the noisy and the denoised images and R(u) is a regularization term that reflects some prior information about the image. When the noise has a Poisson distribution, an appropriate form for 
                        Ψ
                        (
                        u
                        ,
                        v
                        )
                      is [24]:
                        
                           (2)
                           
                              Ψ
                              (
                              u
                              ,
                              v
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              (
                              u
                              −
                              v
                              
                              log
                              
                              u
                              )
                           
                        
                     where Ω denotes the image domain. As for the regularization term, there are many different functions to choose from and a smart choice should be based on two main considerations. First, the regularization term should properly model our prior knowledge about the signal that we want to denoise. Second, the minimization of the resulting functional E(u) in (1) should be tractable. Examples of the regularization functions that have been previously used in sinogram denoising are mentioned in the previous section. Another example is the total variation (TV) and its variations [36,7] that have proved to be very powerful in various image processing tasks including denoising. This regularization has the following form:
                        
                           (3)
                           
                              R
                              (
                              u
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              |
                              ∇
                              u
                              |
                           
                        
                     where 
                        ∇
                        u
                      is the gradient of u. Because it is based on the ℓ1-norm of the gradient, this regularizer is very effective in preserving image edges while suppressing the noise. Therefore, it has been tremendously successful in reconstruction, deconvolution, and denoising of piecewise-constant images. In recent years, there has been a growing body of research in improving the capabilities of this model [7]. Perhaps the most significant enhancements have been achieved by including higher-order differentials in the model [6,38]. This change leads to superior results on images that contain piecewise-smooth features. On this type of image, the above regularizer, (3), leads to artificial blocky features known as staircase effect because with this formulation piecewise-constant solutions are preferred. Including higher-order differentials, on the other hand, will encourage piecewise-smooth solutions. This can be very important for projection measurements in CT. Even though the imaged object, e.g. the human body, may be modeled as piecewise-constant, its projections will, in general, not be piecewise-constant. This is easy to visualize and we show a simple example in Fig. 1
                     . This figure shows a 2D slice and a 1D profile from the low-contrast 3D Shepp–Logan phantom alongside a typical cone-beam projection of it. Even though the phantom itself is strictly piecewise constant, this is not the case for its projection. It is well documented that a regularizer of the form (3) does not achieve optimal performance on images of this type [6,26].

Following the above discussion, we suggest a regularization function that includes the ℓ1-norm of both the gradient and the Hessian of the image, leading to a functional of the form:
                        
                           (4)
                           
                              E
                              (
                              u
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              (
                              u
                              −
                              v
                              
                              log
                              
                              u
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              |
                              ∇
                              u
                              |
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              |
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              u
                              |
                           
                        
                     or in the discrete image domain:
                        
                           (5)
                           
                              E
                              (
                              u
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              (
                              u
                              (
                              i
                              ,
                              j
                              )
                              −
                              v
                              (
                              i
                              ,
                              j
                              )
                              
                              log
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              |
                              ∇
                              u
                              (
                              i
                              ,
                              j
                              )
                              |
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              |
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              |
                           
                        
                     
                  

The norms of the gradient and the Hessian in the discrete image domain are defined as follows:
                        
                           (6)
                           
                              |
                              ∇
                              u
                              (
                              i
                              ,
                              j
                              )
                              |
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             D
                                          
                                          
                                             x
                                          
                                       
                                       u
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             D
                                          
                                          
                                             y
                                          
                                       
                                       u
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              |
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              |
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             D
                                          
                                          
                                             xx
                                          
                                       
                                       u
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             D
                                          
                                          
                                             xy
                                          
                                       
                                       u
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             D
                                          
                                          
                                             yy
                                          
                                       
                                       u
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                           
                        
                     where D
                     
                        x
                     , D
                     
                        y
                     , D
                     
                        xx
                     , D
                     
                        xy
                     , and D
                     
                        yy
                      are the first and second-order difference operators defined as follows:
                        
                           (8)
                           
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              +
                              1
                              )
                              −
                              u
                              (
                              i
                              ,
                              j
                              )
                              
                                 
                                    D
                                 
                                 
                                    y
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              +
                              1
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              ,
                              j
                              )
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              +
                              1
                              )
                              −
                              2
                              u
                              (
                              i
                              ,
                              j
                              )
                              +
                              u
                              (
                              i
                              ,
                              j
                              −
                              1
                              )
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              +
                              1
                              ,
                              j
                              )
                              −
                              2
                              u
                              (
                              i
                              ,
                              j
                              )
                              +
                              u
                              (
                              i
                              −
                              1
                              ,
                              j
                              )
                              
                                 
                                    D
                                 
                                 
                                    xy
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              +
                              1
                              ,
                              j
                              +
                              1
                              )
                              −
                              u
                              (
                              i
                              +
                              1
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              ,
                              j
                              +
                              1
                              )
                              +
                              u
                              (
                              i
                              ,
                              j
                              )
                           
                        
                     Here, we have provided the definitions for the interior pixels. For the boundary pixels we assume periodic boundary condition as in [32,46]. In the rest of the paper, we only work in the discrete domain but to simplify the expressions we drop the pixel indices and only show them when necessary.

To derive a minimization algorithm for the functional E(u), we follow the split Bregman iterative framework [16] which is a very efficient algorithm for ℓ1-regularized problems. Split Bregman method can be considered as a member of larger families of algorithms such as the alternating direction method of multipliers [3] or proximal methods [8]. In the split Bregman method, first the unconstrained optimization problem is converted into a constrained problem by introducing new variables. For E(u) in (5), we write the corresponding constrained problem by introducing three new variables: 
                        
                           (9)
                           
                              minimize
                              
                              ∑
                              (
                              f
                              −
                              v
                              
                              log
                              
                              f
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ∑
                              |
                              g
                              |
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ∑
                              |
                              h
                              |
                              subject
                              
                              to
                              
                              f
                              =
                              u
                              ,
                              g
                              =
                              ∇
                              u
                              ,
                              h
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              u
                           
                        
                     This constrained problem can now be solved through the following Bregman iteration: 
                        
                           (10)
                           
                              Initialize
                              :
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              v
                              ,
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              =
                              v
                              ,
                              
                                 
                                    g
                                 
                                 
                                    0
                                 
                              
                              =
                              ∇
                              v
                              ,
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              v
                              ,
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              while
                              ∥
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    u
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                              >
                              ϵ
                              [
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    g
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       u
                                       ,
                                       f
                                       ,
                                       g
                                       ,
                                       h
                                    
                                 
                              
                              ∑
                              (
                              f
                              −
                              v
                              
                              log
                              
                              f
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ∑
                              |
                              g
                              |
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ∑
                              |
                              h
                              |
                              
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    f
                                    −
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    g
                                    −
                                    ∇
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    h
                                    −
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              +
                              ∇
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    g
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    h
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              end
                           
                        
                     where μ
                     
                        i
                      are the algorithm parameters and b
                     
                        i
                      are auxiliary variables. In the Bregman iterative approach, the updates of the auxiliary variables b
                     
                        i
                      replace the updates of the subgradients of the objective function. We should also note if u is an m-by-n image, i.e., 
                        u
                        ∈
                        
                           
                              R
                           
                           
                              m
                              ×
                              n
                           
                        
                     , then 
                        f
                        ,
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              m
                              ×
                              n
                           
                        
                     , 
                        ∇
                        u
                        ,
                        g
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        ∈
                        
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    m
                                    ×
                                    n
                                 
                              
                              )
                           
                           
                              2
                           
                        
                     , and 
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        u
                        
                        ,
                        h
                        
                        ,
                        
                           
                              b
                           
                           
                              3
                           
                        
                        ∈
                        
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    m
                                    ×
                                    n
                                 
                              
                              )
                           
                           
                              4
                           
                        
                     . In the rest of the paper, we denote the components of g and h as 
                        g
                        =
                        [
                        
                           
                              g
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              g
                           
                           
                              y
                           
                        
                        ]
                      and 
                        h
                        =
                        [
                        
                           
                              h
                           
                           
                              xx
                           
                        
                        ,
                        
                           
                              h
                           
                           
                              xy
                           
                        
                        ,
                        
                           
                              h
                           
                           
                              yx
                           
                        
                        ,
                        
                           
                              h
                           
                           
                              yy
                           
                        
                        ]
                      and the same for 
                        ∇
                        u
                     , 
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        u
                     , b
                     2, and b
                     3.

Although it may seem that the above modification has made the problem harder, the efficiency of the split Bregman scheme lies in the fact that the minimization problem can now be split into smaller problems that can be solved much more easily. Therefore, the large minimization problem in the above algorithm is solved by iteratively minimizing with respect to each of the four variables, resulting in the following algorithm:
                        
                           (11)
                           
                              Initialize
                              :
                              
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              v
                              ,
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              =
                              v
                              ,
                              
                                 
                                    g
                                 
                                 
                                    0
                                 
                              
                              =
                              ∇
                              v
                              ,
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              v
                              ,
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              while
                              ∥
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    u
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                              >
                              ϵ
                              
                              For
                              
                              i
                              =
                              1
                              :
                              N
                              
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       f
                                    
                                 
                              
                              ∑
                              (
                              f
                              −
                              v
                              
                              log
                              
                              f
                              )
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    f
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       u
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    ∇
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    u
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    g
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       g
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ∑
                              |
                              g
                              |
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    g
                                    −
                                    ∇
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       h
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ∑
                              |
                              h
                              |
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∑
                              
                                 
                                    (
                                    h
                                    −
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                              end
                              
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              +
                              ∇
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    g
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    h
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              end
                           
                        
                     
                  

To avoid complicating the notation, we have not introduced additional indices for the variable updates in the For loop. In fact, for many problems only one iteration of this loop is sufficient for fast convergence of the overall algorithm [16]. The efficiency of the split Bregman scheme entirely depends on how fast the sub-problems can be solved. In the following, we will show that for our problem, the four sub-problems can be solved very efficiently.


                     Minimization with respect to f:Returning to the notation with pixel indices, this sub-problem is:
                        
                           (12)
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              (
                              f
                              (
                              i
                              ,
                              j
                              )
                              −
                              v
                              (
                              i
                              ,
                              j
                              )
                              
                              log
                              
                              f
                              (
                              i
                              ,
                              j
                              )
                              )
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              
                                 
                                    (
                                    f
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     This expression can be written as a sum of scalar minimization problems in terms of individual pixel values. Since the function to be minimized is convex in terms of 
                        f
                        (
                        i
                        ,
                        j
                        )
                     , the solution can be found by setting the derivative to zero. Using basic calculus and the knowledge that 
                        f
                        ≥
                        0
                      we can show that the following formula gives the exact solution to this problem:
                        
                           (13)
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          v
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                              where
                              
                              B
                              =
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Minimization with respect to u: This subproblem can be solved through its optimality condition which can be written as [16,32]:
                        
                           (14)
                           
                              [
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 I
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       xx
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       xx
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       D
                                    
                                    
                                       xy
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       xy
                                    
                                 
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       yy
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       yy
                                    
                                 
                                 )
                              
                              ]
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    f
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              )
                              −
                              
                                 
                                    μ
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    2
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    2
                                    y
                                 
                                 
                                    k
                                 
                              
                              )
                              )
                              +
                              
                                 
                                    μ
                                 
                                 
                                    3
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    h
                                 
                                 
                                    xx
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    3
                                    xx
                                 
                                 
                                    k
                                 
                              
                              )
                              +
                              2
                              
                                 
                                    D
                                 
                                 
                                    xy
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    h
                                 
                                 
                                    xy
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    3
                                    xy
                                 
                                 
                                    k
                                 
                              
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    h
                                 
                                 
                                    yy
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    3
                                    yy
                                 
                                 
                                    k
                                 
                              
                              )
                              )
                           
                        
                     where D
                        x
                     
                     
                        T
                     , D
                        y
                     
                     
                        T
                     , D
                        xx
                     
                     
                        T
                     , D
                        xy
                     
                     
                        T
                     , and D
                        yy
                     
                     
                        T
                      are the backward-difference operators corresponding to the forward-difference operators defined in (8). For the pixels in the interior of the image, these operators are defined as: 
                        
                           (15)
                           
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              ,
                              j
                              −
                              1
                              )
                              
                                 
                                    D
                                 
                                 
                                    y
                                 
                                 
                                    T
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              −
                              1
                              ,
                              j
                              )
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                                 
                                    T
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              +
                              1
                              )
                              −
                              2
                              u
                              (
                              i
                              ,
                              j
                              )
                              +
                              u
                              (
                              i
                              ,
                              j
                              −
                              1
                              )
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                                 
                                    T
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              +
                              1
                              ,
                              j
                              )
                              −
                              2
                              u
                              (
                              i
                              ,
                              j
                              )
                              +
                              u
                              (
                              i
                              −
                              1
                              ,
                              j
                              )
                              
                                 
                                    D
                                 
                                 
                                    xy
                                 
                                 
                                    T
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              =
                              u
                              (
                              i
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              −
                              1
                              ,
                              j
                              )
                              −
                              u
                              (
                              i
                              ,
                              j
                              −
                              1
                              )
                              +
                              u
                              (
                              i
                              −
                              1
                              ,
                              j
                              −
                              1
                              )
                           
                        
                     Despite its long expression, (14) is a system of linear equations in 
                        
                           
                              u
                           
                           
                              k
                              +
                              1
                           
                        
                     . Due to the structure of the forward and backward difference matrices, the system matrix is diagonally dominant. When the size of the image is not small, an efficient algorithm for finding a very good approximate solution is the Gauss–Seidel method [17,32].


                     Minimization with respect to g: This problem reads:
                        
                           (16)
                           
                              
                                 
                                    g
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       g
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              |
                              g
                              (
                              i
                              ,
                              j
                              )
                              |
                              +
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              
                                 
                                    (
                                    g
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    −
                                    ∇
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     This problem is also equivalent to a set of scalar problems in terms of individual pixel values. Its solution is a simple extension of the soft thresholding operation [44,33]:
                        
                           (17)
                           
                              
                                 
                                    g
                                 
                                 
                                    x
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 B
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    B
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    y
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 B
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    B
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                              where
                              
                              B
                              (
                              i
                              ,
                              j
                              )
                              =
                              [
                              
                                 
                                    B
                                 
                                 
                                    x
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    B
                                 
                                 
                                    y
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ]
                              =
                              [
                              
                                 
                                    b
                                 
                                 
                                    2
                                    x
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                    y
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    y
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ]
                           
                        
                     
                  


                     Minimization with respect to h: This problem is very similar to minimization with respect to g above. Its solution is similarly a generalization of the soft thresholding operation [33]: 
                        
                           (18)
                           
                              
                                 
                                    h
                                 
                                 
                                    xx
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 C
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          xx
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    C
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    xy
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 C
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          xy
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    C
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    yx
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 C
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          yx
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    C
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    h
                                 
                                 
                                    yy
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              max
                              (
                              
                                 |
                                 C
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 |
                                 −
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 0
                              
                              )
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          yy
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 
                                    |
                                    C
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                 
                              
                              where
                              
                              C
                              (
                              i
                              ,
                              j
                              )
                              =
                              [
                              
                                 
                                    C
                                 
                                 
                                    xx
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    xy
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    yx
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    yy
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ]
                              =
                              [
                              
                                 
                                    b
                                 
                                 
                                    3
                                    xx
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    xx
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                    xy
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    xy
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                    yx
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    yx
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                    yy
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    yy
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              u
                              (
                              i
                              ,
                              j
                              )
                              ]
                           
                        
                     
                  

If we set 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        =
                        0
                      in Eq. (4) or (5), we get a simplified model with standard (i.e., first-order) TV regularization. This will greatly simplify the algorithm because the variables h and b
                     3 will also be removed. We will refer to this simplified model as “TV sinogram denoising” and to the full model described above as “(TV + TV2) sinogram denoising” and will present the results for both models. This will allow us to see whether or not, and to what extent, the more complex model with two regularizers improves the results.

@&#EVALUATION@&#

To evaluate the proposed denoising algorithm, we applied it on sets of simulated and real cone-beam sinograms. In addition to our proposed algorithm, we also implemented a recently published algorithm based on bilateral filtering [28]. This algorithm minimizes a cost function of the following form:
                        
                           (20)
                           
                              E
                              (
                              u
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    d
                                 
                              
                              (
                              i
                              ,
                              i
                              ,
                              k
                              )
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                           
                        
                     where 
                        
                           
                              ω
                           
                           
                              i
                              ,
                              j
                           
                        
                      is a neighborhood around the current pixel location (i,j), and f
                     
                        d
                      and f
                     
                        i
                      are two cost functions in terms of the spatial distance and difference in pixel intensity, respectively. In [28] both f
                     
                        d
                      and f
                     
                        i
                      are suggested to be Gaussians. The bandwidth of f
                     
                        d
                      is suggested to be fixed at 
                        w
                        /
                        6
                     , where w is the neighborhood width. The bandwidth of f
                     
                        i
                      is suggested to be chosen in the range 
                        [
                        0.7
                        ,
                        2.8
                        ]
                     . Here, we denote the bandwidth of f
                     
                        i
                      with σ
                     
                        i
                      and use it as a tuning parameter for bilateral filtering. A larger value of σ
                     
                        i
                      results in a stronger denoising. In our experiments, we will apply the bilateral filtering for 
                        
                           
                              σ
                           
                           
                              i
                           
                        
                        ∈
                        {
                        0.7
                        ,
                        1.0
                        ,
                        1.3
                        ,
                        …
                        ,
                        2.8
                        }
                     .

Noisy cone-beam projections were simulated from a 3D low-contrast Shepp–Logan phantom according to the following model [27,35].
                           
                              (21)
                              
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       (
                                       
                                          −
                                          
                                             
                                                ∫
                                             
                                             
                                                i
                                             
                                          
                                          μ
                                          
                                          ds
                                       
                                       )
                                    
                                 
                              
                           
                        where N
                        
                           d
                        
                        
                           i
                         and N
                        0
                        
                           i
                         denote, respectively, the number of detected and incident photons for the ray extending from the source to the detector i and 
                           
                              
                                 ∫
                              
                              
                                 i
                              
                           
                           μ
                           
                           ds
                         is the line integral of the attenuation coefficient through the object along that ray. We used two different values of 
                           
                              
                                 N
                              
                              
                                 0
                              
                              
                                 i
                              
                           
                           =
                           1000
                         and 
                           
                              
                                 N
                              
                              
                                 0
                              
                              
                                 i
                              
                           
                           =
                           100
                         to simulate two sets of projections with different levels of noise. For each ray, the expected number of detected photons (N
                        
                           d
                        
                        
                           i
                        ) is given by Eq. (21). The actual detected photon count was simulated as a Poisson random variable with mean equal to N
                        
                           d
                        
                        
                           i
                        . We will refer to the scans with 
                           
                              
                                 N
                              
                              
                                 0
                              
                              
                                 i
                              
                           
                           =
                           1000
                         and 
                           
                              
                                 N
                              
                              
                                 0
                              
                              
                                 i
                              
                           
                           =
                           100
                         as low-noise and high-noise, respectively. The phantom size was 2563 voxels and the projections were each 300×300pixels in size. Each simulated scan consisted of 720 projections between 
                           0
                           °
                         and 
                           360
                           °
                        .

Because for this simulated experiment we have access to the true projections, we can quantitatively compare the denoised projections with the true projections. To this end, we computed two criteria: (1) the root-mean-square of the error (RMSE), where the error is defined as the difference between the denoised projection and the true projection (i.e., without the Poisson noise) and (2) the mutual information (MI) between the denoised projections (
                           
                              
                                 u
                              
                              
                                 ^
                              
                           
                        ) and the true projections (u
                        ⁎) computed as [34]:
                           
                              (22)
                              
                                 MI
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ^
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       h
                                    
                                 
                                 q
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ⁎
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                 log
                                 (
                                 
                                    
                                       
                                          q
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ⁎
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ⁎
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                           
                        Here, p and q represent the marginal and joint probability distribution functions, respectively. We used histograms of u
                        ⁎ and 
                           
                              
                                 u
                              
                              
                                 ^
                              
                           
                         for estimating these probability densities and h is the number of bins in the histograms. We normalized the computed 
                           MI
                           (
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 ^
                              
                           
                           )
                         by dividing it by 
                           MI
                           (
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           )
                        .

The results of this comparison have been presented in Table 1
                        . As we mentioned above, “TV sinogram denoising” means setting 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0
                         and adjusting λ
                        1 in our model. We will discuss the role of the parameter values and some possible approaches to selecting proper values later in this paper. The results shown for TV sinogram denoising in Table 1 were obtained with 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           =
                           2
                        , 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           =
                           10
                        , and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           =
                           0.1
                        . The results shown for (TV + TV2) sinogram denoising in Table 1 were obtained with 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           =
                           2
                        , 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0.1
                        , 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           =
                           10
                        , 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           =
                           0.5
                        , and 
                           
                              
                                 μ
                              
                              
                                 3
                              
                           
                           =
                           0.01
                        . For bilateral filtering, the results are shown for the choice of 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           =
                           2.2
                        , which gave us the lowest RMSE. The numbers in this table indicate that the proposed TV sinogram denoising methods, especially the (TV + TV2) sinogram denoising algorithm, outperform the method based on bilateral filtering.

In order to determine the effect of sinogram denoising on the quality of the reconstructed image, we used the FDK algorithm [12] to reconstruct the image of the phantom from noisy and denoised projections. In Fig. 2
                         we have shown the central slices of the reconstructed images. This figure clearly shows that the image reconstructed from the projections denoised with the (TV + TV2)-model has a better quality than the bilateral filtering and TV denoising, especially for the high-noise case. For a quantitative comparison, we computed the RMSE, where error is defined as the difference between the reconstructed image and the true phantom image, and the structural similarity index (SSIM) between the two images [45]. SSIM between two images x and y is computed as:
                           
                              (23)
                              
                                 SSIM
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             μ
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       C
                                       )
                                       (
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             xy
                                          
                                       
                                       +
                                       D
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       C
                                       )
                                       +
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       D
                                       )
                                    
                                 
                              
                           
                        where μ
                        
                           x
                         and σ
                        
                           x
                         represent the mean and standard deviation of x, and 
                           
                              
                                 σ
                              
                              
                                 xy
                              
                           
                         is the covariance. The constants C and D are small constants that are chosen based on the dynamic range of the image.

We have summarized the results of this quantitative comparison in Table 2
                        . The numbers in this table indicate that denoising of the projections using the (TV + TV2)-model results in a better image. The difference is more significant for the high-noise case.

A Gamma Medica eXplore CT 120 micro-CT scanner was used to scan a physical phantom. Detailed information about this phantom can be found in [9]. The distances from the source to the panel of detectors and to the axis of rotation on the scanner were 450.36mm and 398.24mm, respectively. The phantom was scanned twice. The first scan consisted of 720 projections between 
                           0
                           °
                         and 
                           360
                           °
                         at 
                           0.5
                           °
                         intervals. For this scan, we chose the tube voltage, tube current, and exposure time to be, respectively, 70kV, 40mA, and 25ms. We used the full set of 720 projections from this scan to reconstruct a high-quality image. This image was created by first using the FDK algorithm to reconstruct an initial image and then applying five iterations of the MFISTA algorithm [1] to further improve its quality. We will refer to this image as “the reference image” and will use it as the ground-truth for evaluating the denoising algorithms. The second scan of the phantom consisted of 360 projections between 
                           0
                           °
                         and 
                           360
                           °
                         at 
                           1
                           °
                         intervals. For this scan, we chose the tube voltage, tube current, and exposure time to be 50kV, 32mA, and 16mAs, respectively. This was the lowest possible setting in terms of mAs as the scanner did not operate under 0.5mAs. We also used a 0.1-mm copper filter. The resulting scan was very noisy. Since we do not have the true projections, in this experiment we evaluate the denoising algorithms in the image domain. Note that this does not mean that we apply the denoising algorithms in the image domain. It means that after denoising of the projections, we reconstruct the image and compare the reconstructed images with the reference image. Therefore, we denoised the noisy projections using different algorithms, reconstructed the image of the phantom from the denoised projections using the FDK algorithm, and evaluated the quality of the reconstructed image. This is a very appropriate comparison because the ultimate goal of sinogram denosing is to improve the quality of the reconstructed image. The size of the reconstructed image was 880×880×650 voxels, with isotropic voxels of 
                           0.1
                           ×
                           0.1
                           ×
                           0.1
                           
                           
                              
                                 mm
                              
                              
                                 3
                              
                           
                         in size.

In order to evaluate the quality of the reconstructed images, we compared them with the reference image by computing the RMSE and SSIM. The results are summarized in Table 3
                        . In addition, this phantom included various modules that allow for a more detailed evaluation of the quality of the reconstructed images. Specifically, we used two of the modules in this phantom to evaluate the spatial resolution and the noise level in the reconstructed images. The phantom included a plastic-air edge, specially designed to allow accurate estimation of the modulation transfer function (MTF). We used the method proposed in [4] to estimate the MTF over the range of spatial frequencies 
                           [
                           0
                           ,
                           5
                           
                           
                              
                                 mm
                              
                              
                                 −
                                 1
                              
                           
                           ]
                        . We report the spatial frequency at which the normalized MTF reached a value of 0.1 as the indicator of the spatial resolution. The phantom also includes a uniform polycarbonate disk for estimating the noise level in the reconstructed image. We used the standard deviation of the voxel values in this disk as an indicator of noise level. The values in Table 3 clearly show that the proposed TV denoising model is better than bilateral filtering. Moreover, the full (TV + TV2) model has led to a higher image quality than the simpler TV-denoising model.

For visual comparison, in Fig. 3
                         we have shown a slice of the phantom reconstructed from noisy and denoised projections. This figure agrees with quantitative comparison in Table 3. Our proposed TV-based denoising seems to have resulted in a higher quality image than bilateral filtering. Moreover, the (TV + TV2)-model has produced a slightly better image than the TV-model. To show the difference between the images reconstructed from projections denoised with different algorithms more clearly, in Fig. 4
                         we have shown a profile in the reconstructed images. The location of this profiles has been marked with a white vertical line on the slice of the reference image in Fig. 3(a). From the profiles in Fig. 4, the image reconstructed from the projections denoised using the (TV+TV2)-model is much closer to the reference image, which agrees with the quantitative evaluations presented in Table 3.

The values of the image quality metrics presented in Table 3 and the images shown in Figs. 3 and 4 were obtained using one particular set of parameter values for each algorithm. However, they do not present a complete comparison of the performance of different denoising algorithms. It is well known that, in general, stronger denoising leads to a loss of spatial resolution. Therefore, comparing different denoising algorithms requires a more detailed look at the trade-off between noise and spatial resolution for different algorithms. In Fig. 5
                         we have shown plots of noise level versus spatial resolution for a range of parameter values for different algorithms. Noise level and spatial resolution were computed as described above using the slanted edge module and the uniform disk module in the phantom. For bilateral filtering, we have shown the plot for 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∈
                           [
                           0.7
                           ,
                           2.8
                           ]
                        . For the proposed TV-based algorithm we have presented three curves, each for one different value of the regularization parameter 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ∈
                           {
                           0
                           ,
                           0.2
                           ,
                           1
                           }
                        . The curve for 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0
                         corresponds to the “TV-denoising”, i.e., regularization only in terms of the gradient. For each value of λ
                        2, we applied the proposed algorithm for 10 values of λ
                        1 in the range 
                           [
                           0.5
                           ,
                           10
                           ]
                        . Note that a high spatial resolution and a low noise level are desirable. From this figure, it is clear that the proposed TV-based denoising algorithm outperforms the bilateral filtering. For the range of values of λ
                        1 and λ
                        2 that we tried in this experiment, the value of λ
                        1 seems to more strongly affect the behavior of the proposed algorithm. The Hessian regularization has a very positive effect. When 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           >
                           0
                        , i.e., when the Hessian regularization term exists, the proposed algorithm can achieve a better results in term of noise level and spatial resolution, i.e., lower noise level and higher spatial resolution. Moreover, when 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           >
                           0
                        , the performance is more stable with regard to changes in λ
                        1. This can be seen by comparing the three curves that have been shown for the TV-based algorithm. The curve corresponding to 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0
                         is influenced more strongly by the change in λ
                        1, whereas when 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           >
                           0
                         the algorithm is less sensitive to change in λ
                        1.

For a complete characterization of the spatial resolution of the images reconstructed from the projections denoised by different algorithms, we plot the estimated MTFs in Fig. 6
                        . Our approach to estimating the MTFs that are shown in this figure are different from the spatial resolutions shown in Table 3 in an important way. As can be seen in Table 3, the three algorithms are different in terms of both spatial resolution and noise level. However, as we mentioned above, noise and spatial resolution are inter-dependent. Hence, a more appropriate comparison of spatial resolution will require making sure that the noise level is the same for different algorithms. Therefore, estimation of the MTF curves in Fig. 6 was done while matching the noise level of the reconstructed image for different algorithms. As we mentioned above, this phantom included a uniform disk that has been designed for noise level estimation. We adjusted the tuning parameters of the different algorithms (i.e., σ
                        
                           i
                         for bilateral filtering and λ
                        1 and λ
                        2 for the proposed algorithm) such that the noise level was equal to 0.0175 in the reconstructed images for all three algorithms. We then estimated the MTF for different algorithms. From the estimated MTFs in Fig. 6 it can be seen that the TV-based denoising leads to a higher MTF for all spatial frequencies, especially for spatial frequencies above 
                           2
                           
                           
                              
                                 mm
                              
                              
                                 −
                                 1
                              
                           
                        . All three algorithms are very close up to the spatial frequency of approximately 
                           1
                           
                           
                              
                                 mm
                              
                              
                                 −
                                 1
                              
                           
                        . The MTF for the two TV-based algorithms are close, but the (TV + TV2)-model results in a slightly higher MTF at higher spatial frequencies.

The same scanner described above was used to scan two dead rats. The first scan had relatively less noise, whereas the second scan was much noisier. We will refer to these two scans as low-noise and high-noise rat scans. Each of the two scans consisted of 720 projections between 
                           0
                           °
                         and 
                           360
                           °
                         at 
                           0.5
                           °
                         intervals. For both scans, the tube voltage, tube current, and exposure time were set to 50kV, 32mA, and 16ms, respectively. However, for the high-noise scan we used a 0.2-mm copper filter. For both the low-noise and the high-noise rat scans, we used all 720 projections to reconstruct a high-quality reference image using the same procedure as that described for the physical phantom above. We will use this image as the ground-truth for evaluating the denoising algorithms. Similar to our experiment with the physical phantom described above, because we do not have the true projections, we compare different denoising algorithms in terms of the quality of the reconstructed image. We applied the denoising algorithms on a subset of 360 projections of the same scan and reconstructed the image of the rat using the FDK algorithm. We should note that because the internal organs of the rats constantly moved, we could not create two identical scans of the same rat with different noise levels (as we did in our phantom experiment). Therefore, we scanned each rat only once.


                        Table 4
                         shows a summary of the quantitative comparison between different sinogram denoising algorithms in terms of RMSE and SSIM of the reconstructed images of the low-noise rat scan. Furthermore, for a visual comparison, we have shown a typical slice of the reconstructed images in Fig. 7
                        . Similar to the above experiments, compared with bilateral filtering, the TV-based algorithms have produced better results.

In Fig. 8
                        , we have shown a slice from the reconstructed images of the high-noise rat scan. All three sinogram denoising algorithms have resulted in a significant improvement in the visual quality of the reconstructed image from this high-noise scan. Similar to the above experiments, the proposed TV-based algorithm works better than bilateral filtering. Moreover, the (TV + TV2) model seems to have more effectively suppressed the noise without blurring the image features.

However, once again the images shown in Fig. 8 have been reconstructed using a particular set of parameters for each algorithm. In order to ensure a better comparison between different sinogram denoising algorithms, we compared them in terms of the trade-off between the noise suppression and image sharpness. For this purpose, as a measure of the noise level we computed the contrast-to-noise-ratio (CNR). We selected the cubes b and s as shown on the slice of the reference image in Fig. 8(a). We estimated the CNR using the following equation:
                           
                              (24)
                              
                                 CNR
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             b
                                          
                                       
                                       |
                                    
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                       
                                       )
                                       /
                                       2
                                    
                                 
                              
                           
                        where μ and σ denote, respectively, the mean and the standard deviation of the voxels in each cube. As a measure of image sharpness, we computed the maximum slope along the line “L” shown in Fig. 8(a). This line lies on an edge between soft tissue and fat. If the spatial resolution is high, the slope of this edge will also be high. On the other hand, if the image is over-smoothed this slope becomes small. We will denote the computed slope along the line “L” with SL and use it as a measure of image sharpness. A similar approach was used to quantify the spatial resolution in [28]. Therefore, a small SL indicates that the image is over-smoothed and spatial resolution is low. On the other hand, a large value of SL indicates that the image is sharp and spatial resolution is high. Fig. 9
                         shows the plots of SL versus CNR for different parameter values for bilateral filtering and TV-based denoising algorithms. Note that a high CNR and a high SL are desirable. For bilateral filtering, we changed σ
                        
                           i
                         in the range 
                           [
                           0.7
                           ,
                           2.8
                           ]
                        . For the proposed TV-based algorithm, we found that parameter values 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           =
                           4
                         and 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0.4
                         lead to good results. Therefore, in order to investigate the role of these two parameters, we first kept 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           =
                           0.4
                         constant and changed λ
                        1 in the range 
                           [
                           0
                           ,
                           10
                           ]
                        . Then, we kept 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           =
                           4
                         constant and changed λ
                        2 in the range 
                           [
                           0
                           ,
                           2.0
                           ]
                        . Therefore, for the proposed TV-based algorithm we have two curves that show the effect of tuning λ
                        1 and λ
                        2. It is clear from the proposed cost function in Eq. (4) that λ
                        1 and λ
                        2 determine the strength of regularization in terms of the gradient and the Hessian, respectively. The plots in Fig. 9 show that the proposed TV-based denoising algorithm can achieve higher SL and CNR compared with bilateral filtering. It is also clear that both regularization terms play an important role in the performance of the proposed algorithm because when either λ
                        1 or λ
                        2 decrease to zero, one or both of the criteria decrease. Especially, when 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           →
                           0
                        , both SL and CNR decrease. This clearly indicates the importance of the regularization in terms of the Hessian.

@&#DISCUSSION@&#

Overall, the results of our experiments with simulated and real data show that the proposed algorithm is highly effective in suppressing the noise in the projection measurements in cone-beam CT. This is evident from the quantitative evaluation presented in Table 1. The effect of the noise suppression on the quality of the FDK-reconstructed images is substantial, as can be seen from Figs. 2–9 and from the objective image quality metrics in Tables 2–4. Our results suggest that the proposed TV-based algorithm is superior to the method based on bilateral filtering both in terms of spatial resolution and noise suppression. The difference between TV sinogram denoising and (TV + TV2) sinogram denoising models was also significant on both the simulated data and on the real data. This shows a clear gain in the denoising performance by including the regularization in terms of the Hessian. We should note, however, that this gain in performance comes at the cost of more computation. For example, with our Matlab implementation on a Windows 7 PC with a 3.4GHz Intel Core i7 CPU, denoising of one projection from the rat scan takes approximately 33s with the TV model and 46s with the (TV + TV2) model.

The choice of algorithm parameters can significantly influence their performance, as shown in our results in Figs. 5 and 9. There are two sets of parameters in the proposed algorithm. The regularization parameters, λ
                     1 and λ
                     2, control the degree of regularization. They must be selected according to the desired quality of the final image. The Bregman parameters, μ
                     1, μ
                     2, and μ
                     3 mostly influence the convergence of the algorithm [16,32]. The simplified model with only first-order TV regularization has three parameters, λ
                     1, μ
                     1, and μ
                     2, which makes it easier to find good parameter values. For the full model, too, one can first ignore the second-order differential terms and find proper values for λ
                     1, μ
                     1, and μ
                     2, and then proceed to find good values for λ
                     2 and μ
                     3.

A well-known method for selecting λ
                     1 was proposed by Chambolle [5]. His method was proposed for the case of additive Gaussian noise. In our experience this method works for the case of Poisson noise as well. For this method to work, one needs to have a prior estimate of the noise level in the image. If the average noise variance in the noisy image v is σ
                     2, one starts with an arbitrary value of the regularizarion parameter 
                        λ
                        =
                        
                           
                              λ
                           
                           
                              0
                           
                        
                      and updates λ as follows:
                        
                           
                              Repeat
                              
                              until
                              
                              convergence
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       u
                                    
                                 
                              
                              Ψ
                              (
                              u
                              ,
                              v
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              |
                              ∇
                              u
                              |
                              
                              
                                 
                                    λ
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    (
                                    N
                                    σ
                                    )
                                 
                                 
                                    Ψ
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    v
                                    )
                                 
                              
                              end
                           
                        
                     
                  

The same strategy has been suggested for finding λ
                     1 for Poisson denoising in [15]. That paper has also developed an empirical equation relating the regularization parameter λ
                     1 and the Poisson noise variance, which has the form: 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        =
                        1
                        /
                        (
                        72.4
                        /
                        σ
                        +
                        97.7
                        /
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        )
                     , where σ
                     2 is the noise variance. This equation can be very useful for choosing a good initial value for λ
                     1, which can then be improved using Chambolle׳s method mentioned above. For the simplified model, we found that choosing 
                        
                           
                              μ
                           
                           
                              1
                           
                        
                        ≈
                        10
                        
                           
                              λ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              μ
                           
                           
                              2
                           
                        
                        ≈
                        0.1
                        
                           
                              λ
                           
                           
                              1
                           
                        
                      lead to good results. For the full model, we had good results with 
                        λ
                        2
                        <
                        
                           
                              λ
                           
                           
                              1
                           
                        
                     , usually 
                        λ
                        2
                        ≈
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        /
                        10
                     , and 
                        
                           
                              μ
                           
                           
                              3
                           
                        
                        ≈
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        /
                        10
                     , which are not very different from the values suggested for the inpainting problem in [33].

@&#CONCLUSION@&#

Sinogram denoising is an effective approach to exploiting the knowledge of the physics of x-ray CT imaging to reconstruct images of high quality from noisy projection measurements. Sinogram denoising algorithms can, therefore, be considered as one of the most essential tools in low-dose CT. In this paper, we presented a method based on the split Bregman algorithm for reducing the Poisson noise in low-dose projections in CBCT. The full method includes two regularizations in terms of the ℓ1-norms of the gradient and the Hessian of the projections. A simplified algorithm is obtained by considering the ℓ1-norm of the gradient only. Our results show that both the full model and the simplified model are very effective in reducing the Poisson noise in the cone-beam projections. Subjective and quantitative evaluation of the quality of the reconstructed images showed that the denoising of the sinograms with the proposed algorithm substantially improves the quality of the reconstructed images, outperforming the bilateral filtering algorithm. Our results also show that the full model that includes the regularization in terms of Hessian can lead to much better results compared with the simplified model that does not include such a regularization.

None declared.

@&#ACKNOWLEDGMENTS@&#

The real cone-beam projections used in this study were collected in the Centre for High-Throughput Phenogenomics at the University of British Columbia, a facility supported by the Canada Foundation for Innovation, British Columbia Knowledge Development Foundation, and the UBC Faculty of Dentistry. The authors would like to thank Dr. Nancy Ford and Mr. John Schipilow for sharing these data with us and for their help and support. The first author was supported by The Natural Sciences and Engineering Research Council of Canada through an Alexander Graham Bell Canada Graduate Scholarship.

@&#REFERENCES@&#

