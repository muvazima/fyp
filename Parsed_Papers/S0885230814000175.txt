@&#MAIN-TITLE@&#Simplified supervised i-vector modeling with application to robust and efficient language identification and speaker verification

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Simplified and supervised I-vector modeling for robust and efficient language identification and speaker verification


                        
                        
                           
                           I-vector baseline is extended to the proposed label-regularized supervised I-vector modeling for better robustness


                        
                        
                           
                           I-vector baseline is extended to the proposed simplified I-vector modeling for better efficiency


                        
                        
                           
                           Simplified supervised I-vector modeling improves the performance and reduces the computational cost at the same time


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Language identification

Speaker verification

I-vector

Supervised i-vector

Simplified i-vector

Simplified supervised i-vector

@&#ABSTRACT@&#


               
               
                  This paper presents a simplified and supervised i-vector modeling approach with applications to robust and efficient language identification and speaker verification. First, by concatenating the label vector and the linear regression matrix at the end of the mean supervector and the i-vector factor loading matrix, respectively, the traditional i-vectors are extended to label-regularized supervised i-vectors. These supervised i-vectors are optimized to not only reconstruct the mean supervectors well but also minimize the mean square error between the original and the reconstructed label vectors to make the supervised i-vectors become more discriminative in terms of the label information. Second, factor analysis (FA) is performed on the pre-normalized centered GMM first order statistics supervector to ensure each gaussian component's statistics sub-vector is treated equally in the FA, which reduces the computational cost by a factor of 25 in the simplified i-vector framework. Third, since the entire matrix inversion term in the simplified i-vector extraction only depends on one single variable (total frame number), we make a global table of the resulting matrices against the frame numbers’ log values. Using this lookup table, each utterance's simplified i-vector extraction is further sped up by a factor of 4 and suffers only a small quantization error. Finally, the simplified version of the supervised i-vector modeling is proposed to enhance both the robustness and efficiency. The proposed methods are evaluated on the DARPA RATS dev2 task, the NIST LRE 2007 general task and the NIST SRE 2010 female condition 5 task for noisy channel language identification, clean channel language identification and clean channel speaker verification, respectively. For language identification on the DARPA RATS, the simplified supervised i-vector modeling achieved 2%, 16%, and 7% relative equal error rate (EER) reduction on three different feature sets and sped up by a factor of more than 100 against the baseline i-vector method for the 120s task. Similar results were observed on the NIST LRE 2007 30s task with 7% relative average cost reduction. Results also show that the use of Gammatone frequency cepstral coefficients, Mel-frequency cepstral coefficients and spectro-temporal Gabor features in conjunction with shifted-delta-cepstral features improves the overall language identification performance significantly. For speaker verification, the proposed supervised i-vector approach outperforms the i-vector baseline by relatively 12% and 7% in terms of EER and norm old minDCF values, respectively.
               
            

@&#INTRODUCTION@&#

The goal of language identification (LID) is to automatically determine the language spoken in a given segment of speech. In real world applications e.g., security or defense, the speech signals could come from extremely noisy and distorted communication channels, such as short wave AM broadcasting. Thus robust LID on noisy and degraded data represents an important need.

Several algorithmic and computational advances have enabled impressive LID performance in the state of the art. Approaches using phonotactic information, namely PRLM (phoneme recognizer followed by language models) and PPRLM (parallel PRLM), have been shown to be quite successful (Zissman, 1995; Yan and Barnard, 1995). In this phonotactic modeling framework, a set of tokenizers are used to transcribe the input speech into token strings or lattices which are later scored by n-gram language models (Gauvain et al., 2004) or mapped into a bag of trigrams feature vector for support vector machine (SVM) modeling (Li et al., 2007a). Although the traditional hidden Markov model (HMM) based phone recognizer (Rabiner, 1989) is widely used as tokenizer in the state-of-the-art systems, other types of tokenizations could also be applied here (Li et al., 2013), for example, Gaussian Mixture Model (GMM) tokenization (Torres-Carrasquillo et al., 2002b), universal phone recognition (UPR) (Li et al., 2007a), articulatory attribute-based approach (Siniscalchi et al., 2010), deep neural networks based phone recognizer (Hinton et al., 2012; Deng and Li, 2013), just to name a few. A recent literature review on LID is provided in Li et al. (2013).

With the introduction of shifted-delta-cepstral (SDC) acoustic features (Torres-Carrasquillo et al., 2002a), promising results using GMM framework with factor analysis (Castaldo et al., 2007; Kenny et al., 2007a,b, 2008), supervector modeling (Campbell et al., 2006; Li et al., 2007b) and maximum mutual information (MMI) based discriminative training (Burget et al., 2006) have also been reported for LID. In this work, we focus on the acoustic level systems.

Another critical speech processing application domain is speaker verification (SV); this domain also is challenged by significant variability in the speech signal. In particular, the use of joint factor analysis (JFA) (Kenny et al., 2007a,b, 2008) has also contributed to the state of the art performance in text independent speaker verification. It is a powerful technique for compensating the variability caused by different channels and sessions.

Recently, total variability i-vector modeling has gained significant attention in both LID and SV domains due to its excellent performance, low complexity and small model size (Dehak et al., 2011a,b; Martinez et al., 2011). In this modeling, first, a single factor analysis is used as a front end to generate a low dimensional total variability space which jointly models language, speaker and channel variabilities all together (Dehak et al., 2011b). Then, within this i-vector space, variability compensation methods, such as Within-Class Covariance Normalization (WCCN) (Hatch et al., 2006), Linear Discriminative analysis (LDA) and Nuisance Attribute Projection (NAP) (Campbell et al., 2006), are performed to reduce the variability for subsequent modeling (e.g., using SVM, logistic regression (LR) (Martinez et al., 2011) and neural network (Matejka et al., 2012) for LID and probabilistic linear discriminant analysis (PLDA) (Matejka et al., 2011; Kenny, 2010) for SV, respectively).

However, the i-vector training and extraction algorithms are computationally expensive, especially for large GMM model sizes and large training data sets (Aronowitz and Barkan, 2012; Glembek et al., 2011). Both Glembek et al. (2011) and Aronowitz and Barkan (2012) used a pre-calculated UBM weighting vector to approximate each utterance's 0th order GMM statistics vector to avoid the computationally-expensive GMM component wise matrix operations for the SV task. This approximation resulted in 10–25 times computational cost reduction at the expense of a significant performance degradation (about 17% EER) (Aronowitz and Barkan, 2012). By enforcing this approximation in both training and extraction stages, the performance degradation can be reduced notably (Glembek et al., 2011) on condition that there is no or very little mismatch between train/test data and UBM data. Therefore, we investigated an alternative robust and efficient solution for LID and SV tasks in this work.

We perform factor analysis (FA) on the pre-normalized centered GMM first-order statistics supervector to ensure each gaussian component's statistics sub-vector is treated equally in the factor analysis which reduces the computational cost significantly (by a factor of 25). In this way, each utterance is represented with one single pre-normalized supervector as the feature vector plus one total frame number to control its importance against the prior. Each component's sub-vector of statistics is normalized by its own occupancy probability square root, thus mitigating the mismatch between the global pre-calculated average weighting vector (Glembek et al., 2011 adopted the UBM weights) and each utterance's own occupancy probability distribution vector. Furthermore, since there is only one global total frame number inside the matrix inversion, we propose to pre-construct a global lookup table of the resulting matrices against the frame numbers’ log values; the reason to choose the log domain is that the smaller the total frame number, the more important it is against the prior. By looking at the table, each utterance's i-vector extraction is further sped up by a factor of 4 with only a small table index quantization error. The larger the table, the smaller this quantization error.

Moreover, as a single unsupervised method, i-vectors cover language, speaker, channel and other variabilities all together which necessarily requires variability compensation methods (both LDA and WCCN are linear) as the back end. This motivated us to investigate joint optimization to minimize the weighted summation of both the re-construction error and the linear classification error simultaneously. Compared to the sequential optimization used for traditional i-vectors, this proposed joint optimization can select the top eigen directions only related to the given labels. This can help reduce the non-relevant information in the i-vector space, such as noise and variabilities from undesired sources (e.g., non-language related factors for LID and session/channel/language related variabilities for SV).

In this work, the traditional i-vectors are extended to label-regularized supervised i-vectors by concatenating the label vector and the linear regression matrix at the end of the mean supervector and the i-vector factor loading matrix, respectively. There are some obvious extensions of this supervised i-vector framework. We can let the appended label vector be the parameter vector that we want to perform regression with (e.g., ages Li et al., 2012; Bahari et al., 2012, paralinguistic measures Schuller et al., 2013) to make the proposed framework suitable for regression problems. The reason for using a linear classification/regression matrix W is that many back end classification modules in LID and SV are linear (linear kernel SVM, inner product, WCCN, LDA, etc.). Moreover, if the classification or regression relation is not linear, we can use non-linear mapping as a preprocessing step before generating the label vectors. The contribution weight of each supervector dimension and each target class in the objective function is automatically calculated by iterative EM training. The traditional i-vector system serves as our baseline.

Finally, inspired by the success of robust features for noisy data based SV tasks (Shao and Wang, 2008; Lei et al., 2012), we also applied the auditory-inspired Gammatone frequency cepstral coefficients (GFCC) (Shao and Wang, 2008; Zhao and Wang, 2013) features and the spectro-temporal Gabor features (Kleinschmidt and Gelbart, 2002) for robust LID task on the noisy data as additional performance improvement steps. When fused with traditional MFCC and SDC feature based systems, the overall system performance was further enhanced.

The remainder of the paper is organized as follows. The baseline and the proposed algorithms are explained in Sections 2 and 3, respectively. Complexity analysis is given in Section 3.3. Experimental results and discussions are presented in Section 4 while conclusions are provided in Section 5.

In the total variability space, there is no distinction between the language effects, speaker effects and the channel effects. Rather than separately using the eigenvoice matrix V and the eigenchannel matrix U (Kenny et al., 2007b), the total variability space simultaneously captures the speaker and channel variabilities (Dehak et al., 2011a). Given a C component GMM UBM model λ with λ
                     
                        c
                     
                     ={p
                     
                        c
                     , 
                        μ
                              c
                           
                        
                     , 
                        Σ
                              c
                           
                        
                     }, c
                     =1, …, C and an utterance with a L frame feature sequence {
                        y1
                        
                     , 
                        y2
                        
                     , …, 
                        yL
                        
                     }, the 0th and centered 1st order Baum-Welch statistics on the UBM are calculated as follows:
                        
                           (1)
                           
                              
                                 N
                                 c
                              
                              =
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 L
                              
                              P
                              (
                              c
                              |
                              
                                 
                                    
                                       
                                          y
                                          t
                                       
                                    
                                 
                              
                              ,
                              λ
                              )
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          F
                                          c
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 L
                              
                              P
                              (
                              c
                              |
                              
                                 
                                    
                                       
                                          y
                                          t
                                       
                                    
                                 
                              
                              ,
                              λ
                              )
                              (
                              
                                 
                                    
                                       
                                          y
                                          t
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          μ
                                          c
                                       
                                    
                                 
                              
                              )
                           
                        
                     where c
                     =1, …, C is the GMM component index and P(c|
                        yt
                        
                     , λ) is the occupancy probability for 
                        yt
                        
                      on λ
                     
                        c
                     . The corresponding centered mean supervector 
                        
                           
                              
                                 F
                              
                           
                           ˜
                        
                      is generated by concatenating all the 
                        
                           
                              
                                 
                                    
                                       
                                          F
                                          c
                                       
                                    
                                 
                              
                           
                           ˜
                        
                      together:
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   c
                                                
                                             
                                          
                                       
                                    
                                    ˜
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       L
                                    
                                    P
                                    (
                                    c
                                    |
                                    
                                       
                                          
                                             
                                                y
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    λ
                                    )
                                    (
                                    
                                       
                                          
                                             
                                                y
                                                t
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                μ
                                                c
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       L
                                    
                                    P
                                    (
                                    c
                                    |
                                    
                                       
                                          
                                             
                                                y
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    λ
                                    )
                                 
                              
                              .
                           
                        
                     The centered GMM mean supervector 
                        
                           
                              
                                 F
                              
                           
                           ˜
                        
                      can be projected on a low rank factor loading matrix 
                        T
                      following the standard factor analysis framework as shown in Fig. 1
                     :
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                    
                                    ˜
                                 
                              
                              →
                              
                                 
                                    Tx
                                 
                              
                              ,
                           
                        
                     where 
                        T
                      is a rectangular total variability matrix of low rank and 
                        x
                      is the so-called i-vector (Dehak et al., 2011a). Considering a C-component GMM and D dimensional acoustic features, the total variability matrix 
                        T
                      is a CD
                     ×
                     K matrix which can be estimated the same way as learning the eigenvoice matrix 
                        V
                      in Kenny et al. (2005) except that here we consider that every utterance is produced by a new speaker or in a new language (Dehak et al., 2011a).

Given the centered mean supervector 
                        
                           
                              
                                 F
                              
                           
                           ˜
                        
                      and total variability matrix 
                        T
                     , the i-vector is computed as follows (Dehak et al., 2011a):
                        
                           (5)
                           
                              
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          I
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                T
                                                t
                                             
                                             
                                                Σ
                                                
                                                   −
                                                   1
                                                
                                             
                                             NT
                                          
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                          t
                                       
                                       
                                          Σ
                                          
                                             −
                                             1
                                          
                                       
                                       N
                                       
                                          
                                             
                                                
                                                   F
                                                
                                             
                                             ˜
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        N
                      is a diagonal matrix of dimension CD
                     ×
                     CD whose diagonal blocks are N
                     
                        c
                     
                     
                        I
                     , c
                     =1, …, C and 
                        Σ
                      is a diagonal covariance matrix of dimension CD
                     ×
                     CD estimated in the factor analysis training step. It models the residual variability not captured by the total variability matrix 
                        T
                      (Dehak et al., 2011a). The mathematical interpretation under the standard factor analysis framework is provided in Section 3.1.

In this total variability space, two channel compensation methods, namely Linear Discriminant Analysis (LDA) and Within Class Covariance Normalization (WCCN) (Hatch et al., 2006), are typically applied to reduce variability. LDA attempts to transform the axes to minimize the intra-class variance due to the variability effects and maximize the variance between classes while WCCN uses the inverse of the within-class covariance to normalize the cosine kernel. After LDA and WCCN steps, cosine distance is employed for i-vector modeling. The cosine kernel between two i-vectors 
                        x
                     
                     1 and 
                        x
                     
                     2 is defined as follows:
                        
                           (6)
                           
                              k
                              (
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    2
                                 
                              
                              )
                              =
                              
                                 
                                    <
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          2
                                       
                                    
                                    >
                                 
                                 
                                    ∥
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          1
                                       
                                    
                                    
                                       ∥
                                       2
                                    
                                    ∥
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          2
                                       
                                    
                                    
                                       ∥
                                       2
                                    
                                 
                              
                           
                        
                     Finally, PLDA or SVM is adopted as the classifier.

The i-vector training and extraction can be re-interpreted as a classic factor analysis based generative modeling problem. We can assume that the mean supervector is generated by the hidden variable i-vector. For the jth utterance, the prior and the conditional distribution is defined as following multivariate Gaussian distributions:
                           
                              (7)
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       0
                                    
                                 
                                 ,
                                 I
                                 )
                                 ,
                                 
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                      j
                                                   
                                                
                                                ˜
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             Tx
                                             j
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             N
                                             j
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                 
                                 )
                              
                           
                        therefore, the posterior distribution of the hidden variable i-vector 
                           x
                         given the observed 
                           
                              
                                 
                                    F
                                    ˜
                                 
                              
                           
                         is:
                           
                              (8)
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                             ˜
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                                
                                                   Σ
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   N
                                                   j
                                                
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             T
                                             t
                                          
                                          
                                             Σ
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             N
                                             j
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                                
                                                   Σ
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   N
                                                   j
                                                
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                        The mean of the posterior distribution (point estimate) is adopted as the estimation of i-vector.

As shown in Fig. 2
                        , the traditional i-vectors are extended to the label-regularized supervised i-vectors by concatenating the label vector and the linear regression matrix at the end of the mean supervector and the i-vector factor loading matrix, respectively. These supervised i-vectors are optimized not only to reconstruct the mean supervectors well but also to minimize the mean square error between the original and the reconstructed label vectors, and thus can make the supervised i-vectors become more discriminative in terms of the regularized label information.
                           
                              (9)
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       0
                                    
                                 
                                 ,
                                 I
                                 )
                                 ,
                                 
                                 P
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              F
                                                                              j
                                                                           
                                                                        
                                                                        ˜
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        L
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                          =
                                          N
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Tx
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Wx
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        N
                                                                        j
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                  
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                               j
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In (7), (8), (9), 
                           
                              
                                 
                                    
                                       x
                                       j
                                    
                                 
                              
                           
                           ,
                           
                              
                                 
                                    
                                       N
                                       j
                                    
                                 
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             F
                                             j
                                          
                                       
                                       ˜
                                    
                                 
                              
                           
                         and 
                           Lj
                           
                         denote the jth utterance's i-vector, 
                           N
                         vector, mean supervector and label vector, respectively. 
                           Σ
                        
                        1 and 
                           Σ
                        
                        2 denote the variance for CD dimensional mean supervector and M dimensional label vector, respectively. 
                           
                              n
                              j
                           
                           =
                           
                              ∑
                              
                                 c
                                 =
                                 1
                              
                              C
                           
                           
                              
                                 N
                                 cj
                              
                           
                         where N
                        
                           cj
                         denotes the N
                        
                           c
                         for the jth utterance. The reason for using a global scalar n
                        
                           j
                         is that each target class is treated equally in terms of frame length importance, the variance 
                           Σ
                        
                        2 is adopted to capture the variance and accuracy for each particular class.

We design two types of label vectors as follows (type 1 is mainly for identification purposes and type 2 is for verification tasks):
                           
                              (10)
                              
                                 
                                    Supervised
                                    
                                    type
                                    
                                    1
                                    :
                                 
                                 
                                 
                                    
                                       
                                          L
                                       
                                    
                                    ij
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                      utterance
                                                      
                                                       j
                                                      
                                                      is
                                                      
                                                      from
                                                      
                                                      class
                                                      
                                                       i
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                             
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        For type 1 label vectors, we want the regression matrix W to correctly classify the class labels. We denote the dimensionality of label vector L
                        
                           j
                         as M. Suppose there are H target classes (H languages for LID or H speakers for SV), L
                        
                           j
                         is an H (M
                        =
                        H) dimensional binary vector with only one non-zero element with the value of 1 and W is a M
                        ×
                        K linear regression matrix.
                           
                              (11)
                              
                                 
                                    Supervised
                                    
                                    type
                                    
                                    2
                                    :
                                 
                                 
                                 
                                    
                                       
                                          L
                                       
                                    
                                    j
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                
                                                   s
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                 
                                 .
                              
                           
                        Type 2 label vectors specify the sample mean vector of all the supervised i-vectors from the same class in the last iteration 
                           
                              
                                 
                                    
                                       x
                                       ¯
                                    
                                    
                                       
                                          s
                                          j
                                       
                                    
                                 
                              
                           
                         and let the regression matrix be an identity matrix (similar to the one in WCCN). The reason is to reduce the within class covariance and help all the supervised i-vectors to move towards their class sample mean. Therefore, M
                        =
                        K in this case.

The log likelihood of the total Γ utterances is:
                           
                              (12)
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 ln
                                 (
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                             ˜
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       
                                          ln
                                          
                                             
                                                
                                                   P
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                F
                                                                                                j
                                                                                             
                                                                                          
                                                                                          ˜
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          L
                                                                                          j
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  |
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          ln
                                          (
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                              
                           
                        Combining (9) and (12) together and removing non-relevant items, we can get the objective function J for the Maximum Likelihood (ML) EM training:


                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             Γ
                                          
                                          (
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  F
                                                                  j
                                                               
                                                            
                                                            ˜
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   1
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      N
                                                      j
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            L
                                                            j
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      W
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   2
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                n
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      L
                                                      j
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                W
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                       
                                          −
                                          
                                             1
                                             2
                                          
                                          ln
                                          (
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   1
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          |
                                          )
                                          −
                                          
                                             1
                                             2
                                          
                                          ln
                                          (
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   2
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          |
                                          )
                                          )
                                       
                                    
                                 
                              
                           
                        It is worth noting that we simply set 
                           T
                         and 
                           W
                         to be uncorrelated in order to get (13). The reason to make this simplification is that in the factor analysis generative model, given the i-vector 
                           x
                        , the mean supervector 
                           F
                         and label vector 
                           L
                         are conditionally independent.

For the E-step, we estimate E(
                           xj
                           
                        ) and E(
                           xjxj
                           
                        
                        
                           t
                        ):
                           
                              (14)
                              
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                                
                                                   Σ
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   N
                                                   j
                                                
                                                T
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   W
                                                   t
                                                
                                                
                                                   Σ
                                                   2
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             W
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             T
                                             t
                                          
                                          
                                             Σ
                                             1
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             N
                                             j
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             W
                                             t
                                          
                                          
                                             Σ
                                             2
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    j
                                 
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                                 =
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 
                                    
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                    
                                    t
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                                
                                                   Σ
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   N
                                                   j
                                                
                                                T
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   W
                                                   t
                                                
                                                
                                                   Σ
                                                   2
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             W
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        Then, for the M-step, we need to minimize the following expected objective function:


                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          E
                                          (
                                          J
                                          )
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             Γ
                                          
                                          (
                                          
                                             1
                                             2
                                          
                                          Tr
                                          [
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                          )
                                          ]
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      N
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          Tr
                                          [
                                          
                                             
                                                T
                                             
                                          
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      N
                                                      j
                                                   
                                                
                                             
                                          
                                          ]
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  F
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      N
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                       
                                    
                                    
                                       
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         L
                                                         j
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      2
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                j
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      L
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          Tr
                                          [
                                          
                                             
                                                W
                                             
                                          
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      2
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                j
                                             
                                          
                                          ]
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            L
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                      2
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                j
                                             
                                          
                                          
                                             
                                                W
                                             
                                          
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          )
                                          −
                                          
                                             1
                                             2
                                          
                                          ln
                                          (
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   1
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          |
                                          )
                                          −
                                          
                                             1
                                             2
                                          
                                          ln
                                          (
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   2
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          |
                                          )
                                          )
                                       
                                       
                                       
                                    
                                 
                              
                           
                        In deriving(16), we used 
                           Tr
                           [
                           
                              
                                 T
                              
                           
                           
                              
                                 
                                    
                                       x
                                       j
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                              
                              t
                           
                           
                              
                                 
                                    
                                       T
                                    
                                 
                              
                              t
                           
                           
                              
                                 
                                    
                                       Σ
                                       1
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       N
                                       j
                                    
                                 
                              
                           
                           ]
                           =
                           Tr
                           [
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                              
                              t
                           
                           
                              
                                 
                                    
                                       T
                                    
                                 
                              
                              t
                           
                           
                              
                                 
                                    
                                       Σ
                                       1
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       N
                                       j
                                    
                                 
                              
                           
                           
                              
                                 T
                              
                           
                           
                              
                                 
                                    
                                       x
                                       j
                                    
                                 
                              
                           
                           ]
                        . By setting the derivatives of E(J) towards 
                           T
                         and 
                           W
                         to be 0, we can get:
                           
                              (17)
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       
                                          
                                             N
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       
                                          
                                             N
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       n
                                       j
                                    
                                 
                                 
                                    
                                       W
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       n
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                              
                           
                        Since n
                        
                           j
                         is a scalar, the new 
                           W
                         matrix is updated as:
                           
                              (19)
                              
                                 
                                    Type
                                    
                                    1
                                    :
                                 
                                 
                                 
                                    
                                       
                                          W
                                       
                                    
                                    new
                                 
                                 =
                                 [
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       n
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                                 ]
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        Since the regression matrix 
                           W
                         in the type 2 setup is set to identity, we do not update 
                           W
                         for type 2 setup. For the 
                           T
                         matrix, we followed the strategy used in Dehak et al. (2011a) to update component by component since N
                        
                           cj
                         is also a scalar.
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                                c
                                             
                                          
                                       
                                    
                                    new
                                 
                                 =
                                 [
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       N
                                       cj
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   cj
                                                
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    t
                                 
                                 )
                                 ]
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       
                                          
                                             N
                                             cj
                                          
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        In (20), 
                           Tc
                           
                         denotes the [(c
                        −1)D
                        +1:
                        cD] rows sub-matrix of 
                           T
                         and 
                           
                              
                                 
                                    
                                       
                                          F
                                          cj
                                       
                                    
                                 
                              
                              ˜
                           
                         is the [(c
                        −1)D
                        +1:
                        cD] elements sub-vector of 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                 
                              
                              ˜
                           
                        . Similarly, by setting 
                           
                              
                                 ∂
                                 E
                                 j
                              
                              
                                 ∂
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             1
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 ∂
                                 E
                                 j
                              
                              
                                 ∂
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                           
                         to be 0, we can get:
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       diag
                                       {
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   N
                                                   j
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                         j
                                                      
                                                   
                                                
                                             
                                             ˜
                                          
                                       
                                       −
                                       
                                          
                                             
                                                T
                                             
                                          
                                          new
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       }
                                    
                                    Γ
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    Type
                                    
                                    1
                                    :
                                 
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       diag
                                       {
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       (
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                W
                                             
                                          
                                          new
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         L
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       }
                                    
                                    Γ
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    Type
                                    
                                    2
                                    :
                                 
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       diag
                                       {
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       (
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         L
                                                         j
                                                      
                                                   
                                                
                                             
                                             −
                                             E
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                             )
                                             )
                                          
                                          t
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                       
                                       −
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                       )
                                       )
                                       }
                                    
                                    Γ
                                 
                              
                           
                         These 2 variance vectors describe the energy that cannot be represented by factor analysis and control the importance in the joint optimization objective function (13). Σ
                        2 for the type 2 label vectors is just the diagonal elements of the within class covariance matrix in WCCN. After several iterations of EM training, the parameters are learned. For the subsequent supervised i-vector extraction, we let 
                           Σ
                        
                        2 to be infinity since we do not know the ground truth label information. This will make (14) converge back to (5). After the supervised i-vector extraction, the classification methods steps are the same as in the traditional i-vector modeling.

There are some obvious extensions of this supervised i-vector framework. We can make 
                           L
                         as the parameter vector that we want to perform regression with and this can make the proposed framework suitable for regression problems. Moreover, if the classification or regression relation is not linear, we can use non-linear mapping as a preprocessing step before generating 
                           L
                        .

I-vector training and extraction is computationally expensive. Consider the GMM size, feature dimension, factor loading matrix size to be C, D, and K, respectively. The complexity for generating a single i-vector is O(K
                        3
                        +
                        K
                        2
                        C
                        +
                        KCD) (Glembek et al., 2011). As shown in Table 1
                         (K
                        =600, C
                        =2048, D
                        =56), the K
                        2
                        C term dominates the overall complexity. In this work, we make two approximations to reduce the complexity.

The K
                        3 term comes from the matrix inversion while the K
                        2
                        C term is from 
                           TtΣ−1NjT
                         in (5). When C is large, this K
                        2
                        C term's computational cost is huge. The fundamental reason is that each Gaussian component λ
                        
                           c
                         has different N
                        
                           c
                         for each utterance j which means some sub-vectors 
                           
                              
                                 
                                    
                                       
                                          F
                                          cj
                                       
                                    
                                 
                              
                              ˜
                           
                         have less variance than others in 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                 
                              
                              ˜
                           
                         and need utterance specific intra mean supervector re-weighting in the objective function. We first decompose the 
                           Nj
                           
                         vector into 
                           Nj
                           
                        
                        =
                        n
                        
                           j
                        
                        
                           m
                                 j
                              
                           
                         where 
                           
                              n
                              j
                           
                           =
                           
                              ∑
                              
                                 c
                                 =
                                 1
                              
                              C
                           
                           
                              
                                 N
                                 cj
                              
                           
                        , m
                        
                           cj
                        
                        =
                        N
                        
                           cj
                        /n
                        
                           j
                         and 
                           
                              ∑
                              
                                 c
                                 =
                                 1
                              
                              C
                           
                           
                              m
                              cj
                           
                           =
                           1
                        . 
                           mj
                           
                         is the re-weighting vector and n
                        
                           j
                         (total frame number) controls the confidence at the global level. Our motivation is to re-weight each utterance's mean supervector with its own (
                           mj
                           
                        )1/2 before the factor analysis step which makes each dimension of the new supervector 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                 
                              
                              ˆ
                           
                         be treated equally in the approximated modeling (25).
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          =
                                          diag
                                          (
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         L
                                                      
                                                      P
                                                      (
                                                      c
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      λ
                                                      )
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            c
                                                            =
                                                            1
                                                         
                                                         C
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         L
                                                      
                                                      P
                                                      (
                                                      c
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      λ
                                                      )
                                                   
                                                
                                                ]
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   L
                                                
                                                P
                                                (
                                                c
                                                |
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                ,
                                                λ
                                                )
                                                (
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            c
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   L
                                                
                                                P
                                                (
                                                c
                                                |
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                ,
                                                λ
                                                )
                                             
                                          
                                          =
                                          diag
                                          (
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         N
                                                         cj
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                         j
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   L
                                                
                                                P
                                                (
                                                c
                                                |
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                ,
                                                λ
                                                )
                                                (
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            c
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   L
                                                
                                                P
                                                (
                                                c
                                                |
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            t
                                                         
                                                      
                                                   
                                                
                                                ,
                                                λ
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          =
                                          diag
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                 
                              
                           
                        So the intra supervector imbalance is compensated by this pre-weighting, and each utterance is represented by 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                 
                              
                              ˆ
                           
                         as the general feature vector and n
                        
                           j
                         as the confidence value for the subsequent machine learning algorithms. We perform factor analysis in the following way by linearly projecting this new normalized supervector 
                           
                              
                                 
                                    F
                                 
                              
                              ˆ
                           
                         on a dictionary 
                           
                              
                                 
                                    
                                       T
                                    
                                 
                              
                              ˆ
                           
                        :
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                Tx
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 ,
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       0
                                    
                                 
                                 ,
                                 I
                                 )
                                 ,
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                      j
                                                   
                                                
                                                ˆ
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             
                                                T
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             m
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             
                                                T
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             m
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       
                                          
                                             
                                                T
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    n
                                    j
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                 
                                 )
                              
                           
                        Therefore, the posterior distribution of the i-vector 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                              
                              ˆ
                           
                         given the observed 
                           
                              
                                 
                                    F
                                    ˆ
                                 
                              
                           
                         is:
                           
                              (26)
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 N
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         t
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    j
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         t
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                        From the above equation, we can find that the complexity is reduced to O(K
                        3
                        +
                        KCD) since n
                        
                           j
                         is not dependent on any GMM component. By replacing the 1st GMM statistics supervector 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                 
                              
                              ˜
                           
                         with the pre-normalized supervector 
                           
                              
                                 
                                    
                                       
                                          F
                                          j
                                       
                                    
                                    ˆ
                                 
                              
                           
                         and setting 
                           Nj
                           
                         to a scalar n
                        
                           j
                        , the i-vector training equations become the proposed simplified i-vector solution.

Moreover, since the entire term 
                           
                              
                                 (
                                 
                                    
                                       I
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    j
                                 
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                              
                              
                                 −
                                 1
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                             t
                                          
                                       
                                    
                                 
                                 ˆ
                              
                           
                           
                              
                                 
                                    
                                       Σ
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                         in (26) only depends on the scalar total frame number n
                        
                           j
                        , we can create a global table of this quantity against the log value of n
                        
                           j
                        . The reason to choose log domain is that the smaller the total frame number, the more important it is against the prior. If n
                        
                           j
                         is very large compared to the prior, then the two n
                        
                           j
                         get canceled. By enabling the table lookup, the complexity of each utterance's i-vector extraction is further reduced to O(KCD) with a small table index quantization error. The larger the table, the smaller this quantization error. Fig. 3
                         shows the quantization distance curve. We can see that the quantization error is relatively small when n
                        
                           j
                         is small.

In this work, we also derived the simplified supervised i-vector modeling's solution as follows:
                           
                              (27)
                              
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         t
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   W
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   2
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                W
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                             1
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    j
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             W
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                             2
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    j
                                 
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (28)
                              
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    t
                                 
                                 )
                                 =
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 )
                                 
                                    
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                    
                                    t
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                         t
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   W
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                   2
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          j
                                       
                                       
                                          
                                             
                                                W
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          W
                                       
                                    
                                    new
                                 
                                 =
                                 [
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       n
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                             j
                                          
                                       
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    t
                                 
                                 )
                                 ]
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          t
                                       
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    new
                                 
                                 =
                                 [
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    Γ
                                 
                                 
                                    
                                       n
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   j
                                                
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          ˆ
                                       
                                    
                                    t
                                 
                                 )
                                 ]
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          t
                                       
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       diag
                                       {
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       (
                                       
                                          n
                                          j
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                         j
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          new
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   ˆ
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       }
                                    
                                    Γ
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       diag
                                       {
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          Γ
                                       
                                       (
                                       
                                          
                                             n
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                W
                                             
                                          
                                          new
                                       
                                       E
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            L
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          t
                                       
                                       )
                                       }
                                    
                                    Γ
                                 
                              
                           
                        Since the label vector dimensionality M
                        <<
                        CD, the complexity is almost the same as previously shown, O(CDK). It is worth noting that for best accuracy, we only perform approximation using the global table for training purposes. When in testing mode, (27) is still employed (with 
                           
                              Σ
                              2
                              
                                 −
                                 1
                              
                           
                           =
                           0
                        ). All the experimental results based on simplified i-vector or simplified supervised i-vector in Section 4 are generated in this way.

The complexity of the proposed methods for a single utterance is shown in Table 1. We use both LID and SV examples to demonstrate the efficiency of the proposed methods. We can see that the proposed simplified and simplified supervised i-vector systems achieve significant complexity cost reduction (by more than a factor of 100) which has a potentially large impact on mobile devices implementation.

@&#EXPERIMENTAL RESULTS@&#

In this section, we will evaluate the proposed methods on three different LID and SV databases, namely the DARPA RATS, the NIST LRE 2007 and the NIST SRE 2010. First, we present the corpus, classification tasks, feature extraction and score level fusion in Section 4.1. Then experimental results and discussion are provided in Section 4.2. For the DARPA RATS based LID task, we also provide the details of the USC RATS LID submission system and compare with other state-of-the-art systems.

We first use the DARPA Robust Automatic Transcription of Speech (RATS) data corpus (Walker and Strassel, 2012; Matejka et al., 2012; DARPA, 2012; RATS, 2012; Han et al., 2013)
                              1
                           
                           
                              1
                              http://www.darpa.mil/Our_Work/I2O/Programs/Robust_Automatic_Transcription_of_Speech_(RATS).aspx (please copy the full url including those underscores).
                            to evaluate the proposed methods for LID under noisy channels. Each speech recording was collected through various degraded, weak and/or noisy communication channels (labeled A through H), all with low varied SNR. The audio file format is 16-kHz 16-bit PCM MS WAV/RIFF with lossless FLAC compression. In this LID task, each testing sample of speech needs to be scored on every target language hypothesis (a target language of interest to be detected). In other words, the task is to decide whether that target language was in fact spoken in the given sample (“yes” or “no”) based on an automated analysis of the speech signal. Multiple “yes” answers for a single testing sample are allowed. So we used equal error rate (EER), miss rate with 10% false alarm,
                              2
                           
                           
                              2
                              This point in the DET curve is required in the task.
                            minimum average cost C
                           
                              avg
                           
                           
                              3
                           
                           
                              3
                              
                                 C
                                 
                                    avg
                                  is the official evaluation measure for RATS database. C
                                 
                                    avg
                                  is defined in the NIST LRE 2009 evaluation plan with C
                                 
                                    Miss
                                 
                                 =
                                 C
                                 
                                    FalseAlarm
                                 
                                 =1, P
                                 
                                    target
                                 
                                 =0.5, P
                                 
                                    outofset
                                 
                                 =0.2, http://www.itl.nist.gov/iad/mig/tests/lre/2009/.
                            and Detection Error Trade-off (DET) curve as the metrics for evaluation.

It can be observed from Fig. 4
                            that the speech signals can be highly noisy and degraded with significant SNR variability. As a preprocessing step, we performed Speech Activity Detection (SAD) on the raw signal to obtain the speech boundaries. The data set used to train the SAD system is the corpus provided by LDC for the RATS project (DARPA, 2012; RATS, 2012). We used the Multi-Resolution Long-term spectral variability (MR-LTSV) SAD system which uses various resolutions of the LTSV feature originally proposed in Ghosh et al. (2011) and updated in Tsiartas et al. (2013). The classifier we used to classify a frame as speech/non-speech is the K-NN classifier (Cover and Hart, 1967). The parameters of the MR-LTSV features and the number of optimal neighbors of K-NN have been optimized on five randomly picked files for training and five randomly picked files for developing for each channel A-H, given in the RATS corpus. Approximately, the parameters have been optimized on 1h of training and 1h of developing data for each channel. In addition, we have used 100ms frame shift and smoothed the per frame decision using a median filter as described in Ghosh et al. (2011).

We extracted 3 different features on 8K re-sampled valid speech data which have been reported to be useful in the noisy channel LID or SV task, namely MFCC-SDC, MFCC, Gammatone frequency cepstral coefficients (GFCC). For MFCC-SDC feature extraction, a 25ms Hamming window with 10ms shifts was adopted. Each utterance was converted into a sequence of 56-dimensional MFCC SDC feature vectors (Torres-Carrasquillo et al., 2002a), each consisting of a 49 SDC (7-1-3-7) features and 7 MFCC coefficients including C0. We also extracted the 36 dimensional MFCC features consisting of 18 MFCC coefficients and their first derivatives. For the robust LID task on noisy data, we applied the GFCC features as an additional auditory-inspired feature set (Shao and Wang, 2008) in conjunction with the conventional MFCCs and SDCs. 44 dimensional GFCC features using 64 filter banks (22 dimensional GFCCs without C0 and their first derivatives) were generated. It is shown in Fig. 5
                            that GFCC features have more detailed resolution on the low dimensional part of the frequency response and performed better than MFCC features for the robust SV task on a variety of low SNR conditions (Shao and Wang, 2008). In this work, when fused with traditional MFCC feature based systems, the overall system performance was found to be enhanced.

LIBLINEAR (Fan et al., 2008) was employed for the logistic regression (LR) based back end classification. The target and nontarget languages are shown in Table 2
                           . The training data for target and nontarget languages are from ldc2011e111 and ldc2012e03 (Matejka et al., 2012), respectively. The training data was also randomly ten times sub-sampled at the feature level as the UBM training data. The UBM GMM model size is 2048. The dev2 data set from ldc2012e06 is employed as the evaluation data set. Our focus is on the 120s and 30s tasks with 1914 and 1782 testing segments, respectively. The recording sample number for each target language in the 120s task is shown in Table 3
                           . There is a verification trial on every target language for each testing segment which results in 9570 and 8910 trials in total. The major parameters in this work are defined in Table 1.

Due to the limited amount of development data, we simply employed the weighted summation fusion approach with parameters tuned by cross validation. Let there be G input subsystems where the ith subsystem outputs its own posterior probability vector l
                           
                              i
                           (
                              y
                           ) for every trial. Then the fused score vector 
                              
                                 l
                                 ´
                              
                              (
                              
                                 
                                    y
                                 
                              
                              )
                            is given by:
                              
                                 (33)
                                 
                                    
                                       l
                                       ´
                                    
                                    (
                                    
                                       
                                          y
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       G
                                    
                                    
                                       η
                                       i
                                    
                                    
                                       l
                                       i
                                    
                                    (
                                    
                                       
                                          y
                                       
                                    
                                    )
                                 
                              
                           The weight, η
                           
                              k
                           , can be tuned by validation data. For the LR system in the LID task, log-likelihood normalization was adopted to map the log likelihood scores into the posterior probabilities (Li et al., 2012).

It is worth noting that in our official submission system (described in Section 4.1.2), the linear logistic regression based fusion module in the FoCal toolkit (Brümmer, 2007) is adopted to increase the performance.

In this section, we provide the details of our USC LID submission system for RATS evaluation phase 2 which is also based on the proposed simplified supervised i-vector representation. Compared to the in house evaluation system described in the previous section, this submission system employed the Wiener filter and IBM VAD as front end processing, and replaced the LR kernel from linear to polynomial for back end classification. Furthermore, spectro-temporal Gabor features are also included as an additional feature set and fused at the score level. Linear logistic regression in the FoCal toolkit (Brümmer, 2007) is adopted here for fusion. All these modifications together lead to competitive performance and we adopt this result to compare with other start-of-the-art systems for all 4 duration conditions in Table 9.

In addition to the noisy channels based DARPA RATS data, we adopted the 2007 NIST Language Recognition Evaluation (LRE) (NIST, 2007) 30s closed set general task as the evaluation database for clean channel LID. There are 14 target languages and the valid speech in each testing utterance is about 30s long. Data of target languages from Call Friend, OGI Multilingual, OGI 22 languages, NIST LRE 1996, NIST LRE 2003, NIST LRE 2005, NIST LRE 2007 supplemental training as well as a subset of NIST SRE 2004–2006 were used as our training data. We first extracted the same 56 dimensional MFCC-SDC feature as described in Section 4.1.1; then employed a Czech phoneme recognizer (Schwarz et al., 2006) to perform speech activity detection by simply dropping all feature frames that are decoded as silence or noises. We divided the features of each training conversation into multiple 30s (3000 frames) segments. There are totally 81848 training segments, 2158 testing utterances, and 30212 testing trials. A 2048 components GMM UBM model was trained from 20000 training segments randomly selected from the training data. After GMM statistics vectors were calculated, the proposed simplified i-vector, simplified supervised i-vector as well as the i-vector baseline were applied. The back end variability compensation method (WCCN) and the classification method (both linear and 2nd polynomial kernel LR) are the same as in the DARPA RATS experiments. There is no score level fusion since we only adopted one feature set and one classifier. The performance is reported in optimum average cost C
                           
                              avg
                            value as suggested by NIST (2007).

We also performed experiments on the NIST SRE 2010 (NIST, 2010) for SV tasks. Our focus is the female part of the common condition 5 (a subset of tel-tel) in the core task. We used EER, the normalized old minimum decision cost value (norm old minDCF) and norm new minDCF as the metrics for evaluation (NIST, 2010). For cepstral feature extraction, a 25ms Hamming window with 10ms shifts was adopted. Each utterance was converted into a sequence of 36-dimensional feature vectors, each consisting of 18 MFCC coefficients and their first derivatives. We applied the same Czech phoneme recognizer (Schwarz et al., 2006) as the one employed in our NIST LRE 2007 experiments for VAD. Feature warping is applied to mitigate variabilities.

The training data for the NIST SRE 2010 task included Switchboard II part1 to part3 and NIST SRE 2004, 2005, 2006 and 2008 corpora on the telephone channel. The description of the dataset used in each step is provided in Table 4
                           . The gender-dependent GMM UBMs consist of 1024 mixture components. The JFA baseline system (Kenny et al., 2007a,b, 2008) is trained using the BUT toolkit (Burget et al., 2008) and linear common channel point estimate scoring (Glembek et al., 2009) is adopted. The speaker factor size and channel factor size is 300 and 100, respectively. ZTnorm was applied on the JFA subsystem while Snorm was employed in the i-vector subsystem. The PLDA implementation is based on the UCL toolkit (Prince and Elder, 2007) where the sizes of speaker loading matrix U and variability loading matrix G are 250 and 80, respectively. Simple weighted linear summation is adopted here as the score level fusion. Other parameter settings are reported in the caption of Table 1.

@&#RESULTS AND DISCUSSION@&#

The performances of the proposed methods on three feature sets for in house LID evaluation are shown in Tables 5
                            and 6
                           . First, we can observe that WCCN worked well to compensate the variability for most systems. This makes sense since there are 8 highly degraded communication channels for each language. Second, the simplified i-vector achieved comparable results to the i-vector baseline showing only a small degradation in classification. Third, the simplified supervised i-vector outperformed the simplified i-vector dramatically.

Before WCCN was applied, the simplified supervised i-vector systems on all three feature sets outperformed the simplified i-vector systems by more than 10% relatively in terms of EER. After WCCN was adopted for variability compensation, for MFCC 36 dimensional features and GFCC 44 dimensional features, the simplified supervised i-vector still achieved 10%–20% relative error reduction and more than 100 times faster compared to the i-vector baseline. For MFCC-SDC 56 dimensional features, the improvement is more reflected on the min C
                           
                              avg
                            cost values which servers as the official performance measure for RATS.

Moreover, we also observed significant error reduction by fusing 3 feature sets based systems together in Table 7
                           . Fig. 7 shows the DET curves for each feature set as well as the 3 feature set fusion. The fusion system achieved 3.7% EER and 7.6% EER for 120s and 30s tasks, respectively.

In this subsection, we show the results of the USC RATS phase 2 LID submission System on the dev2 sets for all four duration settings in Table 8
                           . As shown in Fig. 6
                           
                            and Section 4.1.2, this system still utilized the proposed simplified supervised i-vector for representation and adopted 4 different feature sets. Compared to the in house evaluation system, this system has better front end processing (Wiener filtering), VAD schemes, newly included spectro-temporal Gabor features, polynomial kernel based LR classification and linear logistic regression based fusion methods. All these modifications lead to a significant performance improvement compared to the aforementioned in house evaluation.

In Table 8, we can observe that score level fusion reduced the error rate dramatically the same way as in the previous in house evaluation which demonstrates that these different feature sets are complementary. Fig. 8
                            shows the EER performance of each individual channel in the LID RATS dev2 120s task. In this task, there is no testing file from channel “D” and “all” means the combined standard testing scenario whose results are the same as the ones in Table 8. First, we can see that fusion improves the performance not only for the combined “all” setting but also for each individual noisy channel which indicates the robustness of different feature sets fusion. Second, each feature set performs differently on different channels and no single one is always better than others. For example, MFCC-SDC outperforms MFCC on channel “A,C,H” but vice versa on channels “E,F,H”; GABOR feature performs the best on channels “A,E” but the worst on channels “B,H”. This diverse performance pattern makes the fusion work and motivates us to consider channel specific fusion in our future work.

Compared to the state-of-the-art systems in Table 9
                           , the proposed methods achieved comparable and competitive results for all four durations. Furthermore, by further combining with IBM's systems at the score level, the IBM-USC joint system achieved 5%–13% relative EER reduction against the latest IBM system.

The performance results on the NIST LRE 2007 30s general task are shown in Table 10
                           . We can find out that the proposed simplified supervised i-vector modeling outperformed the i-vector baseline in both recognition performance and computational cost under the clean channel condition and with more target languages. Furthermore, 2nd order polynomial kernel performed better than the linear kernel in the logistic regression based back end classification.

The results of the i-vector baseline and the proposed supervised i-vector, simplified i-vector as well as the simplified supervised i-vector methods for SV tasks are shown in Table 11
                           . We can observe that LDA, PLDA, and Snorm contributed to increase the performance for all the systems. WCCN reduced the EER by more than 40% for all systems except the type 2 simplified supervised i-vector (T2SSIV). For T2SSIV, WCCN is not that important since the label regularized joint optimization already includes the within class covariance in the objective function (see (11, 13, 14, 23)). This was reflected by a 30% EER reduction (I-vector 9.02%, T2SSIV 6.45%) in the cosine distance raw scoring without any back end processing.

Furthermore, type 1 supervised i-vector (T1SUP-IV) and type 1 simplified supervised I-vector (T1SSIV) outperformed i-vector and simplified i-vector by 5%-10% relatively for all the modeling configurations (3.37% and 3.45% EER vs 2.95% and 3.13% EER). Also as shown in Table 12
                            (ID 6 vs 5), after fusing with JFA baseline, supervised i-vector still outperformed the i-vector baseline by 9% relative EER reduction. Therefore, adding label information in the i-vector training indeed improves the performance. The lower improvement of T2SSIV compared to T1SSIV might be due to the diagonal version of Σ
                           2 against the triangular WCCN matrix.

Moreover, simplified supervised i-vector systems (T1SSIV and T2SSIV) achieved better EER but worse norm cost compared to the i-vector baseline. However, the computational cost is reduced by a factor of 120. And after fusing with the JFA system (Table 12 ID 7 vs 5), this gap is reduced to only 3% to 6% relatively. Therefore, simplified supervised i-vector has the potential to replace the computationally expensive i-vector baseline when fusing with the JFA system.

It is worth noting that the supervised version of all the systems only performed better on EER and norm old minDCF values. How to further reduce the norm new minDCF is our current focus. Future work also includes applying the non-simplified type 2 supervised i-vector as well as evaluating different label vector designs.

Simplified i-vector and supervised i-vector play different roles in the system and behave differently in terms of error rate and computational cost. First, from Table 1, we can observe that simplified i-vector achieved significant complexity cost reduction (by more than a factor of 100). But it does not improve the recognition performance and in most cases it slightly degrades the baseline result due to the simplification. In Table 11, after all the back end processing (LDA, WCCN, PLDA, Snorm), simplified i-vector degraded the EER results by relatively 2.4% compared to the i-vector baseline. Second, the performance improvements come from the supervised i-vector. In Table 11 after back end processing, supervised i-vector alone achieved 12.5% relative EER reduction (3.37% to 2.95%) while simplified supervised i-vector only reduced the baseline EER by relatively 9.2% (3.37% to 3.06%) but with more than 100 times increase in speed. Third, by comparing the results of system ID 5 and 6 in Table 12, we discover that the performance improvement from supervised i-vector is preserved after the fusion with JFA. Finally, these two techniques could be combined together as simplified supervised i-vector to achieve comparable or better recognition performance against the i-vector baseline and at the same time reduce the computational cost by a factor of more than 100.

@&#CONCLUSIONS@&#

This paper presented a robust and efficient approach using simplified and supervised i-vector modeling with applications to automatic language identification (LID) and speaker verification (SV). Several new algorithmic and computational modeling ideas are proposed. First, by concatenating the label vector and the linear regression matrix at the end of the mean supervector and the i-vector factor loading matrix, respectively, the traditional i-vectors are extended to the label-regularized supervised i-vectors. These supervised i-vectors are optimized not only to reconstruct the mean supervectors well but also to minimize the mean square error between the original and the reconstructed label vectors; this can thus make the supervised i-vectors become more discriminative in terms of the regularized label information. Second, factor analysis (FA) is performed on the pre-normalized GMM first order statistics supervector to ensure each gaussian component's statistics sub-vector is treated equally in the FA which reduces the computational cost by a factor of 25. Further computational improvement is obtained by pre-computing a global cache table of the resulting matrices against the total frame numbers’ log values. By using the lookup table, each utterance's i-vector extraction is further sped up by another factor of 4 with just a small table index quantization error. The larger the table, the smaller this quantization error. Third, simplified and supervised i-vector modeling can be used together as the simplified supervised i-vector which outperforms the i-vector baseline in terms of both robustness and efficiency. The solutions for training and extracting these simplified version i-vectors are provided for both the traditional unsupervised and the proposed supervised i-vectors. Finally, Gammatone frequency cepstral coefficients (GFCC) and Gabor features are adopted as yet additional (complementary) auditory-inspired and spectro-temporal features for LID. By fusing GFCC and Gabor features with the traditional MFCC and SDC features based systems, overall LID performance is improved significantly.

@&#REFERENCES@&#

