@&#MAIN-TITLE@&#Ranking evaluation of institutions based on a Bayesian network having a latent variable

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Institutions will be ranked based on a set of performance indicators.


                        
                        
                           
                           A Bayesian network is constructed having a latent variable.


                        
                        
                           
                           Linear Gaussian models are used to express the causal relation among variables.


                        
                        
                           
                           An interval estimate of the ranking of an institution is obtained.


                        
                        
                           
                           A real case and a simulation study are considered.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ranking estimation

Linear Gaussian model

Structure learning

Gibbs sampling

Multiple search

Causal discovery

@&#ABSTRACT@&#


               
               
                  This paper proposes a new probabilistic graphical model which contains an unobservable latent variable that affects all other observable variables, and the proposed model is applied to ranking evaluation of institutions using a set of performance indicators. Linear Gaussian models are used to express the causal relationship among variables. The proposed iterative method uses a combined causal discovery algorithm of score-based and constraint-based methods to find the network structure, while Gibbs sampling and regression analysis are conducted to estimate the parameters. The latent variable representing ranking scores of institutions is estimated, and the rankings are determined by comparing the estimated scores. The interval estimate of the ranking of an institution is finally obtained from a repetitive procedure. The proposed procedure was applied to a real data set as well as artificial data sets.
               
            

@&#INTRODUCTION@&#

Ranking higher education institutions began in the United States in the early 20th century, and it has become increasingly more influential with time. Most ranking systems select the performance indicators (research, education, etc.), assign a weight to each indicator and calculate the weighted score for each institution; this is the ‘weight-and-sum’ approach. However, this method sometimes becomes controversial because assigning weights to performance indicators is subjective. Thus demand for a new quantitative method of ranking is on the rise although there are many issues other than raking methods as pointed out in Vught and Westerheijden [34].

Some studies have used approaches other than the weight-and-sum approach to rank institutions. These methods include an empirical Bayes approach to ranking schools based on student achievement [18], Bayesian analysis for ranking institutions [15], a latent-variable technique for university ranking based on several indicators [16] and the analytic hierarchy process for determining weights of indicators [23]. In addition, a method based on a supervised naïve Bayes structure uses the mixture of truncated exponentials, which applies the rank information of an expert [12]. A Bayesian latent variable model has been proposed for estimating the top ranked SNPs detected from genetic association studies [13], which may also be applied to the institution ranking problem.

When using the ranking evaluation systems other than the weight-and-sum approach, a structure analysis is necessary which considers the relationship among performance indicators. However, few studies have been conducted on the structure analysis for ranking evaluation. The ordinary modeling techniques for the structure analysis are structural equation models (SEMs) based either on linear structure relationships or partial least squares and Bayesian networks (BNs) [20]. Especially, BNs can be used as probabilistic inference engines, building models of domains that have intrinsic uncertainty. BNs are graphical models based on the notion of conditional independence that subsumes a wide range of statistical models including regression models, factor analysis models, and structural equation models. In a BN, a directed acyclic graph (DAG) represents a set of conditional independence constraints among a given number of variables and their related conditional probability distributions. The procedures for developing BNs involve learning the structure (the relationships between variables) first, and then parameterizing the associated conditional distributions. Graphical models, in particular those based on DAGs, have natural causal interpretations and thus form a language in which causal concepts can be discussed and analyzed in precise terms [21]. The conditional independence assumptions in a BN yield models more compact than those based on full joint probability distributions, thus reducing computational complexity when the number of variables is large [30]. Lately, BNs have been used in various applications such as risk management [3], resource allocation decisions [10,11], IT implementation [20], species distribution [1], higher education [12], and health risk assessment [22].

In this paper, we propose a new Bayesian network model which has an unobservable latent variable that affects all other observable variables. To solve the ranking problem, the latent variable represents the ranking variable to be finally estimated, and the observable variables indicate performance indicators of each institution. Our first task is to identify the causal relation among these variables, and the second task is to determine the institution rankings in terms of intervals.

Causal discovery algorithms (CDAs) for a BN can be classified into three different categories: the score-based approach, the constraint-based approach, and the combined approach [35]. Score-based methods select a model with the highest posterior probability when the prior of each model is given. Constraint-based methods use statistical methods to detect associations and independencies among variables. Each method has a trade-off between time complexity and accuracy. Score-based methods generally provide accuracy but their time complexity is very high. Constraint-based methods give much lower time complexity, but they may not be accurate if conditional independence (CI) tests fail. The combined methods use both concepts to build the graph by compromising the benefit in terms of time complexity and accuracy. These methods cannot be directly applied to our new graphical model which has a latent variable, so a new approach needs to be developed for our purpose.

The proposed approach consists of two phases and each phase is repeated until the network structure converges. First, latent rankings are obtained using Gibbs sampling and gradient descent from a given network structure. Second, the updated network structure is found by the revised version of Multiple Search (MS) algorithm [7] using the latent rankings. The final rankings in terms of interval estimates are obtained based on the convergent structure.

The rest of the paper is organized as follows. The BN under consideration is modeled in Section 2. The proposed method of learning the BN is described in Section 3. The proposed method is applied to real data in Section 4. Section 5 reports on a further experiment with artificial data to check the accuracy and consistency of the proposed new Bayesian network model. Conclusions are presented in Section 6.

Our ranking problem is to assign a ranking to each of the given number of institutions based only on their performance indicators. For this purpose we will consider a new type of BN as shown in Fig. 1
                     . The difference from the usual BN is to contain an unobservable latent variable that affects all other observable variables. Let X
                     
                        i
                      (i
                     =1,2,…,
                     m) be the ith variable where m is the number of variables. These variables are performance indicators for our ranking problem. They are assumed to be observable for each institution, and they may have causal relationships among themselves. Let Z be an unobservable latent variable that affects all other variables. Without the latent variable Z, the network will be the same as a usual graphical model. For our ranking problem, Z
                     
                        j
                      (j
                     =1,2,…,
                     n) represents the unobservable ranking score of the jth institution, where n is the number of institutions. Hence, our problem is to estimate the ranking scores of all institutions by considering the causal relationship among observable performance indicators. Once the ranking scores of all institutions are estimated, the ranking will be determined by comparing the scores’ magnitudes.

Consider an arbitrary DAG in which node i represents a continuous random variable X
                        
                           i
                         that has a Gaussian distribution. Then, under the linear Gaussian model, the conditional distribution of X
                        
                           i
                         given its parent node pa
                        
                           i
                         is also Gaussian:
                           
                              (1)
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       
                                          
                                             pa
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ∼
                                 N
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         pa
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where w
                        
                           ij
                         and b
                        
                           i
                         are parameters that govern the relationship of 
                           
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              →
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                        , and v
                        
                           i
                         is the conditional variance of X
                        
                           i
                        .

A DAG ‘G’ depicts a set of variables, X
                        1,
                        X
                        2,…,
                        X
                        
                           m
                        , and their relationships. Each node of G is a variable, and the directed arcs represent the parental relationships among the variables. The joint probability distribution of G is
                           
                              (2)
                              
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 |
                                 G
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             pa
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 G
                                 )
                              
                           
                        where p (x
                        1,
                        x
                        2,…,
                        x
                        
                           m
                        ∣G) represents the probability distribution of a specific combination x
                        1,
                        x
                        2,…,
                        x
                        
                           m
                         from the variables X
                        1,
                        X
                        2,…,
                        X
                        
                           m
                        , and 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         is a vector that represents the list of direct parents of X
                        
                           i
                        , as depicted by G. BNs are locally structured, meaning that each node interacts only with its parent nodes.

For a given structure G under consideration, we estimate its parameters in Eq. (1) and derive the distribution of the latent variable Z
                        
                           j
                        . Because our graphical model includes a latent variable, the existing method cannot be applied. So, we developed a new procedure, which will be described in Section 3.

If the structure of the BN is not known, the underlying structure of the BN given by G must be learned. This structure includes the specifications for the conditional independence assumptions among the variables of the model and the parameters. Many DAGs may determine the same joint probability distribution. Therefore, the family of all DAGs with a given set of vertices is naturally partitioned into Markov-equivalence class, each class being associated with a unique statistical model. This means that the structure of the network can only be learned up to its Markov equivalent class. The literature describes two approaches applied to the task of learning the network structure from data: a constraint-based method and a score-based method. The recent constraint-based method is divided into two steps: the Markov Blanket (MB) discovery step and the causality discovery step. The MB discovery algorithms include Total Conditioning (TC) [27], IAMB [33], IPC-MB [14], and DOS [36]. The causality discovery algorithms include GS [24], CS [28], MS [7], and AO [4].

Here, we use TC for MB discovery which has the lowest time complexity and the revised version of MS which will be described in Section 3. The constraint-based methods [26,32] are efficient, but they may not be robust in terms of accuracy and may encounter difficulties if no causally sufficient condition exists. An algorithm’s outcome is extremely sensitive to failures of conditional independency statistical tests. Furthermore, the conditional independency statistical tests cannot be easily used if any two or more variables have a hidden cause [32]. The score-based methods can remedy the demerits of constraint-based methods, although they are relatively inefficient computationally. Thus, the approach proposed in this paper adopts mainly a constraint-based method but supplemented by a score-based method if the causal direction is not determined. Several scoring functions can be considered, including the Bayesian scores based on the posterior probability of G 
                        [8], approximations of the posterior probability based on the Bayesian Information Criteria (BIC) [31], or an information-geometric score that considers the volume of the manifold that maps the underlying statistical model [29,2,19].

Once the structure of the BN becomes known, the maximum likelihood estimator (MLE), maximum a posteriori (MAP), or a Bayesian estimator can be used to estimate the graph parameters [17,5,6]. Here, we use the regression analysis, which is similar to MLE when the sample size is large enough, assuming that the latent variable has a Gaussian prior.

@&#PROPOSED METHOD@&#

The proposed procedure of ranking evaluation consists of two phases which are repeated until the network structure converges. First, rankings are estimated using Gibbs sampling and gradient descent from a given network structure. Second, an updated network structure is found by the revised Multiple Search (MS) algorithm using the given rankings. The revised MS algorithm will be described in Section 3.2 and Appendix A. The final rankings are obtained based on the final graph structure.

The flow chart of the proposed method is shown in Fig. 2
                     . The initial structure G is obtained from the function InitialStructure(X
                     
                        i
                     ) which is the same as the function FindStructure(Z
                     
                        j
                     , X
                     
                        i
                     ) except for using observable variables X
                     
                        i
                     ’s only. From the function GetRankings(G), we estimate a ‘universal’ latent variable from the given structure G because we assume that a latent variable affects all observable variables. Then, from the function FindStructure(Z
                     
                        j
                     , X
                     
                        i
                     ), we obtain the structure G for the data and the estimated latent variable. Finally, these two functions are iterated until the termination conditions are met. The functions GetRankings(G) and FindStructure(Z
                     
                        j
                     , X
                     
                        i
                     ) will be described in Sections 3.1 and 3.2, respectively. The iterative procedure is similar to the usual EM algorithm [9], but the difference is that FindStructure(Z
                     
                        j
                     , X
                     
                        i
                     ) may not generate a structure having the maximum score because of the constraint-based algorithm used. If the proposed procedure does not converge within the specified number of iterations, the final rankings are drawn for the structure having the highest score so far. The pseudo-code of the proposed procedure is shown in Fig. A2.

Suppose that variable X
                        
                           i
                         (i
                        =1,2,…,
                        m) has a vector of k
                        
                           i
                         parents 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   pa
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   pa
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   pa
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . Also, assume the following linear Gaussian model for X
                        
                           i
                         given its parents and Z
                        
                           j
                        :
                           
                              (3)
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             pa
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ∼
                                 N
                                 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                0
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                Z
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      pa
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      pa
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    β
                                 
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                           
                         is a coefficient that describes the relationship between X
                        
                           i
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is a coefficient that describes the relationship between X
                        
                           i
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                         is the conditional variance of X
                        
                           i
                        . In fact, we are considering the regression model for each variable. Once the value of Z
                        
                           j
                         is known, the regression model can be estimated easily. However, Z
                        
                           j
                         is not known, so we must estimate it and the regression coefficients simultaneously. We propose an iterative method through the function GetRankings(G) for estimating values of the latent variable and the regression parameters simultaneously by assuming a priori that each latent variable follows a standard normal distribution.


                        GetRankings(G) consists of six steps as in Fig. 3
                        , and it is repeated until enough samples for Z
                        
                           j
                         are attained. Step 1; generate the prior of Z
                        
                           j
                        s from a standard normal distribution. Step 2; from Z
                        
                           j
                        , the regression model 
                           
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             0
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       t
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                         and is estimated easily using the ordinary least square method (OLS). Step 3; obtain a new Z
                        
                           j
                         to maximize the posterior distribution of Z
                        
                           j
                         because the complete joint posterior distribution of all parameters is complex. Step 4; repeat steps 2 and 3 to calculate the mean value of the produced Z
                        
                           j
                        s. Step 5; distribution of Z
                        
                           j
                         is obtained by repeating steps 1–4, where one sample of Z
                        
                           j
                         comes from one iteration. Step 6; the median of the posterior distribution of Z
                        
                           j
                         is used as the final estimate of Z
                        
                           j
                        , and the other parameters are obtained through step 2 based on the final estimate of Z
                        
                           j
                        .

Now, we provide the theory behind Step 3, which is the key step. The conditional probability density function (pdf) of Z
                        
                           j
                         given observed data and regression estimators can be expressed by
                           
                              (4)
                              
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 ∝
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ∝
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 pa
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                     +
                                                                     ⋯
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 pa
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 k
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 pa
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                     +
                                                                     ⋯
                                                                     +
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 k
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 pa
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 k
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        To get Z
                        
                           j
                         yielding the maximum conditional pdf, the following optimization problem can be considered:
                           
                              (5)
                              
                                 Minimize
                                 
                                 J
                                 =
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  z
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  
                                                                     
                                                                        pa
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            ⋯
                                                            +
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  
                                                                     
                                                                        pa
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        Then, according to a gradient descent method, value of Z
                        
                           j
                         is updated for given the other parameters by
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       old
                                    
                                 
                                 -
                                 η
                                 
                                    
                                       ∂
                                       J
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       old
                                    
                                 
                                 -
                                 η
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                j
                                             
                                             
                                                old
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      z
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                                 
                                    old
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    β
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          pa
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        . If we set learning rate η as 1, then
                           
                              (6)
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        The gradient descent is used here rather than taking the posterior mean because the result tends to overfit about only one variable when the posterior mean is used. Finally, we estimate the new latent variable as
                           
                              (7)
                              
                                 
                                    
                                       z
                                    
                                    
                                       j
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               old
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               
                                                                  
                                                                     pa
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         ⋯
                                                         +
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               
                                                                  
                                                                     pa
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        The form of this result is similar to that in Guarino et al. [16]. After iterations, the distribution of Z
                        
                           j
                         in step 5 will be used for the ranking of institutions. The term 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         in Eq. (7) can be used as an index of the relative importance of each variable, and it can specify variables that are more influential than others on the latent variable Z
                        
                           j
                        . That is,
                           
                              (8)
                              
                                 Relative
                                 
                                 importance
                                 
                                 of
                                 
                                 variable
                                 
                                 i
                                 =
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The location and scale of the Z
                        
                           j
                        s are not identifiable because any shift in the Z
                        
                           j
                        s can be offset by a shift in 
                           
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              s
                           
                         and any rescaling of the Z
                        
                           j
                        s can be offset by rescaling 
                           
                              
                                 
                                    β
                                 
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                           
                        s. This means that the observed data need not be shifted or rescaled because these processes are built into the model.

The regression parameters and Z
                        
                           j
                        s are estimated jointly. GetRankings(G) alternates between computing the conditional distribution of the Z
                        
                           j
                        s and computing the conditional distribution of the regression parameters. This is basically the Gibbs sampling method. The latent variable rankings can be derived by using a Gibbs sampler to draw samples from the distribution of the Z
                        
                           j
                        s given the observed data. Rankings can also be obtained by comparing estimates of the distribution of the Z
                        
                           j
                        s (i.e., the ranking score for each institution), and an interval around Z
                        
                           j
                         (similar to a confidence interval) can be obtained by repeating the process 1000 times in step 5, using the 5th and 95th percentiles which cover a 90% posterior probability interval; in step 4, we take 100 samples, remove the first 50 samples and average the remaining 50 to remove warm-up and get one sample of the distribution of Z
                        
                           j
                        . The number of samples can be changed depending on the data.

For given latent variable rankings Z
                        
                           j
                        s, we learn the network structure G related to Z
                        
                           j
                         and X
                        
                           i
                        . We use the TC algorithm [27] as MB discovery and the revised MS as causality discovery. Although these algorithms cannot be applied when there are latent variables, we apply them after estimating the latent variable Z
                        
                           j
                         by GetRankings(G).

The revised MS corrects some hidden problems in the MS algorithm [7], which is expected to have better accuracy although it has higher time complexity. MS carries out the conditional independence test for finding V-structure by using the p-value of each independent variable in a linear regression model as a criterion. However, the p-value CI test may fail for loosely connected spouse nodes if a large noise exists between two nodes. Consequently, MS could cause the double-check error for V-structures, which could generate the spouse problem and the cycle problem. Definitions of these terms and how to revise this problem are explained in Appendix A.

The revised MS gives a partially directed acyclic graph (PDAG). Therefore, determining the direction of an arc, if undecided, is a major issue here. To determine the direction of an undirected edge, we first orient maximally a PDAG by the revised MS using 3 rules (Fig. A4). It is common in structure learning to obtain a completed PDAG [26] from a constraint-based algorithm. Meek [25] has proved that these three rules indeed return the maximally oriented graph when given a PDAG whose V-structures are oriented. However, there could still be undirected edges. Here, we use the score evaluation to decide the direction, which is called GetScore(G). For given graph G, GetScore(G) returns the BIC score using the parameters and the latent variable Z
                        
                           j
                         from GetRankings(G). That is, the function GetScore(G) evaluates the structure G using the score BIC that is based on the network’s joint posterior probability distribution. The following score is calculated for given structure G to be considered:
                           
                              (9)
                              
                                 GetScore
                                 (
                                 G
                                 )
                                 =
                                 -
                                 1
                                 
                                 *
                                 
                                 BIC
                                 
                                 score
                                 =
                                 -
                                 1
                                 
                                 *
                                 
                                 (
                                 -
                                 2
                                 ln
                                 
                                 L
                                 +
                                 s
                                 ln
                                 (
                                 n
                                 )
                                 )
                              
                           
                        where L is the maximized value of the likelihood function for the estimated model, and s is the number of free parameters to be estimated.

In summary, FindStructure(Z
                        
                           j
                        , X
                        
                           i
                        ) consists of four steps and returns a completed directed acyclic graph (DAG) as the network structure G (Fig. 4 and Fig. A3
                        ). Step 1; find MB for each node using TC feature based on data including Z
                        
                           j
                         and X
                        
                           i
                        . Here, we assume that Z
                        
                           j
                         has all X
                        
                           i
                         as MB. Step 2; determine the direction of edges in a V-structure in the network using the revised MS and MB information of step 1. Step 3; orient a partially directed acyclic graph maximally using 3 rules. Step 4; if there is an undirected edge after step 3, choose the direction having a higher score by comparing two possible directions for each edge through the function GetScore(G). Throughout this paper we used α
                        =0.05 as the significance level for independency and β
                        =0.01 as the significance level for dependency.

To illustrate how the proposed procedure (Fig. 2) works in evaluating the rankings, we consider the artificial data for 10 institutes having seven indicators (Var A to Var G) as shown in Table 1
                        . This data was generated based on Network 1 in Fig. 10 to which one directed edge is added from Var F to Var G.

The initial graph is obtained from the function InitialStucture(X
                        
                           i
                        ), which follows Steps 1–3 of the function FindStructure(Z
                        
                           j
                        , X
                        
                           i
                        ) using only the data of X
                        
                           i
                        ’s. The resulting graph is shown in Fig. 5
                        . For the initial graph the direction of each undirected edges is chosen arbitrarily.

Now, the iterative procedure is applied to improve the graph having a higher score until the termination condition is met. At each iteration, the latent variable is computed for each institute, and the rankings are made by sorting the values of the latent variable. Table 2
                         shows the result of the first iteration and Fig. 6
                         shows the resultant graph of which calculated score is 18.08.

For this example, the final result is shown in Table 3
                         and Fig. 7
                        . The final score obtained is 175.16.

The real data for this application are those used by the Joong-ang Daily Newspaper to evaluate rankings for 41 Industrial Engineering (IE) departments in Korea. Thirteen indicators (variables) were considered and they are abbreviated (SFR, CR, DJ, IJ, KJ, SJ, BS, ORF, SCH, IRF, GE, DR, RR) as shown in Table 4
                     . Before the analysis, each variable was standardized to have mean 0 and variance 1. In addition, the indicators SFR and DR were multiplied by −1 so that all variables have the property that higher means better.

We apply the proposed method to the data to obtain a network of variables and the ranking of 41 departments. The maximum number of iterations in the proposed method was limited to 40 when the algorithm fails to converge. The network derived using the proposed method (Fig. 8
                     ) shows some significant directed arcs indicating causality among variables. The number of SCI journal publications (SJ) and the number of international journal publications (IJ) have numbers of outgoing arrows larger than others, which means that most of the variables are affected by SJ and IJ in the graph.

The estimated rankings of 41IE departments in Korea were presented as intervals as well as medians, and they were ordered by median rankings so that top-ranked departments appear first (Fig. 9
                     ). The proposed method evaluates the ranking of each institution 1000 times before the ranking distribution of each institution is obtained. The median ranking is the median of this distribution, and the interval is between the 5th and 95th percentiles of the distribution. The intervals for top-ranked departments were narrower than those of departments near the middle and bottom.


                     Fig. 9 also includes the result by the sum method based on the sum of all indicators, which is a naïve estimator of ranking. The rankings by the proposed method and those by the sum were quite different. About 50% of the rankings by the sum were outside the intervals based on the proposed method. As will be seen in Section 5, the sum method works quite well when all the indicators have positive correlations with each other, but it may not work well when some variables have negative correlations as in this case.

As defined in Eq. (8), the relative importance of each variable can be compared. The mean and variance of the relative importance weight of each indicator were calculated for this real data (Table 5
                     ). The number of SCI journal publications (SJ) and the number of international journal publication per faculty (IJ) seem to have greater influence on the ranking than do other variables. This result is consistent with the graph shown in Fig. 8. Using a Bayesian network allows an institution to realize which variables are important to rankings given its current situation and to perform what-if analyses for improving the ranking. However, we have not performed this analysis here because it is beyond the scope of this paper.

We performed two experiments on artificial data to check the accuracy and consistency of the proposed method. The two true networks (Networks 1 and 2) are given in Fig. 10
                     . Network 1 is composed of seven variables (variables A,
                     B,…,
                     G) and Network 2 has 15 variables. Both networks have one latent variable Z. The coefficients used when generating variables were randomly chosen from the uniform distribution between 2 and 10. For example, we first generated ranking scores Z
                     
                        j
                      of 50 institutions randomly from a standard normal distribution, and the actual rankings of these institutions were obtained by comparing these scores. Then, we generated 50 observations on each variable in Network 1, for example, from the following distributions:
                        
                           
                              
                                 
                                    
                                       Variable
                                       
                                       A
                                       ∼
                                       N
                                       (
                                       3.9
                                       Z
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       B
                                       ∼
                                       N
                                       (
                                       4.2
                                       Z
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       C
                                       ∼
                                       N
                                       (
                                       4.3
                                       Z
                                       +
                                       3.5
                                       D
                                       +
                                       2.9
                                       F
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       D
                                       ∼
                                       N
                                       (
                                       4.6
                                       Z
                                       +
                                       4.5
                                       A
                                       +
                                       3.3
                                       B
                                       +
                                       3.8
                                       F
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       E
                                       ∼
                                       N
                                       (
                                       2.5
                                       Z
                                       +
                                       3.2
                                       B
                                       +
                                       4.2
                                       F
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       F
                                       ∼
                                       N
                                       (
                                       2.6
                                       Z
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Variable
                                       
                                       G
                                       ∼
                                       N
                                       (
                                       3.7
                                       Z
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     All measurable variables had the same variance σ
                     2. Two cases of σ
                     2 were considered (σ
                     2
                     =0.1 and 0.5). The second experiment considered fifteen variables, and the remainders were the same. The maximum number of iterations in the proposed method was limited to 20 in the case of no convergence. We repeated the experiment 5 times.

We used the structure error measure as in Choi and Jun [7] to compare the structures derived by the proposed method using only the observable variables based on the true structures. The results are summarized in Table 6
                     , where the total structure error includes four types: edge addition, deletion, reversal, and direction missing. It was found that MS does not identify the causal relation well when an unobservable latent variable is present. However, the proposed method outperformed MS in terms of structural accuracy although time complexity is by far larger than MS.

The 50 institutions were ranked in the form of 90% confidence intervals, and they are reported in Fig. 11
                      (σ
                     2
                     =0.1) and Fig. 12
                      (σ
                     2
                     =0.5) for Network 1, while in Fig. 13
                      (σ
                     2
                     =0.1) and Fig. 14
                      (σ
                     2
                     =0.5) for Network 2. Most of the actual rankings fell within the 90% confidence intervals. Furthermore, the interval lengths were narrow enough to distinguish some institutions from other institutions statistically. These two findings demonstrate that the rankings of the top and bottom institutions are more certain than those in the middle. First, the middle-ranked institutions have larger intervals than the top or bottom-ranked institutions. Second, increasing the variance and the number of variables affected the result of the middle-ranked institutions, especially the interval length, more than the top or bottom-ranked institutions.

The median rankings differ from the actual rankings; more often σ
                     2 is larger. However, increasing the number of variables reduces the difference between the median rankings and the actual rankings. The median rankings and the actual rankings can be compared based on some measures. We first considered the following mean absolute error (MAE) of rankings:
                        
                           (10)
                           
                              MAE
                              =
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                          
                                             true
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 r
                              
                              
                                 i
                              
                              
                                 true
                              
                           
                        
                      is the actual ranking and 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                        
                      is the estimated median ranking. Second, we considered the Top-K inclusion ratio, which is the proportion of the institutions in the estimated Top-K rankings that are in the actual Top-K ranking. We considered K
                     =5, K
                     =10, and K
                     =20. We compared the result of the proposed method with that of the sum method, which simply sums up all variables and uses this sum to estimate the ranking. These comparisons are summarized in Table 7
                     . Generally, the sum method gives a good result in case of all positive coefficients. However, the sum method is expected to perform worse if some coefficients have negative signs. It is shown that the proposed method estimates ranks more accurately than the sum method. When σ
                     2 increased, the estimation performance by the sum method degraded slightly. However, the results of the proposed method were relatively stable. It is also observed that increasing the number of variables has a good effect on the estimation performance.

Lastly, we checked how reliable the proposed method is when the number of observations is small. We set up the experiment with Network 1 (σ
                     2
                     =0.1), but now generating variables for only 10 institutions as observations. It was found that the proposed method yields the total number of error of 3.33±0.58 as compared with 6.67±1.15 when using MS. Table 8
                      and Fig. 15
                      show the result, which shows that the proposed method still works with smaller observations.

@&#CONCLUSION@&#

In this paper, we considered a new type of Bayesian network containing an unobservable latent variable which affects all observable variables. We applied the proposed method to the task of ranking institutions and determining the rankings in terms of intervals based only on the institutions’ scores in the performance indicators. The linear Gaussian models are utilized to express the causal relationship among variables in the network. The proposed iterative method finds the network structure of variables by using a combined algorithm of the revised MS and the BIC scoring function, estimating the parameters by using Gibbs sampling, gradient descent and regression analysis.

The latent variable that represents the ranking score of an institution is estimated, and the final rankings are determined by comparing those scores. The interval estimate and the median estimate of the ranking of an instruction are obtained by repeating the estimation process. The analyses of a real case and some artificial data sets demonstrate the performance of the proposed method.

To sum up, the proposed method has some advantages as a ranking system. First, the proposed method compresses the information of data (performance indicators in our case) into a single latent variable. Second, the proposed method does not require weights for indicators in advance, and therefore, it avoids the controversial subjective assignment of such weights. Third, using the interval estimate rather than the point estimate makes it possible to compare institutions statistically.

However, the proposed method still has some limitations in computation time and in convergence. We also need to handle some semantic constraints in the network structure when utilizing an expert knowledge. On the other hand, the proposed method can be applied to a more general model where a latent variable has both in-degree and out-degree to all observable variables. If we consider a latent variable as a clustering node or a class node, then we can apply the proposed method to an unsupervised clustering problem or a classification problem. These issues should be considered in the future work.

@&#ACKNOWLEDGMENTS@&#

This research was supported by Basic Science Research Program through the National Research Foundation of Korea from the Ministry of Education, Science and Technology (Project No. 2012-0001665).

The MS algorithm [7] is known to be fast and accurate but it can cause double-check errors for V-structures. The double-check error means that for a V-structure X
                     →
                     Y
                     ←
                     Z can be detected from the CI test using X as the dependent variable while it cannot be detected from the CI test using Z as the dependent variable. The double-check error may generate a spouse problem and a cycle problem. The spouse problem occurs when a spouse link of a V-structure X
                     →
                     Y
                     ←
                     Z coexists in another V-structure like M
                     →
                     X
                     ←
                     Z. The cycle problem means that V-structure edges make a cycle. We cannot remove a spouse link from step 7 of phase 1 in the MS algorithm under these problems.

The revised MS treats these problems by adding steps to the phase 2 of MS (Fig. A1
                     ). For X
                     →
                     Y
                     ←
                     Z, we test the effect of center Y using conditioning set D(X, Y)∪
                     D(Y, X), where D is a conditioning set that d-separates X from Y, rather than D(X, Y) because the former increases the probability of d-separation from X to Y. In the case of a spouse problem, we check again the characteristics of a V-structure and compare the degree of independency like the opposite direction collision case which is given in MS. Consequently, one of the two is deleted in the graph. In the case of a cycle problem, we test and compare every V-structure related to each edge in a cycle. As a result, the maximum degrees of independency MaxCI for each edge are obtained. Then, we remove all V-structure related to the edge which has the minimum value of MaxCI. It removes the edge which has a minimum effect of the center among the edges in a cycle. Lastly, we orient all the edges in V-structure to the structure and remove the spouse link in V-structure if there is a link because there are no more collisions or cycles.

Here we include pseudo codes of the proposed method (Fig. A2
                     ), FindStructure(Z
                     
                        j
                     , X
                     
                        i
                     ) (Fig. A3
                     ), and OrientPDAGmax(G) (Fig. A4
                     ).

@&#REFERENCES@&#

