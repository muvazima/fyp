@&#MAIN-TITLE@&#Computer-aided diagnosis system based on fuzzy logic for breast cancer categorization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a new method for categorizing findings in mammograms according to BIRADS.


                        
                        
                           
                           We use fuzzy logic to model a computer-aided diagnosis tool.


                        
                        
                           
                           We construct a fuzzy inference system.


                        
                        
                           
                           The system shows a degree of pertinence of a finding to each BIRADS category.


                        
                        
                           
                           The system achieved an accuracy of 76.7% for nodules and 83.3% for calcifications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computer-aided diagnosis

Breast cancer

Fuzzy logic

Decision support

Healthcare informatics

@&#ABSTRACT@&#


               
               
                  Background
                  Fuzzy logic can help reduce the difficulties faced by computational systems to represent and simulate the reasoning and the style adopted by radiologists in the process of medical image analysis. The study described in this paper consists of a new method that applies fuzzy logic concepts to improve the representation of features related to image description in order to make it semantically more consistent. Specifically, we have developed a computer-aided diagnosis tool for automatic BI-RADS categorization of breast lesions. The user provides parameters such as contour, shape and density and the system gives a suggestion about the BI-RADS classification.
               
               
                  Methods
                  Initially, values of malignancy were defined for each image descriptor, according to the BI-RADS standard. When analyzing contour, for example, our method considers the matching of features and linguistic variables. Next, we created the fuzzy inference system. The generation of membership functions was carried out by the Fuzzy Omega algorithm, which is based on the statistical analysis of the dataset. This algorithm maps the distribution of different classes in a set.
               
               
                  Results
                  Images were analyzed by a group of physicians and the resulting evaluations were submitted to the Fuzzy Omega algorithm. The results were compared, achieving an accuracy of 76.67% for nodules and 83.34% for calcifications.
               
               
                  Conclusions
                  The fit of definitions and linguistic rules to numerical models provided by our method can lead to a tighter connection between the specialist and the computer system, yielding more effective and reliable results.
               
            

@&#INTRODUCTION@&#

Due to the increasing of the amount of digital medical images produced recently, the activities related to acquisition, management and availability of these images have required efforts of researchers and professionals involved in these processes to study and propose computational methods that provide effective support to daily tasks related to image-based diagnosis. Databases containing patient information as well as clinical data have become usual in healthcare environments. Machine learning and data representation techniques allow us to develop tools for computer-aided diagnosis (CAD) [1–3], which have been shown to improve the quality of the tasks performed by radiologists [4] and thereby the performance of radiological diagnosis [5].

Methods for CAD usually face a significant obstacle: the so-called semantic gap, which is characterized by the divergence between the results of automated methods and the results expected by users, due to the difficulties of these methods to represent real situations [6,7]. However, regardless of dealing with a specific context, a purely numeric representation of an image attribute is itself a semantic gap, since it is relatively distant from how the human analyst interprets the image. When analyzing the shape of a breast nodule, the diagnosis is generated in natural language, for example slightly irregular contour. In this case, it is very difficult to set a numeric descriptor for the contour that fits the user׳s semantics. So, we decided to use fuzzy concepts in this context. The concepts of fuzzy logic are designed to handle this kind of situation and can be used to simulate human reasoning in decision support systems [8]. Fuzzy sets handle the separation between classes, commonly limited by ranges of numeric values, by membership grades, replacing abrupt transitions. This approach is suitable to situations in which the boundary between the sets is not well delineated, e.g., the assessment performed by a human being. Fuzzy methods can approach objective knowledge (represented by numerical data) and subjective knowledge (represented by linguistic terms).

The Breast Imaging Reporting and Data System (BI-RADS) standard was developed in collaboration with members and committees of the American College of Radiology (ACR) to guide radiologists and physicians in the evaluation of breast nodules and calcifications [9]. This system aims to unify the terminology used in mammography exams, the categories of findings and their appropriate treatment [10]. The use of the BI-RADS lexicon is highly recommended in the decision-making process as it follows a natural language structure: “if the nodule is round, has well-defined margins and low density, it is more likely to be classified as benign”. This kind of structure can be properly modeled through fuzzy sets. Fuzzy logic is also suitable to represent the divergence between radiologists. In clinical practice, the same image can be analyzed in different ways by each expert. Fuzzy inference models can encompass inter- and intra-observer variations.

In related works, some approaches have been proposed using fuzzy logic to assist the diagnosis of breast lesions. In Ref. [11] the authors present a method to distinguish lobulated contours from microlobulated ones. They created membership functions to represent features, such as the number of contour undulations and its size, and in Ref. [12] the authors implemented a fuzzy rule-based method aiming to characterize the shape of nodules in mammograms. In Ref. [13], three distinct regions in mammograms are compared: regions containing tumors; regions containing calcifications and regions containing no injuries. The authors proposed a fuzzy inference system based on the intensity of the pixels of these three regions, inferring the type of lesion (tumor or calcification) or the absence of lesion. In contrast, the methodology used in our project, in addition to treating attributes as fuzzy sets, also provides a fuzzy output, generating a quantitative response which is standardized by the BI-RADS system.

Fuzzy logic is also applied in Ref. [14], which presents an iterative segmentation algorithm to automatically identify regions of interest (ROIs) from nodules considering the breast tissue density and applying a fuzzy classifier for diagnosis. Concerning breast cancer treatment, Garibaldi et al. [15] present a method based on non-stationary fuzzy sets to model the need of recommendation of post-operative treatment considering clinical variables as attributes. This approach yielded better results when compared to standard fuzzy inference systems.

Another applications to support medical diagnosis can be found in Ref. [16] to help the analysis of malformations of the cerebral cortex. The input variables are based on the expert׳s knowledge. In Refs. [17,18], fuzzy cognitive maps are used to support diagnosis. In computer vision, fuzzy systems can also be used to describe intrinsic attributes of images [19,20]. Moreover, different studies have applied fuzzy-based techniques to medical applications [21–26].

This project aims to investigate the effectiveness of fuzzy representation of the evaluation parameters of breast lesions. For this purpose, we have developed a fuzzy system to provide an automated quantitative analysis of breast nodules and calcifications, based on image visual assessment parameters supplied by the users. This system is based on a new method proposed in Ref. [27] for designing of membership functions in fuzzy sets. This algorithm uses training sets to determine the data distribution for each class and establishes the design of the membership functions to be used by the fuzzy inference model. The system provides a second opinion to aid the radiologist (or other clinicians) to define the diagnosis and the patient׳s mammography classification. For this computerized analysis, we have used the main attributes related to mammographic findings in the reports of the nodules and calcifications. We have also used the BI-RADS evaluation categories and their corresponding prognosis. We have designed and implemented a CAD tool for generating BI-RADS diagnosis. We have evaluated our proposed methodology by the effectiveness in generating results more closer to the ones expected by users. Furthermore, the use of parameters and rules defined in terms of natural language should contribute to an effective adoption of CAD systems by the radiologists.

This paper is organized as follows: Section 2 presents the technical background related to fuzzy logic and the BI-RADS standard; Section 3 describes the proposed methodology for the representation of the BI-RADS attributes as fuzzy sets as well as their evaluation categories; Section 4 presents the experiments and the consequent results; Section 5 presents discussions and Section 6 presents conclusions.

@&#BACKGROUND@&#

Fuzzy set theory distinguishes from the classical set theory since it concerns vague aspects related to information. This theory is less restrictive and can be more suitable to handle information given by humans. It extends the classical binary logic (0 or 1) to the continuous domain (0 to 1), through a gradual transition between pertinence and non-pertinence of an element within a set [8,28]. There are several fuzzy inference models. The most known is the Mamdani model, where the semantic rules use union and intersection operators (Max–Min) and both rule antecedents and consequents present fuzzy relations [29]. For each rule belonging to the database, the fuzzy Cartesian product (fuzzy intersection) is calculated using the components of the rule antecedent part generating an activation coefficient. When this coefficient is greater than zero, it is said that the rule was activated by the current input and will contribute in the calculation of the output provided by the system [30]. For the activated rules, a fuzzy union operation is applied, grouping the rules with the same output categories (or subsets) according to Eq. (1):
                           
                              (1)
                              
                                 µ
                                 
                                    (
                                    C
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       k
                                       =
                                       1
                                       ⋯
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       min
                                       
                                          (
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             µ
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                              
                           
                        where D
                        
                           k
                         is the activation coefficient of each rule that has the output C
                        
                           i
                         and µ(C) is the set of membership grades for each output class C
                        
                           i
                        . The set µ(C) can be used in the decision-making process in a qualitative assessment. For a quantitative result, or a scalar variable, it is necessary to perform the step of defuzzyfication, where µ(C) assumes a numerical value. The centroid method and the maximum average method are the most widely used [30].

The main attributes used for characterizing breast nodules and calcifications standardized by the BI-RADS system are described next [31].

Shape can be classified as round, oval, lobular or irregular. Contour may assume the following values: circumscribed; microlobulated; obscured; indistinct and spiculated. The density of the nodules (compared to the underlying tissue) can be high, isodense, low or fat containing. Irregular shapes, spiculated contours and high densities usually implies a higher degree of malignancy for nodules. The combination of these three attributes characterizes the transition of a lesion from benign to malignant. 
                              Fig. 1 shows some examples of shape, contour and density in breast lesions.

Regarding the type, calcifications can be classified as typically benign (round skin, vascular, coarse etc.), intermediate concern and higher probability of malignancy (pleomorphic and linear). The distribution can be classified as diffuse, regional, linear, segmental or grouped. Similar to the analysis of nodules, the combination of these three attributes characterizes the transition of a lesion from benign to malignant. 
                              Fig. 2 shows some examples of calcifications.

BI-RADS has six evaluation categories numbered from 0 to 5 to characterize findings in mammographic images. Category 0 indicates that further evaluation is needed such as ultrasound exams or MRI. Category 1 indicates that no nodules or suspicious calcifications were found, thus, it is a negative mammogram. Category 2 indicates benign findings without signs of malignancy. A finding in Category 3 is more likely to be benign than malignant, but is less likely than a finding in Category 2. Additionally, in Category 3 there is a small probability of a finding to be malignant (less than 2%) [10], but a new mammogram should be requested after six months. Categories 4 and 5 are considered malignant, i.e. positive. In Category 4, there are lesions with high probability of being malignant, but they do not show morphological characteristics of breast cancer. For a lesion classified as BI-RADS 4 a biopsy should be performed in the breast tissue. Finally, Category 5 presents lesions with the highest probability of being cancer. 
                           Fig. 3 shows examples of nodular lesions classified as BI-RADS 0, 2, 3, 4 and 5.

@&#MATERIAL AND METHODS@&#

The proposed methodology is described in the following sections.

In order to understand the perceptual parameters used by radiologists in the evaluation of breast lesions as well as the use of the BI-RADS lexicon, meetings were held with radiologists at a School Hospital. The meetings supported the methodology used in this project, enabling the creation of numeric scales representing the malignancy of the lesion and the creation of the fuzzy subsets.

The Digital Database for Screening Mammography (DDSM) [32] was used in the evaluations carried out with the radiologists. This database was built by researchers from the Massachusetts General Hospital and from the University of South Florida. The images of this database consist of mammograms where the findings were marked and classified by specialists. In order to make the evaluation easier, we presented to the radiologists a set of ROIs containing the findings.

We have used 40 selected images of nodules. These images were evaluated and classified by 5 radiologists. The evaluations that received Category 0 were not considered, resulting in 148 evaluations, with the following distribution: 3 evaluations of BI-RADS 2; 49 evaluations of BI-RADS 3; 82 evaluations of BI-RADS 4; and 14 evaluations of BI-RADS 5.

Regarding the calcifications, we have used 36 images. They were also evaluated by 5 radiologists. The evaluations that received Category 0 were not considered, resulting in 178 evaluations, with the following distribution: 64 evaluations of BI-RADS 2, 47 evaluations of BI-RADS 3, 59 evaluations of BI-RADS 4, and 8 evaluations of BI-RADS 5.

Fuzzy modeling of the evaluation parameters was divided into two steps:

In the first step, we used the visual attributes for classification of breast nodules and calcifications presented in Section 2.2. To evaluate the contribution of each attribute in determining the classification of a finding, we have considered the malignancy of the tumor as a scalar variable. Scales varying in the range [0,1] represented the concept of malignancy, indicating the relationship between this concept and a particular characteristic of an attribute under consideration.

Then, we presented these scales in the form of a questionnaire to five senior radiologists, experienced in the diagnosis of breast cancer. The referred questionnaire presented fields for evaluating shape, contour and density of nodules. Similarly, for the analysis of calcifications, the questionnaire presented fields for the evaluation of following attributes: type; distribution and quantity. We selected a set of 35 images from the DDSM database and each one was evaluated by each radiologist. During the evaluation, for each attribute, a characteristic was defined as well as its value of malignancy, indicating the influence of this characteristic in the malignancy of the lesion.

Concerning shape attribute, we used a scale to evaluate how the characteristics round, oval, lobular and irregular were related to the malignancy of a nodule. As an example, we could obtain from a radiologist the following assessment: lobular shape with malignancy value of 0.6. Then, the malignancy value associated to lobular shape was determined by computing the average of the malignancy values of all assessments containing this combination attribute/characteristic. Other attributes were processed in a similar way. Finally, the BI-RADS category was also determined by the radiologist.

The only exception was the contour attribute, for which more than one characteristic could be marked in the questionnaire. In this case, a malignancy scale was adopted to each characteristic and not to the attribute itself. The choice of more than one characteristic was noticed in the radiologists routine during the meetings. Furthermore, we defined four linguistic variables to use with these characteristics: totally, very, partially and little. So, as an example of the contour evaluation, we could obtain the following assessment: contour partially circumscribed with malignancy value of 0.2 and very obscured with malignancy value of 0.5. It is important to notice that the variable totally excludes the choice of more than one characteristic.

To calculate the contour coefficient, we applied a weighted average in the cases which more than one characteristic were chosen, as described next.

Let M
                           
                              i,j
                           , be the malignancy defined by a radiologist to the combination of the linguistic variable i with the characteristic j in which i can take the following values: totally, very, partially or little, and j can assume one of the following characteristic of the contour: circumscribed, microlobulated, obscured, indistinct and spiculated. The final malignancy value associated to the pair ij is a weighted average, given by the following expression (Eq. (2)):
                              
                                 (2)
                                 
                                    
                                       
                                          Malignancy
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                          ⋯
                                          n
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                M
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                j
                                             
                                          
                                       
                                       )
                                    
                                    /
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                          ⋯
                                          n
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           where n is the number of assessments containing the pair ij and W
                           
                              j
                            represents the weight assigned to characteristic j. W
                           
                              j
                            is computed as the malignancy average of all assessments containing characteristic j.


                           
                           Table 1 shows the weights obtained (W
                           
                              j
                           ) for each contour characteristic and the average of malignancy (Malignancy
                              i,j
                           ) values for each combination of characteristic/linguistic variable.

After the evaluation of the radiologists, we designed and implemented a database to store the information obtained and to facilitate the extraction of the parameters of interest. This information represents the knowledge of the domain specialists and represents the basis for the system modeling. These evaluations were also used in the creation of the fuzzy sets and the fuzzy database rules. Except for the contour attribute, the values obtained as malignancy coefficients were adopted as inputs for the fuzzy system.

The second step consisted in the creation of the fuzzy inference system. For the evaluation of nodules, the system input were represented by the three coefficients described in step one: shape coefficient; contour coefficient and density coefficient. They represent the numeric entry of the fuzzy system and were mapped into linguistic variables representing the concepts of “high”, “medium”, “low” and “very low.” The higher the value of the coefficient, the greater its influence on the malignancy of the lesion.

We used the Mamdani method as inference model and the fuzzy rules were designed considering the combination of the input coefficients. The BI-RADS Categories 2, 3, 4 and 5 are the consequent part of the rules. Category 0 is not considered in our model because it represents the necessity of an additional examination. A schematic representation of the fuzzy system can be seen in 
                           Fig. 4. Similarly, for the evaluation of calcifications the system input consisted of the following coefficients: type; distribution and quantity.

Typically in fuzzy systems, the creation of the fuzzy sets, as well as other steps, are performed by the domain specialist. In this study, the expert׳s knowledge was represented by the direct analysis of the database created from the radiologists interviews by applying a machine learning algorithm: Fuzzy-Omega. The Fuzzy Omega algorithm generates membership functions based on a statistical analysis of the data set. It uses a measure called inconsistency rate to map the distribution of different classes in a data set. Mathematical functions are generated from polynomial interpolations and they can be used as fuzzy membership functions. This algorithm provides a less subjective analysis as described next.

The Fuzzy-Omega method is based on the Omega algorithm [34], which performs both data discretization and feature selection with linear complexity regarding the number of instances to be processed. The data discretization generates intervals of values represented by a majority class that facilitates further data processing. The input of the Omega algorithm is represented by a set of N instances associated with a class I=(f
                        
                           i
                        ,c
                        
                           i
                        ). Omega processes each attribute separately and the values of the instances should be in ascending order considering the attribute under analysis. The boundaries of the intervals, called bins, represent cut points. Initially, a cut point is created every time there is a change in the associated instance class. So, pure bins are produced with zero entropy, i.e., the intervals generated contains only instances of the same class. 
                        Fig. 5(a) shows instances associated with three different classes (A, B, C) and the cut points generated by applying Omega first step.

In the next step, Omega restricts the number of interval elements to a minimum frequency (H
                        
                           min
                        ), decreasing the number of cut points. Omega removes the second cut points of the intervals that do not satisfies H
                        
                           min
                         (Fig. 5(b)). The higher the value of H
                        
                           min
                        , the smaller the number of intervals obtained in the second step. However, a very high value of H
                        
                           min
                         can introduce inconsistencies in the discretization process.

In the third step, Omega merges possible consecutive intervals according to the inconsistency rate ζ
                        
                           Ti
                        , which is defined by Eq. (3).
                           
                              (3)
                              
                                 
                                    
                                       ζ
                                    
                                    
                                       T
                                       i
                                    
                                 
                                 =
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 −
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       T
                                       i
                                    
                                 
                                 |
                                 /
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                           
                        where |T
                        
                           i
                        | is the number of instances of the inverval |T
                        
                           i
                        | and |M
                        
                           Ti
                        | is the number of instances of the majority class of |T
                        
                           i
                        |. Omega merges consecutive intervals that have the same majority class and whose ζ
                        
                           Ti
                         are greater than a limit ζ
                        
                           Max
                        , as described in Fig. 5(c).

Finally, the last step consists in the attribute selection. Let T be the set of intervals in which an attribute has been discretized, Omega calculates a global inconsistency ζ
                        
                           G
                         according to Eq. (4). Attributes whose values of ζ
                        
                           G
                         are greater than a threshold ζ
                        
                           GMax
                         are not selected.
                           
                              (4)
                              
                                 
                                    
                                       ζ
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       T
                                       i
                                       ∈
                                       T
                                    
                                 
                                 |
                                 T
                                 i
                                 |
                                 −
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       T
                                       i
                                    
                                 
                                 |
                                 /
                                 
                                    
                                       ∑
                                    
                                    
                                       T
                                       i
                                       ∈
                                       T
                                    
                                 
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                           
                        
                        Fuzzy-Omega method: To automatically generate the membership functions related to a specific fuzzy set the Fuzzy-Omega performs 3 steps, as described in the algorithm presented in 
                        Table 2.

The input consists of a set with N instances. Each instance is characterized by the value of an attribute and its associated class (A
                        
                           i
                        , C
                        
                           i
                        ). In step 1, this values will be ordered according to the values of A
                        
                           i
                        . Step 2 consists in the application of the Omega Algorithm to obtain the dataintervals as a result of the discretization process. The number of intervals generated in step 2 will correspond to the number of membership functions created in step 3 for each selected attribute.

In step3, an inconsistency rate is calculated for each element x
                        
                           i
                         beloging to a specific attribute. This rate is calculated based on the classes of the neighboring elements. The number of neighbors to be considered is given by a threshold value n. For example, if we consider n=1, the inconsistency rate will be calculated based on the classes of the previous and the posterior elements as described in 
                        Fig. 6. It is important to remember that the values of the analyzed attribute are already in ascending order and that the inconsistency rate represents how one instance is similar to a specific class. As higher this rate, less representative of this class is this instance. So, in order to obtain a representation for the concept of pertinence we subtracted the inconsistency rates from 1. Finally, we used these values to obtain a polynomial function through an interpolation method.

We can summarize that the Omega algorithm is responsible for generating the number of membership functions for each attribute as it provides a data clusterization and the subsequent process of the Fuzzy-Omega algorithm is responsible for designing the membership functions. 
                        Fig. 7 shows an example of MF designed with the Fuzzy-Omega method. The ploted dots are the values of 1 minus the inconsistency rate for each value of the intermediate interval. The polynomial interpolation generated the curve and its equation.

The rule database in a fuzzy system is determined by the combination of the input subsets. Considering a system with 3 input attributes, each one containing three fuzzy subsets, the database will have 27 rules. In this work, the consequent parts of the rules were also determined using the evaluations obtained from the radiologists, representing the experts knowledge. We considered the input coefficients as antecedents while the BI-RADS categories as the consequent parts of the rules.

The rules were obtained by a training process: For each radiologist׳s evaluation, the combinations of activated subsets were determined based on the Max–Min approach (Mamdani). After, the rules that have presented the same input combination were selected and the majority class were assigned as the consequent part of the rule.

@&#RESULTS@&#

In the evaluation of nodules, we obtained 126 values of malignancy degrees for the shape coefficient and for the density coefficient. For the margin coefficient we obtained 180 values of malignancy degrees due to the fact that the radiologist could select more than one characteristic to this attribute during his/her analysis. After applying the Fuzzy-Omega algorithm, two or three membership functions were generated for each attribute. However, subsequent tests indicated that the use of only two membership functions for the input attributes were not enough to generate rules that distinguish between the categories BI-RADS 2 and 5, although the Categories 3 and 4 could be well characterized. To avoid this situation, the values of each input attribute were considered as a single interval and the actions described in the third step of the Fuzzy-Omega algorithm were carried out adopting each BI-RADS category as the majority class, i.e. the inconsistency rate µ(T
                        
                           i
                        ) for each instance was calculated considering BI-RADS 2 as the majority class and then this process was repeated for BI-RADS 3, 4 and 5. Thus, 4 membership functions were obtained. In addition, once each input attribute was considered as a single inerval, we could use different numbers of instances for each category, without being affected by a statistical bias.

The linguistic variables chosen to represent these functions are very low, low, medium and high. 
                        Fig. 8(a) shows the resulting membership functions for contour coefficient. The function very low coefficient (orange) is a polynomial fit of order 3, which was adopted as the majority class of the dataset for Category 2. This function represents the concept of low malignancy associated with nodules classified as BI-RADS 2.

Also in Fig. 8(a), functions low coefficient (red) and medium coefficient (green) represent BI-RADS 3 and BI-RADS 4, respectively. Classes 3 and 4 are the most frequent in the dataset and the variability of the malignancy degrees given by the radiologists which were associated to theses classes is very high. We can see that the function low coefficient has membership degrees greater than 50% for malignancy coefficients smaller than 0.6. From the malignancy value of 0.5, medium coefficient has greater membership degrees. This last function associates greater malignancy degrees with category BI-RADS 4, regarding contour attribute. Finally, the function high coefficient (blue) was generated considering BI-RADS 5 as the majority class. Similar to the function very low, our dataset presents few examples of BI-RADS 5. This function associates the highest malignancy degrees with Category 5. Fig. 8(b) shows similar functions for density coefficient. For all graphs some cut points were considered in order to disregard membership degrees lower than zero and coefficients greater than 1.

The fuzzy rule database was implemented using the membership functions defined above. This database contains 64 rules resulting from the combinations of the input MFs. The distribution of the input values shows that most frequent cateotries are BI-RADS 3 and 4. Also, during the evaluation performed, we found that the number of rules that lead to these categories was redundant. Therefore only three membership functions were adopted for the shape coefficient, reducing the computational effort in the process of fuzzy inference, since during this process all rules should be analyzed. The shape coefficient was a candidate to use only three MFs, because the subsets “very low” and “low” have a large area of intersection and the maximum membership degree for each one is very similar. This way, there are only 48 rules to be tracked during the inference process.

To illustrate the inference process suppose that shape, contour and density coefficients present the values 0.5, 0.4 and 0.6, respectively. Using the MFs defined previously, we obtain the following membership grades:
                           
                              •
                              
                                 Shape coefficient=0.5: 35% of pertinence to “low” subset and 72% of pertinence to “medium” subset;


                                 Contour coefficient=0.4: 5% de of pertinence to “very low” subset, 83% of pertinence to “low” subset and 29% of pertinence to “medium” subset;


                                 Density coefficient=0.6: 14% of pertinence to “low” subset, 75% of pertinence to “medium” subset and 15% of pertinence to “high” subset.

For the evaluation of calcifications the same process was performed for type, distribution and quantity coefficients. The membership functions for quantity coefficient are presented in Fig. 8(c).

Combining the three MFs for the shape coefficient, the four MFs for the contour coefficient and the four MFs for the density coefficient we have the rule database for nodules partially presented in 
                        Table 3.

We implemented a system prototype called Fuzzy BI-RADS which user interface can be seen in 
                        Fig. 9. This interface allows the radiologist to choose the parameters related to nodules and calcifications. These two types of lesions are evaluated separately. After the processing performed by the fuzzy inference, the system returns to the user the membership degree to each of the BI-RADS categories. Regarding the contour evaluation, more than one characteristic can be chosen.


                        Fig. 9(a) shows an example of a system output using the following input values for nodules: lobular shape (0.6 maligancy grade), high density (0.8 maligancy grade) and very speculated and partially indistinct contour (0.74 maligancy grade). From these values, we obtained 88% of pertinence for BI-RADS 4 and 22% of pertinence for BI-RADS 5. Then, the system suggests BI-RADS 4. Similarly, Fig. 9(b) shows an example of a system output using the following input values for calcifications: high probability of the finding being malignant (0.8 maligancy grade), linear distribution (0.75 maligancy grade) and quantity of calcifications in the analyzed region between low and high (0.45 maligancy grade). So, the system indicates BI-RADS 4 with higher pertinence.

@&#EVALUATION@&#

During the test step, we conducted a set of evaluations with the radiologists. Twelve new images, not used in the training procedure, were selected from the image database [32]. Six images presented nodules and the other six contained calcifications. These images were evaluated by the same five radiologists, resulting in 30 evaluations for each type of finding. 
                        
                        Tables 4 and 5 show the results of these evaluations with BI-RADS categories generated by the Fuzzy-BIRADS system.


                        ID column identifies the image and R column identifies the radiologist. The three subsequent columns present the evaluations performed by the radiologists and RB presents the BI-RADS categories assigned by them. The column System BI-RADS presents the categories assigned automatically by our system and the last column, C
                        
                           M
                        , shows the category with greater membership degree respectively to System BI-RADS.

Accuracy was measured regarding the correct match between the category assigned by the radiologist (RB) and the majority category assigned by the system (C
                        
                           M
                        ). The instances that did not satisfy this condition are marked in bold in Tables 4 and 5. When evaluating ROIs containing nodules, we obtained an accuracy of 76.67% and when analyzing ROIs which presented calcifications, we obtained an accuracy of 83.34%.

We also analyzed sensitivity and specificity of the system. The first is characterized by the frequency which the algorithm correctly identifies the existence of abnormalities and specificity by the frequency which the algorithm correctly identifies the absence of abnormalities. In the case of the BI-RADS categories we compared each class against the other ones. Let TP be the fraction of true positives, FN the fraction of false negatives, TN the fraction of true negatives and FP the fraction of false positives, we have the following definitions:
                           
                              (5)
                              
                                 sensitivity
                                 =
                                 TP
                                 /
                                 TP
                                 +
                                 FN
                              
                           
                        
                        
                           
                              (6)
                              
                                 specificity
                                 =
                                 TN
                                 /
                                 TN
                                 +
                                 FP
                              
                           
                        
                     

The results regarding sensitivity and specificity are shown in 
                        Table 6 for each BI-RADS category. In the analysis of nodules, no test image was classified as BI-RADS 2 and in the analysis of calcifications none were classified as BI-RADS 5. Table 6 also shows the sensitivity and specificity averages for both types of findings.

@&#DISCUSSION@&#

The implemented system and the results presented in the previous section lead us to carry out some comments on certain issues.

The creation of a scale associated with the malignancy of the lesion was an important step of the methodology because only linguistic variables are described in the BI-RADS standard. The scales enabled the process of fuzzy inference and could be used as a weight in the determination of the category of the nodules. During the initial interviews, the same characteristic was associated to different degrees by the specialists. For example, “lobular shape with malignancy degree 0.7” and “lobular shape with malignancy degree 0.4”. The implicit scales associated to characteristics of the mamograms fidings could handle this inconsistency. The lower the degree associated with the finding, the lower its weight in determining the malignancy of the lesion.

Regarding the evaluation of nodules, along the interviews with the radiologists when lower values were adopted as malignancy degrees, they usually decided to classify the lesion as BI-RADS 0, leading to a few examples of BI-RADS 2. Category 0 indicates that an additional exam is requested by the radiologist in order to confirm the malignancy of the lesion. That is why Category 2 is usually only assigned when the radiologist is completely sure of his/her evaluation. The distribution of categories was corroborated in the fuzzy rule database, where most rules lead to Categories 3 and 4.

From the interviews with the radiologists we noticed that for the same reference image they have provided different evaluations. The analyzed examples (Tables 4 and 5) showed that despite having an intersection between the BI-RADS categories adopted by the radiologists there is not a well-defined boundary between the different categories and even among the attributes used to evaluate the lesions. These discrepancies influenced directly the resulting accuracy.


                        
                        Table 7 presents the average values of accuracy, sensitivity and specificity for each readiologist. We selected the majority classes among the radiologists and use them as the gold standard in order to calculate the specified rates. Accuracy represents the fraction of corrected classified images in relation to the majority class. The results represent how each readiologist deviates from the concensus among the group. The lower the values shown in the table, the greater the variability of the radiologist in relation to the group. Sensitivity and specificity were calculated comparing one category against all the others. This explains why the values of sensitivity were lower than the values of specificity for both nodules and calcifications.

In Table 6 we see that the sensitivity obtained for BI-RADS 5 category is lower than for BI-RADS 3 and 4 in that experiment, despite of the fact that BI-RADS 5 is a border category. It could be due to a bias caused by the low number of evaluations that resulted in BI-RADS 5 from the radiologists.

In Section 1, we described approaches that use fuzzy logic to assist the diagnosis of breast lesions. We can find in the literature several descriptions and evaluations of CAD systems, as well as computer-aided detection systems, which were designed and implemented to improve the results of the analysis of breast images, without the use of fuzzy logic.

Dromaina et al. [35] present a review of studies about CAD systems used in mammography and their performance in assistance of reading in screening mammography and as an alternative to double reading. Analyzing several papers they point that CAD-assisted reading is associated with a moderate increase in sensitivity and with a drop in specificity. They also describe studies that show evidences of the advantage of using CAD systems as an alternative to double reading, as well as a clear benefit in using CAD in less experienced or low volume reviewers. Moreover, Bhanumathi and Suresh [36] presents an overview of recent advances in the development of computer-aided detection systems and related techniques for breast cancer based on mammograms. They conclude that upcoming work should focus on the improvement of the performance of these kind of systems.

Moon et al. [37] constructed a CAD system based on information from the radiologists regarding features proposed by BI-RADS for breast ultrasound (US) exams, including shape, orientation, margins, lesion boundary, echo pattern, and posterior acoustic features. The system was used for tumor classification on a database containing benign and malignant masses. Using ROC curves for evaluation, the area under curve (AUC) over 90% sensitivity of the proposed CAD was better than that of a conventional CAD based on the combination of quantitative features (0.90 vs. 0.76). In additions, Shen et al. [38] studied the effectiveness of that features in the same image database. Binary logistic regression model was used to relate all proposed features and pathological result as a CAD system. The correlation between the angular characteristic and pathological result was indicated as very high. On the other hand, the diagnostic values of posterior acoustic feature and orientation feature were relatively low for the CAD system.

Jesneck et al. [39] developed CAD models based on linear discriminant analysis (LDA) and artificial neural network (ANN) that have as input both mammographic and sonographic radiologist-interpreted features from mammograms and as output the classification of masses as benign or malignant. Both the LDA and ANN achieved high classification performance with cross validation: area under the ROC curve=0.92±0.01 (standard deviation) for both. Gupta et al. [40] compared the performance of CAD algorithms using linear discriminant analysis based on BI-RADS descriptors – along with patient age – for masses from mediolateral and craniocaudal views of mammograms. The algorithms based on descriptors from both views performed marginally better than algorithms based on descriptors from a single view. The average results of two classifiers trained separately on both views reached the best performance: AUC=0.920±0.027.

Delogu et al. [41] developed a CAD system consisting of a neural classifier for mass characterization based on a gradient segmentation algorithm that extracts several features related to shape, size and intensity of the image. The capability of the system in discriminating malignant from benign masses has been evaluated in terms of the receiver-operating characteristic (ROC) analysis. The system reached AUC=0.780±0.023. Giannakopoulou et al. [42] in turn developed a CAD system to discriminate the real benign microcalcifications among a specific set of patients with BI-RADS 3 mammograms who had undergone biopsy, thus making it possible to downgrade them to BI-RADS 2 category. The system detected and quantified critical features of microcalcifications and classified them on a risk percentage scale for malignancy. The system characterized as BI-RADS 2 33% of benign lesions previously assigned to BI-RADS 3.

The systems described here, as well as those described in Section 1, present differences concerning type of image, set of features, classification algorithm and/or evaluation measures. We did not find a CAD system that uses the same input data, the same category of image and the same evaluation measure (even a non-fuzzy one) adopted by us in our approach. Thus, it is not appropriate to carry out a direct comparison with them concerning accuracy. Nevertheless, we can observe that in general the performances reached by the related systems are high. However, they usually classify the images only into two classes (benign and malignant), whereas our system considers four classes (BI-RADS 2, 3, 4 and 5), which represent a more complex and challenging approach. Moreover, as a fuzzy system, our approach presents the advantages of being semantically more robust and more user-friendly.

The subjectivity in the process of evaluating a breast lesion became evident when analyzing the data collected in the interviews with radiologists. The numerical evaluation of their deviation showed a high value of inter-variability. The use of fuzzy logic allowed the representation of this subjectivity. This is another great advantage of using fuzzy logic. Also, all the BI-RADS parameters could be easily represented in our model through the malignancy coefficients. Despite fuzzy logic being very suitable to handle the inter-variability, the system can be influenced negatively by this variability as any other machine learning technique.

On the other hand, a problem faced by fuzzy-based systems is that they are dependant on the subjectivity of the experts. We tried to handle this issue by using the Fuzzy-Omega method to generate the membership functions.

@&#CONCLUSION@&#

This paper presents a method for the fuzzy characterization of the main linguistic terminology descriptors used in the evaluation of breast nodules and calcifications, as well as the BI-RADS categories associated with them, for mammographic images. The proposed system was developed in collaboration with domain specialists. Computational methods supported the steps of the system modeling and implementation. The result is a CAD system that suggests to the user a BI-RADS category following the input of the descriptors for masses and microcalcifications.

The use of fuzzy concepts distinguishes our approach by giving it important functionalities: first, the input of data is carried by a more semantically and friendly way, since the user is allowed to qualify the descriptors in degrees. The input parameters are quite close to the natural way the radiologist evaluates and classifies findings in an image. By treating the BI-RADS attributes as fuzzy sets, it was possible to determine a degree of pertinence of a finding to each BI-RADS category and also to provide to the user the chance to perform a quantitative analysis. Second, the output is shown by means of degrees of pertinence to the most probable classes, giving to the user a richer suggestion. These are the most relevant contribution of our work. Regarding the membership functions, the use of the Fuzzy-Omega algorithm proved to be suitable for processing the input coefficients. This method automatically generates membership functions, overcoming the issues related to the modeling of functions only with linguistic parameters based on the subjectivity of a specialist. Considering, for instance, the case of working with intrinsic attributes of images, such as Fourier coefficients, who represents the domain expert? In this case, the Fuzzy-Omega algorithm can play an important role.

The results of our experiments, concerning accuracy and sensitivity/specificity, showed that our approach is promising and represents a new step as a CAD system. As future work, the use of images with BI-RADS categories confirmed by complementary exams as gold standard would be an important step to perform a more precise evaluation.

This system can be seen as a relevant tool in radiology environments, providing a second opinion to the specialists. It can contribute to approach divergent opinions and to train inexperienced professionals, thus generating more accurate diagnosis.

@&#SUMMARY@&#

CAD systems based on medical imaging aim to assist and improve accuracy of diagnosis through the use of a computer, indicating suspicious areas in the image as well as abnormalities. This assistance can be very important since the radiologist׳s diagnosis is based on subjective analysis and personal variations, such as visual fatigue or distraction, image quality and overlay structures, among others. Throughout its evolution, research projects addressing methods for CAD encountered a significant obstacle: the so-called “semantic gap”, which is characterized by the divergence between the results of automated methods and the results expected by users, due to the difficulties of these methods to represent real situations. Fuzzy logic can help to reduce the difficulties faced by computational systems to represent and simulate the reasoning and the style adopted by the radiologists in the process of medical image analysis.

The study described in this paper consists of a new method that applies concepts of Fuzzy logic to improve the representation of features related to image description in order to make it semantically more consistent with the user criterion. Specifically, we have developed a computer-aided diagnosis system for automatic BI-RADS categorization of breast lesions. The user provides values of descriptors such as contour, shape, and density and the system yields a suggestion about the BI-RADS class. Initially, values of malignancy are defined for each image descriptor, according to BI-RADS features. Specifically for the contour attribute, the method considers the matching of features and linguistic variables. The second step consists in the construction of the fuzzy inference system. Then, the creation of membership functions is done by the Fuzzy Omega algorithm, based on statistical analysis of the data set to map the distribution of different classes.

A set of images was analyzed by a group of experts and by the Fuzzy Omega algorithm. The results were compared, achieving an accuracy of 76.67% for nodules and 83.34% for calcifications. The subjectivity in the process of evaluating a breast lesion became evident when analyzing the data collected in the interviews with radiologists. The fit of definitions and linguistic rules to numerical models provided by our method can lead to a tighter connection between the specialist and the computer system, yielding more effective and reliable results. By treating the BI-RADS attributes as fuzzy sets, it was possible to determine a degree of pertinence of a finding to each BI-RADS category and also to provide to the user the chance to perform a quantitative analysis.

None declared.

@&#ACKNOWLEDGMENTS@&#

The authors thank the radiologists of School Hospital of Medicine of University of São Paulo at Ribeirão Preto, Brazil, for the analysis of the selected images.

This research was supported by the São Paulo Research Foundation (FAPESP) (Grant no. 07/59862-0).

@&#REFERENCES@&#

