@&#MAIN-TITLE@&#Mixture model selection via hierarchical BIC

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new HBIC criterion is proposed for model selection in mixture models.


                        
                        
                           
                           BIC ignores the clustered data structure while HBIC matches the structure well.


                        
                        
                           
                           HBIC is a large sample approximation of variational Bayesian lower bound.


                        
                        
                           
                           BIC is a less accurate approximation.


                        
                        
                           
                           The results show that HBIC outperforms BIC and BIC suffers from underestimation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Model selection

Mixture model

EM

Maximum likelihood estimation

BIC

Hierarchical BIC

Clustering

@&#ABSTRACT@&#


               
               
                  The Bayesian information criterion (BIC) is one of the most popular criteria for model selection in finite mixture models. However, it implausibly penalizes the complexity of each component using the whole sample size and completely ignores the clustered structure inherent in the data, resulting in over-penalization. To overcome this problem, a novel criterion called hierarchical BIC (HBIC) is proposed which penalizes the component complexity only using its local sample size and matches the clustered data structure well. Theoretically, HBIC is an approximation of the variational Bayesian (VB) lower bound when sample size is large and the widely used BIC is a less accurate approximation. An empirical study is conducted to verify this theoretical result and a series of experiments is performed on simulated and real data sets to compare HBIC and BIC. The results show that HBIC outperforms BIC substantially and BIC suffers from underestimation.
               
            

@&#INTRODUCTION@&#

Finite mixture models (McLachlan and Peel, 2000) provide flexible and powerful tools for analyzing or modeling heterogeneous multivariate data, in particular, the clustered/grouped data collected from multiple sources, and has been widely used in many fields such as pattern recognition, signal processing, computer vision, engineering, bioinformatics, etc. The Gaussian mixture model (GMM) has achieved much attention in the literature, mainly because of its simplicity and wide applicability in real data analyses.

However, when the covariance structure of GMM is full (FGMM), the number of model parameters to be estimated (i.e. the number of degrees of freedom) increases quadratically with the data dimension and linearly with the number of mixture components, usually leading FGMM to suffer from overfitting for high dimensional data. In such cases, it is necessary to use more parsimonious covariance structures to reduce the number of degrees of freedom in FGMM. Banfield and Raftery (1993), Bensmail et al. (1997) and Celeux and Govaert (1995) propose using various constraints on the eigen-decomposed component covariances, yielding a family of GMMs that enjoys a wide range of degrees of freedom. For clarity, this family is called eigen-decomposed GMMs (EDGMM) in this paper.

The fitting for EDGMM can be carried out by maximum likelihood (ML) or maximum a posteriori (MAP) methods via the popular expectation maximization (EM) algorithm (Dempster et al., 1977). The well known R software mclust (Fraley and Raftery, 2002; Fraley et al., 2012) implements a subset of ten of these models. The Matlab software mixmod (Biernacki et al., 2006) and R software mixture (Browne and McNicholas, 2014) implement all of the fourteen models. Recent developments of EDGMM include the incorporation of 
                        t
                      distributions to deal with outliers (
                        t
                     -EDGMM;  Andrews and McNicholas, 2012), the incorporation of skew distributions to further tackle asymmetry (skew-EDGMM;  Vrbik and McNicholas, 2014) and the extension of 
                        t
                     -EDGMM in the presence of missing data (Lin, 2014).

A central issue in learning EDGMM is to determine a suitable number of mixture components and covariance structure. The Bayesian information criterion (BIC) proposed in Schwarz (1978) is commonly used for this purpose and has been taken as the default model selection criterion in mclust, mainly due to its theoretical consistency result (Keribin, 2000) and substantial practical evidence for satisfactory performance in a number of applications (see, e.g.  Fraley and Raftery, 1998, 2002). Despite its popularity, as can be seen in Section  2.4.1, BIC implausibly penalizes the complexity of each component using the whole sample size and completely ignores the clustered structure inherent in the data, leading to over-penalization.

In this paper, we develop a novel criterion for model selection in EDGMM called hierarchical BIC (HBIC), which penalizes the component complexity only using its local sample size and well matches the clustered data structure. More importantly, we show theoretically that HBIC is an approximation of the variational Bayesian (VB) lower bound when sample size is large and the widely used BIC is a less accurate approximation. Our proposed HBIC is an extension of the criterion under the mixture of factor analyzers in Zhao et al. (2013), which is only applicable to the case of no constraints across components and cannot be used for learning EDGMM.

The remainder of the paper is organized as follows. Section  2 reviews the EDGMM family and two commonly used model selection criteria. In Section  3 we propose a new criterion for EDGMM called hierarchical BIC, which is derived from the variational Bayesian (VB) lower bound in the large sample limit as shown in Section  3. In Section  4, we perform experiments to test our theoretical result and compare HBIC with related competitors. Section  5 ends the paper with a conclusion and some discussions on future works.

In this section, we briefly review the family of eigen-decomposed Gaussian mixture models (EDGMM), its associated algorithms, and two frequently used model selection criteria.

Let 
                           
                              x
                           
                         be a 
                           d
                        -dimensional random vector drawn from a 
                           g
                        -component Gaussian mixture model (GMM). The probability density function (pdf) of 
                           
                              x
                           
                         is given by 
                           
                              
                                 p
                                 
                                    (
                                    
                                       x
                                    
                                    |
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                         is the prior probability of component 
                           k
                         satisfying 
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                           ≥
                           0
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           g
                        , and 
                           
                              
                                 ∑
                              
                              
                                 k
                              
                           
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                           =
                           1
                        , 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       μ
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       Σ
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is the component parameter specified by mean 
                           
                              
                                 
                                    μ
                                 
                              
                              
                                 k
                              
                           
                         and covariance 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                        , 
                           
                              θ
                           
                           ≡
                           
                              {
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                              k
                              =
                              1
                              ,
                              …
                              ,
                              g
                              }
                           
                         collects the set of parameters in the GMM, and the 
                           k
                        -component pdf 
                           p
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is given by 
                           
                              
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                    
                                    
                                       −
                                       d
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                k
                                             
                                          
                                          |
                                       
                                    
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 exp
                                 
                                    {
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         Given a set of i.i.d. sample data 
                           
                              X
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , the log-likelihood of a 
                           g
                        -component GMM is 
                           
                              
                                 L
                                 
                                    (
                                    
                                       X
                                    
                                    |
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 log
                                 
                                    [
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 .
                              
                           
                         The ML estimate 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 ˆ
                              
                           
                         is obtained by maximizing the log-likelihood 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg max
                                       
                                    
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 
                                    {
                                    L
                                    
                                       (
                                       
                                          X
                                       
                                       |
                                       
                                          θ
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         If the prior 
                           p
                           
                              (
                              
                                 θ
                              
                              )
                           
                         for model parameter 
                           
                              θ
                           
                         is available, then the MAP estimate 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 ˆ
                              
                           
                         can be obtained by 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg max
                                       
                                    
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 
                                    {
                                    L
                                    
                                       (
                                       
                                          X
                                       
                                       |
                                       
                                          θ
                                       
                                       )
                                    
                                    +
                                    log
                                    p
                                    
                                       (
                                       
                                          θ
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

If the covariance 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                         is in general form, the number of free parameters of 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                         to be estimated increases quadratically with the data dimension 
                           d
                         and linearly with the number of components 
                           g
                        . In the case that the sample size 
                           N
                         is relatively small compared with the data dimension 
                           d
                        , GMM usually suffers from overfitting and it is necessary to employ more parsimonious covariance structures or constrain 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                        ’s to prevent overfitting. For example, 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              Σ
                           
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           g
                        , restrict all the components to share a common 
                           
                              Σ
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           
                              I
                           
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           g
                        , restrict all of the component covariances to be spherical, where 
                           
                              I
                           
                         denotes an identity matrix of suitable dimension. More generally, Celeux and Govaert (1995) propose the EDGMM family of 14 parsimonious GMMs which enjoys a wide range of degrees of freedom. EDGMM is obtained by employing various constraints on the eigen-decomposed component covariances 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                        ’s as follows.
                           
                              (1)
                              
                                 
                                    
                                       
                                          Σ
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 
                                    |
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    |
                                 
                              
                              
                                 1
                                 /
                                 d
                              
                           
                         is the scalar determining the volume of the component 
                           k
                        , 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 k
                              
                           
                         is the matrix of eigenvectors determining its orientation and 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 k
                              
                           
                         is proportional to the diagonal matrix of eigenvalues determining its shape (
                           
                              |
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    k
                                 
                              
                              |
                           
                           =
                           1
                        ). By either restricting some of 
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 k
                              
                           
                         to be equal (‘E’) across components or allowing them to vary (‘V’), a family of fourteen different models can be obtained.

For notation convenience, the free and common component parameters in 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                           
                         are respectively denoted by 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                        , i.e., 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        . Correspondingly, 
                           
                              
                                 D
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                         are the number of free parameters of 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                        , respectively. Table 1
                         lists all the members in the EDGMM family and their associated number of free (
                           
                              
                                 D
                              
                              
                                 k
                              
                           
                        ) and common (
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        ) parameters to be estimated.

The expectation maximization (EM) algorithm (Dempster et al., 1977) is a well known iterative procedure for finding the ML estimate. In the 
                           t
                        -th iteration, the value 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                         of the model parameter is updated into its new version 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                         through an E-step to obtain the expected complete data log-likelihood, i.e., the so-called 
                           Q
                         function, followed by a M-step to maximize 
                           Q
                         with respect to (w.r.t.) 
                           
                              θ
                           
                        . Celeux and Govaert (1995) give the implementations of the EM for all members in the EDGMM family. Below we give a sketch on this.

Consider the complete data 
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 Z
                              
                              )
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             z
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , where 
                           
                              
                                 
                                    z
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                    k
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                    g
                                 
                              
                              )
                           
                        , 
                           
                              
                                 z
                              
                              
                                 i
                                 k
                              
                           
                         is an indicator variable taking the value 1 if 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         comes from the 
                           k
                        -th component, and 0 otherwise. The complete data log-likelihood is 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    ,
                                    
                                       Z
                                    
                                    |
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 log
                                 
                                    (
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 .
                              
                           
                        
                        E-step: Computes the expected 
                           
                              
                                 L
                              
                              
                                 c
                              
                           
                         given 
                           
                              X
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                        : 
                           
                              
                                 Q
                                 
                                    (
                                    
                                       θ
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 E
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    )
                                 
                                 log
                                 
                                    (
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         depending only on 
                           
                              (
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         of component 
                           k
                        . The posterior probability of data point 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         belonging to component 
                           k
                         is computed by 
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ≜
                                 E
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 P
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    1
                                    |
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                       p
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                       p
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         It is convenient to define the local sample covariance matrix 
                           
                              (2)
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       k
                                    
                                    
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 ≜
                                 
                                    
                                       1
                                    
                                    
                                       N
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                        
                        M-step: For ML estimate, maximizing 
                           Q
                         w.r.t. 
                           
                              θ
                           
                         under the restriction 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 g
                              
                           
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                           =
                           1
                        , we have the following updating equations:
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                          
                                             
                                                π
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                 
                              
                           
                         and the equation for 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 k
                              
                           
                         depends on the parametrization. For the VVV model, we have 
                           
                              (4)
                              
                                 
                                    [
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 eig
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              [
                              λ
                              ,
                              
                                 D
                              
                              ,
                              
                                 A
                              
                              ]
                           
                           =
                           eig
                           
                              (
                              
                                 B
                              
                              )
                           
                         performs the eigen-decomposition as in (1). Let 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                              
                           
                           
                              
                                 π
                              
                              
                                 k
                              
                              
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 k
                              
                              
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                        . For the EEE model, we have 
                           
                              (5)
                              
                                 
                                    [
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             D
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 eig
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The updating formulae for the other models are available in Celeux and Govaert (1995).

For MAP estimate, 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                         is obtained by 
                           
                              (6)
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg max
                                       
                                    
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 
                                    {
                                    Q
                                    
                                       (
                                       
                                          θ
                                       
                                       |
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    log
                                    p
                                    
                                       (
                                       
                                          θ
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

In this subsection, we briefly review two commonly used model selection criteria for the EDGMM family: Bayesian information criterion (BIC;  Schwarz, 1978) and integrated complete-data likelihood criterion (ICL;  Biernacki et al., 2000). Formally, both criteria can be summarized into the general form 
                           
                              (7)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    g
                                    ,
                                    c
                                    ,
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       g
                                       ,
                                       c
                                       )
                                    
                                    )
                                 
                                 =
                                 L
                                 
                                    (
                                    
                                       X
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       g
                                       ,
                                       c
                                       )
                                    
                                    )
                                 
                                 −
                                 P
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       g
                                       ,
                                       c
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           c
                         ranges over 14 candidate covariance structures detailed in Table 1 and 
                           P
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 g
                                 ,
                                 c
                                 )
                              
                              )
                           
                         is a penalty term that penalizes the higher values of 
                           g
                         and more complex covariance structure 
                           c
                        . Given a range of values of 
                           g
                         from 
                           
                              
                                 g
                              
                              
                                 
                                    min
                                 
                              
                           
                         to 
                           
                              
                                 g
                              
                              
                                 
                                    max
                                 
                              
                           
                        , which is assumed to include the optimal one, the optimal model 
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         is chosen as 
                           
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          arg max
                                       
                                    
                                    
                                       
                                          (
                                          g
                                          ,
                                          c
                                          )
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          L
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       g
                                       ,
                                       c
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       
                                          (
                                          g
                                          ,
                                          c
                                          )
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

The Bayesian information criterion (BIC;  Schwarz, 1978) is one of the most popular criterion for model selection in the EDGMM family due to its theoretical consistency in choosing the number of components (Keribin, 2000) and satisfactory performance in a number of applications (Fraley and Raftery, 1998, 2002). For 
                              g
                           -component EDGMM, the penalty term of BIC in (7) is given by 
                              
                                 (8)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             bic
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          k
                                       
                                    
                                    log
                                    N
                                    +
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          g
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    N
                                    ,
                                 
                              
                            where 
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    D
                                 
                                 
                                    0
                                 
                              
                            are the number of free and common parameters in 
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                              
                           , respectively.

It can be observed from (8) that 
                              
                                 
                                    D
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                            are treated equivalently in the sense that both are penalized by the same sample size 
                              N
                           , which means that BIC uses the whole sample size 
                              N
                            to determine the 
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                            of component 
                              k
                           . However, from (2) and (3), the effective sample size for estimating the 
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                                 
                                    s
                                 
                              
                            of component 
                              k
                            in EDGMM is not 
                              N
                            but 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                            only. For illustration, Fig. 1
                            shows a toy data set of two-well separated clusters, where cluster 1 and 2 have 50 and 450 observations, respectively. For this data, BIC uses the total sample size 
                              N
                              =
                              500
                            to determine 
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                           , rather than the effective sample size 50, resulting in over-penalization for component 1. In short, BIC ignores the clustered data structure completely and suffers from over-penalization.

The integrated complete-data likelihood criterion (ICL;  Biernacki et al., 2000) is an extension of BIC that tends to favor well-separated mixtures. The penalty of ICL comprises the BIC penalty and an additional entropy term that measures the overlap among components 
                              
                                 (9)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             icl
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          
                                             bic
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    MAP
                                    
                                       {
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       }
                                    
                                    log
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ,
                                 
                              
                            where 
                              MAP
                              
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 }
                              
                            is the MAP classification with 
                              
                                 
                                    r
                                 
                                 
                                    i
                                    k
                                 
                              
                           , taking 1 if 
                              
                                 
                                    
                                       arg max
                                    
                                 
                                 
                                    l
                                 
                              
                              
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       l
                                    
                                 
                                 }
                              
                              =
                              k
                            and 0 otherwise.

We propose in Section  3.1 a new criterion called hierarchical BIC (HBIC) for model selection in the EDGMM family. In Section  3.2, we show that HBIC is a large sample approximation of the variational Bayesian (VB) lower bound. In Section  3.1.1, we discuss its relationship with BIC.

The proposed criterion also has the general form (7) but with a new penalty term 
                           
                              (10)
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          hbic
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       k
                                    
                                 
                                 log
                                 
                                    (
                                    N
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       g
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 log
                                 N
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 k
                              
                           
                         is the ML/MAP estimate, 
                           
                              
                                 D
                              
                              
                                 k
                              
                           
                         (resp. 
                           
                              
                                 D
                              
                              
                                 0
                              
                           
                        ) is the number of free parameters of 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                         (resp. 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                        ).

Different from BIC in (8), it can be seen from (10) that HBIC determines 
                           
                              
                                 D
                              
                              
                                 k
                              
                           
                         only using the corresponding effective sample size 
                           N
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 k
                              
                           
                         and thus HBIC well matches the clustered data structure as detailed in Section  2.4.1. The key to HBIC is that the parameters are penalized only based on their relevant effective sample sizes. In fact, this idea is not new. For example, Steele (2002) has examined a special case of HBIC under the VVV structure for model selection of one-dimensional GMM and Gollini and Murphy (2014) have further investigated this criterion under mixtures of latent trait analyzers. A theoretical justification of this criterion is given in Zhao et al. (2013). The main difference from this paper is that Zhao et al. (2013) consider the case of no constraints across components while, for EDGMM, we must consider the case that there are constraints across components. Similar criteria for hierarchical or random effects models have also been suggested in Pauler (1998) and Raftery et al. (2007).

On the other hand, it can be seen from (10) that HBIC seems not sensitive to the spurious components that have small values of 
                           N
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 k
                              
                           
                        . In Section  4.2.1, we find that this drawback can be easily eliminated by means of a component annihilation step detailed in Section  4.1.2.

Comparing (8) and (10), we see that (i) when 
                              g
                              =
                              1
                            (i.e., one-component mixture), HBIC degenerates into BIC; and (ii) when 
                              g
                              >
                              1
                           , since 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              ≤
                              N
                           , BIC penalizes the model more heavily than HBIC. Despite the difference, there exist close relationships between HBIC and BIC. In HBIC, BIC is performed in a ‘hierarchical’ manner: the first hierarchy is a global BIC and the second hierarchy is a local BIC. 
                              
                                 •
                                 global BIC for 
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                    ’s and common component parameter 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             0
                                          
                                       
                                    : Since all 
                                       N
                                     data points are devoted to estimating 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             0
                                          
                                       
                                     and the 
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                    ’s under the constraint 
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       1
                                    , the corresponding BIC penalized term to 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             0
                                          
                                       
                                     is 
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                       /
                                       2
                                       log
                                       N
                                     and 
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                    ’s is 
                                       
                                          (
                                          g
                                          −
                                          1
                                          )
                                       
                                       /
                                       2
                                       log
                                       N
                                    , which yields the second term in (10).

local BIC for free component parameter 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    : Since the estimation of 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                     is based on the local effective sample size 
                                       N
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                    , the corresponding BIC penalized term to 
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                     is 
                                       
                                          
                                             D
                                          
                                          
                                             k
                                          
                                       
                                       /
                                       2
                                       log
                                       
                                          (
                                          N
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    . Summing over all the 
                                       g
                                     components leads to the first term in (10).

In the Bayesian treatment of EDGMM, the true posterior 
                           p
                           
                              (
                              
                                 Z
                              
                              ,
                              
                                 θ
                              
                              |
                              
                                 X
                              
                              )
                           
                         is usually intractable. In such a situation, it is often preferred to find a deterministic approximation solution. To this end, the variational Bayesian (VB) adopts a tractable 
                           q
                         to approximate 
                           p
                         and optimizes a lower bound 
                           F
                         of the log marginal likelihood 
                           log
                           p
                           
                              (
                              
                                 X
                              
                              )
                           
                        . By Jensen’s inequality, 
                           
                              (12)
                              
                                 log
                                 p
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 log
                                 ∫
                                 p
                                 
                                    (
                                    
                                       X
                                    
                                    ,
                                    
                                       Z
                                    
                                    ,
                                    
                                       θ
                                    
                                    )
                                 
                                 d
                                 
                                    Z
                                 
                                 d
                                 
                                    θ
                                 
                                 ≥
                                 ∫
                                 q
                                 
                                    (
                                    
                                       Z
                                    
                                    ,
                                    
                                       θ
                                    
                                    )
                                 
                                 log
                                 
                                    
                                       p
                                       
                                          (
                                          
                                             X
                                          
                                          ,
                                          
                                             Z
                                          
                                          ,
                                          
                                             θ
                                          
                                          )
                                       
                                    
                                    
                                       q
                                       
                                          (
                                          
                                             Z
                                          
                                          ,
                                          
                                             θ
                                          
                                          )
                                       
                                    
                                 
                                 d
                                 
                                    Z
                                 
                                 d
                                 
                                    θ
                                 
                                 =
                                 F
                                 
                                    (
                                    q
                                    )
                                 
                                 .
                              
                           
                         The tractable 
                           q
                         can often be obtained by assuming that 
                           q
                         factorizes over 
                           
                              Z
                           
                         and 
                           
                              θ
                           
                        : 
                           
                              (13)
                              
                                 q
                                 
                                    (
                                    
                                       Z
                                    
                                    ,
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 q
                                 
                                    (
                                    
                                       Z
                                    
                                    )
                                 
                                 q
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 .
                              
                           
                         Following Bishop (2006), we use the priors 
                           
                              (14)
                              
                                 p
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 p
                                 
                                    (
                                    
                                       π
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 and ,
                                 
                                 p
                                 
                                    (
                                    
                                       π
                                    
                                    )
                                 
                                 =
                                 Dir
                                 
                                    (
                                    
                                       π
                                    
                                    |
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 C
                                 
                                    (
                                    
                                       
                                          
                                             π
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              Dir
                           
                           
                              (
                              ⋅
                              )
                           
                         denotes the Dirichlet distribution and 
                           C
                           
                              (
                              
                                 
                                    
                                       π
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           =
                           Γ
                           
                              (
                              g
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           /
                           Γ
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                              
                                 g
                              
                           
                         is the normalization coefficient of 
                           p
                           
                              (
                              
                                 π
                              
                              )
                           
                        . With the priors in (14), we obtain the additional factorization 
                           
                              (15)
                              
                                 q
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 q
                                 
                                    (
                                    
                                       π
                                    
                                    )
                                 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                    
                                 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Let 
                           E
                           
                              
                                 
                                    [
                                    ⋅
                                    ]
                                 
                              
                              
                                 q
                                 
                                    (
                                    ⋅
                                    )
                                 
                              
                           
                         stand for an expectation w.r.t. the distribution 
                           q
                           
                              (
                              ⋅
                              )
                           
                        . Substituting (13) and (15) into (12) and maximizing 
                           F
                         over 
                           q
                           
                              (
                              
                                 Z
                              
                              )
                           
                        , 
                           q
                           
                              (
                              
                                 π
                              
                              )
                           
                        , 
                           q
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         and 
                           q
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           g
                        , yields the following VBEM updating steps: 
                           
                              •
                              VBE-step: 
                                    
                                       (16)
                                       
                                          q
                                          
                                             (
                                             
                                                Z
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                ∏
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                ∏
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                g
                                             
                                          
                                          q
                                          
                                             (
                                             
                                                
                                                   
                                                      z
                                                   
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                  where 
                                    
                                       (17)
                                       
                                          log
                                          q
                                          
                                             (
                                             
                                                
                                                   
                                                      z
                                                   
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          
                                             (
                                             E
                                             
                                                
                                                   
                                                      [
                                                      log
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   q
                                                   
                                                      (
                                                      
                                                         π
                                                      
                                                      )
                                                   
                                                
                                             
                                             +
                                             E
                                             
                                                
                                                   
                                                      [
                                                      log
                                                      p
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   q
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      )
                                                   
                                                   q
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             const.
                                          
                                       
                                    
                                 
                              

VBM-step: 
                                    
                                       
                                          (18)
                                          
                                             q
                                             
                                                (
                                                
                                                   π
                                                
                                                )
                                             
                                             =
                                             Dir
                                             
                                                (
                                                
                                                   π
                                                
                                                |
                                                
                                                   α
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                       
                                          (19)
                                          
                                             log
                                             q
                                             
                                                (
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   g
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             E
                                             
                                                
                                                   
                                                      [
                                                      log
                                                      p
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   q
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             +
                                             log
                                             p
                                             
                                                (
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                const
                                             
                                             ,
                                          
                                       
                                    
                                  and 
                                    
                                       (20)
                                       
                                          log
                                          q
                                          
                                             (
                                             
                                                
                                                   
                                                      θ
                                                   
                                                
                                                
                                                   k
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          E
                                          
                                             
                                                
                                                   [
                                                   log
                                                   p
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                             
                                                q
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          +
                                          log
                                          p
                                          
                                             (
                                             
                                                
                                                   
                                                      θ
                                                   
                                                
                                                
                                                   k
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             const
                                          
                                          ,
                                       
                                    
                                 
                              

Substituting (16), (18)–(20) into (12), we can write 
                           F
                         as 
                           
                              (21)
                              
                                 F
                                 =
                                 
                                    
                                       
                                          
                                             E
                                             
                                                
                                                   
                                                      [
                                                      log
                                                      
                                                         
                                                            p
                                                            
                                                               (
                                                               
                                                                  X
                                                               
                                                               ,
                                                               
                                                                  Z
                                                               
                                                               |
                                                               
                                                                  θ
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            q
                                                            
                                                               (
                                                               
                                                                  Z
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   q
                                                   
                                                      (
                                                      
                                                         Z
                                                      
                                                      )
                                                   
                                                   q
                                                   
                                                      (
                                                      
                                                         θ
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             KL
                                             
                                                [
                                                q
                                                
                                                   (
                                                   
                                                      π
                                                   
                                                   )
                                                
                                                ∥
                                                p
                                                
                                                   (
                                                   
                                                      π
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             KL
                                             
                                                [
                                                q
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ∥
                                                p
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   g
                                                
                                             
                                             KL
                                             
                                                [
                                                q
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                ∥
                                                p
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         In the large 
                           N
                         limit, we have 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          D
                                       
                                    
                                    =
                                    L
                                    
                                       (
                                       
                                          X
                                       
                                       |
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    +
                                    O
                                    
                                       (
                                       1
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          m
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    N
                                    −
                                    log
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                π
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    +
                                    O
                                    
                                       (
                                       1
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    N
                                    −
                                    log
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    +
                                    O
                                    
                                       (
                                       1
                                       )
                                    
                                    ,
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 log
                                 
                                    (
                                    N
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 −
                                 log
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 +
                                 O
                                 
                                    (
                                    1
                                    )
                                 
                                 .
                              
                           
                         The proofs for these limits are in general similar to those for the mixtures of factor analyzers in Zhao et al. (2013). Since the proof for the limit of 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         is directly available from Zhao et al. (2013), we simply give the proofs for 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 D
                              
                           
                         in Appendices A and B. By further dropping the order-1 term 
                           p
                           
                              (
                              
                                 
                                    
                                       π
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           +
                           p
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 k
                              
                           
                           log
                           p
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                                 
                                    s
                                 
                              
                              )
                           
                        , we obtain 
                           Theorem 1
                           
                              As the sample size 
                              
                                 N
                               
                              tends to infinity,
                              
                                 
                                    
                                       F
                                       =
                                       L
                                       
                                          (
                                          
                                             X
                                          
                                          |
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             
                                                hbic
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       +
                                       O
                                       
                                          (
                                          1
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          hbic
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                               
                              is given by   (10)
                              .
                           

The HBIC criterion in Section  3.1 follows from Theorem 1. Theorem 1 shows that HBIC is a large sample limit of the VB lower bound 
                           F
                        , which establishes the connection between HBIC and VB, similar to that between BIC and Bayesian. With this connection, we can use HBIC reliably when sample size is large.

@&#EXPERIMENTS@&#

In this section, we perform a series of experiments on synthetic and real-world data sets. The first objective is to empirically examine Theorem 1 and the second is to compare the proposed HBIC with the two commonly used model selection criteria: (i) BIC (Fraley and Raftery, 2002) and (ii) ICL (Biernacki et al., 2000). The parameter estimation is performed by a variant of the EM implementation (Celeux and Govaert, 1995) as detailed in Section  4.1, except that the EVE and VVE models are based on the majorization minimization implementation recently proposed in Browne and McNicholas (2014). Since BIC, ICL, and HBIC differ only in the penalty term, for fair comparison, we compute the values of all criteria using the same estimate.

In this subsection, we discuss several strategies used for our implementation of EDGMM, including maximum a posteriori (MAP) estimation, component annihilation, initialization and convergence criterion.

Since the ML estimate of EDGMM may suffer from the problem of singularities and in this case its BIC or HBIC value cannot be computed, Fraley and Raftery (2007) suggest using the MAP estimate. Inspired by Srivastava et al. (2007), we use the prior 
                              
                                 (22)
                                 
                                    p
                                    
                                       (
                                       
                                          θ
                                       
                                       )
                                    
                                    =
                                    p
                                    
                                       (
                                       
                                          π
                                       
                                       )
                                    
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ∝
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                          
                                       
                                       
                                          −
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       {
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       tr
                                       
                                          (
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             B
                                          
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                            where 
                              
                                 B
                              
                            is a positive definite matrix. The prior (22) assumes an inverted Wishart prior with 
                              g
                            degrees of freedom over 
                              
                                 
                                    
                                       Σ
                                    
                                 
                                 
                                    k
                                 
                              
                            and noninformative priors for component probability 
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           ’s and mean 
                              
                                 
                                    
                                       μ
                                    
                                 
                                 
                                    k
                                 
                              
                           ’s.

Substituting (22) into (6), the updating equation for 
                              
                                 
                                    
                                       Σ
                                    
                                 
                                 
                                    k
                                 
                              
                            in the M-step needs some small modifications. For example, for the VVV model, 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    k
                                 
                                 
                                    
                                       (
                                       t
                                       +
                                       1
                                       )
                                    
                                 
                              
                            in (4) is now replaced by 
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                          
                                             
                                                π
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          +
                                          g
                                       
                                    
                                    
                                       (
                                       N
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          B
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          g
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              =
                              g
                              /
                              
                                 (
                                 N
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                    
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 +
                                 g
                                 )
                              
                           . For the EEE model, 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       (
                                       t
                                       +
                                       1
                                       )
                                    
                                 
                              
                            in (5) is now replaced by 
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                          +
                                          g
                                       
                                    
                                    
                                       (
                                       N
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          B
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          g
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              =
                              g
                              /
                              
                                 (
                                 N
                                 +
                                 g
                                 )
                              
                           .

If we let 
                              g
                              =
                              d
                            and take 
                              
                                 B
                              
                            as a scalar covariance, e.g.,  
                              
                                 B
                              
                              /
                              g
                              =
                              r
                              ⋅
                              tr
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              /
                              d
                              ⋅
                              
                                 I
                              
                           , the ML estimates in (23) and (24) are shrunk by scalar covariances, which are similar to that in regularized discriminant analysis (Friedman, 1989). Nevertheless, the regularization parameters 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            herein are data-adaptive as the sample size 
                              N
                            varies. In our experiments, unless else stated, we set 
                              g
                              =
                              d
                            and 
                              r
                              =
                              0.05
                            in (23), which means that we simply use a small amount of regularization.

The spurious component annihilation mechanism (Zhang et al., 2004) is popular for learning GMM in the machine learning community but it seems to receive little attention in the statistics community. This mechanism is another effective way to alleviate the problem of singularities and its origin should be credited to Figueiredo and Jain (2002). If only the MAP estimate is adopted, the final estimate may still include the spurious or insignificant components that have small values of 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           . When the number of components 
                              g
                            is larger than the optimal one, this tends to happen frequently. To overcome this problem, we follow Zhao et al. (2013) in adding a component annihilation step to the immediate MAP estimates of the EM. In detail, we remove the components with 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              ≤
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           , where 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                            is a user-defined parameter. In other words, any components with their effective sample sizes less than 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                            are regarded as spurious components and simply discarded. As a result, the obtained estimate excludes spurious components and guarantees that the H-BIC value can always be computed.

The possible disadvantage of this step is that, when some component 
                              j
                            is of interest but its local sample size 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              <
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           , this component will not survive and be forced to merge with other ones. Therefore, in practice, it may not be good to take a large value of 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           . Unless else stated, we set 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              =
                              15
                            in our experiments.

To tackle the initialization issue, we choose the best run in terms of log-likelihood out of 
                              r
                              =
                              10
                            runs with different 
                              K
                           -means starts. To monitor convergence, we stop the EM algorithm after the relative change in the objective function is smaller than a threshold 10−5.

In this subsection, we use synthetic data to perform three experiments: (i) sensitivity to the component annihilation threshold 
                           
                              
                                 n
                              
                              
                                 0
                              
                           
                        ; (ii) connection among the VB lower bound, HBIC and BIC; (iii) comparison of HBIC with BIC and ICL.

It can be seen from (10) that HBIC seems insensitive to the spurious components that have small values of 
                              N
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           . Therefore, in this experiment, we investigate the effect of 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                            on the performance of HBIC and BIC. We generate 10-dimensional data from the 3-component EVI model parameterized by 
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                π
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          0.2
                                          ,
                                          
                                          0.5
                                          ,
                                          
                                          0.3
                                          )
                                       
                                       ;
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                0
                                                ,
                                                …
                                                ,
                                                0
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       =
                                       0.5
                                       ,
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             3
                                             i
                                          
                                       
                                       =
                                       −
                                       0.5
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       5
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       diag
                                       
                                          {
                                          1
                                          ,
                                          1
                                          ,
                                          1
                                          ,
                                          1
                                          ,
                                          1
                                          ,
                                          0.1
                                          ,
                                          0.1
                                          ,
                                          0.1
                                          ,
                                          0.1
                                          ,
                                          0.1
                                          }
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       diag
                                       
                                          {
                                          1
                                          ,
                                          5
                                          ,
                                          8
                                          ,
                                          10
                                          ,
                                          10
                                          ,
                                          0.09
                                          ,
                                          0.09
                                          ,
                                          0.09
                                          ,
                                          0.09
                                          ,
                                          0.09
                                          }
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       diag
                                       
                                          {
                                          10
                                          ,
                                          10
                                          ,
                                          8
                                          ,
                                          5
                                          ,
                                          1
                                          ,
                                          0.11
                                          ,
                                          0.11
                                          ,
                                          0.11
                                          ,
                                          0.11
                                          ,
                                          0.11
                                          }
                                       
                                       ,
                                       
                                       and
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       /
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   10
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                    
                                 
                              
                            where 
                              diag
                              
                                 {
                                 
                                    v
                                 
                                 }
                              
                            is a diagonal matrix with the elements of vector 
                              
                                 v
                              
                            on its main diagonal.

We choose a moderately large sample size 500, for which it is expected that Theorem 1 would hold approximately and BIC and HBIC would perform similarly. Table 2
                            shows the successful rates in choosing the number of components over 100 repetitions.

It can be observed from Table 2 that BIC is less sensitive than HBIC to the small values of the component annihilation threshold. Nevertheless, HBIC performs reliably when 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              ≥
                              15
                           . In practice, it may not be good to take a large value of 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           , since the number of data points in the class of interest may be smaller than 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           . Therefore, we choose the moderate one: 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              =
                              15
                            in our following experiments.

In this experiment, we empirically investigate our theoretical result that both HBIC and BIC converge to the VB lower bound in the large sample limit. To this end, we generate 
                              d
                              =
                              10
                           -dimensional data from the three-component EII model parameterized by 
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       1
                                       /
                                       3
                                       ,
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          I
                                       
                                       ,
                                       
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                0
                                                
                                                
                                                
                                                0
                                                ⋯
                                                0
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                4
                                                
                                                
                                                
                                                4
                                                ⋯
                                                4
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                       and
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           
                           Fig. 2
                           (a) shows a typical example of this data with sample size 
                              N
                              =
                              400
                            in the first two-dimensional space. Fig. 2(b)–(d) shows the objective function values of BIC, HBIC and the VB lower bound from one replication of different sample sizes. Table 3
                            summarizes the results obtained by 3-component VVV models over 100 replications, where the relative difference of the VB lower bound 
                              F
                            from BIC (resp. HBIC) is defined as 
                              
                                 (
                                 BIC
                                 −
                                 F
                                 )
                              
                              /
                              F
                            (resp. 
                              
                                 (
                                 HBIC
                                 −
                                 F
                                 )
                              
                              /
                              F
                           ).

From Fig. 2 and Table 3, (i) it can be observed that both HBIC and BIC converge to the VB lower bound in the large sample limit; (ii) HBIC is a better approximation to VB than BIC.

We generate the data from the 3-component EVV model parameterized by 
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                π
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          0.2
                                          ,
                                          0.5
                                          ,
                                          0.3
                                          )
                                       
                                       ;
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                0
                                                ,
                                                …
                                                ,
                                                0
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       3.5
                                       +
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       −
                                       3.5
                                       +
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          Ψ
                                       
                                       =
                                       0.2
                                       ⋅
                                       diag
                                       
                                          {
                                          1.0
                                          ,
                                          1.1
                                          ,
                                          …
                                          ,
                                          1.9
                                          }
                                       
                                       ,
                                       
                                       
                                          A
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          A
                                       
                                       ;
                                       
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          A
                                       
                                       
                                          (
                                          :
                                          ,
                                          1
                                          :
                                          3
                                          )
                                       
                                       ;
                                       
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          A
                                       
                                       
                                          (
                                          :
                                          ,
                                          1
                                          :
                                          4
                                          )
                                       
                                       ,
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   Λ
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ]
                                       
                                       =
                                       eig
                                       
                                          (
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             Ψ
                                          
                                          )
                                       
                                       ,
                                       
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          7
                                          ,
                                          7
                                          )
                                       
                                       =
                                       7
                                       ,
                                       
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          5
                                          ,
                                          5
                                          )
                                       
                                       =
                                       5
                                       ,
                                       
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             3
                                          
                                       
                                       
                                          (
                                          6
                                          ,
                                          6
                                          )
                                       
                                       =
                                       6
                                       ;
                                       
                                       λ
                                       =
                                       3
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   10
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       /
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   10
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       and
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       λ
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                Λ
                                             
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                    
                                 
                              
                            where 
                              
                                 A
                              
                              
                                 (
                                 :
                                 ,
                                 1
                                 :
                                 q
                                 )
                              
                            is the matrix consisting of the first 
                              q
                            columns of matrix 
                              
                                 A
                              
                           , 
                              
                                 [
                                 
                                    D
                                 
                                 ,
                                 
                                    Λ
                                 
                                 ]
                              
                              =
                              eig
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                            performs eigen-decomposition of matrix 
                              
                                 B
                              
                            with 
                              
                                 D
                              
                            being an orthogonal matrix of the eigenvectors and 
                              
                                 Λ
                              
                            being a diagonal matrix of the corresponding eigenvalues.

We investigate the accuracy and prediction/generalization performance of all criteria as the sample size 
                              N
                            varies. To access sampling variation, for each 
                              N
                            we generate 100 training data sets. To measure the accuracy, we use the estimated number of mixture components and/or the successful rate in choosing the correct covariance structure. To investigate the prediction performance of the chosen model by each criterion, we follow Zhao and Yu (2009) in using the test log-likelihood. The test log-likelihood is the log-likelihood of the chosen model evaluated on an independent (or unseen) test data set with size 5000. The test log-likelihood is typically useful for comparing different criteria, because it can show that which criterion yields the best performance, even if its chosen model is not the true.

In the first experiment, we investigate the performance in selecting the number of components only. To this end, we fix the covariance structure to be the true EVV and perform model selection over the set 
                              
                                 {
                                 g
                                 }
                              
                           , where the number of components 
                              g
                            ranges from 
                              
                                 
                                    g
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              =
                              1
                            to 
                              
                                 
                                    g
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              =
                              15
                           . Fig. 3
                            shows the results.

In the second experiment, we investigate the performance in selecting the number of components and the type of covariance structures simultaneously. For all criteria, we perform model selection over the set 
                              
                                 {
                                 
                                    (
                                    g
                                    ,
                                    c
                                    )
                                 
                                 }
                              
                           , where the number of components 
                              g
                            ranges from 
                              
                                 
                                    g
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              =
                              1
                            to 
                              
                                 
                                    g
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              =
                              15
                            and 
                              c
                            ranges over the 14 candidate covariance structures shown in Table 1. Fig. 4
                            shows the results. The main observations from Figs. 3 and 4 include: 
                              
                                 (i)
                                 
                                    Large sample size. When 
                                       N
                                     is large, all criteria tend to perform similarly in both accuracy and prediction.


                                    Small sample size. HBIC outperforms BIC and ICL substantially in both accuracy and prediction. Since the true components almost do not overlap, BIC and ICL perform similarly.

In this subsection, we perform unsupervised clustering experiments on two real data sets: Fisher’s classical Iris data (Fisher, 1936) and Seeds data (Charytanowicz et al., 2010), which are available from UCI Machine Learning Repository (Bache and Lichman, 2013): 
                           
                              (i)
                              The Iris data set contains 150 observations of three classes of plants, measured on four variables: sepal length, sepal width, petal length and petal width. Each class has 50 observations.

The Seeds data set contains 210 observations of three different varieties of wheat: Kama, Rosa and Canadian. Each class has 70 observations, consisting of values measured on seven geometric parameters of wheat kernels. Since these parameters have different measurement units, we preprocess the data by standardization.

The detailed clustering results by BIC, HBIC and ICL on the whole Iris data can be found in Table C.7. A concise summarization is given in Table 4
                            and further visualized in Fig. 5
                           .

From Table 4, it can be seen that HBIC selects a 3-component mixture, which yields the best performance no matter whether judged by adjusted Rand index or misclassification rate, while both BIC and ICL choose the similar 2-component solutions for the 3-class Iris data, which results in significantly lower adjusted Rand index and higher misclassification rate. The VEV structure chosen by HBIC means that all the three types of Iris plant share a common shape but vary in orientations and volumes. From Fig. 5, the solution given by HBIC looks much more satisfactory than those by BIC and ICL.

From Table C.7, it can be observed that the 3-component mixture with the second largest BIC (resp. ICL) value is clearly better than the 2-component mixture with the largest BIC (resp. ICL) value. In fact, this 3-component mixture is very similar to the best given by HBIC. However, this model is not chosen by BIC (resp. ICL) because of its slightly lower BIC (resp. ICL) value. This observation implies that BIC (resp. ICL) suffers from over-penalization while HBIC does not.

For comparison, we re-perform the clustering experiment by the R software mixture as this software implements all of the fourteen models in the EDGMM family. The best model given in Table C.7 also has two components only. Table C.8 lists the detailed results with three different varieties of initialization. From Tables C.7 and C.8, it can be seen that the main results are similar to ours. That is, the 3-component mixture with the second largest BIC is actually the best model but not chosen by BIC.

The results by BIC, HBIC and ICL on the whole Seeds data can be found in Table C.9. A concise version is given in Table 5
                            and visualized in Fig. 6
                           .

The results are generally similar to those obtained on Iris data. From Table 5, it can be seen that the 3-component mixture selected by HBIC yields the best performance, while both BIC and ICL suffer from underestimation, choosing the similar 2-component solutions for the 3-class Seeds data. The VEV structure chosen by HBIC implies that all the three varieties of wheat share a common shape but vary in orientations and volumes. From Fig. 6, the solution given by HBIC looks much better than those by BIC and ICL. It can be observed from Table C.9 that all the top three models by BIC (resp. ICL) have two components only, while those by HBIC have three components, which indicates that BIC (resp. ICL) suffers from serious over-penalization while HBIC does not.

The 5-component mixture obtained by the R software mixture yields very low adjusted Rand index. For this data, the MAP estimation could affect the results significantly while the R software mixture fails to include it and thus the detailed results listed in Table C.10 are not easily comparable with ours in Table C.9. To see how the regularization parameter 
                              r
                            used for the MAP estimation in Section  4.1.1 affects the performance of BIC, HBIC, and ICL, we vary 
                              r
                            in a wide range of 
                              
                                 {
                                 0.0001
                                 ,
                                 0.001
                                 ,
                                 0.01
                                 :
                                 0.01
                                 :
                                 0.1
                                 ,
                                 0.2
                                 ,
                                 0.5
                                 }
                              
                           , where 
                              a
                              :
                              h
                              :
                              b
                            denotes the set 
                              
                                 {
                                 a
                                 ,
                                 a
                                 +
                                 h
                                 ,
                                 …
                                 ,
                                 b
                                 }
                              
                           . The smaller the value of 
                              r
                           , the smaller the amount of regularization, and vice versa. Table 6
                           
                           
                           
                           
                            lists the results. The following can be seen from Table 6. 
                              
                                 (i)
                                 
                                    
                                       r
                                     has a significant effect on the results of BIC, HBIC and ICL. When 
                                       r
                                     is small, e.g.  
                                       r
                                       =
                                       0.0001
                                    , all criteria choose the number of components greater than three. On the contrary, when 
                                       r
                                     is large, e.g.  
                                       r
                                       =
                                       0.5
                                    , all criteria choose three components and the simple EEE structure.

However, when 
                                       0.01
                                       ≤
                                       r
                                       ≤
                                       0.1
                                    , HBIC is much more stable than BIC and ICL, since HBIC always chooses 3 components and the VEV structure, while the choices of BIC and ICL are sensitive to the values of 
                                       r
                                    .

In this paper, we proposed a new criterion called hierarchical BIC (HBIC) for model selection in finite mixture models. We show both theoretically and empirically that HBIC is a large sample limit of the VB lower bound and BIC is a less accurate approximation. Our empirical results demonstrate that our proposed HBIC is more accurate than BIC and ICL.

Compared with HBIC, BIC ignores the clustered data structure and thus suffers from over-penalization. ICL would also suffer from this problem because the penalty of ICL uses the BIC penalty plus an additional entropy term that measures the overlap. On the other hand, BIC is known to over-estimate the number of mixture components in some cases. This is because it tries to select the ‘best’ number of components which best approximates the underlying distribution, instead of the true number of clusters. In contrast, ICL is more tailored at selecting the number of clusters (Biernacki et al., 2000). Therefore, it would be interesting to further develop a hierarchical ICL criterion that uses the HBIC penalty plus the entropy term of ICL, since hierarchical ICL could match clustered data structure and favor well-separated mixtures simultaneously, thus combining the advantage of both HBIC and ICL.

Finite mixture modeling using the 
                        t
                      distribution and skew distributions, namely 
                        t
                     -EDGMM and skew-EDGMM families, have been proposed in Andrews and McNicholas (2012) and Vrbik and McNicholas (2014) and found to perform better than their Gaussian counterpart in real applications. Extending our proposed HBIC to accommodate 
                        t
                     -EDGMM and skew-EDGMM families would be interesting future works.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the Associate Editor and the two anonymous reviewers for their valuable comments and suggestions that improved this paper substantially. The work was supported partly by Natural Science Foundation of China under Grant 11361071, Grant 61403337, Grant 11161053, and Grant U1302267, and partly by Hong Kong Research Grants Councils, General Research Fund, under Grant HKU 706710P.

Let us consider 
                        E
                        
                           [
                           log
                           q
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    k
                                 
                                 
                                    s
                                 
                              
                              )
                           
                           ]
                        
                      and 
                        E
                        
                           [
                           log
                           q
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ]
                        
                     . For exponential family models with missing data, which includes EDGMM as a special case, the variational posterior distribution 
                        q
                        
                           (
                           
                              θ
                           
                           )
                        
                      is approximately normally distributed (Wang and Titterington, 2004), from which it follows that 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                           )
                        
                      and 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                      are also approximately normally distributed. Thus we obtain, as
                        N
                        →
                        ∞
                     , 
                        
                           
                              E
                              
                                 
                                    
                                       [
                                       log
                                       q
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    q
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                 
                              
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 |
                                 2
                                 π
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 |
                              
                              ,
                           
                        
                      and 
                        
                           
                              E
                              
                                 
                                    
                                       [
                                       log
                                       q
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    q
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 |
                                 2
                                 π
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 |
                              
                              ,
                           
                        
                      where 
                        
                           
                              H
                           
                           
                              1
                           
                        
                        
                           (
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                           )
                        
                      and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                      are the negative Hessian matrices of 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                           
                           )
                        
                      and 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                      evaluated at MAP estimator 
                        
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                     , respectively. Noting that 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      scales linearly with 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        
                           
                              r
                           
                           
                              i
                              k
                           
                        
                      (from (20)), and 
                        
                           
                              ∑
                           
                           
                              i
                           
                        
                        
                           
                              r
                           
                           
                              i
                              k
                           
                        
                        /
                        n
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              k
                           
                        
                        →
                        1
                     , we have that as 
                        N
                        →
                        ∞
                     , 
                        
                           
                              H
                           
                           
                              1
                           
                        
                        /
                        N
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              k
                           
                        
                      converges to a constant matrix, denoted by 
                        
                           
                              H
                           
                           
                              10
                           
                        
                     , and thus 
                        
                           (A.1)
                           
                              E
                              
                                 
                                    
                                       [
                                       log
                                       q
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                k
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    q
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 (
                                 N
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 |
                                 2
                                 π
                                 
                                    
                                       H
                                    
                                    
                                       10
                                    
                                 
                                 |
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 (
                                 N
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              .
                           
                        
                     
                  

Similarly, noting that 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      scales linearly with 
                        N
                      (from (19)), we have that as 
                        N
                        →
                        ∞
                     , 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      converges to a constant matrix, and thus 
                        
                           (A.2)
                           
                              E
                              
                                 
                                    
                                       [
                                       log
                                       q
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    q
                                    
                                       (
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              log
                              N
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              .
                           
                        
                      By (A.1) and (A.2), as 
                        N
                        →
                        ∞
                     , we have 
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              E
                              
                                 [
                                 log
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 ]
                              
                              −
                              E
                              
                                 [
                                 log
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              log
                              N
                              −
                              log
                              p
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              ,
                           
                        
                      and 
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    g
                                 
                              
                              E
                              
                                 [
                                 log
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 ]
                              
                              −
                              E
                              
                                 [
                                 log
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                                 ]
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              log
                              
                                 (
                                 N
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              −
                              log
                              p
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              .
                           
                        
                     
                  

In the large 
                        N
                      limit, 
                        q
                        
                           (
                           
                              π
                           
                           )
                        
                     , 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        q
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 k
                              
                              
                                 s
                              
                           
                           )
                        
                      will be strongly peaked at 
                        
                           
                              
                                 π
                              
                           
                           
                              ˆ
                           
                        
                     , 
                        
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              k
                           
                           
                              s
                           
                        
                      (Attias, 1999), that is, 
                        
                           
                              (B.1)
                              
                                 q
                                 
                                    (
                                    
                                       π
                                    
                                    )
                                 
                                 =
                                 δ
                                 
                                    (
                                    
                                       π
                                    
                                    −
                                    
                                       
                                          
                                             π
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 +
                                 O
                                 
                                    (
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              (B.2)
                              
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 δ
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 +
                                 O
                                 
                                    (
                                    1
                                    )
                                 
                                 ,
                              
                           
                        
                      and 
                        
                           (B.3)
                           
                              q
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                              =
                              δ
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              ,
                           
                        
                      where 
                        δ
                        
                           (
                           ⋅
                           )
                        
                      is the Dirac delta function. These results follow from the approximate normal distributions in the large sample limit. Combining (B.1)–(B.3) with (17) yields 
                        
                           (B.4)
                           
                              q
                              
                                 (
                                 
                                    
                                       
                                          z
                                       
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 )
                              
                              =
                              p
                              
                                 (
                                 
                                    
                                       
                                          z
                                       
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              ,
                              
                              as  
                              N
                              →
                              ∞
                              .
                           
                        
                      By (B.1)–(B.4), we obtain that 
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    D
                                 
                              
                              =
                              L
                              
                                 (
                                 
                                    X
                                 
                                 |
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              +
                              O
                              
                                 (
                                 1
                                 )
                              
                              .
                           
                        
                     
                  

See Tables C.7–C.10.

@&#REFERENCES@&#

