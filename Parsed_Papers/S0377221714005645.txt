@&#MAIN-TITLE@&#Weekly self-scheduling, forward contracting, and pool involvement for an electricity producer. An adaptive robust optimization approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Optimization of the self-scheduling, and market strategy of an electricity producer.


                        
                        
                           
                           An adaptive two-stage robust optimization model is proposed, two variants are considered.


                        
                        
                           
                           Two case studies are analyzed, and several instances are investigated.


                        
                        
                           
                           Risk analysis are made by solving each instance for multiple values of budget parameters.


                        
                        
                           
                           The two variants of the algorithms have a similar performance, with some exceptions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Robust optimization

Electricity market

Renewable energy

@&#ABSTRACT@&#


               
               
                  This paper addresses the optimization under uncertainty of the self-scheduling, forward contracting, and pool involvement of an electricity producer operating a mixed power generation station, which combines thermal, hydro and wind sources, and uses a two stage adaptive robust optimization approach. In this problem the wind power production and the electricity pool price are considered to be uncertain, and are described by uncertainty convex sets. To solve this problem, two variants of a constraint generation algorithm are proposed, and their application and characteristics discussed. Both algorithms are used to solve two case studies based on two producers, each operating equivalent generation units, differing only in the thermal units’ characteristics. Their market strategies are investigated for three different scenarios, corresponding to as many instances of electricity price forecasts. The effect of the producers’ approach, whether conservative or more risk prone, is also investigated by solving each instance for multiple values of the so-called budget parameter. It was possible to conclude that this parameter influences markedly the producers’ strategy, in terms of scheduling, profit, forward contracting, and pool involvement. These findings are presented and analyzed in detail, and an attempted rationale is proposed to explain the less intuitive outcomes. Regarding the computational results, these show that for some instances, the two variants of the algorithms have a similar performance, while for a particular subset of them one variant has a clear superiority.
               
            

forward contracts

hydro pump-storage generation units

blocks of the forward contracts

generating units

optimality cuts in the Master problem

feasibility cuts in the Master problem

time periods

thermal generation units

production cost function coefficients for unit i (€/hour)

cold start-up cost of unit i (€/hour)

number of periods unit i must be off at the beginning of the time horizon

time periods spanned by contract f
                     

shut-down cost (€)

minimum down time of unit i (hour)

minimum number of periods a unit i must be off at the beginning of the time horizon

hot start cost of unit i (€/hour)

minimum number of periods a unit i must be on at the beginning of the time horizon

minimum power output of unit i (megawatt)

maximum power output of unit i (megawatt)

power produced at t
                        =0 by unit i (megawatt)

maximum ramp-down rate of unit i (megawatt)

maximum ramp-up rate of unit i (megawatt)

maximum shutdown rate of unit i (megawatt)

spinning reserve for period t (megawatt)

maximum start-up rate of unit i (megawatt)

number of periods unit i must be on at the beginning of the time horizon

initial state of unit i
                        {on,off}={1,0}

minimum up time of unit i (hour)

cold start hours of unit i (hour)

initial status of unit i (hour)

conversion factor between 
                           
                              cubic
                              
                              
                                 
                                    hectometers
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              
                                 
                                    meter
                                 
                                 
                                    3
                                 
                              
                           
                        /seconds in one hour

water head in plant i (meter)

power consumption factor

power generation factor

natural inflow of water for plant i (
                           
                              
                                 
                                    meter
                                 
                                 
                                    3
                                 
                              
                           
                        /seconds)

maximum turbined and pumped flow of water for plant i (
                           
                              
                                 
                                    meter
                                 
                                 
                                    3
                                 
                              
                           
                        /seconds)

maximum volume of water in the reservoir of plant i (
                           
                              cubic
                              
                              
                                 
                                    hectometers
                                 
                                 
                                    3
                                 
                              
                           
                        )

minimum volume of water in the reservoir of plant i (
                           
                              cubic
                              
                              
                                 
                                    hectometers
                                 
                                 
                                    3
                                 
                              
                           
                        )

minimum volume of water in the reservoir of plant i at the of the horizon (
                           
                              cubic
                              
                              
                                 
                                    hectometers
                                 
                                 
                                    3
                                 
                              
                           
                        )

energy price of buying block j of forward contract f (€/megawatthour)

energy price of selling block j of forward contract f (€/megawatthour)

shut-down cost of unit i in period t (€)

total startup, shutdown, production, and online cost of unit i (€)

total startup, shutdown and online cost of unit i (€)

startup cost of unit i in period t (€)

power bought through block j of forward contract f (megawatt)

power sold through block j of forward contract f (megawatt)

operational profit of the producer per week (€)

power output of unit i in period t (megawatt)

power bought in the pool in period t (megawatt)

power sold in the pool in period t (megawatt)

power output of the pumped-storage hydro unit i in period t (megawatt)

power consumption of the pumped-storage hydro unit i in period t (megawatt)

turbined flow of water in plant i in period t (
                           
                              
                                 
                                    meter
                                 
                                 
                                    3
                                 
                              
                           
                        /seconds)

pumped flow of water in plant i in period t (
                           
                              
                                 
                                    meter
                                 
                                 
                                    3
                                 
                              
                           
                        /seconds)

volume of water stored in the reservoir of plant i (
                           
                              cubic
                              
                              
                                 
                                    hectometers
                                 
                                 
                                    3
                                 
                              
                           
                        )

dual variables of the inner problem of the recourse problem

dual variables of the inner problem of the recourse problem

dual variables of the inner problem of the recourse problem

dual variables of the inner problem of the recourse problem

dual variables of the inner problem of the recourse problem

variable that approximates the recourse problem optimal value

on/off status of unit i in period t
                     

startup status of unit i in period t
                     

shutdown status of unit i in period t
                     

selection of forward contract f to buy energy

selection of forward contract f to sell energy

nominal wind power output in period t (megawatt)

down deviation from the nominal wind power output in period t (megawatt)

up deviation from the nominal wind power output in period t (megawatt)

nominal pool price in period t (€/megawatthour)

down deviation from the nominal pool price in period t (€/megawatthour)

up deviation from the nominal pool price in period t (€/megawatthour)

budget of uncertainty parameter for the pool prices and wind power output

wind power output in period t (megawatt)

dummy variable to replace the bilinear term 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                        
                     

dummy variable to replace the bilinear term 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                        
                     

pool price in period t (Dollar/megawatthour)

=1 if the pool price is at the upper bound of the set

=1 if the pool price is at the lower bound of the set

=1 if the wind power output is at the upper bound of the set

=1 if the wind power output is at the lower bound of the set

@&#INTRODUCTION@&#

In general, electricity producers operating in electricity markets sell their energy through bilateral contracts or in the pool. The details of these operations depend on the specific market design where the producer is integrated. For a review on market structure and designs see Conejo, Carrion, and Morales (2010) and Oliveira, Ruiz, and Conejo (2013).

From the point of view of the electricity producer, the selling strategy for each time period should take in consideration the power generation capacity of the producer, and to some extent also to the option to buy electricity from the market to meet the committed sales. Therefore, in this decision making problem the producer faces two integrated challenges: (1) the self-scheduling of the generation units and (2) the optimal forward contract selection and pool involvement.

The basic problem involving unit self-scheduling determines the optimal power outputs of the producer’s generation units subject to feasible operation, which provides a basis to define the market involvement. In general, self-scheduling problems are related to Unit Commitment (UC) problems of thermal and/or hydro units. These are classical scheduling problems that have been addressed by a number of authors using decomposition strategies such as Lagrangian Relaxation, and in the last decade with Mixed Integer Linear (MILP) models, see for example Arroyo and Conejo (2000) and Li and Shahidehpour (2005). Several authors have proposed UC MILP models for systems with thermal units, aiming at developing: (a) tight linear relaxations, by generating facets of the ramping up and down constraints of the units (Ostrowski, Anjos, & Vannelli, 2012), convex hull formulations for the minimum up and down time constraints (Lee, Leung, & Margot, 2004; Rajan & Takriti, 2005), and tight approximate formulations for the linearization of the quadratic objective function (Frangioni, Gentile, & Lacalandra, 2009); (b) compact formulations (Hedman, Ferris, O’Neill, Fisher, & Oren, 2010; Morales-Espana, Latorre, & Ramos, 2013a); and (c) accurate representations of the operations and thermal units (Frangioni, Gentile, & Lacalandra, 2008; Morales-Espana, Latorre, & Ramos, 2013b). The self-scheduling of hydro systems has also been addressed with MILP models, and Mixed Integer Nonlinear Programming (MINLP) models. In MILP models, the nonlinearities of the hydro plants are linearized using piecewise linear approximations, see for example Conejo, Arroyo, Contreras, and Villamor (2002), and Borghetti, D’Ambrosio, Lodi, and Martello (2008) for a tighter linear approximation. MINLP models have been also considered for the self-scheduling of hydro plants, where detailed nonlinear expressions for the power generation function, and relations between the water head and the volume of water in the reservoir are considered. These nonlinear functions are strongly related with the power generation and therefore with the self-scheduling of the hydro units. Recently, the short-term hydro scheduling has been addressed using a detailed nonconvex MINLP model combined with a deterministic global optimization approach to overcome the local solutions of the nonconvex MINLP model (Lima, Marcovecchio, Novais, & Grossmann, 2013).

The self-scheduling problems described above are mainly considered as deterministic, however, in reality, some parameters are subject to uncertainty, such as the electricity demand, electricity prices of the pool, or the renewable energy based generators power output. In this context, stochastic programming models and decomposition methods, or strategies based on conditional value-at-risk analysis have been applied to cope with the uncertainty of some parameters (Conejo, Nogales, Arroyo, & Garcia-Bertrand, 2004; Fleten & Kristoffersen, 2007; Jabr, 2005; Nowak & Romisch, 2000). However, several problems that address self-scheduling with uncertainty fall in the category of self-scheduling in a market environment that is mentioned in the next paragraph.

The second problem is related with the market involvement using trading tools, such as forward contracts and pool involvement. In general, the electricity producers establish forward contracts in order to hedge against the electricity pool prices volatility, whereby signing contracts the producer chooses to have a fixed certain revenue, instead of relying on the uncertain pool prices. The decision making process related to optimal offering (contracts and pool) can be recast as an optimization problem under uncertainty, which has been studied considering different features, namely: (a) self-scheduling and offering strategies (Amjady & Vahidinasab, 2013; Barroso, Street, Granville, & Pereira, 2011; Conejo et al., 2004; Fleten & Kristoffersen, 2007; Kazempour & Moghaddam, 2011; Yamin & Shahidehpour, 2004); (b) offering models for wind power producers where the uncertainty of the wind power plays an important role (Angarita, Usaola, & Martinez-Crespo, 2009; Baringo & Conejo, 2013; Conejo et al., 2010; Morales, Conejo, & Perez-Ruiz, 2010); (c) self-scheduling and strategic offering (Baslis & Bakirtzis, 2011; Cerisola, Baillo, Fenandez-Lopez, Ramos, & Gollmer, 2009; Pousinho, Contreras, Bakirtzis, & Catalao, 2013; Ruiz & Conejo, 2009); (d) offering models that represent the behavior of competitors, but do not include self-scheduling (Bakirtzis, Ziogos, Tellidou, & Bakirtzis, 2007; Gountis & Bakirtzis, 2004; Ni, Luh, & Rourke, 2004; Wen & David, 2001); (e) forward contracts strategies without self-scheduling (Conejo et al., 2010; Dent, Bialek, & Hobbs, 2011; El Khatib & Galiana, 2007; Falbo, Felletti, & Stefani, 2010; Feng, Gan, Zhong, & Ni, 2007); (f) self-scheduling, forward contracting and pool offering (Garces & Conejo, 2010; Guan, Wu, Gao, & Sun, 2008; Simoglou, Biskas, & Bakirtzis, 2012). A relevant review regarding mathematical programming approaches for optimal offering is given in Kwon and Frances (2012), and a recent review on optimal offering strategies for hydro systems can be found in Steeger, Barroso, and Rebennack (2014).

Two recent works addressed the market involvement from two different perspectives. The first looks at the electricity market as a supply chain, considering the different interactions between players and market floors, analyzing for example the overall level of trading in the pool, as a function of the different types of contracts and market structures (Oliveira et al., 2013). The second focus on a small producer that has to maximize the profit through the contract selection and pool sales (Falbo et al., 2010). These latter authors propose an integrated risk management approach to deal with the combination of upstream and downstream uncertainty faced by the electricity producer, and conclude that signing a forward contract is not always the best way to mitigate risk, and therefore, some pool involvement is recommended. In general both works lead to important insights regarding the forward contracting and pool involvement, which are also discussed in this work from the electricity producer point of view.

From the above references, the problem tackled in Garces and Conejo (2010) resembles the problem studied in this work. Those authors address the weekly self-scheduling, forward contracting and (Monday) pool offering, subject to the uncertainty in the pool prices, using a stochastic programming approach. However, there are significant differences between both works, namely the level of time resolution of the model, the electricity production system, and the methodology to deal with uncertainty. The production system in that work is based on thermal units, while here it encompasses a thermal unit, pump-storage hydro plant, and a wind farm, which constitutes a much more general system. In addition, their approach to deal with uncertainty and risk is based on stochastic programming and the conditional value at risk for risk management, while in this work a different approach is developed. Furthermore, an additional source of uncertainty, the wind power output, is considered here.

In these problems, whenever the uncertainty is present, it is mainly addressed using stochastic programming approaches, while an alternative rationale stream addresses the optimization under uncertainty via a robust optimization framework.

The objective of robust optimization is to obtain a solution for the problem under uncertainty, where by robust it is meant that such solution is the optimal for the worst conditions within an uncertainty set describing the problem uncertainty. Robust optimization has its foundations on robust control, and on the optimization of Linear Programming problems involving hard constraints subject to uncertainty (Ben-Tal & Nemirovski, 1998; Soyster, 1973). Robust optimization has three main advantages: (1) under specific conditions, the resulting problems are computationally tractable, without an exponential increase of the size of the model; (2) results can be very reliable, due to the fact that worst case situations are considered; and (3) it does not require a distribution of probabilities as stochastic programming does. On the other hand, the main disadvantage relies on the fact that it is not straightforward and sometimes meaningful to define and control the conservatism level. However, the conservatism inherent to robust optimization has been controlled through the parameterization of budget constraints (Bertsimas & Sim, 2003), resulting in a risk framework analogous to the risk management strategies implemented in stochastic programming to minimize risk. A comprehensive review on robust optimization theory can be found in Bertsimas, Brown, and Caramanis (2011), and a review on its application in Gabrel, Murat, and Thiele (2014).

In the area of energy systems, robust optimization has been applied mainly in two sub-areas: (1) power systems and (2) the optimal strategic planning of oil supply chains (Ribas, Hamacher, & Street, 2010). In power systems it has been mainly applied to deal with the uncertainty in unit commitment problems, and market offering. The application of robust optimization to the unit commitment problem involves solving problems with different features, for example considering uncertainty in the power demand, wind power, demand response, and reserves determination, see for example the work of Bertsimas, Litvinov, Sun, Zhao, and Zheng (2013), Jiang, Zhang, Li, and Guan (2010), Zhang and Guan (2009), Zhao and Zeng (2010), and Zugno and Conejo (2013). These authors have also developed new variants of constraint generation algorithms based on Benders’ Decomposition (Benders, 1962), in order to efficiently address the bi-level optimization problems resulting from the adaptive robust optimization formulations. Two of these variants are further discussed later in this work.

A robust optimization framework was also applied in Baringo and Conejo (2011) and Dominguez, Baringo, and Conejo (2012) to derive optimal market offering strategies for a price-taker power producer for the day-ahead market. In their approaches instead of relying on an electricity forecast distribution via scenarios, they propose an uncertainty convex set for the electricity price. Recently, a similar approach was proposed for the market offering of a solar power producer.

The objective of the present work is to address the optimization under uncertainty of the self-scheduling and market involvement of an electricity producer. The main contributions of this work are the following: (1) development of an adaptive robust optimization model for a power producer that involves two decision stages, and considers the option of forward contracting, self-scheduling, and pool involvement; this represents the point of view of the producer in a market environment, which is a different framework from the models presented in Bertsimas et al. (2013), Jiang et al. (2010), Zhang and Guan (2009), Zhao and Zeng (2010), and Zugno and Conejo (2013); (2) two sources of uncertainty are considered, namely the wind power and electricity prices, which are defined by convex uncertainty sets; (3) analysis and characterization of the properties of the overall approach involving the models and the two constraint generation algorithms implemented; (4) derivation of a linearization scheme for bilinear terms based on the characteristics of the problem, which is further discussed in Section 7.1.

The two constraint generation algorithms are applied to solve two case studies involving different thermal units, and for each case three electricity price forecasts are considered.

The structure of the paper is the following: the introduction is presented in Section 1. In Section 2, the problem statement is defined. Section 3 gives a compact formulation of the deterministic model. The optimization under uncertainty is formulated as a general two stage adaptive robust optimization in Section 4. In Section 5 the two algorithms used are analyzed. In Section 6, the uncertainty convex sets are defined. Section 7 shows the derivation of the master and subproblem used. In Section 8 the case studies are described, and the results are analyzed. The conclusions are presented in Section 9, and in Appendix A the detailed model involving the forward contracts selection, and unit commitment of the thermal and hydro units is described.

This paper addresses the optimal self-scheduling and market involvement of an electricity producer that owns different generation units. The portfolio of this producer includes a wind farm, a thermal plant, and a pump-storage hydro plant. It is assumed that the producer can operate as a virtual power plant, where either the power produced by the wind farm or the thermal unit can be used to pump water back to the reservoir of the hydro plant. The producer can interact with the electricity market by establishing weekly contracts and participating in the pool. The time horizon is one week, with a time resolution of one hour. The decision framework involves two stages, the first occurs before the beginning of the week, when the producer has the option to sign one or more forward contracts, and it must decide the hourly commitment of the thermal unit during the time horizon. On the second stage, the producer has to dispatch the thermal unit, decide the operation of the pumped-storage unit, and the power bought and sold in the pool for each hour of the week. The electricity prices in the pool and the wind power are uncertain, and the uncertainty is defined using convex uncertainty sets. The objective is to determine the optimal production schedule for the hydro and thermal units, forward contracts and pool involvement that maximize the profit of the producer. It is assumed that the producer is a price-taker, and it does not consider the behavior of the other competitors.

The deterministic model used in this paper has three main blocks, the first is related with the definition and choice of the forward contracts, the second involves the operation of the thermal unit, and the third is concerned with the pumped-storage hydro plant operation. These three blocks are linked by the overall energy balance. The detailed equations describing the operating constraints of each unit are presented in detail in Appendix A, while in this section a general formulation is given:
                        
                           (1)
                           
                              max
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                -
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              cop
                              ,
                           
                        
                     
                     
                        
                           (2)
                           
                              s
                              .
                              t
                              .
                              :
                              
                              cop
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       TH
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    cd
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       TH
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       HY
                                    
                                 
                              
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    buy
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       HY
                                    
                                 
                              
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    sell
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                              
                              ,
                              
                              ∀
                              f
                              ,
                              j
                              ,
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              ,
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (6)
                           
                              
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ∈
                              
                                 
                                    ϒ
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              ,
                           
                        
                     where 
                        
                           
                              
                                 f
                              
                              
                                 f
                                 ,
                                 j
                              
                              
                                 buy
                              
                           
                        
                      and 
                        
                           
                              
                                 f
                              
                              
                                 f
                                 ,
                                 j
                              
                              
                                 sell
                              
                           
                        
                      are the power bought and sold at prices 
                        
                           
                              
                                 λ
                              
                              
                                 f
                                 ,
                                 j
                              
                              
                                 buy
                              
                           
                        
                      and 
                        
                           
                              
                                 λ
                              
                              
                                 f
                                 ,
                                 j
                              
                              
                                 sell
                              
                           
                        
                     , respectively, through block j of forward contract f, 
                        
                           
                              
                                 λ
                              
                              
                                 t
                              
                           
                        
                      is the electricity pool price in period 
                        
                           t
                           ,
                           cop
                        
                      is the total cost of the thermal unit during the time horizon, 
                        
                           
                              
                                 cu
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 cd
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      denote the startup and shutdown costs of the thermal unit i in period 
                        
                           t
                           ,
                           
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                        
                      represent cost coefficients, 
                        
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      is the power output of unit i in period 
                        
                           t
                           ,
                           
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                           ,
                           
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 t
                              
                              
                                 up
                              
                           
                        
                     , and 
                        
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 t
                              
                              
                                 dn
                              
                           
                        
                      are binary variables that indicate the on/off, startup, and shutdown status of the thermal units, 
                        
                           
                              
                                 ptb
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 pp
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      denote the power output and consumption, respectively, of the pumped-storage hydro unit in period 
                        
                           t
                           ,
                           
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                        
                      is the wind power output in period t, and 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                              
                                 buy
                              
                           
                        
                      and 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                              
                                 sell
                              
                           
                        
                      are the power bought and sold in the pool in period t, respectively. The objective function of the problem aims to maximize the operational profit of the generation facilities given by the profit of selling energy through weekly contracts plus the profit obtained from the participation in the pool minus the costs incurred with the thermal generation. Eq. (2) defines the total cost of the thermal unit involving the startup, operation, and shutdown costs. Eq. (3) represents the energy balance, stating that the energy generated in each time period by the thermal plant, hydro plant, wind farm plus the energy acquired through the contracts and from the pool is equal to the energy consumed by the pump mode of the pumped-storage hydro plant plus the energy sold through the contracts plus the energy sold in the pool. 
                        
                           
                              
                                 Π
                              
                              
                                 f
                                 ,
                                 j
                              
                           
                           ,
                           
                           
                              
                                 Ω
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                           ,
                           
                           
                              
                                 ϒ
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                        
                      represent the forward contract selection, and the feasible regions of operation of the thermal, and pumped-storage hydro units. The deterministic model summarized above can be represented by the generic formulation:
                        
                           (DET)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   x
                                                   ,
                                                   z
                                                   ,
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                          x
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                z
                                             
                                             
                                                T
                                             
                                          
                                          z
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                T
                                             
                                          
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          Cx
                                          ⩽
                                          b
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Dz
                                          =
                                          d
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Fy
                                          +
                                          Gx
                                          =
                                          w
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Az
                                          +
                                          By
                                          ⩽
                                          d
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Hy
                                          ⩽
                                          h
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          x
                                          ,
                                          
                                          y
                                          ⩾
                                          0
                                          ,
                                          
                                          z
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           x
                           ,
                           
                           z
                        
                     , and y denote the vectors of variables, A, 
                        
                           B
                           ,
                           
                           C
                           ,
                           
                           D
                           ,
                           
                           F
                           ,
                           
                           G
                           ,
                           
                           H
                           ,
                           
                           
                              
                                 c
                              
                              
                                 x
                              
                              
                                 T
                              
                           
                           ,
                           
                           
                              
                                 c
                              
                              
                                 z
                              
                              
                                 T
                              
                           
                        
                     , 
                        
                           b
                           ,
                           
                           d
                           ,
                           
                           w
                        
                     , and h are matrices and vectors with known parameters.

The weekly self-scheduling of the producer and its participation in the market can be described as an optimization problem under uncertainty with recourse (Garces & Conejo, 2010). The decision framework described in Section 2 can be described by an adaptive robust optimization model. In the first stage it is maximized the partial profit given by the difference between the revenues from the forward selling contracts and the costs of both the forward buying contracts and thermal commitment costs. In a second stage the partial profit is calculated as the difference between the revenues of selling energy in the pool and the variable costs involving both the purchase of energy in the pool and the operating costs of the thermal unit. A general formulation of the robust counterpart of the deterministic model presented before can be stated as
                        
                           (RO)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   x
                                                   ,
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                          x
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                z
                                             
                                             
                                                T
                                             
                                          
                                          z
                                          +
                                          R
                                          (
                                          x
                                          ,
                                          z
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          Cx
                                          ⩽
                                          b
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Dz
                                          =
                                          d
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          x
                                          ⩾
                                          0
                                          ,
                                          
                                          z
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where x and z are the first stage variables, and 
                        
                           R
                           (
                           x
                           ,
                           z
                           )
                        
                      is the adaptive recourse profit as a function of x and z, parameterized over the uncertainty set W. In the framework of a robust optimization approach, the recourse profit is maximized for the worst case realization of the stochastic parameters within W, which is broadly translated as the minimum of the maximum profit subject to the constraints of the recourse problem, as in
                        
                           (RP)
                           
                              
                                 
                                    
                                       R
                                       (
                                       x
                                       ,
                                       z
                                       )
                                       =
                                    
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                w
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             T
                                          
                                       
                                       y
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                       s
                                       .
                                       t
                                       .
                                    
                                    
                                       
                                       Fy
                                       =
                                       w
                                       -
                                       Gx
                                    
                                 
                                 
                                    
                                    
                                    
                                    
                                       
                                       By
                                       ⩽
                                       d
                                       -
                                       Az
                                    
                                 
                                 
                                    
                                    
                                    
                                    
                                       
                                       Hy
                                       ⩽
                                       h
                                    
                                 
                                 
                                    
                                    
                                    
                                    
                                       
                                       y
                                       ⩾
                                       0
                                    
                                 
                                 
                                    
                                    
                                       
                                       s
                                       .
                                       t
                                       .
                                    
                                    
                                    
                                       w
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       ∈
                                       W
                                       ,
                                    
                                 
                              
                           
                        
                     where y are the second stage variables, and w and 
                        
                           
                              
                                 c
                              
                              
                                 y
                              
                           
                        
                      denote the parameters subject to uncertainty. The construction of the set W will be specified later for the problem studied in this work. The inner problem of the recourse problem (RP) is a Linear Programming (LP) problem for fixed values of w and 
                        
                           
                              
                                 c
                              
                              
                                 y
                              
                           
                        
                     :
                        
                           (IRP)
                           
                              
                                 
                                    
                                       
                                          IR
                                          (
                                          x
                                          ,
                                          z
                                          ,
                                          w
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                T
                                             
                                          
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          Fy
                                          =
                                          w
                                          -
                                          Gx
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          By
                                          ⩽
                                          d
                                          -
                                          Az
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          Hy
                                          ⩽
                                          h
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          y
                                          ⩾
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and based on duality theory, the dual of the inner problem of (IRP) is given by
                        
                           (DIRP)
                           
                              
                                 
                                    
                                       
                                          DIR
                                          (
                                          x
                                          ,
                                          z
                                          ,
                                          w
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   α
                                                   ,
                                                   β
                                                   ,
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                      -
                                                      Gx
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                
                                                   
                                                      d
                                                      -
                                                      Az
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                T
                                             
                                          
                                          μ
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                F
                                             
                                             
                                                T
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                T
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                H
                                             
                                             
                                                T
                                             
                                          
                                          μ
                                          ⩾
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          α
                                          ∈
                                          R
                                          ,
                                          
                                          β
                                          ⩾
                                          0
                                          ,
                                          
                                          μ
                                          ⩾
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           α
                           ,
                           
                           β
                           ,
                           
                           μ
                        
                      are the dual variables corresponding to the sequence of constraints of the problem (IRP). Assuming the strong duality property, then 
                        
                           IR
                           (
                           x
                           ,
                           z
                           ,
                           w
                           ,
                           
                              
                                 c
                              
                              
                                 y
                              
                           
                           )
                           =
                           DIR
                           (
                           x
                           ,
                           z
                           ,
                           w
                           ,
                           
                              
                                 c
                              
                              
                                 y
                              
                           
                           )
                        
                      at the optimum. Integrating the dual of the inner problem with the outer problem results the following recourse problem:
                        
                           (RP1)
                           
                              
                                 
                                    
                                       
                                          LDR
                                          (
                                          x
                                          ,
                                          z
                                          )
                                          =
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   w
                                                   ,
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   ,
                                                   α
                                                   ,
                                                   β
                                                   ,
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                      -
                                                      Gx
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                
                                                   
                                                      d
                                                      -
                                                      Az
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                T
                                             
                                          
                                          μ
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                F
                                             
                                             
                                                T
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                T
                                             
                                          
                                          β
                                          +
                                          
                                             
                                                H
                                             
                                             
                                                T
                                             
                                          
                                          μ
                                          ⩾
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          α
                                          ∈
                                          R
                                          ,
                                          
                                          β
                                          ⩾
                                          0
                                          ,
                                          
                                          μ
                                          ⩾
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          w
                                          ,
                                          
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                          ∈
                                          W
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Problem (RP1) is characterized by a convex feasible region that is independent of the first stage variables x and z, and by a bilinear term involving the variables w and α in the objective function. This nonlinear term can be linearized, but it requires the previous definition of the polyhedral uncertainty set W, see Section 6. At this point it is assumed that Problem (RP1) can be solved. Using the above formulation for the recourse problem, Problem (RO) is equivalent to
                        
                           (RO2)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                x
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             T
                                          
                                       
                                       x
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             z
                                          
                                          
                                             T
                                          
                                       
                                       z
                                       +
                                    
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                w
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                
                                                ,
                                                α
                                                ,
                                                β
                                                ,
                                                μ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   -
                                                   Gx
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       α
                                       +
                                       
                                          
                                             
                                                
                                                   d
                                                   -
                                                   Az
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       β
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             T
                                          
                                       
                                       μ
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                       s
                                       .
                                       t
                                       .
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             T
                                          
                                       
                                       α
                                       +
                                       
                                          
                                             B
                                          
                                          
                                             T
                                          
                                       
                                       β
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             T
                                          
                                       
                                       μ
                                       ⩾
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                    
                                       α
                                       ∈
                                       R
                                       ,
                                       
                                       β
                                       ⩾
                                       0
                                       ,
                                       
                                       μ
                                       ⩾
                                       0
                                    
                                 
                                 
                                    
                                    
                                    
                                    
                                       w
                                       ,
                                       
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       ∈
                                       W
                                    
                                 
                                 
                                    
                                       
                                       s
                                       .
                                       t
                                       .
                                    
                                    
                                       Cx
                                       ⩽
                                       b
                                    
                                    
                                    
                                 
                                 
                                    
                                    
                                       Dz
                                       =
                                       d
                                    
                                    
                                    
                                 
                                 
                                    
                                    
                                       x
                                       ⩾
                                       0
                                       ,
                                       
                                       z
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       .
                                    
                                    
                                    
                                 
                              
                           
                        
                     
                  

Problem (RO2) does not have a trivial optimization formulation because of the bi-level structure involving a Max–Min problem that cannot be solved by a standard solver. In this work, Problem (RO2) is addressed using a constraint generation algorithm based on Benders’ Decomposition (Benders, 1962). This approach has been studied by other authors to solve similar problems, see for example Jiang et al. (2010), Thiele, Terry, and Epelman (2009), Zhang and Guan (2009), Zhao and Zeng (2010), and Zugno and Conejo (2013). From the algorithmic point of view, the constraint generation algorithm relies on an iterative procedure, where on each iteration two problems are solved. First, a subproblem is solved using initial guesses for the first stage variables, and its solution involving the dual variables is used to construct Benders type cuts that are added to the master problem formulation. At this level, a lower bound on the objective function of the problem is calculated, as detailed in the algorithm description. In a second stage the master problem is solved, generating a new set of first stage variables, and an upper bound for the objective function of the problem. The algorithm stops when the gap between the lower and upper bound reaches a pre-specified tolerance. A description of the algorithm and formulations of these two problems are presented in Fig. 1
                     .

The following considerations are in order regarding the constraint generation algorithm:
                           
                              1.
                              The uncertainty of the wind power and of the electricity prices is described by polyhedral sets, which ensures that the solution of the outer problem of the subproblem is at one of the extremes of the polyhedral set. The construction of these sets is an active area of research, and therefore, for a matter of simplicity a simple set representation is used.

The dual of the inner problem (DIRP) has a feasible region that is independent of the first stage decision variables. This property is common in the subproblems of Benders Decomposition, and it is useful to build the master problem.

The objective function of the subproblem has a set of bilinear terms involving 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             t
                                          
                                       
                                    
                                 . Based on the feasible region of the subproblem and the polyhedral sets used, this nonlinearity can be linearized and the solution of the resulting subproblem is still at one of the vertices of the subproblem (Thiele et al., 2009; Zhao & Zeng, 2010).

Any feasible solution from the subproblem is a valid cut for the master problem, while the optimal solution is the tighter cut.

The master problem (MP) is built over a relaxation of Problem (RO2). There are two steps involved in the construction of the master. The first one, involves the replacement of the recourse problem by a new variable Θ that is limited by the constraint 
                                    
                                       Θ
                                       ⩽
                                       
                                          
                                             min
                                          
                                          
                                             w
                                             ,
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             α
                                             ,
                                             β
                                             ,
                                             μ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   -
                                                   Gx
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       α
                                       +
                                       
                                          
                                             
                                                
                                                   d
                                                   -
                                                   Az
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       β
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             T
                                          
                                       
                                       μ
                                    
                                 . While, in the second step this inequality is approximated by the set of inequalities:
                                    
                                       (7)
                                       
                                          Θ
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      Gx
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      d
                                                      -
                                                      Az
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          O
                                          ,
                                       
                                    
                                 which are incrementally added to the master problem during the iterative procedure of the algorithm above. This is the main difference between the typical Benders Decomposition and the column generation algorithm, where in the latter the master is relaxed and progressively tightened by including additional cuts.

In general the master problem should be built to generate first stage decisions that ensure that the problem (RP1) is bounded, which guarantees complete recourse of the subproblem. However, if that is not possible for all first stage decisions, and the problem (RP1) becomes unbounded, then a the feasibility cut similar to the one used in Benders’ Decomposition would be added to the master problem:
                                    
                                       (8)
                                       
                                          0
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      Gx
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      d
                                                      -
                                                      Az
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          S
                                          .
                                       
                                    
                                 This feasibility cut is built using the extreme rays of the dual obtained with the solution of the problem (Hooker & Ottosson, 2003):
                                    
                                       (FP1)
                                       
                                          
                                             
                                                
                                                   
                                                      SLDR
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            
                                                               min
                                                            
                                                            
                                                               w
                                                               ,
                                                               α
                                                               ,
                                                               β
                                                               ,
                                                               μ
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                                  -
                                                                  
                                                                     
                                                                        Gx
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      α
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  -
                                                                  
                                                                     
                                                                        Az
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      β
                                                      +
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      μ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      .
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      α
                                                      +
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      β
                                                      +
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      μ
                                                      ⩾
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      α
                                                      ∈
                                                      R
                                                      ,
                                                      
                                                      β
                                                      ⩾
                                                      0
                                                      ,
                                                      
                                                      μ
                                                      ⩾
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      w
                                                      ∈
                                                      W
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The case study addressed in this work exhibits complete recourse, and therefore the feasibility cuts discussed above are not used. However, for the sake of clarity they are briefly mentioned.

An improved constraint generation algorithm called primal cut algorithm was proposed in Zhao and Zeng (2010). These authors keep the same logic of the constraint generation algorithm, but the master problem is extended to include information about the subproblem. This information is based on the full set of constraints of the primal (inner problem of the recourse problem) built over a copy of the primal variables. Their main motivation was to improve the feasibility of the subproblem, through the transfer of information from the subproblem to the master, in order to generate first stage variables that help the subproblem to remain feasible. Based on this, the master problem has the following formulation:
                           
                              (PMP)
                              
                                 
                                    
                                       
                                          
                                             PF
                                             (
                                             x
                                             ,
                                             z
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      x
                                                      ,
                                                      z
                                                      ,
                                                      Θ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   T
                                                
                                             
                                             x
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   z
                                                
                                                
                                                   T
                                                
                                             
                                             z
                                             +
                                             Θ
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                             Θ
                                             ⩽
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         -
                                                         Gx
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         d
                                                         -
                                                         Az
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             k
                                             ∈
                                             O
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             Θ
                                             ⩽
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   Tk
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             k
                                             ∈
                                             O
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Fy
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             Gx
                                             ,
                                             
                                             k
                                             ∈
                                             O
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   By
                                                
                                                
                                                   k
                                                
                                             
                                             ⩽
                                             d
                                             -
                                             Az
                                             ,
                                             
                                             k
                                             ∈
                                             O
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Hy
                                                
                                                
                                                   k
                                                
                                             
                                             ⩽
                                             h
                                             ,
                                             
                                             k
                                             ∈
                                             O
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             Cx
                                             ⩽
                                             b
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             Dz
                                             =
                                             d
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             x
                                             ⩾
                                             0
                                             ,
                                             
                                             z
                                             ∈
                                             {
                                             0
                                             ,
                                             1
                                             }
                                             ,
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             Θ
                                             ∈
                                             R
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The disadvantage of the primal cut algorithm relies on the size of the master problem, which increases in number of equations and variables when compared with constraint generation algorithm. This suggests that the overhead of these extra equations and variables should be studied case by case, because for certain problems this overhead may not be worthy.

The uncertainty associated with the wind power and electricity prices is described by polyhedral sets, which are built around a nominal value and bounded by a lower and upper bound. To protect against over conservative situations arising from extreme values of the uncertainty sets, budget constraints parameterized over a budget constant are considered. This is a common technique used to control the level of conservatism in robust optimization, and it may adopt different formulations (Bertsimas & Sim, 2004; Thiele et al., 2009; Zhao & Zeng, 2010). In this work, the polyhedral set for the uncertainty is given by 
                        
                           W
                           =
                           
                              
                                 W
                              
                              
                                 w
                              
                           
                           ∪
                           
                              
                                 W
                              
                              
                                 λ
                              
                           
                        
                     , where 
                        
                           
                              
                                 W
                              
                              
                                 w
                              
                           
                        
                      and 
                        
                           
                              
                                 W
                              
                              
                                 λ
                              
                           
                        
                      are the sets for the wind power and electricity prices. Therefore, the polyhedral set for the wind power involves the relation between the wind power, the nominal value and the lower and upper values as given by 
                        
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                           +
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 +
                              
                           
                           
                              
                                 w
                              
                              
                                 t
                              
                              
                                 u
                              
                           
                           -
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 -
                              
                           
                           
                              
                                 w
                              
                              
                                 t
                              
                              
                                 l
                              
                           
                        
                      and the budget constraint 
                        
                           
                              
                                 ∑
                              
                              
                                 t
                              
                           
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 +
                              
                           
                           +
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 -
                              
                           
                           ⩽
                           Γ
                        
                      where Γ is the budget parameter that limits the variation of the wind. Note that 
                        
                           Γ
                           ⩽
                           |
                           T
                           |
                        
                     , where 
                        
                           |
                           T
                           |
                        
                      is the number of time periods. A high value of Γ implies that a high number of periods, with wind power outputs exhibiting deviations from the forecast nominal value have been accounted for. Conversely, smaller values of Γ correspond to a lower number of such wind power outputs being accounted for. A conservative approach will therefore tend to favor the former, since most worst cases have already been contemplated, while a more risk prone approach will be keen to select the latter. Hence, the wind set definition is given by
                        
                           (9)
                           
                              
                                 
                                    W
                                 
                                 
                                    w
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                       ⩾
                                       0
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       ,
                                       ∀
                                       t
                                       ,
                                       :
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       ⩽
                                       Γ
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      is the nominal wind power, 
                        
                           
                              
                                 w
                              
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      and 
                        
                           
                              
                                 w
                              
                              
                                 t
                              
                              
                                 l
                              
                           
                        
                      are the upper and lower bound for the wind power, and 
                        
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 -
                              
                           
                        
                      are binary variables that define the bounds of the uncertainty set. The polyhedral set for the electricity price follows a similar rationale:
                        
                           (10)
                           
                              
                                 
                                    W
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                       
                                       ⩾
                                       0
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       ,
                                       ∀
                                       t
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       ⩽
                                       Γ
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      is the nominal electricity price, 
                        
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      and 
                        
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 l
                              
                           
                        
                      are the upper and lower bound for the electricity prices, and 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                              
                                 -
                              
                           
                        
                      are binary variables that define the bounds of the uncertainty set.

The robust optimization formulation for this problem is represented by
                        
                           (11)
                           
                              P
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       X
                                    
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                f
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               f
                                                               ,
                                                               j
                                                            
                                                            
                                                               sell
                                                            
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               f
                                                               ,
                                                               j
                                                            
                                                            
                                                               sell
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               f
                                                               ,
                                                               j
                                                            
                                                            
                                                               buy
                                                            
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               f
                                                               ,
                                                               j
                                                            
                                                            
                                                               buy
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       cp
                                       +
                                       
                                          
                                             
                                                min
                                             
                                             
                                                W
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         Y
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 p
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                              
                                                                                 sell
                                                                              
                                                                           
                                                                           -
                                                                           
                                                                              
                                                                                 p
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                              
                                                                                 buy
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                                  ∈
                                                                  TH
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               i
                                                               ,
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              s
                              .
                              t
                              .
                              :
                              
                              cp
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       TH
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    cd
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                           
                        
                     where
                        
                           
                              
                                 
                                    
                                    
                                       
                                          X
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         f
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         f
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         up
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   :
                                                   
                                                   Eqs
                                                   .
                                                   
                                                   
                                                      (A.3a)–(A.5),(A.11)–(A.18),(A.27)–(A.29)
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          Y
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ptb
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         pp
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         qp
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   :
                                                   
                                                   Eqs
                                                   .
                                                   
                                                   
                                                      (A.2),(A.6)–(A.9),(A.30)–(A.32)
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where cp is the cost of the thermal unit associated with the first stage decisions involving the startup, shutdown and fixed operation costs, X represents the feasible region defined by the equations that describe the forward contact selection, and the startup and shutdown operations of the thermal unit, Y is the feasible region of operation of the thermal and hydro plants, and the energy water balance, and W denotes the uncertainty set that describes the uncertainty of the wind power and electricity prices. The two next sections describe the construction of the subproblem and master problems based on the above specific formulation.

The derivation of the subproblem for the constraint generation algorithm is performed in two steps, the first is the construction of the dual of the inner problem of the recourse problem, which was presented with the generic formulation (IRP), and corresponds to the dual of the problem with the feasible region Y described above. The specific formulation of the dual is given by
                           
                              (13)
                              
                                 
                                    
                                       Profit
                                    
                                    
                                       pool
                                    
                                 
                                 =
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     f
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           f
                                                                        
                                                                        
                                                                           f
                                                                           ,
                                                                           j
                                                                        
                                                                        
                                                                           sell
                                                                        
                                                                     
                                                                     -
                                                                     
                                                                        
                                                                           f
                                                                        
                                                                        
                                                                           f
                                                                           ,
                                                                           j
                                                                        
                                                                        
                                                                           buy
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 :
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         RU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   U
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         up
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          >
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         RU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         up
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         RD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϑ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         GQ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         in
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          >
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                GQ
                                             
                                             
                                                i
                                             
                                             
                                                in
                                             
                                          
                                          
                                             
                                                ν
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                ϖ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                τ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                υ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   HY
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   tf
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 s
                                 .
                                 t
                                 .
                                 :
                                 
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 
                                 ∀
                                 t
                                 
                                 :
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                    
                                       sell
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 
                                 ∀
                                 t
                                 
                                 :
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                    
                                       buy
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   ζ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   ϑ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ⩾
                                             -
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                             ∀
                                             i
                                             ∈
                                             TH
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             t
                                             =
                                             1
                                             
                                             :
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   ϑ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   ϑ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             ⩾
                                             -
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                             ∀
                                             i
                                             ∈
                                             TH
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             t
                                             >
                                             1
                                             
                                             :
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       υ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 1
                                 :
                                 v
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       υ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 >
                                 1
                                 ,
                                 
                                 t
                                 <
                                 tf
                                 :
                                 v
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       υ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 tf
                                 :
                                 v
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                 G
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ϖ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 1
                                 
                                 :
                                 q
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                 G
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ϖ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 >
                                 1
                                 :
                                 q
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 :
                                 ptb
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 :
                                 pp
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                 -
                                 G
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 1
                                 :
                                 qp
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                 -
                                 G
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 >
                                 1
                                 :
                                 qp
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 R
                                 
                                 ∀
                                 i
                                 ,
                                 t
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       η
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       ϑ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ϖ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       υ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 ∀
                                 i
                                 ,
                                 t
                              
                           
                        In this problem, the first stage variables 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              ,
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              ,
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              ,
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                           
                        , and the variables from the outer problem of the recourse problem 
                           
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                           
                         are fixed. Note that for each equation the dual variable is shown on the right. An interesting feature of the dual problem is that if the producer has the option to buy and sell electricity in the pool and the prices are deterministic, then 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              =
                              -
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                              
                           
                        .

The second step of the construction of the subproblem involves merging the dual with the outer problem of the recourse problem, which corresponds to the general formulation (RP1). In this problem the variables 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                              
                           
                         are not fixed, but rather defined over the polyhedral set W. Therefore, the objective function of the previous problem exhibits bilinear terms involving 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                         that can be linearized. The procedure to linearize is as follows. Based on the definition of the uncertainty set of the wind, the bilinear term can be replaced by the right hand side (rhs) of the equation
                           
                              (29)
                              
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       u
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        where on the rhs the bilinear terms can be replaced by two new variables, 
                           
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                        ,
                           
                              (30)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        and these can be linearized using the following inequalities
                           
                              (32)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 
                                    
                                       M
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       M
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    M
                                 
                                 
                                    4
                                 
                              
                           
                         are Big-M constants. The optimal values for these constants can be determined analytically through the following reasoning. The dual variable 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                         is related with the electricity prices, 
                           
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                              
                           
                        , by Eqs. (14) and (15), and based on the definition of the uncertainty set of the electricity prices, these equations can be replaced by 
                           
                              -
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                                 
                                    u
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    -
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                                 
                                    l
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        . Therefore, the inequalities above can be improved by considering that 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              -
                              (
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              -
                              (
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    t
                                 
                                 
                                    u
                                 
                              
                              )
                           
                        , leading to
                           
                              (36)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 .
                              
                           
                        Note that the bounds on the dual variable 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                         are related with the power bought and sold in the pool, and therefore, if the model does not consider the option to buy electricity from the pool, then it is not possible to determine a lower bound for 
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                           
                        . Consequently, the Big-M parameter 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                           
                         must be set to a nonpositive value with a large absolute value. Taking into consideration the merging of both problems, the substitutions and linearizations described, the formulation of the subproblem is given by
                           
                              (40)
                              
                                 
                                    
                                       Profit
                                    
                                    
                                       pool
                                    
                                 
                                 =
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   f
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   TH
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            -
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   TH
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  RU
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            U
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  SU
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  up
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   TH
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   >
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  RU
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  SU
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  up
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  RD
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  SD
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  dn
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϑ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   HY
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            V
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  GQ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  in
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   HY
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   >
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         GQ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         in
                                                      
                                                   
                                                   
                                                      
                                                         ν
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   HY
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         ϖ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   HY
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   tf
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 s
                                 .
                                 t
                                 .
                                 :
                                 
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                +
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (46)
                              
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩾
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩽
                                 Γ
                              
                           
                        
                        
                           
                              (48)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       -
                                    
                                 
                                 ⩽
                                 Γ
                              
                           
                        
                        
                           
                              (49)
                              
                                 
                                 Eqs
                                 .
                                 
                                 (
                                 16
                                 )
                                 –
                                 (
                                 28
                                 )
                              
                           
                        
                     

The specific formulation of the master problem is the following:
                           
                              (50)
                              
                                 
                                    
                                       Profit
                                    
                                    
                                       master
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          y
                                          ,
                                          u
                                          ,
                                          f
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   f
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  j
                                                               
                                                               
                                                                  sell
                                                               
                                                            
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  j
                                                               
                                                               
                                                                  sell
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  j
                                                               
                                                               
                                                                  buy
                                                               
                                                            
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  j
                                                               
                                                               
                                                                  buy
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          cp
                                          +
                                          Θ
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (51)
                              
                                 s
                                 .
                                 t
                                 .
                                 :
                                 
                                 cp
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       cu
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       cd
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                 Eqs
                                 .
                                 
                                 
                                    (A.3a)–(A.5), (A.11)–(A.18), (A.27)–(A.29),
                              
                           
                        
                        
                           
                              (53)
                              
                                 Θ
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                t
                                             
                                             
                                                +
                                                ,
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                t
                                             
                                             
                                                -
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         RU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   U
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         up
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          >
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         RU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SU
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         up
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         RD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SD
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϑ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         GQ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         in
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          >
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                GQ
                                             
                                             
                                                i
                                             
                                             
                                                in
                                             
                                          
                                          
                                             
                                                ν
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                ϖ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                τ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                υ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          tf
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                E
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 O
                                 ,
                              
                           
                        
                        
                           
                              (54)
                              
                                 Θ
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         sell
                                                         ,
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         buy
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (55)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          TH
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          HY
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ptb
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                pp
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                    
                                       sell
                                       ,
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                    
                                       buy
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                f
                                                ,
                                                j
                                             
                                             
                                                sell
                                             
                                          
                                          -
                                          
                                             
                                                f
                                             
                                             
                                                f
                                                ,
                                                j
                                             
                                             
                                                buy
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (56)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       u
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 TH
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (57)
                              
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 TH
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (58)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 P
                                 
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       RU
                                    
                                    
                                       i
                                    
                                 
                                 U
                                 
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       SU
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       up
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 TH
                                 ,
                                 t
                                 =
                                 1
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (59)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                       -
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       RU
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       SU
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       up
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 TH
                                 ,
                                 t
                                 >
                                 1
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (60)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                       -
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       RD
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       SD
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       dn
                                    
                                 
                                 ,
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 TH
                                 ,
                                 
                                 t
                                 >
                                 1
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (61)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 G
                                 (
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       qp
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 V
                                 
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       GQ
                                    
                                    
                                       i
                                    
                                    
                                       in
                                    
                                 
                                 ,
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (62)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                       -
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 G
                                 
                                    
                                       
                                          -
                                          
                                             
                                                q
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                qp
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       GQ
                                    
                                    
                                       i
                                    
                                    
                                       in
                                    
                                 
                                 ,
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 >
                                 1
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (63)
                              
                                 
                                    
                                       ptb
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (64)
                              
                                 
                                    
                                       pp
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       qp
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (65)
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (66)
                              
                                 
                                    
                                       qp
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (67)
                              
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 -
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (68)
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 t
                                 ,
                                 k
                                 ,
                              
                           
                        
                        
                           
                              (69)
                              
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 -
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                    
                                       E
                                    
                                 
                                 ,
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 HY
                                 ,
                                 
                                 t
                                 =
                                 tf
                                 ,
                                 k
                                 ,
                              
                           
                        where the optimality cut is given by (53), and (54)–(69) are the constraints that characterize the master problem in the primal constraint generation algorithm, which are based on the constraints of the primal inner problem of the recourse problem. Note that the dual variables, and variables that represent the wind and wind power are fixed in the master. While, the variables that are copies of the primal variables, 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    sell
                                    ,
                                    k
                                 
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    buy
                                    ,
                                    k
                                 
                              
                           
                        , 
                           
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                        , 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    k
                                 
                              
                           
                         are free.


                        
                           
                              1.
                              Both master and subproblem are MILP problems. Note that the inner problem of the recourse problem is a linear programming problem, but when it is merged with the outer problem and linearized, the subproblem becomes an MILP problem.

The subproblem of this case study is always bounded for any first stage decisions if the option to buy energy from the pool is considered.
                                    
                                       (a)
                                       (Primal analysis) The first stage decision variables 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                           are linked with the variables of the subproblem through the energy balance:
                                             
                                                (70)
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            TH
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            HY
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ptb
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            HY
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         pp
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         sell
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         f
                                                         ,
                                                         j
                                                      
                                                      
                                                         buy
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   t
                                                   ,
                                                
                                             
                                          and therefore, the values of 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                           must allow the subproblem to satisfy the energy balance. If there is no option to buy electricity from the pool the adaptive actions to meet the energy balance are limited by the operating constraints of the production units, which may result in an infeasible subproblem. This means that the master problem suggests the signing of contracts to sell energy that is above the generation capacity of the producer. However, with the option to buy electricity from the pool, the energy balance can always be verified by adapting the electricity bought in the pool.

(Dual analysis) 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                             
                                           are the only variables that have coefficients in the objective function that may be nonpositive, and depend on the first stage variables. However, 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           is bounded by 
                                             
                                                -
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                -
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          , and therefore, the lower bound prevents the subproblem to be unbounded, while the inequalities involving 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                             
                                           help the problem to remain bounded.

If the MILP subproblem is not solved to optimality (because of a maximum CPU time restriction) then the lower bound should not be computed with the best solution of the subproblem found, but with the best lower bound found at the maximum CPU time. Thus, the lower bound of the problem is given by 
                                    
                                       LB
                                       
                                       ≔
                                       
                                       max
                                       {
                                       LB
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             z
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             LDR
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                 , where 
                                    
                                       
                                          
                                             LDR
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  is the best possible bound.

If the subproblem is not solved to optimality, the solution obtained is still a valid bound for the variable Θ, since 
                                    
                                       Θ
                                       ⩽
                                       LDR
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ⩽
                                       
                                          
                                             LDR
                                          
                                          
                                             ̲
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 , where 
                                    
                                       
                                          
                                             LDR
                                          
                                          
                                             ̲
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  is the value of the integer solution at the maximum CPU time.

In this section, the adaptive robust optimization model and the constraint generation algorithms are used to solve two case studies characterized by the following generation systems:
                        
                           •
                           Case 1 – 1 thermal unit named G1, 1 pumped-storage hydro unit, and 1 wind farm.

Case 2 – 1 thermal unit named G2, 1 pumped-storage hydro unit, and 1 wind farm.

These two cases differ only on the thermal units characteristics, which have significant differences in the operating limits and costs, while the pumped-storage hydro unit and wind farm are identical. The data related with these units is presented in Tables 1 and 2
                     
                     . The electricity prices are expected to have an important impact on the scheduling of the system, and on the market transactions, and therefore, three different instances of the electricity prices forecasts are considered. These forecasts are based on real data collected from the Iberian Electricity Market (MIBEL) (OMIE, 2013). The first instance corresponds to the day-ahead electricity prices for the 4th week of February of 2012, the second to the 1st week of July 2012, and the last one to the 3rd week of April 2013. The electricity prices forecasts for each of the instances, labeled as EP1, EP2, and EP3, are shown in Fig. 2
                     . The electricity price forecasts of EP 1 and EP2 represent typical situations, while EP3 illustrates a scenario where the weather forecast predicts rainy and windy days that drive the electricity prices close to zero. The format of the forward contracts is based on the framework proposed in Conejo, Garcia-Bertrand, Carrion, Caballero, and de Andres (2008), where each contract can be defined as a forward selling or buying contract. For each instance of the electricity price forecast, it is considered one curve representing one contract. Each contract consists of three buying blocks and three selling blocks, and each block corresponds to a constant power of 50megawatt. Fig. 3
                      illustrates the curves for each price instance.

The uncertainty associated with the wind power generation and electricity prices is described by convex uncertainty sets parameterized by a forecast value, and a lower and upper bound for each time period. The wind power uncertainty parameters are presented in Fig. 4
                     , and the uncertainty set for the electricity price forecast EP1 is shown in Fig. 5
                     .

In this section the computational performance of the dual and the primal constraint generation algorithms is evaluated for several instances of the two case studies described. The performance of the algorithms is assessed in terms of number of iterations, CPU time, and the relative gap obtained, where the relative gap is given by 
                           
                              (
                              UB
                              -
                              LB
                              )
                              /
                              LB
                           
                        , and LB and UB correspond to the bounds calculated during the constraint generation algorithm. The stop criteria are set to a maximum CPU time of 1500seconds, and a relative gap of 0.1% for the constraint generation algorithms. For the solution of the MILP master and MILP subproblem, a maximum CPU time of 200seconds and 50seconds, respectively. The models and the constraint generation algorithm are implemented in GAMS (Brooke, Kendrick, Meeraus, & Raman, 1998) and solved on a computer with an Intel Core i7@3.07gigahertz CPU, 64 bits, and 8gigabytes of RAM. The MILP problems are solved with CPLEX 12.5.

The results obtained show that both dual and primal constraint generation algorithms have a similar performance when applied to the instances that use the electricity price forecasts EP1 and EP2, see Table 3
                           . In general, both algorithms require one iteration to solve all instances with EP1 and EP2, and therefore, no significant differences arise between the two algorithms’ performance. The electricity price forecast EP3 forces both algorithms to perform some more iterations to close the 0.1%, but only requiring a maximum CPU time of 30 and 33seconds for the dual and primal constraint generation algorithms, respectively. This set of electricity prices, EP3, raises some differences in the performance of the two algorithms. The dual constraint generation algorithm requires more iterations, but less CPU time to close the gap than the primal version, for example for EP3 with 
                              
                                 Γ
                                 =
                                 168
                              
                            the dual requires 18 iterations and 27seconds, while the primal needs 8 iterations and 30seconds. The column on the far right of Table 3 indicates the relative CPU time reductions obtained with the primal constraint generation algorithm.

Note that the profile of the electricity prices EP3 is significantly different from those of EP1 and EP2. First, for profile EP3 the electricity prices are comparatively low in the first half of the week, and in the second half the prices drop close to zero in several time periods (Fig. 2). This type of price profile forces the thermal unit to shutdown in the second half of the week, (Fig. 9(a) and (b)), which has an impact on the number of iterations required by both algorithms (Fig. 1). For the specific problem addressed in this paper, the first stage binary variables related with the status of the thermal unit are initialized as 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 t
                              
                           , for all optimization runs, and thus, the algorithms for EP3 require some additional iterations to converge to a solution where the thermal unit is shutdown and remains off during the second half of the week, meaning 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 =
                                 0
                              
                            for some periods in the second half of the week.

Regarding EP3, the differences between the two algorithms, in terms of iterations and CPU time, is explained by the fact that the primal decomposition approach generally provides a stronger link between the master problem and the subprolems, which generally results in a reduced number of iterations. However, this is achieved at the cost of increasing the computational burden of the master problem, whose solution generally requires comparatively higher time. Therefore, there is a trade-off that, depending on the application, resolves in one direction or the other. Case 2, which is presented next, provides some additional insights regarding the computational performance of both algorithms.

The results obtained for this Case show that in general both constraint generation algorithms have difficulties to reduce the relative gap to 0.1% within the maximum CPU time set, see Table 4
                           . The dual constraint generation algorithm is able to solve the instances with EP1 and EP2 with 
                              
                                 Γ
                                 =
                                 {
                                 0
                                 ,
                                 10
                                 }
                              
                           , but fails to close the gap for the remaining values of Γ, independently of the electricity price forecast used. In general, the primal constraint generation algorithm exhibits a better performance than the dual version in terms of minimum relative gap obtained, but it also fails to reduce the relative gap to 0.1% for the instances with EP1 and EP2 with 
                              
                                 Γ
                                 =
                                 {
                                 100
                                 ,
                                 150
                                 ,
                                 168
                                 }
                              
                           . However, the primal constraint generation algorithm is successful in solving all instances with EP3, with a considerable better performance than the dual version. Fig. 6
                            presents an example of the convergence profile of these two algorithms.

A deeper analysis of the performance of both algorithms, reveals that some subproblems are solved to optimality in a short time, while for other subproblems it is difficult to close the optimality gap. Examples of the former situation are the subproblems of instances EP3 solved with the dual constraint generation algorithm, which in approximately 1500seconds, more than 145 subproblems for 
                              
                                 Γ
                                 =
                                 {
                                 0
                                 ,
                                 10
                                 }
                              
                            are solved, and more than 64 for 
                              
                                 Γ
                                 =
                                 {
                                 100
                                 ,
                                 150
                                 ,
                                 168
                                 }
                              
                           . On the other hand, for the instances EP2 solved with the primal constraint generation algorithm, the difficulties in solving the subproblem limit the number of iterations to 
                              
                                 {
                                 25
                                 ,
                                 28
                                 ,
                                 28
                                 }
                              
                            for 
                              
                                 Γ
                                 =
                                 {
                                 100
                                 ,
                                 150
                                 ,
                                 168
                                 }
                              
                           , for approximately the same CPU time. Note that a similar performance occurs for the dual constraint generation algorithm. This is the result of a very loose relaxation of the MILP subproblem that occurs for some fixed first decision variables in the subproblem. Analyzing the convergence of some instances, it suggests that at a given iteration, the subproblem has reached the optimal LB of the constraint generation algorithm, although it cannot prove the LB because the MILP subproblem does not converge to optimality. For example, the convergence profile of the primal constraint generation algorithm presented in Fig. 7
                           (a) and (b) is an example of a constraint generation gap that seems not to close because of the subproblem.

In Case 2, the coefficient cost 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            of the thermal unit is greater than the same coefficient for the thermal unit of Case 1, which means that the thermal generation unit in Case 2 has a higher marginal cost. This marginal cost of the unit G2 in combination with the electricity prices forecast and also the drive to maximize sales through contracts, available to the master, may introduce some difficulties to the dual constraint generation algorithm in terms of convergence. This is explained by the fact that the algorithm is divided in two levels, where in the first, the master problem neither accounts for all cost information of the thermal unit nor for the prices in the pool. Therefore, the master may try to drive the search for selling contracts and/or commitments that in the subproblem are not profitable taking into account the variable generation cost and prices of the pool.

An important issue in robust optimization is the trade-off between protection against worst case situations and prevent very conservative solutions. This issue can be addressed either during the construction of the uncertainty set, or by considering the so-called budget constraints and budget parameters. In the context of this work, the values of the budget parameter are associated with the level of risk that the producer is able to assume regarding the outcomes of the wind power and electricity prices. Here, a more conservative approach corresponds to higher values of the budget parameter, Γ, and a more risk prone attitude to lower values of Γ. A conservative approach considers that a large number of time periods may lead to significant deviations from the wind power and electricity prices forecast, while a more risk prone approach is comfortable with the forecasts, assuming that fewer periods of time will have wind power and electricity prices deviations from the forecast values. Clearly, the relation between Γ and the profit is based on the impact that Γ has on the deviations of wind power and electricity prices from the forecast values. Therefore, the choice of the Γ value has a considerable impact on the results obtained from the point of view of profit, scheduling, contracts settings, and market offering.

The results presented in Tables 3 and 4 clearly show that the profit decreases with the increase of Γ. For example for Case 1 with 
                           
                              Γ
                              =
                              10
                           
                         the profit is 4,936,002, while for 
                           
                              Γ
                              =
                              168
                           
                         the profit decreases to 2,935,271.

The influence of the budget parameter over the power generated, and power sold and bought is shown in Figs. 8 and 9
                        
                         for Case 1, using the electricity price forecasts EP1 and EP3, respectively. In these figures on the left are presented the results obtained with 
                           
                              Γ
                              =
                              10
                           
                         and on the right with 
                           
                              Γ
                              =
                              100
                           
                        . In Fig. 8, the commitment and dispatch of the thermal unit is independent of the budget parameter. However, the wind power produced with 
                           
                              Γ
                              =
                              10
                           
                         is considerable greater than the one generated for 
                           
                              Γ
                              =
                              100
                           
                        , since the latter reflects a more conservative approach on the wind power forecast. As expected the pumped-storage hydro plant operates in pump mode during the wind power peaks, see Fig. 8(a) and (b). In terms of market, the budget parameter has a considerable impact over the energy sold through the contracts and in the pool. For 
                           
                              Γ
                              =
                              10
                           
                        , which represents a more risk prone approach, 100megawatt of electricity are sold by contract, and the power being sold in the pool is above 400megawatt, see Fig. 8(c). On the other hand, 
                           
                              Γ
                              =
                              100
                           
                         establishes a more conservative perspective and now 300megawatt of electricity are sold by contract and around 200megawatt in the pool.


                        Fig. 9 shows the results obtained with the electricity price forecast EP3 for Case 1. This set of prices are relatively lower than EP1 and EP2, and thus, force the thermal unit and the pumped-storage hydro unit to generate power only during the periods with higher electricity prices, and shutdown during the lower electricity prices. In addition, the pumped-storage hydro unit operates in pump mode during the periods of lower electricity prices as it would be expected, see Fig. 9(a) and (b). In terms of market, the more risk prone approach sells most of the energy in the pool during the high price periods with hourly offers of more than 500megawatt, while the power sold by contracts remains on 100megawatt, see Fig. 9(c). The conservative approach decides to sell 200megawatt of electricity through contracts during the week, and no more than 300megawatt in the pool. In addition, the conservative approach buys electricity from the pool in the second half of the week when the prices are close to zero, see Fig. 9(d). These results are aligned with the expected purpose of the forward contracts, which are used to hedge against the risk of the price volatility in the pool, returning a certain revenue.


                        Fig. 10
                         shows the results obtained for Case 2 with the electricity price forecast EP1. The power generation schedule obtained for both values of Γ exhibit an expected trend, with the thermal unit being off during the beginning of the week when the prices are lower, and then ramping up to the maximum power output, while the wind power generated is correlated with the Γ value. Regarding the market results, two interesting aspects should be highlighted: (1) for 
                           
                              Γ
                              =
                              10
                           
                         there are 100megawatt sold through contracts, while for 
                           
                              Γ
                              =
                              168
                           
                         there are only 82megawatt; (2) for 
                           
                              Γ
                              =
                              168
                           
                         the system needs to buy electricity from the pool during several periods of time, see Fig. 10(c) and (d). Note that the classical result “the higher the risk the higher the pool involvement” does not hold for some of the above results. This is clarified in the following. Tables 5 and 6
                        
                         present for each case and instance of the electricity price forecast, the power sold through contracts, and the total energy sold and bought in the pool as a function of the budget parameter, for the whole week. These results correspond to the primal constraint generation algorithm. For Case 1 there is a clear relationship between the conservatism level and the power sold through contracts and in the pool, showing that conservative views result in selling less in the pool and more through contracts. However, for Case 2 a similar trend is not observed for instances considering EP1 and EP2, where the more conservative approaches, contrarily to the more risk prone ones, result in selling comparatively less energy through contracts and buying comparatively more energy in the pool. In general, the two-stage adaptive robust optimization framework finds the optimal contract form (price and energy) that hedges the electricity producer against the worst case realizations of the electricity prices. In this optimization framework, a high value of the budget parameter means a high number of periods with deviations from the forecast values, while a low number of the budget parameter implies a low number of periods of time with deviations from the forecast values, as explained in Section 6. Therefore, a given producer considering a high or a low budget parameter is assuming a comparatively low electricity price or a comparatively high electricity price. Consequently, the optimization framework allocates more energy through contracts when the conservative approach is used, in order to protect against the lowest electricity prices. However, since different levels of wind power are assumed by both the conservative approach and the more risk prone, the relationship between contracts and the pool may be distorted. In this optimization framework, a given producer considering a high or a low budget parameter is considering a comparatively low wind power (conservative approach) or a comparatively high wind power (risk prone approach). In short, with a high budget parameter the producer assumes lower wind power available than with a low budget parameter.

The production capacity is equal to the capacity of the thermal unit plus the wind capacity plus the pump-storage capacity (generation mode). This capacity depends on several variables: (a) the wind power, which has uncertain deviations from the forecast values; (b) the power output of the hydro plant, which may not be able to operate at maximum power during all periods due to water usage limits; and (c) the power output of the thermal plant, which is known, but costly. Therefore, the power sold by contract is bounded by the sum of two variables: (1) the minimum power output over all time periods, see Fig. 11
                        (a) and (2) the power that the producer can buy in the pool to sell through contracts with an overall profit.

For Case 1 and profiles with EP1 and EP2, if the electricity prices are high, the thermal unit generates power during all time periods, and the power sold through contract is always lower than the power output of the thermal unit (see Fig. 8). In this case, the wind power difference between the conservative and risk prone approaches does not affect the power generation that supports the contract. With price profile EP3 and comparatively high prices, the power sold through contracts is also below the power generated by the thermal unit (provided that it is on), while for comparatively low electricity prices in the pool, the thermal unit is off, and the contract is satisfied with electricity bought in the pool (see Fig. 9).

For Case 2 and price profile EP3, similar results are obtained, since the producer can buy electricity in the pool at low prices during the second half of the week. However, with price profiles EP1 and EP2, a similar trend is not observed. Note that in Case 2, the capacity of the thermal unit is lower than that in Case 1, and it may be smaller than the wind power available. Furthermore, the variable generation cost of the thermal unit in Case 2 is higher than that in Case 1 (see Table 1), which may favor buying electricity in the pool during periods when prices are comparatively low and there are negative deviations from the wind power forecasts, as can be observed in Table 6 for 
                           
                              Γ
                              =
                              {
                              100
                              ,
                              150
                              ,
                              168
                              }
                           
                        . Fig. 11 provides some additional insights for Case 2 and price profile EP1. Particularly, Fig. 11(a) shows for 
                           
                              Γ
                              =
                              10
                           
                         that the 100megawatt sold through the contract are lower than the minimum power generation of 110megawatt that occurs in time period 94. However, the 100megawatt are above the capacity of the thermal unit, which results in the wind power contributing to meet the contract settled. While for 
                           
                              Γ
                              =
                              168
                           
                        , a more conservative approach which considers comparatively lower wind power, the power sold through the contract is only 82megawatt, which in some periods of time is above the power generation (Fig. 11(b)). Therefore, with a comparatively lower wind power available, the optimization framework determines a lower level of power allocated to the contract. In addition, the latter contract forces the producer to buy electricity in the pool to satisfy the contract, as shown in Fig. 11(c). In this figure, the white area corresponds to the electricity bought in the pool, which moves the minimum power generation plus the electricity bought to the level of the line of the contract for all time periods.

In order to support the above conclusions and to further analyze the relationship between the conservatism level and the market involvement, additional results from optimization runs considering perfect wind power information, but uncertain electricity prices are presented below. In this situation, perfect wind power information ensures that the wind power generation does not influence the market involvement for different conservatism levels. The results obtained show that for both Cases 1 and 2, that the higher the risk the higher the pool involvement, as shown in Tables 7 and 8
                        
                        . These results follow the expected trend, and help to understand that considering wind power uncertainty and different levels of conservatism, which imply deviations on the assumed wind power forecast, may distort the traditional trade-off between contracts and pool involvement.

@&#CONCLUSIONS@&#

In this paper a two stage adaptive robust optimization approach is used to tackle the optimal self-scheduling, forward contracting, and pool involvement of an electricity producer. The generation portfolio of the producer involves thermal, pumped-storage hydro, and wind power units, with the electricity prices and wind power being subject to uncertainty. The solution approach used relies on a constraint generation algorithm based on Benders’ Decomposition. Two variants of this algorithm are tested: a dual and a primal approach. The derivation of the subproblem of the algorithm and the linearization of bilinear terms establishes a relation between the dual variables associated with the energy balance and the uncertainty convex set defined for the electricity. This derivation also shows that the subproblem has full recourse given that for the producer the option to buy electricity from the pool remains open.

The results obtained indicate that the two variants of the constraint generation algorithm have similar and efficient performances for most of the cases, but there are instances for which the primal constraint generation algorithm is clearly superior in terms of convergence rate and computational time. A careful analysis of the constraint generation algorithm performance shows that some subproblems cannot be solved to optimality within a reasonable CPU time, therefore, suggesting the use of a lower bound calculation based on the best possible solution of the MILP subproblem, instead of the integer solution. This difficulty to close the gap of the subproblem is propagated to the gap of the constraint generation algorithm, and therefore, the algorithms have difficulties to converge. However, the constraint generation algorithm seems to have converged if in the calculation of the gap, it is considered the integer solution of the subproblem.

The coordination of the thermal and pumped-storage hydro units present a clear relation with the price of electricity, showing the correct adaptation of the thermal unit to high prices, with the pump mode of the pumped-storage unit being activated when the prices are low.

The control of the conservatism level is analyzed through several instances solved for different values of the budget parameter. The results obtained show that the most conservative approaches lead to lower profits than those that are more risk prone, as it would be expected. The former corresponds to the selection of forward contracts to hedge against the volatility of the electricity prices of the pool, while for the latter this is not verified for all instances.

As it is found that, for Case 2 for two instances of the electricity pool prices, contrarily to the more risk prone, the more conservative approach will tend to sell less energy through forward contracts, and rely more on the pool to buy electricity. This illustrates the fact that uncertainty of wind power gives rise to a situation, where it is difficult to foresee and isolate the relation between the conservatism level and both the contract selection and pool involvement.

The work presented suggests that future work should include a comparison between stochastic programming and robust optimization in terms of computational performance, and an assessment based on an out of sample simulation.

@&#ACKNOWLEDGMENTS@&#

The research leading to these results has received funding from the European Union Seventh Framework Programme (FP7/2007-2013) under Grant Agreement N. PCOFUND-GA-2009-246542 and from the Foundation for Science and Technology of Portugal under the Welcome II Programme. The authors would like to thank the anonymous referees whose relevant suggestions have contributed to improve the paper.

The objective function of the problem is the maximization of the operational profit given by
                        
                           (A.1)
                           
                              P
                              =
                              
                                 max
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                -
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      f
                                                      ,
                                                      j
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      sell
                                                   
                                                
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      buy
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              cop
                              .
                           
                        
                     
                     
                        
                           (A.2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       TH
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       HY
                                    
                                 
                              
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    buy
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       HY
                                    
                                 
                              
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    sell
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ,
                              
                              ∀
                              t
                              .
                           
                        
                     The format and modeling of the contracts is based on the framework proposed in Conejo et al. (2008).
                        
                           (A.3a)
                           
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              ⩽
                              
                                 
                                    F
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              
                              ∀
                              f
                              ,
                              j
                              ,
                           
                        
                     
                     
                        
                           (A.3b)
                           
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ⩽
                              
                                 
                                    F
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              
                              ∀
                              f
                              ,
                              j
                              ,
                           
                        
                     
                     
                        
                           (A.3c)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    buy
                                 
                              
                              
                              ∀
                              f
                              ,
                           
                        
                     
                     
                        
                           (A.3d)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    sell
                                 
                              
                              
                              ∀
                              f
                              ,
                           
                        
                     
                     
                        
                           (A.3e)
                           
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    sell
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    buy
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              f
                              .
                           
                        
                     
                  

The feasible region of operation of the thermal unit is based on the models described in Arroyo and Conejo (2000) and Ostrowski et al. (2012).
                        
                           (A.4)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       tt
                                       ⩾
                                       t
                                       -
                                       
                                          
                                             UT
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       ,
                                       tt
                                       ⩽
                                       t
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    tt
                                 
                                 
                                    up
                                 
                              
                              ⩽
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                              
                              ∀
                              i
                              ,
                              
                              t
                              ⩾
                              
                                 
                                    LM
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.5)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       tt
                                       ⩾
                                       t
                                       -
                                       
                                          
                                             DT
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       ,
                                       tt
                                       ⩽
                                       t
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    tt
                                 
                                 
                                    dn
                                 
                              
                              ⩽
                              1
                              
                              
                              ∀
                              i
                              ,
                              
                              t
                              ⩾
                              
                                 
                                    FM
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              ,
                           
                        
                     where 
                        
                           
                              
                                 LM
                              
                              
                                 i
                              
                           
                           =
                           min
                           {
                           |
                           T
                           |
                           ,
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                           }
                           ,
                           
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                        
                      is the number of hours generator i needs to be on at the beginning of the time horizon, 
                        
                           
                              
                                 FM
                              
                              
                                 i
                              
                           
                           =
                           min
                           {
                           |
                           T
                           |
                           ,
                           DMi
                           }
                           ,
                           
                           
                              
                                 DM
                              
                              
                                 i
                              
                           
                        
                      denotes the number of hours the generator needs to be off at the beginning of the time horizon.
                        
                           (A.6)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.7)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              P
                              
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    RU
                                 
                                 
                                    i
                                 
                              
                              U
                              
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    SU
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              
                              t
                              =
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.8)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    RU
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    SU
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              
                              t
                              >
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.9)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    RD
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    SD
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              
                              t
                              >
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.10)
                           
                              cop
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       TH
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    cd
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (A.11)
                           
                              
                                 
                                    cd
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                    
                                 
                              
                              
                              
                              ∀
                              i
                              ,
                              t
                              =
                              1
                              ,
                              
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    I
                                 
                              
                              >
                              0
                              ,
                           
                        
                     
                     
                        
                           (A.12)
                           
                              
                                 
                                    cd
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              
                                 
                                    DC
                                 
                                 
                                    i
                                 
                              
                              
                              ∀
                              i
                              ,
                              t
                              ⩾
                              2
                              ,
                           
                        
                     
                     
                        
                           (A.13)
                           
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              
                                 
                                    HS
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.14)
                           
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                tt
                                                ⩾
                                                t
                                                -
                                                (
                                                
                                                   
                                                      DT
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      c
                                                   
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             tt
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    CS
                                 
                                 
                                    i
                                 
                              
                              
                              ∀
                              i
                              ,
                              t
                              >
                              
                                 
                                    TD
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (A.15)
                           
                              
                                 
                                    cu
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                tt
                                                <
                                                t
                                             
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             ,
                                             tt
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    CS
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                              ∀
                              i
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    I
                                 
                              
                              <
                              0
                              ,
                              
                              
                                 
                                    
                                       
                                          
                                             TD
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             I
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              <
                              t
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             TD
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (A.16)
                           
                              1
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              =
                              0
                              ,
                              
                              ∀
                              i
                              ,
                              t
                              =
                              1
                              ,
                              
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                              >
                              0
                              ,
                           
                        
                     
                     
                        
                           (A.17)
                           
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              =
                              0
                              ,
                              
                              ∀
                              i
                              ,
                              t
                              =
                              1
                              ,
                              
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                              <
                              0
                              ,
                           
                        
                     
                     
                        
                           (A.18)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              =
                              0
                              ,
                              
                              ∀
                              i
                              ,
                              t
                              >
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.19)
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              -
                              G
                              (
                              -
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              )
                              =
                              V
                              
                                 
                                    0
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    GQ
                                 
                                 
                                    i
                                 
                                 
                                    in
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              
                              t
                              =
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.20)
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                    -
                                    1
                                 
                              
                              -
                              G
                              (
                              -
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              +
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    GQ
                                 
                                 
                                    i
                                 
                                 
                                    in
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              
                              t
                              >
                              1
                              ,
                           
                        
                     
                     
                        
                           (A.21)
                           
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.22)
                           
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              -
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              .
                           
                        
                     
                     
                        
                           (A.23)
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.24)
                           
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.25)
                           
                              
                                 
                                    V
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    l
                                 
                              
                              ⩽
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    V
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    u
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.26)
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                                 
                                    E
                                 
                              
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              =
                              tf
                              ,
                           
                        
                     
                     
                        
                           (A.27)
                           
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    buy
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    f
                                    ,
                                    j
                                 
                                 
                                    sell
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              f
                              ,
                              j
                              ,
                           
                        
                     
                     
                        
                           (A.28)
                           
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    sell
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    f
                                 
                                 
                                    buy
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              f
                              ,
                           
                        
                     
                     
                        
                           (A.29)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    up
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                                 
                                    dn
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.30)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              i
                              ∈
                              TH
                              ,
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.31)
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    sell
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                                 
                                    buy
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (A.32)
                           
                              
                                 
                                    ptb
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    pp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    qp
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              i
                              ∈
                              HY
                              ,
                              t
                              .
                           
                        
                     The above model for the thermal unit involves: (a) minimum up and down time limits, Eqs. (A.4), and (A.5), see Rajan and Takriti (2005); (b) bound on the power output, Eqs. (A.6)–(A.9), see Ostrowski et al. (2012); (c) modeling of operating, starting, and shutdown costs, Eqs. (A.10), (A.12)–(A.15), see Nowak and Romisch (2000); Arroyo and Conejo (2000); Morales-Espana et al. (2013a); and (d) logical relations between the different states of the unit, Eqs. (A.16)–(A.18). For the pumped-storage hydro unit, the model considers: (a) water mass balances for the reservoir at the end of each period, Eqs. (A.19) and (A.20); and (b) power generation and consumption functions, Eqs. (A.21) and (A.22).

@&#REFERENCES@&#

