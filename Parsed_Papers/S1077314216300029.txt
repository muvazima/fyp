@&#MAIN-TITLE@&#A detection-driven and sparsity-constrained deformable model for fascia lata labeling and thigh inter-muscular adipose quantification

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A deformable model for robust reconstruction of fascia lata surface is proposed.


                        
                        
                           
                           The model’s deformation is driven through a discriminative detector.


                        
                        
                           
                           A sparsity-constrained optimization is used to suppress detection outliers.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Thigh inter-muscular adipose tissue quantification

Fascia lata

Deformable model

Learning-based and narrow-band Detection

Sparsity-constrained optimization

@&#ABSTRACT@&#


               
               
                  Quantification of the thigh inter-muscular adipose tissue (IMAT) plays a critical role in various medical data analysis tasks, e.g., the analysis of physical performance or the diagnosis of knee osteoarthritis. Several techniques have been proposed to perform automated thigh tissues quantification. However, none of them has provided an effective method to track fascia lata, which is an important anatomic trail to distinguish between subcutaneous adipose tissue (SAT) and IMAT in the thigh. As a result, the estimates of IMAT may not be accurate due to the unclear appearance cues, complicated anatomic, or pathological characteristics of the fascia lata. Thus, prior tissue information, e.g., intensity, orientation and scale, becomes critical to infer the fascia lata location from magnetic resonance (MR) images. In this paper, we propose a novel detection-driven and sparsity-constrained deformable model to obtain accurate fascia lata labeling. The model’s deformation is driven by the detected control points on fascia lata through a discriminative detector in a narrow-band fashion. By using a sparsity-constrained optimization, the deformation is solved from errors and outliers suppression. The proposed approach has been evaluated on a set of 3D MR thigh volumes. In a comparison with the state-of-the-art framework, our approach produces superior performance.
               
            

@&#INTRODUCTION@&#

The inter-muscular adipose tissue (IMAT) is an essential tissue component of the thigh. It lies within the fascia lata surrounding the leg musculature. The fascia lata, shown in Fig. 1
                     , is a fibrous membrane giving off sheaths to the thigh muscles. Different from the subcutaneous adipose tissue (SAT), IMAT encompasses and permeates skeletal muscle blocks, with which it shares a direct vascular connection (Durheim et al., 2008) as illustrated by a T1-weighted magnetic resonance (MR) image in Fig. 2
                     .

IMAT has been considered as an important predictor of the human body’s metabolism, muscle function, and mobility function (Addison et al., 2014). The volume of IMAT seemed to be inversely associated with physical activity and the increase of IMAT volume could contribute to losses in muscle strength (Manini et al., 2007). Tuttle et al. showed that IMAT impacts physical performance (Tuttle et al., 2012). Quantification of IMAT can also provide an important cue for the diagnosis of knee osteoarthritis (OA). Knee OA is a type of disease of degenerative joints, including articular cartilage and subchondral bone, which is the most prevalent arthritis in older people. Maly et al. revealed the relationship between IMAT volume and knee extensor strength, and physical performance among women with or at risk of knee OA using magnetic resonance imaging (MRI) (Maly et al., 2011, 2013). In addition, a further study in Dannhauer et al. (2014) has shown that the increase of IMAT content is associated with structural and pathological progression of knee OA in women. Therefore, an accurate quantitative assessment of thigh IMAT is crucial in many medical and clinical analyses, such as leg functional quality analysis, metabolic dysfunction or knee OA diagnosis from a large number of MR images.

In recent years, several techniques have been proposed to perform automated muscle/tissue segmentation and IMAT assessment. A 2D segmentation by gradient vector flow (GVF) based active contour was used to assess IMAT and other tissues in thigh (Positano et al., 2009). Makrogiannis et al. (2012) incorporated a parametric deformable model and unsupervised tissue clustering for IMAT extraction. Valentinitsch et al. (2013) used a model based on k-means clustering and mathematical morphology to classify and delineate IMAT and SAT. In Andrews et al. (2011) and Baudin et al.(2012) the authors incorporated shape/appearance priors into their segmentation methods to segment individual skeletal muscle blocks. In our previous study (Tan et al., 2014), we proposed a robust framework to handle the parameter sensitivities in segmentation and high variation in thigh data by utilizing a variational Bayesian Gaussian mixture model and the metamorphs (Huang et al., 2004).

So far, all the above-mentioned existing methods assume that the contour of the general muscular region is the boundary separating SAT and IMAT if we call the enclosed area including all the skeletal muscle blocks as the general muscular region. Since the fascia lata is close to the muscle groups in normal subjects, such an assumption is acceptable. However, this assumption does not hold for pathological subjects, because the fascia lata may not be close to muscle regions (as shown in Fig. 1(b)). When processing the image data from subjects with pathological changes, such as obesity or muscle looseness, the existing methods may not have accurate fascia lata delineation due to the following challenges. First, the fascia lata has a low-contrast contour. Part of its appearance is weak or even missing (Fig. 1(c)), and nearby tissues may have similar image texture as the fascia lata. Such ambiguous image cues may mislead traditional segmentation methods like deformable model and edge detection. Second, the shape of fascia lata has a large variation. Its morphology and structure may change due to the affecting disorders and diseases of the thigh. Third, there exist unknown noises and imaging artifacts in medical images, which can impact the accuracy of image analysis. For example, the bias field is a low-frequency noise which can cause intensity and contrast inhomogeneities in MR images. Lastly, robust and precise segmentation for objective and consistent measurements is challenging in clinical trials due to the significant geometric and physiologic variations in subjects as well as the diverse sources the medical images were acquired from.

In this paper, we propose to label the fascia lata through its reconstruction by a sparsity-constrained deformable model driven by learning-based detection. Specifically, the approach includes the following three parts. (a) The initialization of the deformable model is implemented by an efficient unsupervised tissue segmentation integrating global image context and shape refinement. The initialized surface is modeled as a set of meshless vertices, which provides a regularization (prior term) to preserve the local shape during model evolution. (b) The model evolution is driven by a force (data term) which is derived from the detected control points on fascia lata. The control points are detected in a narrow-band fashion from the initialized surface using features like local image context and global orientation. (c) To overcome errors and outliers in the detection, a sparsity constraint (Zhang et al., 2012a) has been utilized to optimize the model deformation. The deformation result can be forwarded back to step (a) for iterative updates until the model converges. The proposed method (I) captures both global and local image information for the model initialization and control points detection; (II) integrates geometric information and sparse outliers expression into the model optimization. As a result, this method is able to handle ambiguous boundaries like the one shown in Fig. 1(c). The evaluation on a set of 3D T1-weighted MR thigh volumes shows that our method produces superior performance compared to state-of-the-art approaches. The proposed method can produce robust IMAT quantification in clinical analyses.

The rest of the paper is organized as follows. Section 2 reviews relevant work about thigh muscle extractions using atlas-based segmentations, the popular deformable models, and shape priors and sparsity constraint methods. Section 3 presents the proposed framework and its implementation for the fascia lata labeling. Section 4 shows the experimental results on a dataset from OA clinical trials and discussions. Finally, we conclude in Section 5.

@&#RELATED WORK@&#

Atlas-based automated approaches have been used to effectively segment objects of interest in biomedical images. An atlas is a pair of a target scan and a corresponding manual labeling image. The atlas-based segmentation is estimated using image registration, and hence a single segmented result is propagated (Ashburner and Friston, 2005; Iosifescu et al., 1997). Numerous atlas-based variations have been proposed. Slagmolen et al. (2007), Okada et al. (2007) and Yan et al. (2014) demonstrated that the atlas-based methods can provide a reliable initial segmentation for refinement. Aljabar et al. (2009) introduced an atlas selection to accelerate the label fusion and obtain more accurate segmentation. Recently, the multi-atlas approach with joint label fusion (Wang et al., 2013) and its optimization with a generative probability model (Wu et al., 2014) achieved very good accuracies in brain parcellation challenges. Some authors have utilized atlas-based methods for thigh muscle extraction (Ahmad et al., 2014; Prescott et al., 2011). However, the performance of atlas-based methods highly depends on the availability and selection of appropriate training samples, and the accuracy of nonrigid image registration methods. In addition, the computational cost would be a burden for the analysis of large databases.

In recent decades, with the success of active contours, a large family of deformable models has been developed and widely used in medical image analysis. The most common and basic member, Snake (Kass et al., 1988), models the deformable contour as an energy-minimizing spline and constrains it with image features. The energy formulation E
                     total in the Snake model is combined with an internal E
                     int and an external E
                     ext energy term. In the classical definition, E
                     int constrains the model tension and rigidity, while E
                     ext, coinciding with an edge gradient magnitude map, deforms the model towards object boundary. Since the degradation factors (resolution, noise and organ location) exist in medical imaging, the derived boundary instances from image appearance cues in the method may be incomplete in the presence of weak or missing appearance cues. Other parametric models (Li and Acton, 2007; Xu and Prince, 1998), were proposed to enlarge the capture range of the external term in the Snake by using the gradient vector flow (GVF) and the vector field convolution (VFC). However, because the major external constraint is still image gradient information, these methods may be trapped by low contrast or missing edges. Additionally, in order to improve the robustness to noise, region-based energy terms, E
                     region, have been involved in the Snake energy functional by Huang et al. (2004) and Shen et al. (2008). The region term provides two-way balloon forces that drive the current model surface towards the predicted object boundary. The predicted boundary is computed from the current model-interior intensity statistics. The statistics are learned during model evolution, which are unsupervised and may limit their performance due to the high shape variation and boundary ambiguity. Laplacian coordinates (Nealen et al., 2006; Sorkine et al., 2004), called differential coordinates, represent a node as the weighted difference between this node and its neighbors (result of applying the discrete Laplacian operator). Compared with the spline-based methods, the Laplacian coordinate is more flexible for shape representation. In the modified Laplacian-coordinate-based deformable models, Zhang et al. (2013) employed it to encode shape details and smoothness constraints, and Shen et al. (2011) decomposed the Laplacian of each mesh vertex to keep the model’s surface smooth. In this paper, we build a data energy term by the Laplacian coordinate to conveniently represent as well as preserve the shape of model.

Some other studies integrate expert-labeled shape priors into the deformable models. A classic shape modeling method is the Active Shape Model (ASM) (Cootes et al., 1995), which captures shape variations by principal component analysis (PCA). But using the mean shape of training images as initialization and assuming Gaussian shape distribution limit its performance due to gross and sparse errors. In recent years, sparsity has been widely investigated and the sparsity prior has been vastly used in medical image analysis. The sparsity constraints have been employed to model sparsity priors effectively in deformable segmentation (Zhang et al., 2012a, 2012b), low-dose CT perfusion (Fang et al., 2012, 2013) and landmark matching (Zheng et al., 2014). Alternatively, learning-based models have successfully inferred potential shape priors. Zhan et al. proposed a learning-based deformable model (Zhan et al., 2009) by inferring potential shape priors. Yet in the model, the hierarchical clustering needs a sophisticated feature selection, and the Haar feature and Adaboost based boundary detector is not efficient in classifying the orientations of objects and might overfit data. Zheng et al. (2008) showed that steerable features can capture the orientation and scale of human organs very efficiently. Random forest (Breiman, 2001) has merits, such as no overfitting, parallel sub-tree growing etc. It can be trained as an effective medical tissue classifier. However, the steerable feature and random forest based boundary detector could not directly delineate the exact boundary of organs for two reasons. (1) This model can only generate a probability map of being on the boundary for each pixel. Smooth and continuous boundaries could not be obtained by directly thresholding the probability values. (2) This model could not avoid outliers in detection, which leads to noise in boundary delineation. Thus, we develop a narrow-band and sparse strategy to detect the fascia lata. This strategy avoids the full image searching and only detects a sparse set of fascia lata points. In this way, we can apply ℓ1 and ℓ2 norms to regularize the force of detected points to suppress Gaussian errors and sparse gross errors, respectively.

@&#METHODS@&#

Accurate fascia lata labeling can distinguish the two types of thigh adipose tissue, IMAT and SAT, and benefit the quantification of thigh IMAT. We formulate this problem as a reconstruction work by a novel deformable model. The model is firstly initialized by the edge of the thigh general muscular region. Meanwhile, the initialized meshless vertices are formulated as a prior term to preserve the local similarity by using the Laplacian coordinate. Then the detected fascia lata points are formulated as a robust data term which drives the model to the detected position in the MR image. Besides, a sparsity regularization is integrated into model deformation to handle detection outliers. Fig. 3
                      shows the algorithm flowchart.

Reliable initialization is a key step of deformable models. For the fascia lata segmentation, a superior initialization is the outer edge of the general muscular region, which is the closest contour including all muscle blocks. A case of the edge is demonstrated as the blue contour in Fig. 3(a). This initialization has two advantages. (I) It can be generated robustly since the contrast between muscle and adipose tissues is relatively clear. (II) It locates closely to the fascia lata in normal subjects. Thus, it can accelerate the deformation and avoid detection errors. Although numerous existing learning-based methods may obtain the contour, they all require a large number of training samples to cover the variance in clinical studies. Unfortunately, due to the expensive costs of manual labeling, such a good training set is usually unavailable.

In the T1-weighted MR thigh images, the pixel intensity of the primary anatomical tissues (adipose, muscle) have significant differences. The adipose has high pixel value, while the value of the muscle is at intermediate level. Additionally, SAT and muscle have considerably consistent spatial distributions. SAT, shown as the pink label in Fig. 2, is a kind of adipose tissue between the skin (green-dashed contour in Fig. 4
                        ) and muscles, and firmly encircles the muscle region (brown label). Thus, we design a 2D tissue segmentation to efficiently and effectively extract the general muscular region in two sub-steps; clustering and refinement. The clustering step uses a common clustering method (e.g. fuzzy c-means (Bezdek et al., 1984)) with two features: intensity map X
                        
                           i
                         (intensity value at each pixel) and distance map X
                        
                           d
                         (for each pixel in the thigh, calculate its closest distance to the skin) to roughly label the general muscular region. Because of the spatial distance feature, the output of the clustering algorithm is guaranteed to be a connected region covering all the muscles. Then the refinement step just refines the edge of the general muscular region through GVF-snake evolution, resulting in a smoothed and connected contour. The vector field of the snake is only derived from the intensity map to drive the contour closer to the muscle boundaries. After these two sub-steps, we get one general muscular contour from each axial image. Using these contours in the image volume, we initialize our model and start the later fascia lata detection. The initialized model V
                        0 is defined as a set of meshless nodes on all the contours in the image volume. The initialization flowchart is shown in Fig. 4.

We define a set of control points on fascia lata obtained from the learned detector, shown as the red points in Fig. 3(b). Our data set consists of volumetric mid-thigh axial MR scans. Based on the observation that the fascia lata in adjacent axial slices from the same 3D volume have strong correlation, we train a 2D fascia lata detector from training image slices. In this way, we have more training samples (image slices) and the detection task is easier. The training employs the random forest classifier (Breiman, 2001) as shown in Fig. 5
                        . We use points on the manually labeled fascia lata as positive samples. From each positive point, we collect f points forward and b points backward along its normal direction at equal intervals as the negative samples. To detect fascia lata, both local information, e.g. local orientation and image texture, and global information, e.g. the relative position to the thigh mass center, are necessary. We extract steerable features (Zheng et al., 2008) as the local feature. To compute the steerable features of a image pixel, a few points are sampled from the image patch centered at the pixel using a regular sampling pattern. Then local (intensity-based and gradient-based) features are extracted for each sampling point. The steerable features embed orientation and scale information into the distribution of sampling points, while each individual feature set is locally defined. In this way, the transformation of image patch can be well captured by the transformation of the sampling pattern; and the recognition of the transformed image patch can be conducted using these steerable features. The same local features and sampling pattern as in Zheng et al. (2008) are used in our training. For the global feature, we put the origin of the global coordinate at the thigh mass center 
                           
                              
                                 p
                                 o
                              
                              =
                              
                                 (
                                 
                                    x
                                    o
                                 
                                 ,
                                 
                                    y
                                    o
                                 
                                 )
                              
                           
                        . The x-axis p
                        
                           x
                         and y-axis p
                        
                           y
                         are parallel to the image’s horizontal and vertical axes, respectively. The global feature of pixel at p
                        
                           s
                         is represented as a relative angle θ between 
                           
                              
                                 p
                                 s
                              
                              −
                              
                                 p
                                 o
                              
                           
                         and p
                        
                           x
                        .

With the trained detector, we detect the fascia lata points starting from the initialization. Narrow-band processing, which restricts most computations into a thin band, obviously improves the searching efficiency. Because the fascia lata, as shown in Fig. 1, is near or attached to the outer boundary of muscles, we define the narrow band as the range surrounding the initialized model. Another practical strategy to increase computational efficiency is detecting a sparse set of control points. Instead of detecting the control points for all the n vertices in the initialized model V
                        0, we only detect for a subset C
                        0 ⊂ V
                        0 which contains m(≪ n) vertices. The detection result is denoted by Ce
                        . Fig. 3(b) demonstrates the detection procedure. To catch the control point of a certain vertex q ∈ C
                        0, the 2D detector searches along q’s normal direction in the 2D image for the position with highest probability to be the fascia lata.


                        Fig. 6
                         gives some detection results. The blue stars are the sparse set C
                        0, sampled from the initial model V
                        0. The red stars belong to the detected control point set Ce
                        . So there is a one-to-one correspondence between the points of the two sets. The narrow-band and sparse control points detection may cause limited search area, and thus the deformed surface may still have errors in capturing the whole fascia lata. A possible solution is to detect the control points and deform the current model iteratively.

In the proposed method, the fascia lata surface is represented by a meshless model V, which is a set of discretized nodes. V
                        0, as described above, is the initialized model. Let Ve
                         denote a meshless model inferred by Ce
                        . Starting from V
                        0, we compute the deformed model Vd
                        , which is driven by Ce
                         to best approximate Ve
                        . Meanwhile, during the deformation, C
                        0(⊂ V
                        0) is also transformed to Cd
                        (⊂ Vd
                        ), maintaining the same one-to-one correspondence to Ce
                        . We formulate the deformation as an energy minimization problem, and the total energy is defined as:

                           
                              (1)
                              
                                 
                                    
                                       E
                                       total
                                    
                                    =
                                    
                                       
                                          E
                                          prior
                                       
                                       
                                          (
                                          
                                             V
                                             d
                                          
                                          )
                                       
                                       +
                                       
                                          E
                                          data
                                       
                                       
                                          (
                                          
                                             
                                                V
                                                d
                                             
                                             ,
                                             
                                                V
                                                e
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        Here, the prior energy term E
                        prior aims to preserve the local shape structure in Vd
                         by using the Laplacian coordinate. The data energy term E
                        data is used to minimize the distance between the current model and the control model Ve
                        .

A vertex i ∈ Vd
                         is represented by the 3D homogeneous coordinate 
                           
                              
                                 v
                                 i
                              
                              =
                              
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ,
                                    
                                       y
                                       i
                                    
                                    ,
                                    
                                       z
                                       i
                                    
                                    ,
                                    1
                                    )
                                 
                                 T
                              
                           
                        . A control point k ∈ Ce
                         is represented by the 3D cartesian coordinate 
                           
                              
                                 v
                                 k
                                 e
                              
                              =
                              
                                 
                                    (
                                    
                                       x
                                       k
                                    
                                    ,
                                    
                                       y
                                       k
                                    
                                    ,
                                    
                                       z
                                       k
                                    
                                    )
                                 
                                 T
                              
                           
                        .

The proposed model deforms each meshless vertex i ∈ Vd
                            by a transformation matrix Ti
                            ∈ R
                           3 × 4. The Ti
                            is a special linear matrix defined in Yu et al. (2014). As formulated by Eq. (2), the matrix includes a scalar ai
                            for isotropic 3D scaling, a translation vector 
                              
                                 (
                                 
                                    p
                                    i
                                    x
                                 
                                 ,
                                 
                                    p
                                    i
                                    y
                                 
                                 ,
                                 
                                    p
                                    i
                                    z
                                 
                                 )
                                 ,
                              
                            and parameters 
                              
                                 (
                                 
                                    h
                                    i
                                    1
                                 
                                 ,
                                 
                                    h
                                    i
                                    2
                                 
                                 ,
                                 
                                    h
                                    i
                                    3
                                 
                                 )
                              
                            for linear approximation of rotations with small angles.

                              
                                 (2)
                                 
                                    
                                       
                                          T
                                          i
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         h
                                                         i
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                      i
                                                      2
                                                   
                                                
                                                
                                                   
                                                      p
                                                      i
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                      i
                                                      1
                                                   
                                                
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         h
                                                         i
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                      i
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         h
                                                         i
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                      i
                                                      3
                                                   
                                                
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                                
                                                   
                                                      p
                                                      i
                                                      z
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

In our meshless model, each vertex has a Laplacian representation defined by the distances to its neighbors. Since the transformation matrices (e.g., Ti
                            and Tj
                           ) of two neighbouring vertices (i and j) should be similar for a local shape-preserving deformation, we regularize the difference between the deformed neighbouring vertices. Thus, the energy function of the prior term is defined as

                              
                                 (3)
                                 
                                    
                                       
                                          E
                                          prior
                                       
                                       =
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   V
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   N
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   ∥
                                                
                                                
                                                   T
                                                   i
                                                
                                                
                                                   v
                                                   i
                                                
                                                −
                                                
                                                   T
                                                   j
                                                
                                                
                                                   v
                                                   j
                                                
                                                
                                                   
                                                      ∥
                                                   
                                                   2
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 N
                                 
                                    (
                                    i
                                    )
                                 
                                 ⊂
                                 
                                    V
                                    d
                                 
                              
                            is the neighboring node set of vertex i, with s closest nodes. As a result of minimizing the summation of the deforming difference, the energy term ensures the local similarity and thus preserve shape details.

With the detected control points Ce
                           , the proposed model can be robustly guided to the estimate location. To obtain more accurate fascia lata reconstruction, we define the energy function of the data term as

                              
                                 (4)
                                 
                                    
                                       
                                          E
                                          data
                                       
                                       =
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   C
                                                   e
                                                
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                T
                                                k
                                                m
                                             
                                             
                                                v
                                                k
                                                m
                                             
                                             −
                                             
                                                v
                                                k
                                                e
                                             
                                             
                                                
                                                   ∥
                                                
                                                2
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           Here, each control point k ∈ Ce
                            with 3D cartesian coordinate 
                              
                                 v
                                 k
                                 e
                              
                            has an one-to-one-matched vertex in Cd
                            with 3D homogeneous coordinate 
                              
                                 v
                                 k
                                 m
                              
                           . 
                              
                                 T
                                 k
                                 m
                              
                            is the transformation matrix of the vertex (in Vd
                           ) corresponding to control point k. The data term measures the distance from Ce
                            to Cd
                           . So by minimizing this term, the deformable model evolves to the detected fascia lata.

Combining the energy term (3) and (4), the total energy formulation of the deformable model is

                              
                                 (5)
                                 
                                    
                                       
                                          E
                                          total
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             
                                                V
                                                d
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                N
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   
                                                      T
                                                      i
                                                   
                                                   
                                                      v
                                                      i
                                                   
                                                   −
                                                   
                                                      T
                                                      j
                                                   
                                                   
                                                      v
                                                      j
                                                   
                                                
                                                ∥
                                             
                                             2
                                             2
                                          
                                       
                                       +
                                       α
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             
                                                C
                                                e
                                             
                                          
                                       
                                       
                                          
                                             ∥
                                             
                                                
                                                   T
                                                   k
                                                   m
                                                
                                                
                                                   v
                                                   k
                                                   m
                                                
                                                −
                                                
                                                   v
                                                   k
                                                   e
                                                
                                             
                                             ∥
                                          
                                          2
                                          2
                                       
                                    
                                 
                              
                           where scalar α balances the shape smoothness constraint and the control points’ attraction. Since all the vertices with the coordinates 
                              
                                 
                                    v
                                    k
                                    m
                                 
                                 ,
                                 k
                                 ∈
                                 
                                    C
                                    e
                                 
                                 ,
                              
                            are in Vd
                           , the unknown arguments to be solved are Ti, i ∈ Vd
                           .

However, the minimization of the function is not straightforward since the unknown Ti
                            is a matrix. Hence, we reformulate the prior term as:

                              
                                 (6)
                                 
                                    
                                       
                                          E
                                          prior
                                       
                                       =
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   V
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   N
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      
                                                         D
                                                         i
                                                      
                                                      
                                                         t
                                                         i
                                                      
                                                      −
                                                      
                                                         D
                                                         j
                                                      
                                                      
                                                         t
                                                         j
                                                      
                                                   
                                                   ∥
                                                
                                                2
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           Here, unknown matrix Ti
                            is reformulated as a vector 
                              
                                 
                                    t
                                    i
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          a
                                          i
                                       
                                       ,
                                       
                                          h
                                          i
                                          3
                                       
                                       ,
                                       
                                          h
                                          i
                                          2
                                       
                                       ,
                                       
                                          h
                                          i
                                          1
                                       
                                       ,
                                       
                                          p
                                          i
                                          x
                                       
                                       ,
                                       
                                          p
                                          i
                                          y
                                       
                                       ,
                                       
                                          p
                                          i
                                          z
                                       
                                       )
                                    
                                    T
                                 
                              
                           . And the vertex coordinate v
                           
                              i
                            is encoded as a matrix Di
                            ∈ R
                           3 × 7
                           
                              
                                 (7)
                                 
                                    
                                       
                                          v
                                          i
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                   i
                                                
                                                ,
                                                
                                                   y
                                                   i
                                                
                                                ,
                                                
                                                   z
                                                   i
                                                
                                                ,
                                                1
                                             
                                             )
                                          
                                          T
                                       
                                       ⇒
                                       
                                          D
                                          i
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                      i
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      z
                                                      i
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         y
                                                         i
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      i
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         z
                                                         i
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      i
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                      i
                                                   
                                                
                                                
                                                   
                                                      y
                                                      i
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         x
                                                         i
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Using these new notations, we can simplify the prior term to a linear system which is convenient to solve. First, let Ui
                            ∈ R
                           3s × 7n
                            be a unified matrix of s × n blocks. Each block is a 3 × 7 matrix. Ui
                            represents point i’s neighboring coordinate structure. In Ui
                           , each of the blocks on the ith column is Di
                           . Every block row has one distinct column 
                              
                                 j
                                 ∈
                                 N
                                 (
                                 i
                                 )
                              
                            filled by 
                              
                                 −
                                 
                                    D
                                    j
                                 
                              
                           . All the other blocks are zero matrices. Therefore, the sum of the neighboring displacements 
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       N
                                       (
                                       i
                                       )
                                    
                                 
                                 
                                    
                                       ∥
                                       
                                          
                                             D
                                             i
                                          
                                          
                                             t
                                             i
                                          
                                          −
                                          
                                             D
                                             j
                                          
                                          
                                             t
                                             j
                                          
                                       
                                       ∥
                                    
                                    2
                                    2
                                 
                              
                            can be rewritten as 
                              
                                 
                                    ∥
                                    
                                       
                                          U
                                          i
                                       
                                       t
                                    
                                    ∥
                                 
                                 2
                                 2
                              
                           .

                              
                                 (8)
                                 
                                    
                                       
                                          U
                                          i
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                
                                                   
                                                      i
                                                      th
                                                      
                                                      
                                                      column
                                                   
                                                
                                                
                                                   
                                                
                                                
                                                   
                                                      j
                                                      th
                                                      
                                                      
                                                      column
                                                   
                                                
                                                
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      D
                                                      i
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      −
                                                      
                                                         D
                                                         j
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Then, we concatenate all the unknown vectors t
                           
                              i
                            to form the vector 
                              
                                 t
                                 =
                                 
                                    
                                       (
                                       
                                          t
                                          1
                                          T
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          t
                                          n
                                          T
                                       
                                       )
                                    
                                    T
                                 
                                 ∈
                                 
                                    R
                                    
                                       7
                                       n
                                       ×
                                       1
                                    
                                 
                                 ,
                              
                            and all 
                              
                                 
                                    U
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 .
                                 .
                                 .
                                 ,
                                 n
                              
                            to form the matrix U. Thus, the prior term is finally formulated as

                              
                                 (9)
                                 
                                    
                                       
                                          E
                                          prior
                                       
                                       =
                                       
                                          
                                             ∥
                                             
                                                U
                                                t
                                             
                                             ∥
                                          
                                          2
                                          2
                                       
                                       ,
                                       
                                       where
                                       
                                       U
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      U
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      U
                                                      n
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          R
                                          
                                             3
                                             s
                                             n
                                             ×
                                             7
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        

Similarly, we can reformulate the data term as

                              
                                 (10)
                                 
                                    
                                       
                                          E
                                          data
                                       
                                       =
                                       
                                          
                                             ∥
                                             
                                                M
                                                t
                                                −
                                                
                                                   v
                                                   e
                                                
                                             
                                             ∥
                                          
                                          2
                                          2
                                       
                                    
                                 
                              
                           Here, the vector 
                              
                                 
                                    v
                                    e
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                v
                                                1
                                                e
                                             
                                             )
                                          
                                          T
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          
                                             (
                                             
                                                v
                                                m
                                                e
                                             
                                             )
                                          
                                          T
                                       
                                       )
                                    
                                    T
                                 
                                 ∈
                                 
                                    R
                                    
                                       3
                                       m
                                       ×
                                       1
                                    
                                 
                              
                            contains all the 3D cartesian coordinates of the control points. The sparse matrix M ∈ R
                           3m × 7n
                            has m × n blocks; each of them is a 3 × 7 matrix. Assuming l ∈ 1, ..., n is the vertex index in Vd
                           , and vertex l has one-to-one correspondence to the kth control point in Ce
                            (
                              
                                 k
                                 =
                                 
                                    1
                                    ,
                                    .
                                    .
                                    .
                                    ,
                                    m
                                 
                              
                           ). We set the submatrix at the kth row and the lth column as the coordinate matrix of l ∈ Vd
                           .

                              
                                 (11)
                                 
                                    
                                       M
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                
                                                   
                                                
                                                
                                                   
                                                      l
                                                      th
                                                      
                                                      
                                                      column
                                                   
                                                
                                                
                                                   
                                                
                                                
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      k
                                                      th
                                                      
                                                      row
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      D
                                                      l
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                             
                                             
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Combining the energy terms (9) and (10), the deformable model is solved by minimizing the total energy (Eq. (5)) as

                              
                                 (12)
                                 
                                    
                                       arg
                                       
                                          min
                                          t
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   ∥
                                                   
                                                      U
                                                      t
                                                   
                                                   ∥
                                                
                                                2
                                                2
                                             
                                             +
                                             α
                                             
                                                
                                                   ∥
                                                   
                                                      M
                                                      t
                                                      −
                                                      
                                                         v
                                                         e
                                                      
                                                   
                                                   ∥
                                                
                                                2
                                                2
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

Since the detection result of fascia lata control points may contain both sparse gross errors and Gaussian noises, the ℓ2 norm in the data term can cause the deformed model to overfit the gross outliers. On the other hand, if we employ a ℓ1 norm in the data term as sparsity constraint to alleviate the outliers (as formulated in Eq. (13)), it cannot handle the Gaussian noises:

                              
                                 (13)
                                 
                                    
                                       arg
                                       
                                          min
                                          t
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   ∥
                                                   
                                                      U
                                                      t
                                                   
                                                   ∥
                                                
                                                2
                                                2
                                             
                                             +
                                             α
                                             
                                                
                                                   ∥
                                                   
                                                      M
                                                      t
                                                      −
                                                      
                                                         v
                                                         e
                                                      
                                                   
                                                   ∥
                                                
                                                1
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

Based on the sparse representation in Yu et al. (2014) and Zhang et al. (2011), we utilize both ℓ1 and ℓ2 norms to efficiently reconstruct the fascia lata by

                              
                                 (14)
                                 
                                    
                                       arg
                                       
                                          min
                                          
                                             t
                                             ,
                                             e
                                          
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   ∥
                                                   
                                                      U
                                                      t
                                                   
                                                   ∥
                                                
                                                2
                                                2
                                             
                                             +
                                             α
                                             
                                                (
                                                
                                                   
                                                      
                                                         ∥
                                                         
                                                            M
                                                            t
                                                            −
                                                            
                                                               v
                                                               e
                                                            
                                                            −
                                                            e
                                                         
                                                         ∥
                                                      
                                                      2
                                                      2
                                                   
                                                   +
                                                   β
                                                   
                                                      
                                                         ∥
                                                         e
                                                         ∥
                                                      
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           where e is a vector representing the detection gross errors, and β is a weighting parameter to control the sparsity of e.

To summarize, the fascia lata reconstruction through the model deformation is described in Algorithm 1
                           
                           .

@&#EXPERIMENTS@&#

In this section, we start by describing the dataset and different methods compared in the experiments, as well as the evaluation strategies. Then the experimental results are presented, including their visualization, quantitative and statistical accuracy comparisons. At last, we discuss about some issues and limitations observed in the experiments.

A dataset of mid-thigh MR volumetric scans for 40 subjects, aged from 49 to 77, is used for evaluation. This dataset is selected from the public Osteoarthritis Initiative (OAI) database. In the dataset, all the MR scans are axial T1-weighted. Images have 0.98 mm in-plane resolution and 5.0 mm between-slice resolution. The in-plane sizes range from 130 × 127 to 235 × 237, and the slice numbers are all 15. Due to strong imaging bias on most right legs in the dataset, we only extract and process the left legs.

We compare the proposed method with our implementation of a state-of-the-art approach (Tan et al., 2014) (we name it as MDM). This compared approach segments the SAT and extracts the IMAT by a modified parametric deformable model. It integrates a region-of-interest-based balloon term described in the Metamorphs model (Huang and Metaxas, 2008). We also evaluate different regularizations using only the ℓ2 or ℓ1 norms (Eq. (12) and Eq. (13)) and compare with the proposed optimization. All the approaches were implemented in Matlab and C++, tested on a computer with 4.0 GHz Intel Core i7 4790K and 32Gb RAM and 4G-RAM GPU.

The training set for the 2D fascia lata detector consists of 90 2D thigh images with ground truth labeled by experts. These images were extracted from 30 volumetric scans. For each volumetric scan, we selected 3 cross-sectional slices from the top, middle, and bottom of the middle thigh, respectively. One slice and its ground truth are shown in Fig. 1(c) and (d). We set parameters 
                           
                              f
                              =
                              4
                           
                         and 
                           
                              b
                              =
                              3
                           
                         for the negative points collection. The random forest has 500 trees. The number of predictors sampled for spliting at each tree node is square root of the feature number. The rest 10 labeled volumes are used for testing. For evaluation, we fill the inside area of fascia lata, report the mean and standard deviation of dice similarity coefficients (DSC) and relative errors (RE) compared to the ground truth in the testing set.

                           
                              (15)
                              
                                 
                                    DSC
                                    =
                                    
                                       
                                          2
                                          T
                                          P
                                       
                                       
                                          2
                                          T
                                          P
                                          +
                                          F
                                          P
                                          +
                                          F
                                          N
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    RE
                                    =
                                    
                                       
                                          F
                                          P
                                          +
                                          F
                                          N
                                       
                                       
                                          T
                                          P
                                          +
                                          F
                                          N
                                       
                                    
                                 
                              
                           
                        where TP, TN, FP and FN are the number of tissue voxels correctly identified, correctly rejected, incorrectly identified, and incorrectly rejected respectively.

Besides, the distance errors between the reconstructed surface and the ground truth surface are reported. The symmetrical surface distance error is computed the same way as in Yan et al. (2014).

@&#EXPERIMENTAL RESULTS@&#


                        Fig. 7 shows some results of subject 1 (female, 63 years old). The MDM is unsupervised. It dynamically estimates tissue’s intensity probability map to generate a region based force. This force can enhance external force and facilitate the model convergence. When the MDM runs on the regions without loose fascia lata, it can obtain a strong region force and work well because the fascia lata is located at muscle’s edges. However, in the red circled region of Fig. 7(a), the fascia lata is loose from the muscle boundary. In this case, the loose fascia lata is excluded from the probability map, so the MDM can not obtain an effective region force to capture the whole fascia lata contour. Moreover, segmentation using insufficient meshes may make the MDM capture imprecise boundaries of muscles. Thus, the MDM has under-segmentation issue (yellow contour in Fig. 7(c)). On the other hand, although the testing case has the loose symptom, our method can detect most of the control points on the fascia lata (Fig. 7(b)), which provides accurate cues for the driving forces. Furthermore, because of the sparsity constraints, outliers do not have much negative impacts on the model deformation.

In Fig. 8
                        , another subject’s results (female, 68 years old) are shown. In this case, subject has no obvious pathological changes on fascia lata; most parts are close to the muscle boundaries. However, we still observe two issues of MDM. In the green circled region (Fig. 8(c)), there is a vein (spot noise). It has similar pixel intensity as muscle and is close to muscle regions. The MDM includes this spot into the probability map, generating a strong region force pointing to that point. Thus, it (the yellow contour) has over-segmentation issue. The second one is shown in the blue circled region (Fig. 8(c)), where the MDM has under-segmentation issue because of the loose fascia lata. Our detection-driven model, on the other hand, produce the (red) contour accurately. The sparsity constraints fix the noise in detection caused by the vein. The red circled region in Fig. 8 indicates a place where our method is a litter worse. It is because the detected control points in this region are trapped in a local minimum.


                        Fig. 9
                         shows some reconstruction results by the models with different regularization norms. The model with the ℓ2 norm is adversely impacted by the outliers in the detection. The ℓ1 norm produces better result than ℓ2, but still has errors at the bottom. The proposed model in Fig. 9(d) gets the best fascia lata contour here.


                        Fig. 10
                         shows visual comparisons in 3D view. The fascia lata surface distance errors are plotted for three subjects (in three columns). Fig. 10(a)–(c) show the surface distances between ground truth and the model initialization. Then each row shows the error maps from one different approach. Results by our proposed method are shown in the last row (Fig. 10(m)–(o)), which demonstrate the least errors.

Quantitative comparisons are shown in Table 1
                        . We report dice scores and errors for the model initialization (Initial), the MDM, the BRS (Blurred rough surface, which is obtained by blurring the detected fascia lata surface with a 3D box filtering), the ℓ2- and ℓ1-based methods, and the proposed approach. For the distance errors, we first calculate the closest distance to the GT at each point on the resulting surfaces, and then compute the means and the standard deviations. The time to process one volume is within 15 minutes.

@&#DISCUSSION@&#

In this part, we discuss the parameter selection, time and memory consumption, and limitations of our method.

                           
                              1)
                              All the parameters in our model, including initialization, fascia lata detection, and sparsity-constrained deformation, are tuned experimentally for one case and applied to all the testing samples. The above comparison results indicate that our proposed approach has better robustness.

In the offline training step, most of the time is spent on the learning of the 2D fascia lata detector. That consumes about 16 hours on the 90 training images. The memory cost in training the detector depends on the size of training set. For the online fascia lata labeling, the major time cost is on the minimization of the energy function equation (14) for model deformation. The memory cost depends on the number of vertexes in the meshless model. In our experiments, the training and testing stages consume up to 6GB and 5GB memories, respectively.

From our observations, the main segmentation errors from the proposed approach are due to the inaccurate control points from the fascia lata detection. The reasons causing these fallacious detections come from the blurred boundaries in some low-quality areas or the heavy bias noise existing in the testing MR images. When the detection is carried out, if the ambiguous or weak fascia lata boundary were large or the area were highly degraded by bias noise, many false control points would exist in the local area, the sparsity constraints could fail and the final segmentation could hardly catch the correct boundary. This is the main limitation of the proposed framework. In future, this could be improved by constructing a more accurate detection framework to search the control points on fascia lata. A potential candidate could be deep learning based shape prior modeling (Chen et al., 2013; Zhang et al., 2014).

@&#CONCLUSIONS@&#

Quantitative assessment of the thigh IMAT is essential in medical and clinical analyses. The quantity of IMAT is an important measure in studying metabolic risks, muscle strengths, and mobility functions. It is also highly associated with the knee OA. However, several recent approaches for the thigh tissue extraction are limited when pathological changes are observed. In these situations, the fascia lata may not be close to muscle regions. Factors including imaging artifacts, ambiguous image cues and high-variance shapes of fascia lata, make the fascia lata labeling an even more challenging problem.

In this paper, we propose a novel deformable model to reconstruct fascia lata surface robustly. It can improve the accuracy of the thigh IMAT quantification. Specifically, this approach utilizes a meshless deformable model based on the Laplacian coordinate. It initializes the model by segmenting the general muscular region via unsupervised clustering and shape refinement. A 2D fascia lata detector is learned and used to obtain control points on the fascia lata contour. Then the control points are integrated into the deformable model to provide a reliable force to drive the evolution. Furthermore, sparsity constraints are involved in the model deformation to suppress detection outliers. We extensively validated this method in a clinical dataset of volumetric mid-thigh scans. Compared to a state-of-the-art thigh tissue classification method and different optimizations using only ℓ2 or ℓ1 norms, the results show that our approach is more robust and accurate. Therefore, our detection-driven and sparsity-constrained deformable model for efficient fascia lata labeling can be easily applied to the assessment of the thigh tissues in clinical studies.

@&#ACKNOWLEDGEMENTS@&#

This work was supported in part by the New Jersey Healthcare Foundation, and NSF (CNS 
                  1229628, CMMI 1334389, IIS 1451292, and IIS 1555408).

@&#REFERENCES@&#

