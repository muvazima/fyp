@&#MAIN-TITLE@&#A consensus approach for estimating the predictive accuracy of dynamic models in biology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a method for quantifying the quality of predictions in dynamic models.


                        
                        
                           
                           The approach helps in deciding which additional measurements are more useful.


                        
                        
                           
                           Meta-parameters are used for accelerating parameter estimation and reducing the risk of over-fitting.


                        
                        
                           
                           An ensemble of models is built, and consensus among their predictions is used as an indication of reliability.


                        
                        
                           
                           The method is demonstrated on a metabolic model of Chinese Hamster Ovary cells (CHO).


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Systems biology

Metabolic engineering

Cell line engineering

Dynamic modelling

Ensemble modelling

Consensus

@&#ABSTRACT@&#


               
               
                  Mathematical models that predict the complex dynamic behaviour of cellular networks are fundamental in systems biology, and provide an important basis for biomedical and biotechnological applications. However, obtaining reliable predictions from large-scale dynamic models is commonly a challenging task due to lack of identifiability. The present work addresses this challenge by presenting a methodology for obtaining high-confidence predictions from dynamic models using time-series data. First, to preserve the complex behaviour of the network while reducing the number of estimated parameters, model parameters are combined in sets of meta-parameters, which are obtained from correlations between biochemical reaction rates and between concentrations of the chemical species. Next, an ensemble of models with different parameterizations is constructed and calibrated. Finally, the ensemble is used for assessing the reliability of model predictions by defining a measure of convergence of model outputs (consensus) that is used as an indicator of confidence. We report results of computational tests carried out on a metabolic model of Chinese Hamster Ovary (CHO) cells, which are used for recombinant protein production. Using noisy simulated data, we find that the aggregated ensemble predictions are on average more accurate than the predictions of individual ensemble models. Furthermore, ensemble predictions with high consensus are statistically more accurate than ensemble predictions with large variance. The procedure provides quantitative estimates of the confidence in model predictions and enables the analysis of sufficiently complex networks as required for practical applications.
               
            

@&#INTRODUCTION@&#

Mathematical modelling is a fundamental task in systems and computational biology [1], with important applications in biomedicine [2–5]. Among other features, models allow monitoring the state of unmeasured variables and making predictions about system behaviour for a larger number and broader variety of conditions than can be efficiently tested in experiments [6]. The construction and calibration of models of large, complex dynamic systems is a particularly challenging task. Uncertainties appear at different stages of the process, limiting the confidence in the resulting predictions [7,8]. Shortage of experimental data can easily lead to poor identifiability. As an example, consider a well-known result from nonlinear systems theory which states that, to identify a model described by differential equations containing r parameters, 2r
                     +1 experimental measures may be enough [9]. This result assumes exact, noise-free measurements; however, in practice there will always be errors in the data, hence the 2r
                     +1 figure represents a lower bound. When the number of parameters is larger than what can be actually determined from data, the calibration procedure can sometimes—when allowed by the model structure—yield a perfect fit between model predictions and measurements. However, there is a danger of overfitting in this situation, i.e., the model is being trained to fit in detail the noise contained in the data instead of actually learning the system dynamics. This problem entails the risk that model predictions will be wrong for altered experimental conditions.

The problem of dealing with uncertainty in cellular network modelling was reviewed in [10]. In that review, the use of ensembles—sets of models with different structures and/or parameter values—was considered as a powerful and generally applicable approach for reducing prediction errors. However, it was also acknowledged that the concept has not sufficiently matured yet. Indeed, ensemble modelling approaches have been recently applied to a variety of problems, ranging from climate prediction [11] to impact of vaccines [12]. An early example of the use of an ensemble approach in biological models was presented in [13], which was limited to ensembles of topologies of Boolean networks. Tran et al. [14] extended the approach to the dynamic case, building an ensemble of metabolic models that reached the same steady state and applying it to the central carbon metabolism of Escherichia coli. A related application was presented in [15]. For a review of metabolic ensemble modelling see [16].

The use of the consensus as an indication of the reliability of the predictions was explored by Bever [17], who computed time-dependent probability distributions of protein concentrations in artificial gene regulatory networks and introduced the concept of consensus sensitivity, finding that consensus among ensemble models was a good indicator of high-confidence predictions. Recently, further steps were taken with the introduction of the concept of “core prediction”: a property that must be fulfilled if the model structure is to explain the data, even if the individual parameters are not accurately identified [18].

The present paper deals with the problem of evaluating and, if possible, increasing the confidence in the predictions made by kinetic metabolic models. It is assumed that the model structure—the topology of the metabolic network—is known. Actually, this assumption is not a requirement of the proposed methodology, which may be applied to ensembles of models with different topologies. However, in the present work the uncertainty in the predictions is due only to uncertainty in the parameter values. To overcome uncertainty, an ensemble of models with different parameterizations is built. As a preceding step to improve identifiability and to reduce overfitting, the initial model parameters are grouped into modules of meta-parameters, which are used during calibration. Then a measure of consensus among model outcomes is introduced, which is used to quantify the confidence in the predicted metabolite concentrations. A schematic depiction of the methodology is shown in Fig. 1
                     .

We note that, while a consensus approach was proposed in [17], it used different measures than the ones we introduce here, and it was applied to toy models consisting of 3 or 4 genes. The present methodology includes entirely new features such as the use of meta-parameters, and it is tested on a medium-size network including 34 metabolites. We also remark that, unlike the approach presented in [18], we do not intend to characterize the model's core predictions, but instead to give estimates of the confidence in the predictions. Finally, we note that a preliminary version of this work [19] was presented at the PACBB’14 conference. This new version has been extensively rewritten, including new figures and results, which have been calculated with a new dissensus measure that enables a more sensitive discrimination of larger and smaller prediction errors.

@&#METHODS@&#

The methodology aims at adapting the kinetics of interrelated reaction pathways. Highly correlated trajectories of simulated concentrations and reaction rates point at functional dynamic relations, which can be adjusted by the parameters that correspond to the correlated time courses of concentrations and fluxes. We will refer to these sets of parameters as meta-parameters and use them for improving identifiability and reducing the risk of overfitting.

Let us consider an ordinary differential equation (ODE) model with rate kinetics which follow the description in [20], where a rate of an enzyme i is defined by
                           
                              (1)
                              
                                 
                                    
                                       r
                                       i
                                    
                                    =
                                    
                                       r
                                       i
                                       
                                          
                                             max
                                          
                                       
                                    
                                    ⋅
                                    
                                       f
                                       i
                                    
                                    (
                                    
                                       c
                                       j
                                    
                                    ,
                                    
                                       p
                                       i
                                       j
                                    
                                    )
                                    =
                                    
                                       r
                                       i
                                       
                                          
                                             max
                                          
                                       
                                    
                                    ⋅
                                    
                                       
                                          1
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                                p
                                                a
                                                r
                                                s
                                             
                                          
                                          
                                             
                                                p
                                                i
                                                j
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                            j
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with r
                        
                           i
                         being a product of the maximal rate (
                           
                              
                                 r
                                 i
                                 
                                    
                                       max
                                    
                                 
                              
                           
                        ) and a kinetic rate expression (f
                        
                           i
                        ) which is a function of the metabolite concentrations (c
                        
                           j
                        ) and the parameters (
                           
                              
                                 p
                                 i
                                 j
                              
                           
                        ) that quantify the contribution of metabolite j in the rate i. The function f
                        
                           i
                         is following here linlog kinetics [21], but it can be any generic kinetic rate equation where parameters 
                           
                              
                                 p
                                 i
                                 j
                              
                           
                         are associated to specific metabolite concentrations c
                        
                           j
                        , such as K
                        
                           M
                         values in Michaelis–Menten type kinetic equations.

The model is simulated with a set of initial parameter values 
                           
                              
                                 p
                                 i
                                 
                                    j
                                     
                                    0
                                 
                              
                              =
                              (
                              
                                 p
                                 i
                                 
                                    1
                                     
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 p
                                 i
                                 
                                    n
                                    p
                                    a
                                    r
                                    s
                                     
                                    0
                                 
                              
                              )
                           
                        , obtaining time courses of concentrations and rates. The Pearson Correlation Coefficients (PCC) are then calculated between simulated concentration time courses for all balanced species c
                        
                           j
                        , as well as between all simulated rates r
                        
                           i
                        . This yields two correlation arrays, C
                        
                           r
                         and C
                        
                           c
                        :
                           
                              (2)
                              
                                 
                                    
                                       C
                                       r
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            r
                                                            1
                                                            ,
                                                            r
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            r
                                                            1
                                                            ,
                                                            r
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            r
                                                            m
                                                            ,
                                                            r
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            r
                                                            m
                                                            ,
                                                            r
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                     
                                    
                                       C
                                       c
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            c
                                                            1
                                                            ,
                                                            c
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            c
                                                            1
                                                            ,
                                                            c
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            c
                                                            n
                                                            ,
                                                            c
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      P
                                                      C
                                                      
                                                         C
                                                         
                                                            c
                                                            n
                                                            ,
                                                            c
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Meta-parameters are defined by pairing metabolites and reactions. First, a set of metabolites is selected, c
                        
                           j sel
                        , which is of particular interest, e.g. because their time courses have been measured. Each metabolite of interest is paired with the reaction rate with the highest contribution to the metabolite balance, r
                        
                           i
                           
                           sel
                        . In most cases the flux with the highest contribution corresponds to the formation rate of the metabolite. Rates which are highly correlated (PCC>0.8) with the selected rate r
                        
                           i
                           
                           sel
                         are then included in a vector r
                        
                           i
                           
                           corr
                        . Similarly, the metabolites which are present in the kinetic equations of the correlating rates (r
                        
                           i corr
                        ) and which are highly correlated with c
                        
                           j sel
                         are included in a vector, 
                           
                              
                                 c
                                 
                                    j
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    i
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                        . Thus for each concentration-rate pair (c
                        
                           j sel
                        , r
                        
                           i sel
                        ), two vectors 
                           
                              
                                 c
                                 
                                    j
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    i
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                         and r
                        
                           i
                           
                           corr
                         are obtained.

A meta-parameter vector MP
                        
                           i sel,j sel
                         consists of all the parameters 
                           
                              
                                 p
                                 
                                    i
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    j
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                         which are related to the metabolite concentrations 
                           
                              
                                 c
                                 
                                    i
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    j
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                         in the correlating rates r
                        
                           i
                           
                           corr
                        . Each meta-parameter vector MP
                        
                           i sel,j sel
                         is split into two vectors, one for substrate parameters 
                           
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                 
                              
                           
                         and one for product parameters 
                           
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                     
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    p
                                    r
                                    o
                                    d
                                 
                              
                           
                        :
                           
                              (3)
                              
                                 
                                    M
                                    
                                       P
                                       
                                          i
                                           
                                          s
                                          e
                                          l
                                          ,
                                          j
                                           
                                          s
                                          e
                                          l
                                       
                                       
                                          p
                                          r
                                          o
                                          d
                                       
                                    
                                    =
                                    (
                                    
                                       p
                                       
                                          i
                                           
                                          c
                                          o
                                          r
                                          r
                                       
                                       
                                          j
                                           
                                          p
                                          r
                                          o
                                          d
                                           
                                          c
                                          o
                                          r
                                          r
                                       
                                    
                                    )
                                    ,
                                     
                                    M
                                    
                                       P
                                       
                                          i
                                           
                                          s
                                          e
                                          l
                                          ,
                                          j
                                           
                                          s
                                          e
                                          l
                                       
                                       
                                          s
                                          u
                                          b
                                          s
                                       
                                    
                                    =
                                    (
                                    
                                       p
                                       
                                          i
                                           
                                          c
                                          o
                                          r
                                          r
                                       
                                       
                                          j
                                           
                                          s
                                          u
                                          b
                                          s
                                           
                                          c
                                          o
                                          r
                                          r
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

If identical meta-parameters are identified from correlation analysis, just one parameter vector is kept to avoid co-linearity.

For each meta-parameter, an optimization parameter k
                        
                           i sel,j sel
                         is defined, which multiplies every parameter in the set. This reduces the size of the optimization problem: instead of estimating all the parameters 
                           
                              
                                 p
                                 
                                    i
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    j
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                         included in a meta-parameter separately, they are kept at their nominal values and only the k
                        
                           i sel,j sel
                         need to be estimated, that is, 
                           
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    p
                                    r
                                    o
                                    d
                                     
                                    o
                                    p
                                    t
                                    i
                                    m
                                    a
                                    l
                                 
                              
                              =
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    p
                                    r
                                    o
                                    d
                                     
                                    n
                                    o
                                    
                                       min
                                    
                                    a
                                    l
                                 
                              
                              ×
                              
                                 k
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    p
                                    r
                                    o
                                    d
                                     
                                    o
                                    p
                                    t
                                    i
                                    m
                                    a
                                    l
                                 
                              
                           
                         for product parameters, and 
                           
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                     
                                    o
                                    p
                                    t
                                    i
                                    m
                                    a
                                    l
                                 
                              
                              =
                              M
                              
                                 P
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                     
                                    n
                                    o
                                    min
                                    a
                                    l
                                 
                              
                              ×
                              
                                 k
                                 
                                    i
                                     
                                    s
                                    e
                                    l
                                    ,
                                    j
                                     
                                    s
                                    e
                                    l
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                     
                                    o
                                    p
                                    t
                                    i
                                    m
                                    a
                                    l
                                 
                              
                           
                         for substrate parameters.

Multiple meta-parameters can be grouped into modules. A module is a set of meta-parameters that is designed to manipulate the dynamics of one phenotypic property. With a different choice of metabolites of interest, different meta-parameter sets for the same model structure are obtained. Thus, the property of interest determines the choice of meta-parameters.

In the present work the meta-parameter sets have been determined using the modelling and simulation software Insilico Discovery™ (Insilico Biotechnology AG, Stuttgart, Germany). The routine has a low computational cost: for the model under examination, calculations were carried out in less than three minutes.

For better understanding, in the remaining of this subsection we explain the generation and grouping of a meta-parameter for a particular example. Let us assume that we want to obtain a module of meta-parameters related to the energy metabolism, in which we know that e.g. glucose plays a key role. We therefore choose glucose (C
                        
                           glc
                        ) as c
                        
                           j sel
                        . The glucose uptake rate (r
                        
                           glc uptake
                        ) has the highest contribution to the node balance, and it is therefore chosen as r
                        
                           i sel
                        . Then, we generate the concentration and rate correlation arrays by calculating the Pearson Correlation Coefficients from simulated concentration and rate time curves. We obtain the vector r
                        
                           glc uptake corr
                         for rates which correlate strongly (i.e., PCC>0.8) with r
                        
                           glc uptake
                        . Concentrations which are (i) included in the kinetic expressions of the rates in r
                        
                           glc uptake corr
                         and (ii) correlate strongly with c
                        
                           glc
                        , are included in the vector c
                        
                           glc corr
                        . One of the rates in the rate vector r
                        
                           glc uptake corr
                         is the aspartate–glutamate carrier reaction (r
                        
                           agc
                        ). The kinetic equation for this reaction is shown in equation (4) below. The kinetic rate expression (r
                        
                           agc
                        ) includes the concentrations of four metabolites: two substrates, cytosolic glutamate (
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                        ) and mitochondrial aspartate (
                           
                              
                                 c
                                 
                                    a
                                    s
                                    
                                       p
                                       m
                                    
                                 
                              
                           
                        ), and two products, mitochondrial glutamate (
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       m
                                    
                                 
                              
                           
                        ) and cytosolic aspartate (
                           
                              
                                 c
                                 
                                    a
                                    s
                                    
                                       p
                                       c
                                    
                                 
                              
                           
                        ):
                           
                              (4)
                              
                                 
                                    
                                       r
                                       
                                          a
                                          g
                                          c
                                       
                                    
                                    =
                                    
                                       r
                                       
                                          a
                                          g
                                          c
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    
                                       
                                          1
                                          +
                                          
                                             p
                                             
                                                a
                                                g
                                                c
                                             
                                             
                                                s
                                                u
                                                b
                                                s
                                                g
                                                l
                                                
                                                   u
                                                   c
                                                
                                             
                                          
                                           
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            g
                                                            l
                                                            
                                                               u
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            g
                                                            l
                                                            
                                                               u
                                                               c
                                                            
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             p
                                             
                                                a
                                                g
                                                c
                                             
                                             
                                                s
                                                u
                                                b
                                                s
                                                 
                                                a
                                                s
                                                
                                                   p
                                                   m
                                                
                                             
                                          
                                           
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               m
                                                            
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             p
                                             
                                                a
                                                g
                                                c
                                             
                                             
                                                p
                                                r
                                                o
                                                d
                                                 
                                                g
                                                l
                                                
                                                   u
                                                   m
                                                
                                             
                                          
                                           
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            g
                                                            l
                                                            
                                                               u
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            g
                                                            
                                                               c
                                                               m
                                                            
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             p
                                             
                                                a
                                                g
                                                c
                                             
                                             
                                                p
                                                r
                                                o
                                                d
                                                 
                                                a
                                                s
                                                
                                                   p
                                                   c
                                                
                                             
                                          
                                           
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               c
                                                            
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From the four metabolites present in the equation, we find one (cytosolic glutamate) whose concentration time course, 
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                        , is strongly correlated with the time course of the glucose concentration, c
                        
                           glc
                        ; hence we include 
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                         in the vector 
                           
                              
                                 c
                                 
                                    g
                                    l
                                    c
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                                 
                                    g
                                    l
                                    c
                                     
                                    u
                                    p
                                    t
                                    a
                                    k
                                    e
                                     
                                    c
                                    o
                                    r
                                    r
                                 
                              
                           
                        . The parameter corresponding to both r
                        
                           agc
                         and 
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                         is 
                           
                              
                                 p
                                 
                                    a
                                    g
                                    c
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                     
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                        , which is therefore included in the meta-parameter vector 
                           
                              M
                              
                                 P
                                 
                                    g
                                    l
                                    u
                                     
                                    u
                                    p
                                    t
                                    a
                                    k
                                    e
                                    ,
                                     
                                    g
                                    l
                                    c
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                 
                              
                           
                         (since cytosolic glutamate is a substrate in the reaction of the aspartate–glutamate carrier). By repeating this procedure for all the rates present in the vector r
                        
                           glc uptake corr
                        , we obtain the meta-parameters 
                           
                              M
                              
                                 P
                                 
                                    g
                                    l
                                    u
                                     
                                    u
                                    p
                                    t
                                    a
                                    k
                                    e
                                    ,
                                     
                                    g
                                    l
                                    c
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                 
                              
                           
                         and 
                           
                              M
                              
                                 P
                                 
                                    g
                                    l
                                    u
                                     
                                    u
                                    p
                                    t
                                    a
                                    k
                                    e
                                    ,
                                     
                                    g
                                    l
                                    c
                                 
                                 
                                    p
                                    r
                                    o
                                    d
                                 
                              
                           
                        . The set of parameters included in those meta-parameters, together with the parameters in other concentration—rate pairs (e.g. 
                           
                              
                                 c
                                 
                                    A
                                    T
                                    
                                       P
                                       c
                                    
                                 
                              
                              −
                              
                                 r
                                 
                                    a
                                    t
                                    p
                                    a
                                    s
                                    e
                                 
                              
                           
                        ) that are key metabolites for the energy metabolism, form the module “energy metabolism”.

As already mentioned, the procedure is not only valid for linlog kinetics, but also for any generic kinetic rate equation. To demonstrate the validity for an alternative rate equation, we reformulate Eq. (4) using irreversible Michaelis–Menten kinetics. Using the notation 
                           
                              
                                 K
                                 M
                              
                              =
                              
                                 p
                                 i
                                 j
                              
                           
                         for the Michaelis–Menten constant, we have the following expression:
                           
                              (5)
                              
                                 
                                    
                                       r
                                       
                                          a
                                          g
                                          c
                                       
                                    
                                    =
                                    
                                       r
                                       
                                          a
                                          g
                                          c
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            a
                                                            s
                                                            
                                                               p
                                                               m
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         p
                                                         
                                                            a
                                                            g
                                                            c
                                                         
                                                         
                                                            s
                                                            u
                                                            b
                                                            s
                                                             
                                                            a
                                                            s
                                                            
                                                               p
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            g
                                                            l
                                                            
                                                               u
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         
                                                            g
                                                            l
                                                            u
                                                            c
                                                         
                                                      
                                                      +
                                                      
                                                         p
                                                         
                                                            a
                                                            g
                                                            c
                                                         
                                                         
                                                            s
                                                            u
                                                            b
                                                            s
                                                             
                                                            g
                                                            l
                                                            
                                                               u
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Following the same reasoning as before, since the concentration 
                           
                              
                                 c
                                 
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                         is highly correlated with the concentration of our metabolite of interest, c
                        
                           glc
                        , the corresponding parameter 
                           
                              
                                 p
                                 
                                    a
                                    g
                                    c
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                     
                                    g
                                    l
                                    
                                       u
                                       c
                                    
                                 
                              
                           
                         is included in the meta-parameter 
                           
                              M
                              
                                 P
                                 
                                    g
                                    l
                                    c
                                     
                                    u
                                    p
                                    t
                                    a
                                    k
                                    e
                                    ,
                                     
                                    g
                                    l
                                    u
                                 
                                 
                                    s
                                    u
                                    b
                                    s
                                 
                              
                           
                        . This is equivalent to the linlog case.

The parameter values are estimated by calibrating the models in the ensemble with the enhanced scatter search parameter estimation method [22]. It is a state-of-the-art metaheuristic that has shown competitive performance with large-scale multimodal problems [23]. A parallel version of the method is available [24]; however, the computational effort associated with the optimization problem tackled in the present work is not as demanding as to require parallel techniques. Hence we decided to apply the sequential version of the method that is included in the AMIGO toolbox [25]. Recent applications of parallel optimization metaheuristics in bioinformatics can be found e.g. in [26].

The enhanced scatter search metaheuristic (eSS) can be regarded as a hybrid technique which combines global and local search, the latter in order to accelerate convergence to nearby optima. In this application, the local method chosen is the Matlab routine fmincon, available in the Optimization Toolbox.

When there is lack of identifiability, different sets of parameter values can fit the data equally well. Because eSS is a stochastic technique, several optimization runs with different random initializations result in different solutions, each of which is a member of the ensemble. Models in the ensemble share the same structure but have different parameterizations. Each meta-parameter set leads to a model with a different parameter set for optimization purposes. In turn, each of these models can give rise to several models by changing the parameter values. The resulting ensemble includes (i) models calibrated with the meta-parameter approach and (ii) models that were calibrated with the original parameter set.

After creating an ensemble of models with different meta-parameter set and/or different parameter values, it is used for estimating the reliability of the predictions. The behaviour of each model in a different experimental condition is simulated. Convergence of the model outputs (consensus) is then taken as an indicator of the confidence in the prediction (see Section 3 for justification).

Let us introduce the following notation: let n
                        
                           p
                         be the number of data points (that is, of time instants corresponding to the measurements), n
                        
                           m
                         the number of models in the ensemble, and n
                        
                           s
                         the number of dynamic states (concentrations) for which a prediction is made. The prediction of the dynamic state j at time i made by model k is A
                        
                           ijk
                        . The average prediction of all the models for every state and time instant is the n
                        
                           p
                        
                        ×
                        n
                        
                           s
                         array:
                           
                              (6)
                              
                                 
                                    
                                       
                                          A
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             n
                                             m
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             n
                                             m
                                          
                                       
                                    
                                    
                                       
                                          A
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The dissensus d
                        
                           ijk
                         of every model k with respect to the average prediction for a concentration j at every time instant i can be encapsulated as a n
                        
                           p
                        
                        ×
                        n
                        
                           s
                        
                        ×
                        n
                        
                           m
                         array,
                           
                              (7)
                              
                                 
                                    
                                       d
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   A
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      A
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          
                                             max
                                             k
                                          
                                          (
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          )
                                          −
                                          
                                             min
                                             k
                                          
                                          (
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The mean dissensus of every model for every state along the time horizon is
                           
                              (8)
                              
                                 
                                    
                                       d
                                       
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             n
                                             p
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                n
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

And the ensemble dissensus is the mean dissensus among all the models for a particular state along the time horizon,
                           
                              (9)
                              
                                 
                                    
                                       d
                                       j
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                
                                                   n
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                d
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             n
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From which we define the ensemble consensus for each state as:
                           
                              (10)
                              
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    max
                                    (
                                    
                                       d
                                       j
                                    
                                    )
                                    −
                                    
                                       d
                                       j
                                    
                                 
                              
                           
                        
                     

To compare the consensus elicited by different states in the same model it is useful to use normalized metrics which have values between 0 and 1. With this aim we define a scaled ensemble consensus for each state as:
                           
                              (11)
                              
                                 
                                    s
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       
                                          max
                                          (
                                          
                                             d
                                             j
                                          
                                          )
                                          −
                                          
                                             d
                                             j
                                          
                                       
                                       
                                          max
                                          (
                                          
                                             d
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

In this way, if we obtained e.g. sx
                        1
                        =0.8051, sx
                        2
                        =0.9874, and sx
                        3
                        =0.9903, we would note that the ensemble consensus for state variable 2 (which typically represents the concentration of a chemical species) is clearly higher than for state variable 1, and therefore the methodology would suggest that the predictions about the concentrations of species 2 are more reliable than for species 1. Furthermore, since the differences between sx
                        2 and sx
                        3 are relatively small, we could also conclude that the predictions about the concentrations of state variables 2 and 3 are similarly reliable.

Finally, we can calculate an average global consensus for all the states as
                           
                              (12)
                              
                                 
                                    x
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                x
                                                j
                                             
                                          
                                       
                                       
                                          
                                             n
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Defining other consensus metrics is straightforward, by choosing other measures of the distance between model predictions. For example, in Eq. (7) we could use the difference in absolute values rather than the squared difference, i.e.
                           
                              (13)
                              
                                 
                                    
                                       d
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                A
                                                ¯
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          |
                                       
                                       
                                          
                                             max
                                             k
                                          
                                          (
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          )
                                          −
                                          
                                             min
                                             k
                                          
                                          (
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The expression described in Eq. (13) was chosen in a previous work [19]. However, comparisons between both metrics have shown that using the expression in Eq. (7) enables a more sensitive discrimination of larger and smaller prediction errors, and is hence the one used in the present work.

We quantify the error in the prediction of model k with respect to the true value of a concentration j at every time instant i as:
                           
                              (14)
                              
                                 
                                    
                                       e
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   A
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   A
                                                   
                                                      i
                                                      j
                                                   
                                                   *
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          
                                             max
                                             k
                                          
                                          (
                                          
                                             A
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

where 
                           
                              
                                 A
                                 
                                    i
                                    j
                                 
                                 *
                              
                           
                         is the true value of the concentration. The error of every model for every state along the time horizon is
                           
                              (15)
                              
                                 
                                    
                                       e
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   n
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                e
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             n
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        
                     

And the average prediction error for a state is the average error of all the models,
                           
                              (16)
                              
                                 
                                    
                                       e
                                       j
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                
                                                   n
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                d
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             n
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To normalize the prediction error between 0 and 1 we define a scaled error as:
                           
                              (17)
                              
                                 
                                    s
                                    
                                       e
                                       j
                                    
                                    =
                                    
                                       
                                          
                                             e
                                             j
                                          
                                       
                                       
                                          max
                                          (
                                          
                                             e
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

@&#RESULTS AND DISCUSSION@&#

The methodology was applied to a metabolic model of Chinese Hamster Ovary cells (CHO), which are used for recombinant protein production in fermentation processes. We simulated a batch process with resting cells and a time horizon of 300h. The fermenter medium contains glucose as the main carbon source, and leucine and methionine as representative amino acids that are taken up. Lactate is modelled as key by-product of the fermentation process. A synthesized protein serves as main product of the fermentation process. Glucose, lactate, product protein, leucine, and methionine are assumed to be measured in the fermenter. Aspartate, malate, pyruvate, oxaloacetate, ATP, and ADP are assumed to be available as intracellular metabolite measurements.

The model comprises 34 metabolites (whose concentrations are the state variables, numbered in Table 1
                        ) and 32 reactions, and includes protein product formation, Embden–Meyerhof–Parnas pathway (EMP), TCA cycle, a reduced amino acid metabolism, lactate production, and the electron transport chain. The metabolic network is shown in Fig. 2
                         and the detailed reactions are listed in the supplementary information (Table 7). The kinetic ODE model comprises 117 parameters in total. The kinetic expressions of the rates are of the form of Eq. (1). The values of 
                           
                              
                                 r
                                 i
                                 
                                    
                                       max
                                    
                                 
                              
                           
                         that appear in the equation can be taken from a stationary reference flux distribution, which we obtained by applying Flux Balance Analysis (FBA). The objective function for FBA is defined as:
                           
                              (18)
                              
                                 
                                    
                                       f
                                       
                                          o
                                          b
                                          j
                                       
                                       
                                          F
                                          B
                                          A
                                       
                                    
                                    =
                                    max
                                    (
                                    m
                                    r
                                    )
                                 
                              
                           
                        where mr is the maintenance rate, which is defined as surplus of all ATP producing fluxes over all ATP demanding metabolic processes in the cell. Uptake and production rate constraints were chosen to be close to measured stationary fluxes in [27]. The remaining parameters that need to be identified are: the K
                        
                           m
                         values in the Michaelis–Menten kinetics, and the elasticities in the linlog kinetics. The model is available in different formats (SBML, Matlab, C, COPASI, AMIGO) as part of the BioPreDyn-Bench suite [28], which can be downloaded from https://sites.google.com/site/biopredynbenchmarks/.

The model was subdivided into five different physiological modules, for which associated meta-parameter modules were generated (more details are given in Tables 2–6 in the Supplementary information):
                           
                              •
                              
                                 Central metabolism module: MPs from concentration and rate pairs related to the EMP and TCA cycle, describing the dynamics of glucose, leucine, methionine, and 2-oxoglutarate.


                                 Fermenter module: describing the dynamics of glucose, lactate, methionine, leucine, and product protein.


                                 Energetics module: TCA cycle and energy-related metabolites, describing the dynamics of glucose, pyruvate, methionine, leucine, and ATP.


                                 Uptake and energetics module: substrate-associated meta-parameters describing the dynamics of glucose, methionine, leucine, ATP, product protein, and lactate.


                                 Uptakes module: describing the dynamics of glucose, methionine, and leucine.

Meta-parameters in these modules were estimated either for single modules or for module combinations during the parameter estimation procedure. Synthetic measurement data was generated using a reference model and was used in lieu of experimental data. Care was taken to ensure resemblance to realistic experimental conditions. For each of the 13 metabolites that are typically measured, 12 sampling times were assumed and Gaussian noise was added with a standard deviation of 20% while non-negativity for all synthetically generated concentrations was ensured.

Using the eSS algorithm for parameter estimation included in AMIGO, we carried out 10 optimizations of the full model without meta-parameters (117 parameters) starting from different initial random guesses. The lower and upper bounds for the parameters were 1/5 and 5 times the nominal values. All of the optimizations succeeded in obtaining a good fit to the data, yielding 10 solutions that differed significantly; this non-uniqueness suggests lack of practical identifiability.

Following this initial calibration with the original parameter set, we re-parameterized the model using the meta-parameter approach. Every meta-parameter is defined as a function of several of the original parameters, for which a default value has to be set. This default value may simply be chosen as a random initial guess within the parameter bounds. Alternatively, the result of a calibration with the original parameter set can be used, if it is available. In our case, since we had already performed 10 optimizations, we chose to use their results for setting the default values. Since 10 different possible solutions were found in the first set of calibrations, we averaged the 10 parameter vector values obtained and used the result as the initial guess. Realizing that this simple average biases the guess towards large values, we also considered a solution with smaller parameter values as second initial guess. Thus two different guesses for the vector of 117 parameters were used, pg1 and pg2.

Next we carried out parameter estimations with each of the 5 meta-parameter modules defined in Section 3.1. As before, the optimizations started from 10 different initial points for each module; that is, the initial guesses were 10 parameter vectors whose values were chosen randomly within the parameter bounds. They were carried out twice: with pg1 and pg2, resulting in a total of 2×10×5=100 optimizations. Reducing the number of optimized parameters (from the original 117 parameters to between 5 and 12 meta-parameters, depending on the module) improved the identifiability of the model, and the 100 optimizations yielded only 22 different solutions (that is, the fraction of different solutions obtained in the optimizations was reduced from 100% to 22%). In particular, the “uptake and energetics” module returned just a single solution with p
                        
                           g1
                         and another one with p
                        
                           g2
                        . On the other hand, we obtained 4 and 6 different solutions, respectively, for the fermenter module. The number of solutions returned by the remaining modules was between the two aforementioned results.

An ensemble of models was created with these 22 parameterizations plus the 10 resulting from the optimization of the original model, that is, a total of 32 models. All of these models provided a near-perfect fit to the pseudo-experimental data used for calibration, as shown in Fig. 3(A). The fact that the models calibrated with the meta-parameter modules (which had between 5 and 12 free parameters to be optimized) managed to fit the data equally well as the models calibrated with the full original set (117 parameters) supports the idea that the models calibrated with the original parameter set had a clear risk of overfitting. The decrease in the number of optimal solutions found with the meta-parameter approach suggests that its use reduced this risk. The reduction in the number of estimated parameters also led to a decrease of the computation times of the optimization procedure by up to two orders of magnitude.

Next we evaluated the ability of the calibrated models and of the ensemble to reproduce the concentrations of the remaining 21 metabolites, which are typically not measured in practice. The scaled consensus in the predictions among models in the ensemble was calculated for each of the measured and unmeasured metabolites as in Eq. (11). In general, the measured metabolites elicited more consensus than the unmeasured ones as expected. Panel B of Fig. 3 shows the predictions of every model in the ensemble (in grey) together with the real output (in red) and the ensemble prediction (in blue), for the 21 unmeasured states. Visual inspection of this figure shows that consensus is a good indicator of the confidence in the predictions, a result further confirmed by the numerical results. For example, predictions of the time course of NADH (cytosol) elicit a very high consensus (sx
                        23
                        =0.999992), which suggests that its consensus prediction is very close to the real output. This is indeed the case: in Fig. 3(B), the ensemble prediction of this variable (blue line) is indistinguishable from its true time course (red line). Conversely, variable number 10 (concentration of glutamine in cytosol) has the lowest consensus: due to scaling, its value is actually zero, sx
                        10
                        =0, and the resulting prediction is far from the real output. Therefore, if we were thinking of measuring additional metabolites, we should concentrate our efforts on those metabolites with the larger dissensus, such as glutamine, and we could safely avoid additional measurements and rely on the ensemble prediction for metabolites such as NADH.

Indeed, consensus and prediction error were found to be significantly anti-correlated, with a correlation coefficient of r
                        =−0.7719 and p-value=9×10−8. Fig. 4(A) plots the scaled consensus sx
                        
                           j
                         and scaled prediction errors se
                        
                           j
                         for the 13 measured variables. Since the models were fitted to these data, the prediction errors are very low and the consensus is very high for all the variables. Fig. 4(B) shows the corresponding values for the 21 unmeasured variables.

It can be noticed that, for the 10 unmeasured variables that elicit higher consensus (numbers 31, 22, 7, 9, 18, 20, 17, 19, 23, and 25), the prediction errors are very low, which is not always the case for the other variables. Thus, ranking the predictions according to their consensus is a useful way of deciding which metabolites should be measured and which can be left unmeasured because we have enough confidence in the predictions.

Assessing the confidence in predictions of the system's behaviour under different conditions than those used for calibration represents another application of the consensus approach. In this case, often no experimental data are available. To test the validity of the approach in this type of scenario, we generated a new set of experimental conditions by randomly changing the initial concentrations of all the metabolites. Then we simulated the model's behaviour with nominal parameter values, generating a new artificial dataset, and compared it with the corresponding output of the ensemble models; results are shown on Fig. 5
                        . Fig. 6
                         plots the scaled consensus sx
                        
                           j
                         and scaled prediction errors se
                        
                           j
                         for the 34 variables. Again, consensus and prediction error were found to be anti-correlated, with a correlation coefficient of r
                        =−0.9998 and p-value=5×10−56. Finally, Fig. 7
                         represents in a different way the results shown in Figs. 4 and 6.

@&#DISCUSSION@&#

Before proceeding to the conclusions, we discuss in this section some aspects of the procedure and the results that deserve further comment.

We begin by remarking that an advantage of using an ensemble approach is that, as suggested by the anti-correlation between sx
                     
                        j
                      and se
                     
                        j
                     , the ensemble average can generally recapitulate the true system behaviour. This is shown in Figs. 3 and 5, where it can be noticed that the average (blue lines) and the true output (red lines) are generally close to each other, while some individual predictions (grey lines) are sometimes very far from reality.

This is not always true, though: in some cases (i.e. for some concentrations) the ensemble average fails to recapitulate the true dynamics. However, what the aforementioned anti-correlation implies is that—to a certain extent—we can expect to know when we should trust the ensemble predictions and when we should not. Thus, from Fig. 4 we conclude that the predictions for the variables with the highest consensus (that is, 19, 23, 25,…) are highly reliable; and when we look at the corresponding plots in Fig. 3 we see that this is indeed the case. Conversely, since variables such as 10, 28, and 12 elicit low consensus, we expect their predictions to be of less quality than the others, which is indeed the case if we look again at Fig. 3. To sum up, the introduction of a consensus metric complements the ensemble approach by providing indications of the confidence in the ensemble prediction.

We remark that the ensemble prediction is, on average, better than the individual predictions of the models in the ensemble. This is shown in Fig. 8
                     , which compares the prediction errors of the ensemble average for all the states with the average error of each of the calibrated models. Furthermore, Fig. S1 (see Supplementary file) aggregates the prediction errors of each model for all states, thus comparing the predictions of individual models with the ensemble prediction globally (instead of doing it separately for each state), showing that in both scenarios the ensemble prediction is among the top performers. To sum up, from the results it can be concluded that, since one cannot know a priori the quality of a particular model's prediction, the best option is always to use the ensemble prediction instead of the prediction of an individual model.

Another aspect that should be noted is that the consensus can vary between scenarios. For example, variable 21, which is pyruvate (cytosol), elicits high consensus in the first scenario (Fig. 4), while in the second scenario (Fig. 6) its consensus is very low, and as a consequence the ensemble average has a large prediction error. This difference in consensus can be easily explained: in the first scenario pyruvate (cytosol) was one of the measured variables, and hence its data were used to calibrate the models; hence all of the models managed to fit those data well—the output of all the models was nearly identical for that variable—producing a high consensus. In the second scenario, however, there were no measured data, so in principle there was no reason to expect a higher consensus for any particular variable.

Finally, another aspect of the methodology that is open to discussion is whether to include in the ensemble all the available models, or only those calibrated with the meta-parameter approach. The difference between both options can be analyzed according to two criteria: (1) the resulting ensemble prediction error and (2) how the prediction error for each variable correlates with the ensemble dissensus for that variable. We computed quantities (1) and (2) for ensembles built in two ways: (A) including all the available models, and (B) including only models calibrated with the meta-parameter approach. We found that the differences between both cases were small (data not shown). Furthermore, the ‘best’ strategy was different in the scenarios considered in Section 3.3 (predicting time courses of unmeasured variables) and Section 3.4 (predicting time courses of all variables in a different experimental condition). To sum up, the consensus approach provided good results for ensembles built with and without the meta-parameter approach, and the differences between both cases are small. Given that all the calibrated models yielded a good fit to the data, we found no reason to leave out of the ensemble the ones that had been calibrated without meta-parameters.

@&#CONCLUSIONS@&#

We have presented a method for making high-quality predictions in large-scale dynamic models. The method introduces two computational techniques, which we have referred to as the meta-parameter approach and the consensus approach. Its use has been demonstrated on a biotechnological application, a batch process for recombinant protein production in Chinese Hamster Ovary (CHO) cells. After building a metabolic model of CHO cells, we reduced the number of its parameters by applying the meta-parameter approach without reducing the model structure. This decreased the risk of over-fitting and accelerated the parameter estimation procedure, which produced an ensemble of models with different parameterizations. This ensemble was used as a basis for application of the consensus approach, whose core idea is to consider the coincidence among predictions of the models in the ensemble as an indication of the reliability of these predictions. Using a measure of the relative distance between the average prediction of all models and the true value, the procedure quantifies the degree of confidence in the predictions of the time evolution of each of the state variables (which can be e.g. metabolite concentrations, as in the example application). This quantitative indication can be used to decide where it is most efficient to make an additional measurement effort, that is, which state variables should be actually measured and for which we can rely on the model simulations. In summary, it has been shown how the combination of the meta-parameter approach and of the consensus approach can be a valuable tool for improving the identifiability and applicability of complex dynamic models.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the EU project “BioPreDyn” (EC FP7-KBBE-2011-5, grant 289434) and by the Spanish MINECO and the European Regional Development Fund (ERDF; project “MultiScales”, DPI2011-28112-C04-03). We further would like to thank Michael Rempel for valuable technical support.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cmpb.2015.02.001.

The following are the supplementary data to this article:
                        
                           
                        
                     
                  

@&#REFERENCES@&#

