@&#MAIN-TITLE@&#Microfacet-based interference simulation for multilayer films

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model the interaction of light and films by the multi-beam interference equations.


                        
                        
                           
                           We introduce Fresnel coefficients for the metallic and dielectric films.


                        
                        
                           
                           We incorporate microfacet factor to take into account the geometry of rough surfaces.


                        
                        
                           
                           We model the iridescence of Morpho butterflies with the regularity and irregularity.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Iridescent color

Multilayer films

Multi-beam interference equations

Fresnel coefficients

Anisotropic and isotropic scattering

Morpho butterfly

@&#ABSTRACT@&#


               
               
                  It has proved difficult to visualize the iridescent colors of objects coated with multilayer films in ray-based tracers. A physical-based full spectrum scattering model is proposed in this paper; this model applies the multi-beam interference equations to explain the multiple reflection and refraction of light inside the thin films in order to simulate the phase and amplitude variations of light related to iridescent colors. The Fresnel coefficients for the metallic and dielectric films are introduced respectively to photo-realistically render the wave properties of multilayer films. The solution is further extended to take into account the geometry of rough surfaces instead of a smooth averaging surface where the anisotropic and isotropic scattering characteristics are well explained. We demonstrate the validity of the proposed model by visualizing wave effects for diverse metallic or dielectric multilayer film structures and a Morpho butterfly.
               
            

@&#INTRODUCTION@&#

When light propagates through objects with the multilayer film structures, it undergoes multiple reflection and transmission inside films and superimposes each other to generate iridescent colors, namely amplitude-splitting interference. Rainbow colors caused by thin films or layered structures, for instance, often appear on optical lenses, soap bubbles or oil slicks [1,2].

In computer graphics, it is desired to build an accurate scattering model of the interaction of light and the multilayer films for visualizing the optical effects of objects with layered structures such as soap bubbles and butterfly wings. Multiple models have been proposed to render the iridescent phenomena generated by such structures. For example, Gondek et al. [3] utilized a wavelength based bidirectional reflectance distribution function and a virtual goniospectrophotometer to analyze, and make renderings of thin films and pearlescent paints. Hirayama et al. [4] constructed an accurate illumination model to visualize the interference effects of dielectric or metallic materials. Sun [5] also proposed an iridescent shading process to render biological iridescences in RGB-based renderers using analytic calculation and numerical simulation. These methods are able to describe wave properties of films approximately, but few of them take the roughness of the microstructure into account and account for the anisotropic nature of the scattering light on the structures.

To accurately rendering optical phenomena from various kinds of film materials, we propose a generalized wave bidirectional scattering distribution function (BSDF) shading model. The multi-beam interference equations are used in our model for explaining multiple reflection, interference and absorption of light inside multilayer thin films. Different from the Fresnel formulae for thin films [6,4,7], the introduced Fresnel coefficient for conductors is utilized to visualize interference effects caused by multilayer metallic films which have complex refractive indices and affect the absorption of photons. In addition, the microfacet scattering factor is incorporated into the iridescent shading model to simulate the interaction of light and the surfaces with the different roughnesses where the isotropic and anisotropic properties are taken into consideration together. For renderings, we further adopt the gamma correction to account for approximate linear relation between pixel values and display intensity. The paper also presents a set of examples to illustrate how to apply our shading model to visualize the wave effects of rough objects coated with multilayer metallic or dielectric films and Morpho butterfly wings.

Section 2 briefly reviews some techniques related to the photo-realistic rendering. The analytical calculation process for the composite reflectivity and transmissivity of multilayer film structures is presented in Section 3. Section 4 discusses a new model for visualizing the iridescent colors of surfaces with high roughness. Experimental results and comparisons are showed in Section 5. Finally, we make a summary with discussions on future work in Section 6.

@&#RELATED WORK@&#

The photo-realistic rendering is involved in the physical simulation of the interaction of light and objects. Many classical ray-based approaches have been developed for realistically modeling reflection behavior of light on surfaces using the bidirectional scattering distribution function [8–10]. However, they cannot account for the phase variances to visualize the iridescent colors appearing on objects with the wavelength-scale microstructure or multilayer films.

Beckmann and Spizzichino [11] proposed an early physical model to describe the reflection behavior from the wavelength-scale microstructure. Moravec [12] applied the wave optics model to graphics to model diffraction effects based on the phase tracking technology. Kajiya [13] developed a BRDF anisotropic reflection model where a numerical solution is used to solve the Kirchhoff integral formula. He et al. [14] described a sophisticated physical model to simulate the reflection phenomena from a variety of surfaces. Stam [15] constructed a general diffraction shaders, followed by the works of Agu [16], Sun [17], and Wu [18], to render iridescent colors from periodic structures such as compact discs in a ray-based renderer. In addition, Sadeghi et al. [19] derived a physically-based model for simulating rainbows. More recently, the Wigner distribution function was applied to model the interference after multiple bounces from wavelength-scale microstructures [20,21]. Most of present methods, however, cannot explain the film interference effects.

For rendering optical effects of objects coated with multilayer film structures, Gondek et al. [3] presented a wavelength-dependent bidirectional reflectance function to analyze and make iridescent colors of pearlescent paints and pigmented materials. Icart et al. [22,23] also constructed a physically-based BRDF model for multilayer systems consisting of homogeneous and isotropic thin films with rough boundaries. Stam et al. [24] reported a method of visualizing transmittance effects of rough surfaces by generalizing the Cook-Torrance model. Sun [5] constructed spectra from colors and proposed an iridescent shading process for rendering the multilayer interference of Morpho butterflies and ground beetles based on the analytical calculation and numerical simulation. Few of these methods consider the geometry of rough surfaces to accurately visualize the isotropic and anisotropic wave characteristics of multilayer film structures. In addition, multiple other models have also been presented [25–31]. More recently, the finite-difference time-domain (FDTD) algorithm [32,33] has been widely used to solve Maxwell’s equations numerically for structural colors, and its variant was used by Okada et al. [34] with high accuracy but lower cost. Musbach et al. [35] also applied the FDTD to create computer-generated pictures of a Morpho butterfly. This approach, however, depends closely on a fine defined numerical grid and cannot fully explain the irregularity of ridge positions on butterfly wing surfaces [36,37].

Walter et al. [38] discussed the appropriate microfacet distribution and shadowing-masking functions for transmissive materials with rough surfaces and provided effective importance sampling schemes, but the phase information of light was ignored. The proposed illumination model in this article takes into account the wave scattering characteristics of objects with roughness where the Blinn [39] isotropic and Ashikhmin [40] anisotropic functions are used as basis to enhance the iridescent colors.

Multi-beam interference equations are commonly used to describe the reflection and transmission of light inside multilayer film structures, which describe the amplitude-splitting interference phenomena appearing on natural objects.

Here we use the formulae to model the complex interaction between light and films. As an example, we consider a object coated with a single-layer dielectric film with the thickness H and the index of refraction 
                        
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                        
                      as illustrated in Fig. 1
                     . The indices of refraction of the air and the substrate are denoted as 
                        
                           
                              
                                 n
                              
                              
                                 0
                              
                           
                        
                      and 
                        
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                        
                      respectively. The 
                        
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                      denote the reflection and transmission coefficients on the corresponding boundary plane.

Referring to thin film literature [41,42], the reflectivity of a single-layer film is given by
                        
                           (1)
                           
                              r
                              =
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          δ
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          δ
                                       
                                    
                                 
                              
                           
                        
                     and the corresponding transmissivity is written as
                        
                           (2)
                           
                              t
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          δ
                                       
                                    
                                 
                              
                           
                        
                     where δ denotes the phase difference between two adjacent boundary plane, which is written as
                        
                           (3)
                           
                              δ
                              =
                              
                                 
                                    4
                                    π
                                 
                                 
                                    λ
                                 
                              
                              nH
                              cos
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 θ
                              
                              
                                 t
                              
                              
                                 ′
                              
                           
                        
                      is the refractive angle that the transmitted light make with the surface normal.

For two or more M-layer thin film system, we can iterative the calculation of the reflection and transmission coefficients from the last layer adjacent to the substrate to the first layer. For the Mth layer, for instance,
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          M
                                       
                                    
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          M
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where δ is defined as
                        
                           (6)
                           
                              
                                 
                                    δ
                                 
                                 
                                    M
                                 
                              
                              =
                              
                                 
                                    4
                                    π
                                 
                                 
                                    λ
                                 
                              
                              
                                 
                                    n
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    M
                                 
                              
                              cos
                              
                                 
                                    θ
                                 
                                 
                                    M
                                 
                              
                           
                        
                     Assume the Mth layer and the substrate as a whole, then add the (
                        
                           M
                           -
                           1
                        
                     )th layer and calculate the scattering coefficients, namely
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    M
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    M
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          M
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          r
                                       
                                       
                                          M
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 δ
                              
                              
                                 M
                                 -
                                 1
                              
                           
                           =
                           
                              
                                 4
                                 π
                              
                              
                                 λ
                              
                           
                           
                              
                                 n
                              
                              
                                 M
                                 -
                                 1
                              
                           
                           
                              
                                 h
                              
                              
                                 M
                                 -
                                 1
                              
                           
                           cos
                           
                              
                                 θ
                              
                              
                                 M
                                 -
                                 1
                              
                           
                        
                     . The calculation process is repeated until the first layer adjacent to air. Finally, we can obtain the composite reflectivity and transmissivity coefficients of the multilayer film system.

If the light source is monochromatic, the viewer can see a set of concentric circles of bright and dark stripes from the reflected or transmitted ray direction. Similarly, one can see a set of colored stripes when the light source is a white light.

In the photo-realistic rendering field, more and more attentions are focused on the wave characteristics that the multilayer film structures exhibit. In this paper, we construct the interference illumination model to visualize the optical effects caused by the interaction of light and films where the indices of refraction, thicknesses and the irregular geometry of films play an important role.

In ray tracers, the bidirectional reflectance distribution function (BRDF) and bidirectional transmittance distribution function (BTDF) are commonly used to represent the energy ratio between the incident light and the reflected or transmitted light for describing the behavior of light, which provide an efficient way in accurately rendering the appearance of the material.

Here, we construct the wave BSDF that contains both the BRDF and the BTDF to solve the wave rendering equation which is defined as
                        
                           (9)
                           
                              
                                 
                                    L
                                 
                                 
                                    o
                                 
                              
                              (
                              p
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    o
                                 
                              
                              ,
                              λ
                              )
                              =
                              
                                 
                                    L
                                 
                                 
                                    e
                                 
                              
                              (
                              p
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    o
                                 
                              
                              ,
                              λ
                              )
                              +
                              ∫
                              
                                 
                                    BSDF
                                 
                                 
                                    λ
                                 
                              
                              ×
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              (
                              p
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                              
                              ,
                              λ
                              )
                              |
                              cos
                              θ
                              |
                              d
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 L
                              
                              
                                 o
                              
                           
                           (
                           p
                           ,
                           
                              
                                 ω
                              
                              
                                 o
                              
                           
                           ,
                           λ
                           )
                        
                      denotes the the scattered radiance of wavelength λ in the direction 
                        
                           
                              
                                 ω
                              
                              
                                 o
                              
                           
                        
                      at the point 
                        
                           P
                           ,
                           
                              
                                 L
                              
                              
                                 e
                              
                           
                           (
                           p
                           ,
                           
                              
                                 ω
                              
                              
                                 o
                              
                           
                           ,
                           λ
                           )
                        
                      is the self-emitted energy, 
                        
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                           (
                           p
                           ,
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ,
                           λ
                           )
                        
                      is the incident irradiance of wavelength λ in the direction 
                        
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                        
                     , and 
                        
                           
                              
                                 BSDF
                              
                              
                                 λ
                              
                           
                           (
                           p
                           ,
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 ω
                              
                              
                                 o
                              
                           
                           )
                        
                      denotes the reflected or transmitted coefficient which encapsulates amplitude and phase variations.

When light propagates through the multilayer dielectric films, its behavior can be approximated by perfect specular reflection and transmission as illustrated in Fig. 2
                        . It assumes that the absorption of light is not taken into account and the direction of the transmitted light inside thin films complies with Snell’ law which is written as
                           
                              (10)
                              
                                 
                                    
                                       η
                                    
                                    
                                       i
                                    
                                 
                                 sin
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       η
                                    
                                    
                                       t
                                    
                                 
                                 sin
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    η
                                 
                                 
                                    t
                                 
                              
                           
                         denote the indices of refraction for the incident and transmitted media, and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                              
                           
                         are angles that incident light and transmitted light make with the surface normal respectively.

To solve the composite reflectivity and transmissivity of multilayer dielectric films, it is necessary to compute the reflectivity and transmissivity of each layer where the Fresnel formulae are applied to determine the amount of reflected or transmitted light for interface between two layer media. A known approximation to the Fresnel formulae of dielectrics for s-polarized and p-polarized light is
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ‖
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ⊥
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ‖
                                                
                                             
                                             =
                                             
                                                
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ⊥
                                                
                                             
                                             =
                                             
                                                
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    ‖
                                 
                              
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    ‖
                                 
                              
                           
                         denote the Fresnel coefficients for parallel polarized light, and 
                           
                              
                                 
                                    r
                                 
                                 
                                    ⊥
                                 
                              
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    ⊥
                                 
                              
                           
                         denote the coefficients for perpendicular polarized light. The transmitted angle complies with Snell’ law [6,10].

In ray-based renderers, the Fresnel reflectance and transmittance are defined as the average of the squares of the s-polarized and p-polarized light. Hence, for the M-layer film structures, the reflectance derivation is defined as
                           
                              (12)
                              
                                 
                                    
                                       R
                                    
                                    
                                       fresnel
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ⊥
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        and the corresponding transmittance derivation is written as
                           
                              (13)
                              
                                 
                                    
                                       T
                                    
                                    
                                       fresnel
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ⊥
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    ¯
                                 
                              
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                           
                         are the calculated composite reflectivity and transmissivity respectively based on the Eqs. (4)–(8) (see Section 3 for details). Fig. 3
                         shows a case where the glass model coated with a 400nm dielectric films is rendered with the proposed model. Refractive indices of the glass and dielectric materials are set to 1.5 and 2.0 respectively. Note how refraction through the transmissive object distorts the scene behind it and how the right mirror material reflects the interference effect.

It is necessary to take into account the absorption of light for iridescent colors from multilayer metallic films. New reflectance derivations are introduced to solve the problem. Unlike the previous multilayer film model [6] where the recursive formula for conductors is very complex due to the complex refractive index, we adopt the approximated Fresnel formula for conductors [10] which is subject to two the additional quantities η, the index of refraction of the conductor, and k, its absorption coefficient. Here, the index of refraction and absorption coefficient vary with the wavelength of light. Fig. 4
                         shows a plot of the wavelength-dependent indices of refraction and absorption coefficients for gold and copper materials based on the simulated data [10].

The simple approximation to the Fresnel reflectance for conductors is written as
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ⊥
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   -
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   +
                                                   2
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   cos
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    k
                                 
                                 
                                    λ
                                 
                              
                           
                         denotes the absorption coefficient for wavelength λ and the 
                           
                              
                                 
                                    η
                                 
                                 
                                    λ
                                 
                              
                           
                         denotes the refractive index for wavelength λ.

Substituting Eq. (14) in Eq. (12) yields the reflectance derivation of the metallic film. It is used for rendering scenes of objects coated with metallic films as illustrated in Fig. 5
                         where the transmitted light is absorbed.

For the multilayer film structures with a certain amount of irregularity such as Morpho butterflies as illustrated in Fig. 6
                        , the occlusion, shadowing and interreflection of light among ridges may lead to the uneven spatial distribution of energy. Kinoshita et al. [25,36] and Lee [33] have demonstrated that the behavior of light is the result of joint action of the regularity and irregularity of multilayer film structures, and cannot be simply explained using the multi-beam interference principle.

It is necessary to incorporate the irregularity of the film structure to model the diffusive nature. For the isotropic distribution, we adopt the Blinn shader [39], namely 
                           
                              
                                 
                                    D
                                 
                                 
                                    facet
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          h
                                       
                                    
                                    ·
                                    n
                                    )
                                 
                                 
                                    e
                                 
                              
                           
                         with the half-angle vector 
                           
                              
                                 
                                    ω
                                 
                                 
                                    h
                                 
                              
                           
                        , surface normal n and an exponent e. However, some film structures often show backscattering and anisotropic spectral characteristics. Many geometrical models have been developed [8,39,40]. They work by statistically modeling the scattering of light, where the wave-like properties are ignored. As an extension, we incorporate the Ashikhmin microfacet scattering shader [40], namely Eq. (15), into the wave BSDF illumination model to describe the local anisotropic effects.
                           
                              (15)
                              
                                 
                                    
                                       D
                                    
                                    
                                       facet
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             2
                                             )
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       2
                                       π
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             h
                                          
                                       
                                       ·
                                       n
                                       )
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       ϕ
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       ϕ
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ω
                                 
                                 
                                    h
                                 
                              
                           
                         denotes the half angle vector for incident direction 
                           
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                              
                           
                         and outgoing direction 
                           
                              
                                 
                                    ω
                                 
                                 
                                    o
                                 
                              
                           
                        , n denotes the surface normal, ϕ denotes the orientation angle, and 
                           
                              
                                 
                                    e
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    y
                                 
                              
                           
                         denote the exponents of anisotropic distribution along the x and y axes respectively.

This paper develops a new wave bidirectional scattering distribution function that provides an efficient way of accurately rendering the interference appearance of films with periodic structures, written as
                           
                              (16)
                              
                                 
                                    
                                       BSDF
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       diffuse
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             facet
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             fresnel
                                          
                                       
                                       G
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       4
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             o
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              G
                              (
                              
                                 
                                    ω
                                 
                                 
                                    o
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              min
                              (
                              1
                              ,
                              min
                              (
                              
                                 
                                    2
                                    (
                                    n
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          h
                                       
                                    
                                    )
                                    (
                                    n
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    2
                                    (
                                    n
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          h
                                       
                                    
                                    )
                                    (
                                    n
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    ·
                                    
                                       
                                          ω
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              )
                              )
                           
                         denotes a geometric attenuation term [10] and 
                           
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                              
                           
                         and 
                           
                              
                                 
                                    c
                                 
                                 
                                    b
                                 
                              
                           
                         are the weighted coefficients. 
                           
                              
                                 
                                    F
                                 
                                 
                                    fresnel
                                 
                              
                           
                         equals to 
                           
                              
                                 
                                    R
                                 
                                 
                                    fresnel
                                 
                              
                           
                         in the reflectance distribution and 
                           
                              
                                 
                                    T
                                 
                                 
                                    fresnel
                                 
                              
                           
                         in the transmittance distribution respectively, determined by Eqs. (12) and (13). 
                           
                              
                                 
                                    I
                                 
                                 
                                    diffuse
                                 
                              
                           
                         denotes the diffuse effect which is defined as a constant for regular multilayer film structures. However in case of Morpho butterfly, there exists diffraction due to the wavelength-scale separation between ridges corresponding to Fig. 6. So 
                           
                              
                                 
                                    I
                                 
                                 
                                    diffuse
                                 
                              
                           
                         is given by
                           
                              (17)
                              
                                 
                                    
                                       I
                                    
                                    
                                       diffuse
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                sin
                                                α
                                             
                                             
                                                α
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   sinN
                                                   β
                                                
                                                
                                                   sin
                                                   β
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 δ
                                 (
                                 m
                                 λ
                                 ±
                                 d
                                 (
                                 sin
                                 
                                    
                                       ω
                                    
                                    
                                       o
                                    
                                 
                                 -
                                 sin
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                              
                           
                        where N is the number of lamellar structure, 
                           
                              β
                              =
                              
                                 
                                    π
                                    d
                                    (
                                    sin
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    ±
                                    sin
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    λ
                                 
                              
                           
                         denotes the phase difference between disturbances from the corresponding points in adjacent ridge separation and 
                           
                              α
                              =
                              
                                 
                                    π
                                    b
                                    (
                                    sin
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    ±
                                    sin
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    λ
                                 
                              
                           
                        .

As is known that the renderer usually exhibits a non-linear relationship between pixel values and the radiance that they represent. The common practice in graphics is to apply the Gamma correction to approximate [43,44] where a power curve with the exponent 
                           
                              
                                 
                                    I
                                 
                                 
                                    gamma
                                 
                              
                           
                         is widely used as illustrated in Eq. (18). As modeling the interference effects also generates out of gamut colors between nature and the monitor [1], we have chosen to use the same clipping approach with constant lightness and hue.
                           
                              (18)
                              
                                 
                                    
                                       I
                                    
                                    
                                       des
                                    
                                 
                                 =
                                 powf
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       scale
                                    
                                 
                                 ∗
                                 
                                    
                                       I
                                    
                                    
                                       src
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       gamma
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    I
                                 
                                 
                                    scale
                                 
                              
                           
                         is a constant, determining the scaling size, 
                           
                              
                                 
                                    I
                                 
                                 
                                    src
                                 
                              
                           
                         denotes the original pixel intensity, 
                           
                              
                                 
                                    I
                                 
                                 
                                    des
                                 
                              
                           
                         denotes the calculated target values and 
                           
                              
                                 
                                    I
                                 
                                 
                                    gamma
                                 
                              
                           
                         has a range of 1.0 to 2.0.

When light propagates through a layer of film with high index of refraction to another with low index of refraction, total internal reflection will occur where the reflected value is set to the constant one. It is necessary to exchange the indices of refraction of incident and transmitted media in Eqs. (11) and (14) when light propagates away from surfaces.

Meanwhile, the BSDF scattering coefficient composed of BRDF and BTDF complies with the energy conservation law, namely
                           
                              (19)
                              
                                 
                                    ∫
                                    
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       BRDF
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 p
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       ir
                                    
                                 
                                 )
                                 |
                                 cos
                                 θ
                                 |
                                 d
                                 
                                    
                                       ω
                                    
                                    
                                       ir
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       BTDF
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 p
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       it
                                    
                                 
                                 )
                                 |
                                 cos
                                 θ
                                 |
                                 d
                                 
                                    
                                       ω
                                    
                                    
                                       it
                                    
                                 
                                 ⩽
                                 1
                              
                           
                        
                     

We implemented our wave model for rendering iridescent colors of objects coated with multilayer films by creating a new material plugin in the PBRT system [10]. All of the images in this work were produced on a Dell T7600 workstation with a 2.40GHz Intel Xeon CPU E5-2609 and a NVIDIA Quadro 6000. We focused on the visual spectrum (350–730nm) and showed physical-based renderings as examples for the thin film interference to demonstrate the validity of the proposed model.


                     Fig. 7
                      shows a case where the glass model coated with a 600nm dielectric films is rendered with the proposed model. Refractive indices of the glass and dielectric materials are set to 1.5 and 2.0 respectively. Compared with Figs. 3, 7 shows color shifts to the red end with the increase of film thickness, which is consistent with observations. Note how refraction through the transmissive object distorts the scene behind it and how the right mirror material reflects the interference effect.

In Fig. 8
                     , our model is further applied to render the iridescent patterns of opaque objects coated with dielectric films of different thicknesses under global illumination. The indices of refraction of dielectric and substrate are set to 1.5 and 1.25. In addition, we visualized the reflectance distributions for both incident angles and wavelengths corresponding to the above patterns (Fig. 8) as illustrated in Fig. 9
                     .


                     Fig. 10
                      is an example of isotropic and anisotropic renderings of opaque objects coated with the 500nm dielectric of the refractive index 1.5. We addressed the effects of the surface roughness and anisotropy on the visual optical appearance where both Blinn [39] isotropic and Ashikhmin [40] anisotropic functions are used as the basis for our optical model. A approximated Morpho butterfly’s wing with several air-cuticle layers [45] was modeled in Maya software and rendered at different camera positions respectively using our optics model as shown in Fig. 11
                     . The cuticle layer has a refractive index of 1.56 and the air separation of 90nm, and the generated results can agree well with the experimental measurements [5,27,34]. See the attachment for our animated video.

We also implemented the film interference patterns of other diverse scenes such as the kangaroo, bunny, teapot and Buddha in Fig. 12
                      based on the proposed approach in the physical-based PBRT framework [10], where the parameters denoting the film thickness and the microfacet roughness used for each object can be easily adjusted as needed.

As an extension of previous work [6,7], Figs. 5 and 10 describe the new produced isotropic and anisotropic interference effects for metallic and dielectric multilayer films respectively using our proposed model. In addition, our model can be directly applied to render biological iridescences. Based on the analytical derivations of multilayer films, we show a comparison between previous Morpho butterfly shaders and the iridescent model in this work as shown in Fig. 13
                         where our model applies Ashikhmin [40] distribution function to generate the anisotropic spectral distribution instead of the isotropic Phong [46] specular exponent used in [5,27]. Our model also generates similar iridescent colors with the work of Kinoshita [25] based on experimental measurements.

Okada et al. [34] and Musbach et al. [35] use the nonstandard and standard FDTD respectively to achieve the accurate far-field spectral reflectance from butterfly wings with a regular ridge structures of equal height. In measurements, however, the real-life ridge structures are irregularly positioned and the theoretical results of regular structures are unlikely to account for the continuous spread of scattered intensity over a range of wavelengths or angles [36,37]. Based on the work of Sun [5], we introduced Fresnel equations for metallic and dielectric materials and microfacet scattering factor to exhibit the anisotropic interference in a wide angular range. Fig. 14
                         shows the color variations of the butterfly wings with different cuticle layer thicknesses where the light source and camera positions are fixed. Compared with the shader of Sun [5], our proposed model can not only photo-realistically model the color shift from blue
                           1
                           For interpretation of color in Fig. 14, the reader is referred to the web version of this article.
                        
                        
                           1
                         to red due to the increase of the layer thickness, but also show the color variations dependent on viewing directions in the constant layer thickness. The second row of Fig. 14, for example, illustrates the color changes from blue to purple (left), from yellow to green (middle) or from red to yellow (right), which closely follows the measurement results [47,48]. Note that the viewing angle from the camera to the wing surface varies with the surface position. In addition, a ground-truth verification of the proposed model is proposed in Fig. 15
                         where the rendered results can approximate the real-world Morpho butterfly by properly adjusting the cuticle layer film thickness.

In this paper, we have presented a new wave illumination model that has sufficient flexibility to represent the isotropic and anisotropic optics phenomena. This model applies a wavelength-dependent BSDF scattering coefficient to describe the spatial and the spectral distributions of the reflected or transmitted light from a surface in ray tracers. The multi-beam interference equations have been introduced to represent the multiple reflection and transmission of light inside multilayer film structures, whose values are used for the importance-based Monte Carlo sampling in order to realistically rendering the local illumination.

We have also described the approximated reflectivity and transmissivity formulae for dielectric and metallic films that are applied to keep track of amplitude changes. The microfacet scattering factor is further incorporated to take into account the isotropic and anisotropic characteristics from the geometry of rough surface. The developed BSDF derivations that contain BRDFs and BTDFs are implemented to show how the extended method can be used to model iridescent colors caused by phase and amplitude variances in reflected or transmitted light.

However, it is desirable to compare the rendered results with the goniospectrophotometric data taken from real surfaces in many cases measured appearance data can improve the accuracy. In addition, how to explain diffraction and interference problems in a uniform form is another important and promising work.

@&#ACKNOWLEDGMENTS@&#

We sincerely acknowledge Jiaze Wu for discussions and the anonymous reviewers for their valuable comments. This work was funded by National High Technology Research and Development Program of China (2009AA01Z303 and 2012AA011206). The Buddha, bunny, kangaroo and teapot scenes are from PBRT [10].

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.gmod.2014.12.003.


                     
                        
                           Supplementary Image 1
                           
                        
                     
                  


                     
                        
                           Supplementary Image 2
                           
                        
                     
                  


                     
                        
                           Supplementary Image 3
                           
                        
                     
                  


                     
                        
                           Supplementary Image 4
                           
                        
                     
                  


                     
                        
                           Supplementary Image 5
                           
                        
                     
                  


                     
                        
                           Supplementary Image 6
                           
                        
                     
                  


                     
                        
                           Supplementary Image 7
                           
                        
                     
                  


                     
                        
                           Supplementary Video 1
                           
                        
                     
                  

@&#REFERENCES@&#

