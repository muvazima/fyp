@&#MAIN-TITLE@&#Adaptive neuro-fuzzy inference systems with k-fold cross-validation for energy expenditure predictions based on heart rate

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a practical approach based on neuro-fuzzy systems to estimate energy expenditure using heart rate monitoring.


                        
                        
                           
                           The proposed approach improves the standard Flex-HR method in that it does not require individual calibration.


                        
                        
                           
                           The proposed approach treats the uncertainty in human physiological systems and in various workplaces by using fuzzy logic.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Flex–HR method

Physical workload

Adaptive neuro-fuzzy inference system (ANFIS)

@&#ABSTRACT@&#


               
               
                  This paper presents a new model based on adaptive neuro-fuzzy inference systems (ANFIS) to predict oxygen consumption 
                        
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                              )
                           
                        
                      from easily measured variables. The ANFIS prediction model consists of three ANFIS modules for estimating the Flex–HR parameters. Each module was developed based on clustering a training set of data samples relevant to that module and then the ANFIS prediction model was tested against a validation data set. Fifty-eight participants performed the Meyer and Flenghi step-test, during which heart rate (HR) and 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      were measured. Results indicated no significant difference between observed and estimated Flex–HR parameters and between measured and estimated 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      in the overall HR range, and separately in different HR ranges. The ANFIS prediction model (MAE = 3 ml kg−1 min−1) demonstrated better performance than Rennie et al.'s (MAE = 7 ml kg−1 min−1) and Keytel et al.'s (MAE = 6 ml kg−1 min−1) models, and comparable performance with the standard Flex–HR method (MAE = 2.3 ml kg−1 min−1) throughout the HR range. The ANFIS model thus provides practitioners with a practical, cost- and time-efficient method for 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimation without the need for individual calibration.
               
            

@&#INTRODUCTION@&#

Researchers in occupational health and safety have demonstrated the importance of designing jobs according to the physiological capacity of a particular workforce. Studies have shown that such design, based on the balance between physiological capacity of the workforce and energetic demands of physical work, is a key factor in maintaining workforce safety and productivity (Abdelhamid, 1999; Wu and Wang, 2002; Dempsey et al., 2008). Oxygen consumption 
                        
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                              )
                           
                        
                      reflects energy expenditure (EE) and physical workload associated with physically demanding work (Smolander et al., 2008; Wu and Wang, 2002; Bouchard and Trudeau, 2008).

Direct measurement of 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      requires sophisticated and costly instrumentation; therefore attempts have been made to find alternative estimation methods (e.g., ISO8996, 2004; Smolander et al., 2008).

The Flex–HR method is one of the most widely used methods based on heart rate (HR) measurements (Spurr et al., 1988; Ceesay et al., 1989; Schulz et al., 1989; Garet et al., 2005). This method assumes a linear relationship between HR and 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      above a transition point (Flex point) and a more variable relationship, which uses the average of HR values during rest, below this point (Garet et al., 2005; Valanou et al., 2006). The Flex point is empirically defined as the average of the lowest HR during exercise and the highest HR during rest (Valanou et al., 2006). Accordingly, the Flex–HR method is based on four parameters, namely resting oxygen consumption (
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      rest), the Flex point, the slope, and the intercept of the linear function describing the 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                           –HR
                        
                      relationship above the Flex point. The main criticism about the Flex–HR method is the impracticality of establishing individual calibration curves at workplaces with large populations, since it takes at least 45 min per participant (Rennie et al., 2001). Another criticism concerns the uncertainty in determining the Flex point due to several factors, such as the physical and physiological characteristics of the population under study, as well as the type and number of physical activities (Garet et al., 2005).

Group calibration methods have been used to estimate energy expenditure from HR (Li et al., 1993; Luke et al., 1997; Rutgers et al., 1997; Rennie et al., 2001; Keytel et al., 2005). These methods were based on linear prediction models using regression and mixed-model analyses, which require a large sample size and lack the ability to capture nonlinearity, uncertainty and the true relationship between variables in the human physiological system (Shimizu and Jindo, 1995; Park and Han, 2004).

In recent years, artificial intelligence (AI) techniques have been proposed as alternatives to conventional statistical methods (Jang et al., 1997; Kaya et al., 2003; Yildirim and Bayramoglu, 2006). One of the most effective AI techniques, particularly for nonlinear function approximation, is the adaptive neuro-fuzzy inference system (ANFIS). It combines the unique ability of fuzzy logic to make decisions in uncertain conditions with the learning and adaptive capabilities of artificial neural networks. ANFIS has consistently been demonstrated effective in approximating nonlinear functions, particularly in biomedical engineering (Güler and Übeyli, 2004, 2005; Übeyli and Güler, 2005a,b).

This study presents a new approach to estimating 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      using HR without the need for an individual calibration test. The proposed approach attempts to improve the standard Flex–HR method so as to be suitable for large-scale workplaces. Three ANFIS modules forming the ANFIS prediction model were developed for the estimation of the Flex–HR parameters from measurements that can be easily obtained in field. Once the Flex–HR parameters are estimated, individuals' 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      during different activities can be determined. Laboratory and field data collection were conducted for the ANFIS prediction model development and testing. The ANFIS prediction model was compared with measured 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      values and three 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimation methods, namely the standard Flex–HR method, Rennie et al.'s and Keytel et al.'s models.

@&#METHODS@&#

This study used three data sets (i.e., training, validation and test), each of which was obtained from different sets of participants. Training data were obtained from 28 laboratory subjects performing a step-test in a laboratory environment. Validation data were obtained from 22 forest workers (i.e., brushcutters) performing a morning step-test near their work site (field step-test). Since these two data sets (training and validation) were used for ANFIS prediction model development (training data set for model training, and validation data set for parameters optimizing), they will be referred to as the learning data set for the remainder of the paper (Fig. 1). The third data set (test set) was obtained from a different group of eight forest workers (i.e., tree-planters) who performed a morning step-test near their work site followed with actual forest work. This set was used to test the accuracy of the developed model and compare its performance in estimating work 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      with that of traditional models.

Brushcutting work included regeneration release and precommercial thinning, which are young forests vegetation management methods (Wiensczyk et al., 2011). Both treatments involve cutting all competing vegetation within a 1 m area around desired young trees so as to foster their growth by allowing light and soil resources to reach them. This work is typically performed using a motor–manual brushsaw. While being very similar task-wise, they are performed at different moments in the silvicultural treatments sequence. Regeneration release is usually prescribed in the first two to five years after reforestation while precommercial thinning is performed when young trees reach 1.5 m in height and a bigger basal diameter. Brushcutters free selected young trees by operating the brushsaw (average load of about 10 kg) while walking back and forth in 2 m wide strips for an average of 87% out of the total 17.5 h needed to treat one hectare of reforested land (SD = 8.9 h; n = 91) (Dubeau et al., 2012). Precommercial thinning is usually more time consuming (e.g., 23.5 h/ha) but showed a similar proportion of effective time in previous studies (84.7%; n = 129) (LeBel and Dubeau, 2007). Tree-planting work consisted in finding a proper microsite, making a hole using a carrot extractor or a shovel, inserting a seedling (young nursery tree), compacting the soil around it and moving to the next proper microsite. In this study, tree-planters typically walked most of the day to plant trees at a mean rate ranging between 5.3 and 15.5 s/tree (depending on seedling size and weight) for an average of 77% out of a mean 8.2-h workday (SD = 0.7 h). They started a cycle by gathering seedlings (initial carried weight ranging between 7.0 and 18.0 kg), then proceeding to plant them following prepared furrows until their load was empty, then refilled seedlings, took a short rest pause and started the next cycle.

Fifty-eight healthy men aged from 21 to 64 years participated in the research. Fifty subjects, including 22 brushcutters from various areas in the Province of Quebec and 28 healthy males from various background drawn either from clients attending physical activities at the University of Montreal sport center facilities or from the local population through advertisement, hereafter referred to laboratory subjects, constituted the learning data set participants. The remaining eight subjects were tree-planters and constituted the test data set participants (Table 1
                        ). Participants had to pass the pre-activity readiness questionnaire (PAR-Q) before being accepted for the study (Chisholm et al., 1975; Shephard, 1988). No participants were competitive athletes and none regularly used medication. The study was approved by the Human Research Ethics Committee of Polytechnique Montréal. All participants signed a written informed consent form prior to partaking in the study.

@&#PROCEDURE@&#

The 50 learning data set participants performed the Meyer and Flenghi (1995) step-test either during the day in a laboratory (for the 28 laboratory subjects) or in the morning close to the work site prior to beginning the day's work (for the 22 brushcutters). This step-test ability to predict maximum aerobic capacity has been validated against the maximal multistage 20-m shuttle run test (Meyer and Flenghi, 1995) and against a maximal treadmill test (Imbeau et al., 2009). It has the following advantages: simple, cost-effective, and practical, it can be implemented safely without imposing high cardiac strain, particularly for older and less active individuals. An additional advantage is that step frequency (15 steps per min paced with a metronome) is sufficiently low for any worker to be able to keep pace at all four step heights, for superior overall test precision and robustness. Imbeau et al. (2010) demonstrated that the highest exertion level on this test reached by a forest workers group corresponded well to the exertion generally measured during typical brushcutting work. A detailed description of the Meyer and Flenghi step-test was provided in Kolus et al. (2014). The participant's HR was continuously measured and monitored during the test using a heart rate monitor (Polar Electro T-61 coded). Breath-by-breath 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            was measured using a portable apparatus (COSMED Fitmate™ PRO).

The learning data set included 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                                 –HR
                              
                            measurements collected at rest and for each step height of the step-test, as well as individual participants' physical characteristics (age, weight, height, BMI, and HRrest). The learning data set included 1050 data samples, of which 588 samples (28 participants × 21 min) were obtained from the laboratory subjects and 462 samples (22 participants × 21 min) from the brushcutters.

The eight forest workers first performed the Meyer and Flenghi step-test in the morning shortly after their arrival at the worksite, close to the patch that had to be cleared during the day. HR and 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            were continuously measured using the Polar Electro and COSMED Fitmate™ PRO instruments. The worker's HRrest was determined during the 5-min seated rest preceding the test. After completing the step-test, the worker was released and began his regular workday (of regeneration release work), which involved variable workload intensities resulting from working under a variety of environmental conditions (e.g., sloping terrain, field obstacles, vegetation density, and stem diameters to be cut) (Toupin et al., 2007). Meyer and Flenghi (1995) showed that the step-test can be administered at the beginning of a workday without compromising a participant's ability to perform physical work throughout the work shift due to undue fatigue.

The worker's HR was continuously measured throughout the day using the Polar Electro, while 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            was measured using the COSMED Fitmate™ PRO for an average duration of 37 min (range: 34–53 min) around mid-morning or mid-afternoon. The COSMED Fitmate™ PRO imposed this time limit since it was deemed uncomfortable by the workers. The forest work 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            measurements provided a means to validate the energy expenditure estimates produced by the different heart rate based models.

The test data set included 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                                 –HR
                              
                            measurements collected during the early morning step-test and during the workday, as well as workers' physical characteristics (age, weight, height, BMI, and HRrest). The sample size of the test set was 464 data samples, of which 168 samples (8 participants × 21 min) were obtained during the field step-test and 296 samples (8 participants × 37 min) were obtained during regeneration release work activities. The HR data collected during work were corrected from thermal heat stress by one of the authors using the method proposed by Vogt et al. (1970, 1973) to remove the thermal component (or thermal pulse) from the raw field-measured HR data. According to this method, the thermal pulse is the HR elevation above rest measured during the 4th min of a seated rest pause taken immediately after cessation of a work period. Typically, 4–5 seated rest pauses were undertaken during the workday at the worksite, one of which followed immediately the work 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            measurement period (Mairiaux and Malchaire, 1990). The thermal pulse is related to an increase in body core temperature caused by hot working conditions, clothing insulation or sustained moderate to high physical work (Rowell, 1986; Kampmann et al., 2001), and it may contribute to a significant 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            overestimation when a participant's 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                                 –HR
                              
                            relationship from the morning step-test is used to estimate work 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            from uncorrected HR measurements in the field (ISO8996, 2004; Dubé, 2015). The corrected work HR profile was used to estimate work 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            with the ANFIS prediction model and the three traditional 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            estimation methods.

Three ANFIS modules were built for the estimation of the Flex–HR parameters using the learning data set, namely ANFIS module 1 (associated with 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         rest), ANFIS module 2 (associated with the Flex point), and ANFIS module 3 (associated with the slope and intercept of the linear 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                              –HR
                           
                         curve) (Fig. 1
                        ). The development of each module involved three steps: input screening, model selection, and final model building. For the simultaneous input screening and model selection, the learning set was split into two sets (training and validation) (Ripley, 1996). The training data set was used for developing models incorporating different sets of input variables, while the validation data set was used to determine the optimal set of input variables. The estimated Flex–HR parameters formed individuals' calibration curves (ANFIS prediction model), which were used to estimate 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                        . The estimated Flex–HR parameters were then compared to those estimated by the standard Flex–HR method and by Rennie et al.'s (2001) model using workers' step-test data from the test data set. In addition, 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates from the ANFIS prediction model were compared to the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                        , and estimates from the standard Flex–HR method, Rennie et al.'s model, and Kytel et al.'s model using the 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                              –HR
                           
                         work data from the test data set. The fuzzy logic toolbox provided in MATLAB (version 7.5.0) was used to develop the fuzzy models.

The first step in developing the ANFIS model was to identify the significant input variables associated with each ANFIS module. In this study, five input variables were considered in the following order: age, weight, height, BMI, and HRrest. The following sets were defined as follows: {i} is the set of input variables after removing the ith input variable; {i, j} is the set of input variables after removing the ith and jth input variables; {i, j, k} is the set of input variables after removing the ith, jth and kth input variables (where i, j, k = 1, 2, 3, 4, 5 and i ≠ j ≠ k). Candidate sets of input variables were determined for each ANFIS module using the backward selection method (Chiu, 1996). The 10-fold cross validation method was simultaneously used for accurate performance assessment since it has been found superior to other methods (e.g., holdout, bootstrap and leave-one-out cross validation methods) in determining the generalization error in model selection problems (Breiman and Spector, 1992; Kohavi, 1995; Molinaro et al., 2005). A description of the simultaneous use of the backward selection method and 10-fold cross validation is provided in Appendix A.

As demonstrated by Rennie et al. (2001), a strong negative correlation (0.94) was found between the slope and the intercept of the linear curve. Therefore, due to the dependency between the slope and the intercept, module 3 was used for the estimation of both parameters in this study. Candidate sets of input variables associated with the ANFIS modules are presented in Table 2
                           . Based on each candidate set, a fuzzy model was developed for each of the 10 partitions using the training data set associated with that partition. The optimal subtractive clustering parameters were determined using an enumerative search (Table 2). Fig. 2(a, b, and c) shows the average performance (i.e., RMSE) (over all 10 partitions) of the fuzzy models incorporating different candidate sets for modules 1, 2, and 3, respectively, based on the validation data set. Significant input variables associated with the ANFIS modules are presented in Table 2.

After identifying the sets of significant input variables, each ANFIS module was trained with the learning data set using the back-propagation gradient descent method combined with the least squares method for 20 epochs (Fuzzy logic toolbox, MATLAB version 7.5.0). The final structure of the ANFIS modules is presented in Table 3
                           .

The three modules are described as follows. The ANFIS module 1 concerned with estimating 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                              
                            rest consists of the following two fuzzy IF–THEN rules:
                              
                                 
                                    
                                       If Age is
                                       
                                       
                                          A
                                          i
                                       
                                       
                                       AND Weight is
                                       
                                       
                                          B
                                          i
                                       
                                       
                                       AND Height is
                                       
                                       
                                          C
                                          i
                                       
                                       
                                       AND
                                       
                                       
                                          
                                             HR
                                          
                                          
                                             rest
                                          
                                       
                                       
                                       is
                                       
                                       
                                          E
                                          i
                                       
                                       
                                       THEN
                                       
                                       
                                          
                                             VO
                                          
                                          2
                                       
                                       
                                       rest
                                       =
                                       
                                          a
                                          i
                                       
                                       ×
                                       Age
                                       +
                                       
                                          b
                                          i
                                       
                                       ×
                                       Weight
                                       +
                                       
                                          c
                                          i
                                       
                                       ×
                                       Height
                                       +
                                       
                                          e
                                          i
                                       
                                       ×
                                       
                                          
                                             HR
                                          
                                          
                                             rest
                                          
                                       
                                       +
                                       
                                          f
                                          i
                                       
                                    
                                 
                              
                           where (i = 1, 2) corresponds to the rule number.

The ANFIS module 2 concerned with estimating the Flex point consists of the following five fuzzy IF–THEN rules:
                              
                                 
                                    
                                       If Weight is
                                       
                                       
                                          B
                                          i
                                       
                                       
                                       AND BMI is
                                       
                                       
                                          D
                                          i
                                       
                                       
                                       
                                          
                                             AND HR
                                          
                                          
                                             rest
                                          
                                       
                                       
                                       is
                                       
                                       
                                          E
                                          i
                                       
                                       
                                       THEN Flex point
                                       =
                                       
                                          b
                                          i
                                       
                                       ×
                                       Weight
                                       +
                                       
                                          d
                                          i
                                       
                                       ×
                                       BMI
                                       +
                                       
                                          e
                                          i
                                       
                                       ×
                                       
                                          
                                             HR
                                          
                                          
                                             rest
                                          
                                       
                                       +
                                       
                                          f
                                          i
                                       
                                    
                                 
                              
                           where (i = 1, 2, 3, 4, 5) corresponds to the rule number.

The ANFIS module 3 concerned with estimating the slope and intercept of the linear 
                              
                                 
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                       
                                       O
                                    
                                    2
                                 
                                 –HR
                              
                            curve above the Flex point consists of the following two fuzzy IF–THEN rules:
                              
                                 
                                    
                                       
                                          
                                             If Age is
                                             
                                             
                                                A
                                                i
                                             
                                             
                                             AND Weight is
                                             
                                             
                                                B
                                                i
                                             
                                             
                                             AND Height is
                                             
                                             
                                                C
                                                i
                                             
                                             
                                             AND BMI is
                                             
                                             
                                                D
                                                i
                                             
                                             
                                             
                                                AND HR
                                                
                                                   rest
                                                
                                             
                                             
                                             is
                                             
                                             
                                                E
                                                i
                                             
                                             
                                             THEN
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   Slope
                                                   =
                                                   
                                                      a
                                                      i
                                                   
                                                   ×
                                                   Age
                                                   +
                                                   
                                                      b
                                                      i
                                                   
                                                   ×
                                                   Weight
                                                   +
                                                   
                                                      c
                                                      i
                                                   
                                                   ×
                                                   Height
                                                   +
                                                   
                                                      d
                                                      i
                                                   
                                                   ×
                                                   BMI
                                                   +
                                                   
                                                      e
                                                      i
                                                   
                                                   ×
                                                   
                                                      
                                                         HR
                                                      
                                                      
                                                         rest
                                                      
                                                   
                                                   +
                                                   
                                                      f
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             AND 
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   Intercept
                                                   =
                                                   
                                                      a
                                                      i
                                                   
                                                   ×
                                                   Age
                                                   +
                                                   
                                                      b
                                                      i
                                                   
                                                   ×
                                                   Weight
                                                   +
                                                   
                                                      c
                                                      i
                                                   
                                                   ×
                                                   Height
                                                   +
                                                   
                                                      d
                                                      i
                                                   
                                                   ×
                                                   BMI
                                                   +
                                                   
                                                      e
                                                      i
                                                   
                                                   ×
                                                   
                                                      
                                                         HR
                                                      
                                                      
                                                         rest
                                                      
                                                   
                                                   +
                                                   
                                                      f
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where (i = 1, 2) corresponds to the rule number.


                           A
                           
                              i
                           , B
                           
                              i
                           , C
                           
                              i
                           , D
                           
                              i
                            and E
                           
                              i
                            are fuzzy sets describing the age, weight, height, BMI and HRrest, respectively. a
                           
                              i
                           , b
                           
                              i
                           , c
                           
                              i
                           , d
                           
                              i
                           , e
                           
                              i
                            and f
                           
                              i
                            are consequent parameters (coefficients) describing the fuzzy rules. i denotes the rule number associated with each module. The consequent parameters and the parameters describing the Gaussian membership functions associated with the fuzzy sets in each ANFIS module are presented in Table 4
                           .

Three 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation methods were used in this study for comparison with the developed ANFIS prediction model. The standard Flex–HR method uses individual 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                              –HR
                           
                         measurements during the Meyer and Flenghi step-test to determine the Flex–HR parameters so as to establish a participant's calibration curve. The Flex–HR parameters were determined in accordance with Spurr et al. (1988) and Ceesay et al. (1989). In addition, two general 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation models proposed by Rennie et al. (2001) and Keytel et al. (2005) were considered in this study. The former model includes three linear prediction equations developed using regression analysis for estimating the Flex–HR parameters:
                           
                              (1)
                              
                                 
                                    Resting energy expenditure
                                    
                                    
                                       (
                                       
                                          EE
                                       
                                       )
                                    
                                    
                                    
                                       (
                                       
                                          kJ
                                          .
                                          
                                          
                                             
                                                min
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    −
                                    1.1
                                    ×
                                    Gender
                                    +
                                    0.04
                                    ×
                                    Weight
                                    +
                                    0.02
                                    ×
                                    
                                       
                                          HR
                                       
                                       
                                          rest
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    Flex point
                                    
                                    
                                       (
                                       
                                          bpm
                                       
                                       )
                                    
                                    =
                                    1.7
                                    ×
                                    Gender
                                    +
                                    0.23
                                    ×
                                    BMI
                                    +
                                    0.93
                                    ×
                                    
                                       
                                          HR
                                       
                                       
                                          rest
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    Slope
                                    
                                    
                                       (
                                       
                                          kJ
                                          .
                                          
                                          
                                             
                                                min
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          .
                                          
                                          
                                             
                                                bpm
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    −
                                    0.12
                                    ×
                                    Gender
                                    +
                                    0.002
                                    ×
                                    Age
                                    +
                                    0.003
                                    ×
                                    Weight
                                 
                              
                           
                        
                     

The input variable Gender equals 1 for male and 2 for female. The intercept of the linear function describing the 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                              –HR
                           
                         relationship above the Flex point is estimated using regression analysis on the computed slope (Eq. (3)). On the other hand, Keytel et al.'s model consists of one linear equation to estimate EE using mixed-models analyses:
                           
                              (4)
                              
                                 
                                    EE
                                    
                                    
                                       (
                                       
                                          kJ
                                          .
                                          
                                          
                                             
                                                min
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          2
                                          −
                                          Gender
                                       
                                       )
                                    
                                    ×
                                    
                                       (
                                       
                                          −
                                          55.0969
                                          +
                                          0.6309
                                          ×
                                          HR
                                          +
                                          0.1988
                                          ×
                                          Weight
                                          +
                                          0.2017
                                          ×
                                          Age
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          Gender
                                          −
                                          1
                                       
                                       )
                                    
                                    ×
                                    
                                       (
                                       
                                          −
                                          20.4022
                                          +
                                          0.4472
                                          ×
                                          HR
                                          −
                                          0.1263
                                          ×
                                          Weight
                                          +
                                          0.074
                                          ×
                                          Age
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

The input variable Gender equals 1 for male and 2 for female.

Part of the test data set, which is the morning step-test data collected from the eight forest workers, was used to determine the parameters of the standard Flex–HR method (observed parameters) and to develop the associated individual calibration curves. The observed parameters were then compared with the estimates from the three ANFIS modules, and Rennie et al.'s model (Eqs. (1)–(3)). Next, 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates from the ANFIS prediction model were compared with 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         measurements, as well as with 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates from the standard Flex–HR (observed parameters), Rennie et al.'s and Keytel et al.'s (Eq. (4)) models using the rest of the test data set, which is the eight workers' data collected during the workday. HR data measured during work constituted the main input into the various models so as to produce 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates (ANFIS prediction, standard Flex–HR from observed parameters, Rennie et al.'s and Keytel et al.'s models). Comparisons were made throughout the HR range, as well as for three HR categories: very light work: <80 bpm; light work: 80–100 bpm; and moderate to heavy work: >100 bpm (Smolander et al., 2008).

The performance of the three ANFIS modules in estimating the Flex–HR parameters was assessed and compared with other models using the mean absolute error (MAE) and mean absolute percentage error (MAPE). Similarly, MAE and MAPE were used to assess and compare the performance of the ANFIS prediction model in estimating 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         against the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         values and against other models' estimations. Student's two-tailed t-test for paired observations was used to test for differences among the values to be compared. A threshold of p < 0.05 was considered statistically significant. Limits of agreement (LOA) between the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         values and the values estimated by the ANFIS prediction model, the standard Flex–HR, Rennie et al.'s and Keytel et al.'s models, were determined using the Bland–Altman plot to examine the accuracy of the estimation models (Bland and Altman, 1986). Moreover, the coefficient of variation (CV = 100 × standard deviation/sample mean) was used to assess the relative precision of all models.

@&#RESULTS@&#

Overall, 1514 min were analyzed (1218 min during the step-tests and 296 min during regeneration release work). The mean of the individual average HR was 86 (range 47–142) bpm during the step-tests and 104.4 (range 49–146) bpm during the regeneration release work. The largest portion of HR data (43%) from all participants during the step-tests was below 80 bpm, followed by 33% between 80 and 100 bpm, and 24% above 100 bpm. However, the largest portion of HR data (59%) during regeneration release work was above 100 bpm, followed by 23% below 80 bpm, and 18% between 80 and 100 bpm.


                        Table 5
                         presents the average observed Flex–HR parameters and estimated parameters using the three ANFIS modules and Rennie et al.'s model. The respective ANFIS modules yielded significantly better performance than Rennie et al.'s model in terms of percent difference vs observed value for each parameter, MAE and MAPE. The paired t-test indicated no significant differences in estimating the observed parameters using the three ANFIS modules, whereas Rennie et al.'s model yielded significantly different parameter estimates (p < 0.001). Fig. 3
                         shows the performance of the three ANFIS modules as well as that of Rennie et al.'s model in estimating the observed parameters of the standard Flex–HR method with the morning step-test data obtained from the eight workers.


                        Table 6
                         summarizes the results obtained for each 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation method based on the data obtained from the eight workers during actual work activities. It shows the mean of all participants' average 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation per model, as well as the corresponding mean MAE and MAPE for the whole HR range and separately for the three HR categories. In addition, it includes a ranking of different 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation models. Results show that the standard Flex–HR, ANFIS prediction and Rennie et al.'s models underestimated measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         with overall mean differences of 0.69, 1.12 and 6.18 ml kg−1 min−1, respectively, whereas Keytel et al.'s model overestimated measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         with an overall mean difference of 0.92 ml kg−1 min−1. In addition, measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         values were underestimated by all models in the lower HR range. The 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         relative difference associated with the lower HR range was smallest with the standard Flex–HR method (8.9%) and largest with Rennie et al.'s model (25.1%). In the medium HR range, the smallest relative difference was obtained with ANFIS prediction model (4.8%), whereas the highest relative difference was obtained with Keytel et al.'s model (12%). The relative difference in the higher HR range was smallest with Keytel et al.'s model (2.5%) and highest with Rennie et al.'s model (37.2%).

In terms of model estimation errors, the standard Flex–HR method yielded the most accurate 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates, followed by the ANFIS prediction model, Rennie et al.'s and Keytel et al.'s models throughout the overall HR range and in different HR ranges. Rennie et al.'s model outperformed Keytel et al.'s in the lower and medium HR ranges, whereas the latter had smaller relative estimation errors in the higher HR range. The paired t-test showed no significant difference between the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         values and those estimated by the ANFIS prediction model throughout the entire HR range and separately in different HR ranges. On the other hand, the standard Flex–HR method significantly underestimated the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         in the overall HR range and in the higher HR range (Table 6). Rennie et al.'s model significantly underestimated the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         in the overall, lower and higher HR ranges. Keytel et al.'s model significantly overestimated the measured 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         in the higher HR range.

The Bland–Altman plot in Fig. 4
                         depicts the limits of agreement (LOA) between measured and estimated (i.e., by the standard Flex–HR, ANFIS prediction, Rennie et al.'s and Keytel et al.'s models) 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         values. The difference between the measured and estimated 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         was smallest: in the medium HR range with the standard Flex–HR and ANFIS prediction model, in the lower HR range with Rennie et al.'s model, and in the higher HR range with Keytel et al.'s model. On the other hand, the largest bias was: in the lower HR range with Keytel et al.'s model, and in the higher HR range with other models. Results show more compact 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimates by all 
                           
                              
                                 
                                    
                                       
                                          V
                                          ˙
                                       
                                    
                                    O
                                 
                                 2
                              
                           
                         estimation models in the lower HR range reflecting lower standard deviations (Table 7
                        ). Moreover, the LOA associated with the ANFIS prediction and Keytel et al.'s models get narrower as work intensity decreases. However, for the standard Flex–HR and Rennie et al.'s models, the LOA are widest in the medium HR range.

@&#DISCUSSION@&#

The analysis of the estimated Flex–HR parameters by the three ANFIS modules did not only show a similarity to the observed Flex–HR parameters, but also a significant reduction in estimation errors when compared to Rennie et al.'s model. For example, a reduction in MAE of approximately 76%, 80%, 75%, and 80% was reported when estimating 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      rest, Flex point, slope, and intercept, respectively. The ANFIS prediction model yielded more accurate 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimates than Rennie et al.'s and Keytel et al.'s models in the overall HR range and separately in different HR ranges, as indicated in Table 6. The results show that the proposed model produces percentage differences at lower (15.5%), medium (4.8%) and higher (6.9%) HR ranges, respectively, that are comparable with the ±10% figure generally expected when estimating the metabolic rate based on HR measurements using individual calibration methods (ISO8996, 2004). The paired t-test indicated a significant difference between the measured and estimated 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      by the standard Flex–HR method in the overall and higher HR ranges, which was not the case for the ANFIS prediction model. A possible explanation for this result is the very small standard error of the differences between the measured 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      values and those estimated by the standard Flex–HR method. As a result, a large t-ratio (2.58 throughout the entire HR range and 2.49 in the higher HR range) was obtained, corresponding to a small p-value (0.038 over the entire HR range and 0.042 in the higher HR range). Despite this result, a closer look at the 95% confidence interval (CI) of the true mean difference between the measured and estimated 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      reveals that both CI ends (CI: 0.05–1.3 ml kg−1 min−1 over the entire HR range and 0.06–2.2 ml kg−1 min−1 in the higher HR range) represent a trivial difference. Hence, one can conclude that although the difference between the measured 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      values and those estimated by the standard Flex–HR method is statistically significant, practically speaking, it is relatively small.

The fact that the ANFIS prediction model provides better prediction in the lower and medium HR ranges (than the higher HR range) indicates its ability to deal with the nonlinearity and uncertainty between 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      and HR at low work intensity. This finding is also supported by the comparable LOA associated with the ANFIS prediction (−2.7, 5.8) and with the standard Flex–HR (−3.5, 5.1) models in the lower HR range. The agreement between the measured 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      values and that estimated by the ANFIS prediction model throughout the entire HR range suggests the potential of the developed model to be a very efficient replacement for the standard Flex–HR method, since it does not require the collection of submaximal exercise data and the construction of an individual's Flex–HR calibration curve. The developed model can be used directly to assess 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      from HR measured during work provided that age, weight, height, and HRrest of the participant are known. Although the standard Flex–HR method provides more accurate 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimates, this precision can only be achieved at the expense of a greatly increased cost of implementation.

The model performance statistics from this study are in agreement with the recent literature. In 2001, Rennie and colleagues showed that EE estimated using their proposed models correlated with measured EE with a correlation coefficient of 0.82 (p < 0.01) over the full HR range. Moreover, Keytel et al. (2005) found that their proposed model correlated with the measured EE values with a correlation coefficient of 0.77 (p < 0.0001). These results agree with our findings for Rennie et al.'s model (r = 0.87, p < 0.0001) and Keytel et al.'s model (r = 0.79, p < 0.0001). Furthermore, the correlation coefficient associated with the ANFIS prediction model (r = 0.91, p < 0.0001) was found to be higher than that of Rennie et al.'s and Keytel et al.'s models, but lower than the standard Flex–HR method (r = 0.96, p < 0.0001). Firstbeat Technologies (2005) proposed a general neural network-based method for 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimation based on both HR and heart rate variability. Pulkkinen et al. (2004) found this method to yield a MAE of approximately 2.5 ml kg−1 min−1, which is comparable to our findings with the ANFIS prediction model (MAE = 3 ml kg−1 min−1, range = 1.8–4 ml kg−1 min−1). Firstbeat Technologies (2007) reported a 13.5% MAPE for the standard Flex–HR method, which is coherent with our finding (MAPE = 16.3%, range = 10.1–25.5%). They also reported a 22% MAPE for Rennie et al.'s model, which is lower than our findings (MAPE = 36.1%, range = 35.5–36.6%). This difference is likely due to the use of field-collected data (vs. laboratory data) for model evaluation and comparison in this study. The age differences and consequently the maximum aerobic capacity differences between the subject groups used in this paper may also explain this difference. The standard Flex–HR method has been reported to yield a coefficient of variation (CV) of 16.7% (Ceesay et al., 1989) and 18.6% (Spurr et al., 1988) over the full HR range, which is comparable with our finding (CV = 16.2%, range = 8.6–23.6%) (Table 5). Moreover, our results indicated that the ANFIS prediction model proposed here yielded a CV of 16.6% (range = 8.9–23.3%), indicating a relative precision comparable to that of the standard Flex–HR method.

Although adequate knowledge of MATLAB was required to develop the ANFIS prediction model, it has been implemented in Excel so that researchers and practitioners can easily use it as a decision support tool. (A complete Excel file implementing the model can be obtained by contacting the first author of the paper). Unlike other general calibration models, the ANFIS prediction model treats different portions of the 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                           –HR
                        
                      relationship by using three ANFIS modules, therefore using more information for each. For example, ANFIS module 1 provides an accurate estimate of 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      rest, which indicates daily sedentary energy expenditure, with an estimation error of approximately 0.57 ml kg−1 min−1. HR can be monitored during sitting rest, and the average of recorded HRrest values—in addition to age, weight, and height—can be entered into the ANFIS module 1 rule-base to obtain an estimate of 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      rest. The ANFIS module 1 has the potential to be implemented in a wide range of applications that require estimations of an individual's daily sedentary energy expenditure, such as in sport and health centers to establish dietary intake and weight-loss programs (Hofsteenge et al., 2010) and in medical centers and hospitals to determine patients caloric demand and thus their nutritive needs (Schwartz, 1998; Hart et al., 2002).

On the other hand, determining the Flex point with ANFIS module 2 helps to distinguish between energy expenditure during rest and activity (Livingstone et al., 1992). This may be useful in a wide range of applications particularly in the industry, since determining workers' Flex point may allow for better design of work–rest schedules. Although the ANFIS prediction model was tested with younger participants (test data set), the results demonstrate its performance to be comparable with the standard Flex–HR method. This indicates that the performance of the ANFIS prediction model would be expected to be higher if tested with older participants, since it was initially trained with data from older participants. The results attest to the robustness of the modeling approach used in this paper.

Practitioners should be aware that the ANFIS prediction model will overestimate 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      when a significant thermal pulse is present. Hence, the HR thermal component (thermal pulse) must be removed prior to using the ANFIS model (Vogt et al., 1970, 1973). This raises the need to investigate the thermal stress impact on the ANFIS modules development. Further studies could include a larger number and variety of participants and as well a variety of actual work activities with different intensities for ANFIS modules training and validation.

@&#CONCLUSION@&#

The purpose of this study was to develop a simple and practical approach to estimating energy expenditure based on HR measurements that does not require individual submaximal graded exercise calibration test data. The proposed ANFIS prediction model stems from the standard Flex–HR method, which has been recognized as one of the most accurate methods for 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimation based on HR. This study shows the proposed ANFIS model to be quite accurate (<10%) in estimating measured 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                     , which strongly implies that it can replace the standard Flex–HR method, especially in work environments where one cannot afford to have each participant of a group targeted for study to take a graded exercise test. The proposed model does not only represent a new application of fuzzy logic for 
                        
                           
                              
                                 
                                    
                                       V
                                       ˙
                                    
                                 
                                 O
                              
                              2
                           
                        
                      estimation, but it can also be implemented as easily as the standard Flex–HR method due to recent significant advancements in software and computational methods.

@&#ACKNOWLEDGMENTS@&#

This project received joint funding from the Ministère des Forêts, de la Faune et des Parcs of Québec, the Fonds Québécois pour la recherche sur la nature et les technologies (FQRNT), and the Natural Science and Engineering Research Council of Canada (NSERC), through the Canada Research Chair in Ergonomics of Polytechnique de Montreal, #950-202668.


                     
                        
                           1.
                           Randomly assign the learning set to each of 10 equal-sized partitions such that at each partition, 9 different folds are used as the training set while the remaining fold is used as the validation set.

For each partition, develop an initial fuzzy model using the training set and incorporating the set of all possible input variables.

For each partition, assess the performance (i.e., RMSE) of the developed initial fuzzy model using the validation set.

Compute the average performance (i.e., average RMSE) of the developed initial fuzzy models over all 10 partitions.

For each partition, temporarily remove each input variable from the set of possible input variables, one at a time from the rule base of the fuzzy model and assess the performance (i.e., RMSE) of the resultant truncated fuzzy models using the validation set.

Compute the average performance (i.e., average RMSE) of the truncated fuzzy models over all 10 partitions.

If there is improvement over a previous level, permanently remove the input variable associated with the best average performance obtained in step 6. Identify the best set of input variables associated with the best truncated fuzzy model and its corresponding performance. If there is no improvement, go to step 9.

If there is another input variable remaining in the best truncated fuzzy model, go to step 5. Otherwise, go to step 9.

Of the developed initial fuzzy model and the winner truncated fuzzy models, select the set of input variables associated with best average performance (lowest average RMSE).

Train the fuzzy model (with best average performance) using the whole learning set and call it ANFIS module.

@&#REFERENCES@&#

