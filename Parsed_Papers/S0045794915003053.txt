@&#MAIN-TITLE@&#
               hp-Finite element solution of coupled stationary magnetohydrodynamics problems including magnetostrictive effects

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The first computational treatment of magnetostritive effects in conducting fluids.


                        
                        
                           
                           Consistent linearisation of the coupled non-linear equations.


                        
                        
                           
                           Computational solution using Newton–Raphson and hp-finite elements.


                        
                        
                           
                           Benchmarking against problems with homogeneous material parameters.


                        
                        
                           
                           Simulation of complex flow problems with non-homogeneous material parameters.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Magnetohydrodynamics

Coupled problems




                     hp-Finite elements

Magnetostriction

@&#ABSTRACT@&#


               
               
                  We extend our existing hp-finite element framework for non-conducting magnetic fluids (Jin et al., 2014) to the treatment of conducting magnetic fluids including magnetostriction effects in both two- and three-dimensions. In particular, we present, to the best of our knowledge, the first computational treatment of magnetostrictive effects in conducting fluids. We propose a consistent linearisation of the coupled system of non-linear equations and solve the resulting discretised equations by means of the Newton–Raphson algorithm. Our treatment allows the simulation of complex flow problems, with non-homogeneous permeability and conductivity, and, apart from benchmarking against established analytical solutions for problems with homogeneous material parameters, we present a series of simulations of multiphase flows in two- and three-dimensions to show the predicative capability of the approach as well as the importance of including these effects.
               
            

@&#INTRODUCTION@&#

Magnetohydrodynamics (MHD) studies the behaviour of electrically conducting fluids under the existence of a magnetic field [6,15,30]. Since it was established by Hannes Alfvén in 1942, the field of MHD has grown rapidly and is now widely established and used in a variety of research fields, such as in geophysics (e.g. [3]), space weather forecasting (e.g. [33]), plasma physics (e.g. [22]), nuclear fusion reactors (e.g. [31]), metal casting (e.g. [14]) and in the Lorentz force flowmetre [28], to name but a few.

MHD can be viewed as a particular case of coupling between magnetic fields and fluids. In general, time independent magneto-fluid coupled problems can be described by the coupling between the steady incompressible Navier–Stokes equations
                        
                           (1a)
                           
                              ρ
                              (
                              ∇
                              v
                              )
                              v
                              -
                              ∇
                              ·
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    F
                                 
                              
                              ]
                              ]
                              =
                              f
                              ,
                           
                        
                     
                     
                        
                           (1b)
                           
                              ∇
                              ·
                              v
                              =
                              0
                              ,
                           
                        
                     which govern the fluid flow, and the time independent Maxwell equations
                        
                           (2a)
                           
                              ∇
                              ×
                              H
                              =
                              
                                 
                                    J
                                 
                                 
                                    ext
                                 
                              
                              +
                              
                                 
                                    J
                                 
                                 
                                    ohm
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (2b)
                           
                              ∇
                              ×
                              E
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           (2c)
                           
                              ∇
                              ·
                              B
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           (2d)
                           
                              ∇
                              ·
                              D
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    v
                                 
                              
                              ,
                           
                        
                     which govern the electromagnetic fields. In (1), 
                        
                           ρ
                        
                      is the fluid density, 
                        
                           v
                        
                      is the fluid velocity, 
                        
                           [
                           [
                           
                              
                                 σ
                              
                              
                                 F
                              
                           
                           ]
                           ]
                        
                      is the Cauchy stress tensor and 
                        
                           f
                        
                      is total body force. Furthermore, in (2), 
                        
                           B
                        
                      is the magnetic flux density vector, 
                        
                           D
                        
                      is the electric flux intensity vector, 
                        
                           
                              
                                 J
                              
                              
                                 ext
                              
                           
                        
                      is the external current source, 
                        
                           
                              
                                 J
                              
                              
                                 ohm
                              
                           
                        
                      is the Ohmic current, 
                        
                           
                              
                                 ρ
                              
                              
                                 v
                              
                           
                        
                      is the volume current density and 
                        
                           E
                        
                      and 
                        
                           H
                        
                      are the electric and magnetic field intensity vectors, respectively.

From the fluid perspective, we shall consider it to be Newtonian, with constitutive law
                        
                           (3)
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    F
                                 
                              
                              ]
                              ]
                              =
                              -
                              
                                 
                                    p
                                 
                                 
                                    ̂
                                 
                              
                              [
                              [
                              I
                              ]
                              ]
                              +
                              2
                              
                                 
                                    μ
                                 
                                 
                                    ̂
                                 
                              
                              [
                              [
                              ε
                              ]
                              ]
                              ,
                           
                        
                     where 
                        
                           [
                           [
                           I
                           ]
                           ]
                           ,
                           [
                           [
                           ε
                           ]
                           ]
                        
                      are the identity and strain rate tensors, respectively. Furthermore, 
                        
                           
                              
                                 p
                              
                              
                                 ̂
                              
                           
                        
                      is the pressure and 
                        
                           
                              
                                 μ
                              
                              
                                 ̂
                              
                           
                        
                      is the dynamic viscosity. From the electromagnetic perspective, we consider constitutive laws of the form
                        
                           (4)
                           
                              B
                              =
                              μ
                              H
                              ,
                              
                              
                                 
                                    J
                                 
                                 
                                    ohm
                                 
                              
                              =
                              Σ
                              E
                              ,
                              
                              D
                              =
                              ∊
                              E
                              ,
                           
                        
                     where 
                        
                           μ
                        
                      is the permeability of the material, which describes the extent of magnetisation, 
                        
                           Σ
                        
                      is its conductivity and 
                        
                           ∊
                        
                      is its permittivity. Note that residual magnetism will be ignored and that, in general, 
                        
                           μ
                           ,
                           Σ
                        
                      and 
                        
                           ∊
                        
                      are tensors, in which case we denote them as 
                        
                           [
                           [
                           μ
                           ]
                           ]
                           ,
                           [
                           [
                           Σ
                           ]
                           ]
                        
                      and 
                        
                           [
                           [
                           ∊
                           ]
                           ]
                        
                     , respectively. For a discussion on different classes of diamagnetic, paramagnetic and non-magnetic fluids, we refer to [26].

Intrinsic to simulating MHD problems is the coupling mechanism. The existence of a magnetic field applies a magnetic body force 
                        
                           f
                           
                              
                              
                                 EM
                              
                           
                        
                      (ponderomotive force) (as a contribution to 
                        
                           f
                        
                     ) onto the fluid domain, which affects the fluid flow. There are several different expressions for this magnetic body force, which can be found in the literature [10–12,29,38]. All in all, the magnetic body force consists of the Lorentz force, the magnetostrictive force and the dimagnetophoretic force [10]. We follow Stratton [38] and call the combination of dimagnetophoretic and magnetostrictive forces magnetostriction. In previous research on MHD, the electromagnetic constitutive relations are usually selected as (2), with a scalar constant permeability and conductivity. Furthermore, dielectric effects and the magnetostrictive (and dimagnetophoretic) forces are neglected and only the Lorentz force is considered [1,29]. This, in turn, leads to the standard governing equations for MHD stated in Moreau [30], Davidson [6] and Armero and Simo [1]. However, when considering problems with different fluid phases [16,41], as well as problems where the induced strain rate alters the distribution of 
                        
                           [
                           [
                           μ
                           ]
                           ]
                        
                     , which in turn changes the magnetic field distribution, magnetostrictive effects become important [26,27]. This coupling mechanism is illustrated in Fig. 1
                     . In order to include magnetostrictive effects with ease, it makes sense to revisit the governing equations for MHD and instead express the ponderomotive force 
                        
                           f
                           
                              
                              
                                 EM
                              
                           
                        
                      in terms of the divergence of a stress tensor 
                        
                           [
                           [
                           
                              
                                 σ
                              
                              
                                 EM
                              
                           
                           ]
                           ]
                        
                     
                     
                        
                           (5)
                           
                              f
                              
                                 
                                 
                                    EM
                                 
                              
                              =
                              ∇
                              ·
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    EM
                                 
                              
                              ]
                              ]
                              ,
                           
                        
                     which, in turn, permits more general coupling mechanisms to be considered. In order to solve MHD problems cost-effectively, various finite element methodologies have been applied thus far. Guermond and Minev [19,20] dealt with a decoupled linear MHD problem involving electrically conducting and insulating regions by using a mixed finite element approach with nodal (
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                        
                      conforming) finite elements for the magnetic field. It was observed that in non-convex domains with sharp edges and corners, a nodal finite element approach may fail to capture the singularities associated with these domains. Therefore, Schneebeli and Schötzau proposed a new mixed finite element for stationary incompressible MHD based on the Sobolev space 
                        
                           H
                           (
                           curl,
                           Ω
                           )
                        
                      
                     [34,36]. In [21], a weighted regularisation approach was used to solve the same equation set. In [5], Codina and Hernández-Silva present a stabilised finite element method for the stationary magneto-hydrodynamic equations based on a simple algebraic version of the subgrid scale variational concept. Houston, Schötzau and Wei applied a discontinuous Galerkin (DG) method to linearised incompressible MHD in [23]. Greif, Schötzau, Wei and Li used a DG method with divergence free velocities for incompressible MHD [18]. A 
                        
                           H
                           (
                           div
                           )
                        
                      conforming finite element has been proposed to solve the MHD equations so that the divergence-free condition on the magnetic flux intensity vector is rigorously guaranteed [4]. However, in all of these approaches, only a simple conducting fluid with constant permeability and conductivity was considered.

Our recent work has been devoted to the application of high-order hp-finite element discretisations to problems involving the coupling of electromagnetism, mechanics and fluids including electrostricitive and magnetostrictive effects. In [17], a fixed point algorithm was applied to the simulation of fully coupled electrostrictive dielectric materials. Then, in [25,26], we extended our methodology to account for magnetostrictive effects in both nearly incompressible and incompressible Newtonian fluids and applied a Newton–Raphson algorithm, which exhibits quadratic convergence of the residual and exponentially fast convergence of the unknown fields. In closely related work, [32], the hp-finite element analysis of three-dimensional linear piezoelectric beams is also considered.

This work continues to build on these developments and presents the following novel contributions. We extend our existing hp-finite element framework for non-conducting magnetic fluids to the treatment of conducting magnetic fluids including magnetostriction effects in both two- and three-dimensions. In particular, we present, to the best of our knowledge, the first computational treatment of magnetostrictive effects in conducting fluids. We propose a consistent linearisation of the resulting non-linear equations and solve the resulting discretised equations by means of the Newton–Raphson algorithm. We once again employ the high order hp-finite element discretisation of Schöberl and Zaglmayr [35,40], but the computational complexity in the present contribution is considerably higher than in our previous work due to the requirement of compatible 
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           H
                           (
                           curl
                           )
                        
                      conforming discretisations, which this basis set provides. The advantages of hp-finite elements are already outlined in [7,8,17] and thus are not discussed here.

The article is broken down into the following sections. In Section 2, the coupling approach is introduced and applied to derive the governing equations of MHD for homogeneous conducting fluids as well as for conducting magnetostrictive fluids. In Section 3, the Newton–Raphson algorithm is established via a consistent linearisation for both cases. Section 4 describes, briefly, the main features of the hp-finite element framework employed for the spatial discretisation of the weak form. Section 5 includes a series of numerical examples, well known within the fluid mechanics community, which are used to demonstrate the accuracy and robustness of the hp-implementation. Finally, some concluding remarks are summarised in Section 6.

In this section we construct the boundary value problems (BVPs) for describing the problem of stationary incompressible MHD, beginning with the boundary value problem for homogeneous isotropic conducting fluids with constant scalar permeability and conductivity and then, extending this to the treatment of more general magnetic fluids, including magnetostrictive effects. In the first case, following the discussion in the introduction, the electromagnetic body force is assumed to be described entirely using only the Lorentz force. Then, in the second case, we consider a more general ponderomotive force, which is expressed as the divergence of a stress tensor.

In a similar manner to [23,36], we consider a bounded Lipschitz domain 
                           
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                              d
                              =
                              2
                              ,
                              3
                              ,
                              Ω
                              
                              ≔
                              
                              
                                 
                                    Ω
                                 
                                 
                                    F
                                 
                              
                              ∪
                              
                                 
                                    Ω
                                 
                                 
                                    M
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    F
                                 
                              
                           
                         is the fluid domain and 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    M
                                 
                              
                           
                         is the magnetic domain. For simplicity, we shall assume that 
                           
                              Ω
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    F
                                 
                              
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    M
                                 
                              
                           
                         and its boundary can be described as 
                           
                              ∂
                              Ω
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    F
                                 
                              
                              ∪
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    F
                                 
                              
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    M
                                 
                              
                              ∪
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    M
                                 
                              
                           
                        . We introduce the scaled fields as
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                          
                                             E
                                             =
                                             
                                                
                                                   ∊
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             E
                                             ,
                                             
                                             D
                                             =
                                             
                                                
                                                   ∊
                                                
                                                
                                                   0
                                                
                                                
                                                   -
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             D
                                             ,
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   v
                                                
                                             
                                             =
                                             
                                                
                                                   ∊
                                                
                                                
                                                   0
                                                
                                                
                                                   -
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̂
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             H
                                             =
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             H
                                             ,
                                             
                                             B
                                             =
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                                
                                                   -
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             B
                                             ,
                                             
                                             J
                                             =
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             J
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         denote the permittivity and permeability of free space, respectively. It can then be shown that the coupling between (1) and (2) due to the Lorentz force, in absence of dielectric effects and the magnetostrictive forces and with constitutive relations (4) and (3), leads to the BVP formulation derived in [1,18,36], which we write in the form
                           
                              (7a)
                              
                                 ρ
                                 (
                                 ∇
                                 v
                                 )
                                 v
                                 -
                                 ∇
                                 ·
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 ]
                                 ]
                                 =
                                 f
                                 
                                 in
                                 
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (7b)
                              
                                 ∇
                                 ·
                                 v
                                 =
                                 0
                                 
                                 in
                                 
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (7c)
                              
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 ∇
                                 r
                                 +
                                 ∇
                                 ×
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 -
                                 ∇
                                 ×
                                 (
                                 v
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 =
                                 g
                                 
                                 in
                                 
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (7d)
                              
                                 ∇
                                 ·
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 =
                                 0
                                 
                                 in
                                 
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (7e)
                              
                                 v
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       D
                                    
                                 
                                 
                                 on
                                 
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7f)
                              
                                 (
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 ]
                                 ]
                                 )
                                 n
                                 =
                                 t
                                 
                                 on
                                 
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7g)
                              
                                 n
                                 ×
                                 H
                                 =
                                 f
                                 
                                    
                                    
                                       D
                                    
                                 
                                 
                                 on
                                 
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7h)
                              
                                 n
                                 ×
                                 (
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 +
                                 v
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 =
                                 f
                                 
                                    
                                    
                                       N
                                    
                                 
                                 
                                 on
                                 
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              H
                           
                         is the scaled magnetic field intensity introduced in (6) and 
                           
                              g
                              :
                              =
                              ∇
                              ×
                              (
                              c
                              
                                 
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    ]
                                    ]
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    ex
                                 
                              
                              )
                           
                         is a source term, 
                           
                              n
                           
                         is unit outward normal vector. In addition, 
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ]
                              ]
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                0
                                             
                                          
                                          /
                                          
                                             
                                                ∊
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                              [
                              [
                              Σ
                              ]
                              ]
                           
                         is the scaled electric conductivity tensor, 
                           
                              [
                              [
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              ]
                              ]
                              
                              ≔
                              
                              [
                              [
                              μ
                              ]
                              ]
                              /
                              
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         is the relative permeability tensor, c is the speed of light and 
                           
                              
                                 
                                    J
                                 
                                 
                                    ex
                                 
                              
                           
                         is an external current source. Here r is the Lagrange multiplier which is used to enforce (7d) 
                        [36].

The constitutive laws for this system are stated in (4) and (3) where, for the scaled fields, 
                           
                              [
                              [
                              μ
                              ]
                              ]
                           
                         becomes 
                           
                              [
                              [
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              ]
                              ]
                           
                         and 
                           
                              [
                              [
                              Σ
                              ]
                              ]
                           
                         becomes 
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ]
                              ]
                           
                        . Furthermore, in the case of a homogeneous isotropic conducting fluid, 
                           
                              [
                              [
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              ]
                              ]
                           
                         and 
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ]
                              ]
                           
                         become constant multiples of 
                           
                              [
                              [
                              I
                              ]
                              ]
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ̂
                                 
                              
                           
                         adopts a constant value. Furthermore, the body force 
                           
                              f
                           
                         in this case is
                           
                              (8)
                              
                                 f
                                 :
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 +
                                 f
                                 
                                    
                                    
                                       EM
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 +
                                 ∇
                                 ×
                                 H
                                 ×
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 ,
                              
                           
                        which follows from rescaling the Lorentz force 
                           
                              J
                              ×
                              B
                           
                        . In the above, 
                           
                              
                                 
                                    f
                                 
                                 
                                    ̃
                                 
                              
                           
                         is the non-magnetic part of the total body force. Note that, compared to the form of the stationary incompressible MHD equations presented in [23,36], we have chosen to write the formulation in terms of the scaled magnetic intensity 
                           
                              H
                           
                        , rather than the magnetic flux density 
                           
                              B
                              
                              ≔
                              
                              [
                              [
                              μ
                              ]
                              ]
                              H
                           
                        .

With the addition of suitable transmission conditions, (7) can already treat problems involving subdomains in which 
                           
                              [
                              [
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              ]
                              ]
                           
                         and 
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ]
                              ]
                           
                         are different scalar multiples of 
                           
                              [
                              [
                              I
                              ]
                              ]
                           
                        . However, we also wish to include other effects. As stated in the introduction, magnetostrictive effects become crucial in the case of multiphase problems where the magnetic permeability exhibits changes in its gradient. In order to include these effects, we consider a total body force acting on the fluid domain, where we express 
                           
                              f
                              
                                 
                                 
                                    EM
                                 
                              
                           
                         in terms of the divergence of a stress tensor as
                           
                              
                                 f
                                 :
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 +
                                 ∇
                                 ·
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 ,
                              
                           
                        and, in general,
                           
                              
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 :
                                 =
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       E
                                    
                                 
                                 ]
                                 ]
                                 +
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       H
                                    
                                 
                                 ]
                                 ]
                                 ,
                                 
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       E
                                    
                                 
                                 ]
                                 ]
                                 =
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             E
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             E
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       ∊
                                    
                                 
                                 ,
                                 
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       H
                                    
                                 
                                 ]
                                 ]
                                 =
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       μ
                                    
                                 
                                 .
                              
                           
                        
                     

Note that 
                           
                              f
                              
                                 
                                 
                                    EM
                                 
                              
                           
                         expressed in this form implicitly includes the effects described by 
                           
                              J
                              ×
                              B
                              =
                              ∇
                              ×
                              H
                              ×
                              (
                              [
                              [
                              μ
                              ]
                              ]
                              H
                              )
                           
                         in the absence of magnetostriction. In our case, only magnetic effects are important and so 
                           
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    EM
                                 
                              
                              ]
                              ]
                              =
                              [
                              [
                              
                                 
                                    σ
                                 
                                 
                                    H
                                 
                              
                              ]
                              ]
                           
                         and the contributions 
                           
                              
                                 
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          H
                                       
                                    
                                    ]
                                    ]
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          H
                                       
                                    
                                    ]
                                    ]
                                 
                                 
                                    μ
                                 
                              
                           
                         are those associated with free space and a magnetic material, respectively. Specifically, in the case of a homogeneous isotropic medium with 
                           
                              [
                              [
                              μ
                              ]
                              ]
                              =
                              
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              [
                              [
                              I
                              ]
                              ]
                           
                        , then in the same manner as [17],
                           
                              (9a)
                              
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       0
                                    
                                 
                                 H
                                 ⊗
                                 H
                                 -
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 H
                                 ·
                                 H
                                 )
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       μ
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               (
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          H
                                          ⊗
                                          H
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          1
                                          )
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                          )
                                          (
                                          H
                                          ·
                                          H
                                          )
                                          [
                                          [
                                          I
                                          ]
                                          ]
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                           
                         are as defined in [26].

Further simplifications can be made by making use of the scaled magnetic intensity 
                           
                              H
                           
                        , such that
                           
                              (10a)
                              
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 H
                                 ⊗
                                 H
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 H
                                 ·
                                 H
                                 )
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (10b)
                              
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             H
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       μ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          1
                                          )
                                          -
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 H
                                 ⊗
                                 H
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 )
                                 (
                                 H
                                 ·
                                 H
                                 )
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 .
                              
                           
                        
                     

For a magnetostrictive conducting fluid, the stress tensor can be expressed in a similar way to [26] to include magnetostrictive effects as
                           
                              (11)
                              
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 =
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 H
                                 )
                                 ]
                                 ]
                                 =
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 H
                                 ⊗
                                 H
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                    
                                 
                                 (
                                 H
                                 ·
                                 H
                                 )
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 =
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 ]
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       
                                          [
                                          [
                                          I
                                          ]
                                          ]
                                          +
                                          (
                                          ∇
                                          ·
                                          v
                                          )
                                          [
                                          [
                                          I
                                          ]
                                          ]
                                          -
                                          2
                                          [
                                          [
                                          ε
                                          (
                                          v
                                          )
                                          ]
                                          ]
                                       
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 [
                                 [
                                 ε
                                 (
                                 v
                                 )
                                 ]
                                 ]
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 v
                                 )
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 .
                              
                           
                        
                     

Using the stress tensor approach allows us to consider a more general set of boundary conditions for (7) as
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             v
                                             =
                                             
                                                
                                                   v
                                                
                                                
                                                   D
                                                
                                             
                                             
                                             on
                                             
                                             ∂
                                             
                                                
                                                   Ω
                                                
                                                
                                                   D
                                                
                                                
                                                   F
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             [
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   F
                                                
                                             
                                             ]
                                             ]
                                             +
                                             [
                                             [
                                             
                                                
                                                   σ
                                                
                                                
                                                   EM
                                                
                                             
                                             ]
                                             ]
                                             )
                                             n
                                             =
                                             t
                                             
                                             on
                                             
                                             ∂
                                             
                                                
                                                   Ω
                                                
                                                
                                                   N
                                                
                                                
                                                   F
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             n
                                             ×
                                             H
                                             =
                                             f
                                             
                                                
                                                
                                                   D
                                                
                                             
                                             
                                             on
                                             
                                             ∂
                                             
                                                
                                                   Ω
                                                
                                                
                                                   D
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             n
                                             ×
                                             (
                                             c
                                             
                                                
                                                   [
                                                   [
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   ]
                                                   ]
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             ∇
                                             ×
                                             H
                                             +
                                             v
                                             ×
                                             [
                                             [
                                             
                                                
                                                   μ
                                                
                                                
                                                   r
                                                
                                             
                                             ]
                                             ]
                                             H
                                             )
                                             =
                                             f
                                             
                                                
                                                
                                                   N
                                                
                                             
                                             
                                             on
                                             
                                             ∂
                                             
                                                
                                                   Ω
                                                
                                                
                                                   N
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∂
                              Ω
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    F
                                 
                              
                              ∪
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    F
                                 
                              
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    M
                                 
                              
                              ∪
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    M
                                 
                              
                           
                         and, in general we do not require that 
                           
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    F
                                 
                              
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                                 
                                    M
                                 
                              
                           
                         or 
                           
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    F
                                 
                              
                              =
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                 
                                 
                                    M
                                 
                              
                           
                        . The difference between the homogeneous isotropic conducting fluid and a magnetostrictive conducting fluid is that, the Neumann boundary for the fluid domain contains the total stress tensor, which is more realistic at describing the actual physics since, in real experiments, terms making up the contributions to the applied traction cannot be identified separately.

If 
                           
                              Ω
                           
                         consists of a series of non-overlapping regions such that 
                           
                              Ω
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    1
                                 
                              
                              ∪
                              
                                 
                                    Ω
                                 
                                 
                                    2
                                 
                              
                              ∪
                              ⋯
                           
                         then, at the interfaces between different materials, 
                           
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                              ∩
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    j
                                 
                              
                           
                        , the following conditions are required to hold
                           
                              
                                 v
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 v
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 (
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 ]
                                 ]
                                 +
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 )
                                 n
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 (
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 ]
                                 ]
                                 +
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 )
                                 n
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 n
                                 ×
                                 H
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 n
                                 ×
                                 H
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 n
                                 ×
                                 (
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 +
                                 v
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 n
                                 ×
                                 (
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 +
                                 v
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 
                                    
                                       |
                                    
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In this section, we present the linearised schemes for both homogeneous isotropic conducting and magnetostrictive conducting fluids. Once the linearised schemes have been established by computing directional derivatives, the Newton–Raphson is applied and the resulting algorithms are summarised in Algorithms 1 and 2.

We begin by following the treatment described in Section 2.1. Associated with (7), we define for the weak solutions 
                           
                              (
                              v
                              ,
                              
                                 
                                    p
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              H
                              ,
                              r
                              )
                              ∈
                              W
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                         the associated residuals 
                           
                              
                                 
                                    R
                                 
                                 
                                    v
                                 
                              
                              ,
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    R
                                 
                                 
                                    H
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    r
                                 
                              
                           
                         as
                           
                              (13a)
                              
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ̂
                                    
                                 
                                 ,
                                 H
                                 )
                                 :
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 ρ
                                 (
                                 ∇
                                 v
                                 )
                                 v
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 ]
                                 ]
                                 :
                                 [
                                 [
                                 ε
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 )
                                 ]
                                 ]
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ×
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 ·
                                 ∇
                                 ×
                                 H
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             N
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 ∂
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (13b)
                              
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 )
                                 
                                 ≔
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 v
                                 )
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (13c)
                              
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 H
                                 ,
                                 r
                                 )
                                 :
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 v
                                 ×
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 ∇
                                 r
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 g
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             N
                                          
                                          
                                             M
                                          
                                       
                                    
                                 
                                 f
                                 
                                    
                                    
                                       N
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 ∂
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (13d)
                              
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 H
                                 )
                                 :
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 H
                                 ·
                                 ∇
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         where, following [36], we have
                           
                              
                                 W
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       D
                                    
                                 
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          v
                                          ∈
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                Ω
                                                )
                                                )
                                             
                                             
                                                d
                                             
                                          
                                          :
                                          v
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                D
                                             
                                          
                                          
                                          on
                                          
                                          ∂
                                          Ω
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 Z
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̂
                                             
                                          
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Ω
                                          )
                                          :
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                ̂
                                             
                                          
                                          
                                          d
                                          Ω
                                          =
                                          0
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 Y
                                 (
                                 f
                                 
                                    
                                    
                                       D
                                    
                                 
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          H
                                          ∈
                                          H
                                          (
                                          curl,
                                          Ω
                                          )
                                          :
                                          n
                                          ×
                                          H
                                          =
                                          f
                                          
                                             
                                             
                                                D
                                             
                                          
                                          
                                          on
                                          
                                          ∂
                                          Ω
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 X
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          r
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Ω
                                          )
                                          :
                                          r
                                          =
                                          0
                                          
                                          on
                                          
                                          ∂
                                          Ω
                                       
                                    
                                 
                                 .
                              
                           
                        In the above 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              (
                              Ω
                              )
                              ,
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              ,
                              H
                              (
                              curl,
                              Ω
                              )
                           
                         have their usual meanings (e.g. [7]) and we denote by 
                           
                              
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 
                                    Ω
                                 
                              
                              :
                              =
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              u
                              ·
                              v
                              
                              d
                              Ω
                           
                         the standard 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         inner product and by 
                           
                              ‖
                              u
                              
                                 
                                    ‖
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              :
                              =
                              
                                 
                                    (
                                    u
                                    ,
                                    u
                                    )
                                 
                                 
                                    Ω
                                 
                                 
                                    -
                                    1
                                    /
                                    2
                                 
                              
                           
                         the 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         norm. In addition, we associate the corresponding 
                           
                              ‖
                              u
                              
                                 
                                    ‖
                                 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              :
                              =
                              
                                 
                                    (
                                    ‖
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    ‖
                                    ∇
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                           
                         and 
                           
                              ‖
                              u
                              
                                 
                                    ‖
                                 
                                 
                                    H
                                    (
                                    curl
                                    )
                                 
                              
                              :
                              =
                              
                                 
                                    (
                                    ‖
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    ‖
                                    ∇
                                    ×
                                    u
                                    
                                       
                                          ‖
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                           
                         norms.

The residuals given in (13) are obtained by weighting Eq. (7) with the weights 
                           
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                           
                         and performing integration by parts. Notice that all boundary terms disappear for the pure Dirichlet case.

We remark that it is necessary to add the criteria that 
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    ̂
                                 
                              
                              
                              d
                              Ω
                              =
                              0
                           
                         in Z in order to ensure uniqueness of the pressure field when dealing with pure Dirichlet boundary conditions for 
                           
                              v
                           
                         
                        [37].

With an iterative solution approach in mind, we consider possible trial solutions 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                         and linearise the residuals (13) as follows
                           
                              (14a)
                              
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (14b)
                              
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 D
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (14c)
                              
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (14d)
                              
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       DR
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         with update equations
                           
                              (15a)
                              
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       +
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15b)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       +
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15c)
                              
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       +
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15d)
                              
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       +
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 .
                              
                           
                        
                     

The directional derivatives can be computed as
                           
                              (16a)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 ∇
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 :
                                 ∇
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 (
                                 ∇
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 )
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 ρ
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 ∇
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       ρ
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             v
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       ·
                                       ∇
                                       
                                          
                                             v
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       )
                                       ·
                                       
                                          
                                             v
                                          
                                          
                                             δ
                                          
                                       
                                       
                                       d
                                       Ω
                                    
                                    
                                       ̲
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (16b)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 )
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (16c)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             δ
                                          
                                       
                                       ×
                                       [
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             r
                                          
                                       
                                       ]
                                       ]
                                       
                                          
                                             δ
                                          
                                          
                                             H
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       )
                                       ·
                                       ∇
                                       ×
                                       
                                          
                                             H
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       
                                       d
                                       Ω
                                    
                                    
                                       ̲
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (16d)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (16e)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 H
                                 ,
                                 r
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       ×
                                       (
                                       [
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             r
                                          
                                       
                                       ]
                                       ]
                                       
                                          
                                             δ
                                          
                                          
                                             H
                                          
                                          
                                             [
                                             m
                                             ]
                                          
                                       
                                       )
                                       ·
                                       ∇
                                       ×
                                       
                                          
                                             H
                                          
                                          
                                             δ
                                          
                                       
                                       
                                       d
                                       Ω
                                    
                                    
                                       ̲
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (16f)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 H
                                 ,
                                 r
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (16g)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 H
                                 ,
                                 r
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 ∇
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (16h)
                              
                                 
                                    
                                       DR
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 H
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 ∇
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 .
                              
                           
                        where certain terms have been highlighted for later reference. Assuming the solutions 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                           
                         to be known, and associating the bilinear forms 
                           
                              
                                 
                                    C
                                 
                                 
                                    vv
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    v
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    vH
                                 
                              
                           
                        , 
                           
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    v
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    HH
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    Hv
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    Hr
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    rH
                                 
                              
                           
                         in turn with the directional derivatives stated above, the Newton–Raphson iteration can be stated as: Find 
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         such that
                           
                              (17a)
                              
                                 
                                    
                                       C
                                    
                                    
                                       vv
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       v
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       vH
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (17b)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (17c)
                              
                                 
                                    
                                       C
                                    
                                    
                                       HH
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       Hv
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       Hr
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (17d)
                              
                                 
                                    
                                       C
                                    
                                    
                                       rH
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 .
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         with 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                        .

Note that, by neglecting terms with an underline in (16) the simplified Picard iterative scheme can be obtained [36]. This scheme is fully symmetric with 
                           
                              
                                 
                                    C
                                 
                                 
                                    vH
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    Hv
                                 
                              
                              (
                              
                                 
                                    δ
                                 
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              )
                           
                        , in addition to the already symmetric terms 
                           
                              
                                 
                                    C
                                 
                                 
                                    v
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    v
                                 
                              
                              (
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    Hr
                                 
                              
                              (
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    rH
                                 
                              
                              (
                              
                                 
                                    δ
                                 
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              )
                           
                        . The Newton–Raphson scheme for a homogeneous fluid can be summarised as shown in Algorithm 1.
                           Algorithm 1
                           Newton–Raphson scheme for a homogeneous isotropic conducting fluid. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                 for 
                                                   
                                                      m
                                                      =
                                                      0
                                                   
                                                 and TOL
                                             
                                          
                                          
                                             
                                                1: while 
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ,
                                                      ‖
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ,
                                                      ‖
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                   
                                                 and 
                                                   
                                                      ‖
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ⩾
                                                      TOL
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                2: Solve the linear system of Eq. (17) 
                                                
                                                   
                                                      →
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                3: Record the residual for step 
                                                   
                                                      m
                                                      →
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                4: Update the solution with Eq. (15) 
                                                
                                                   
                                                      →
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                5: 
                                                
                                                   
                                                      m
                                                      ←
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                6: end while
                                             
                                          
                                          
                                             
                                                7: return 
                                                
                                                   
                                                      v
                                                      ←
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      H
                                                      ←
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      r
                                                      ←
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In this section we consider the extension of Section 3.1 to more complex magnetostrictive fluids. In order to achieve this we follow Section 2.2 and our own presentation in [26]. In this case, associated with (7), we define for the weak solutions 
                           
                              (
                              v
                              ,
                              
                                 
                                    p
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              H
                              ,
                              r
                              )
                              ∈
                              W
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                         the associated residuals 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    v
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    H
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                           
                         as
                           
                              (18a)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ̂
                                    
                                 
                                 ,
                                 H
                                 )
                                 
                                 ≔
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 ρ
                                 (
                                 ∇
                                 v
                                 )
                                 v
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       F
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 :
                                 [
                                 [
                                 ε
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 )
                                 ]
                                 ]
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             N
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 ∂
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (18b)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 )
                                 
                                 ≔
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 v
                                 )
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (18c)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 v
                                 ,
                                 H
                                 ,
                                 r
                                 )
                                 :
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 H
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 v
                                 ×
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 ]
                                 H
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 ]
                                 ∇
                                 r
                                 )
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 g
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             N
                                          
                                          
                                             M
                                          
                                       
                                    
                                 
                                 f
                                 
                                    
                                    
                                       N
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 ∂
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (18d)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 H
                                 ,
                                 v
                                 )
                                 :
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 ]
                                 H
                                 )
                                 ·
                                 ∇
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                        . Note that in the case of non-pure Dirichlet conditions the constraint of 
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    ̂
                                 
                              
                              
                              d
                              Ω
                              =
                              0
                           
                         in Z can also be dropped.

Analogue to the previous section, with the possible trial solutions 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    ̃
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                        , the linearised residuals (18) can be written as follows
                           
                              (19a)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (19b)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (19c)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (19d)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 +
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    ̃
                                 
                              
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              
                                 
                                    Y
                                 
                                 
                                    ̃
                                 
                              
                              (
                              0
                              )
                              ×
                              X
                           
                         with similar update equations to (15).

The directional derivatives are
                           
                              (20a)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (20b)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       DR
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (20c)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 ε
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 )
                                 ]
                                 ]
                                 :
                                 
                                    
                                       ∂
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             EM
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       ∂
                                       H
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (20d)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       DR
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              (20e)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∇
                                 ×
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ×
                                 (
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ]
                                 ]
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (20f)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ×
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ]
                                 ]
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                (
                                                [
                                                [
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ]
                                                ]
                                                H
                                                )
                                             
                                             
                                                ∂
                                                [
                                                [
                                                ε
                                                ]
                                                ]
                                             
                                          
                                          :
                                          [
                                          [
                                          ε
                                          (
                                          
                                             
                                                δ
                                             
                                             
                                                v
                                             
                                             
                                                [
                                                m
                                                ]
                                             
                                          
                                          )
                                          ]
                                          ]
                                       
                                    
                                 
                                 ·
                                 ∇
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (20g)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ]
                                 ]
                                 ∇
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (20h)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 ∇
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ·
                                 
                                    
                                       ∂
                                       (
                                       [
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             r
                                          
                                       
                                       ]
                                       ]
                                       H
                                       )
                                    
                                    
                                       ∂
                                       [
                                       [
                                       ε
                                       ]
                                       ]
                                    
                                 
                                 :
                                 [
                                 [
                                 ε
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ]
                                 ]
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        
                        
                           
                              (20i)
                              
                                 D
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 [
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ]
                                 ]
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ·
                                 ∇
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 
                                 d
                                 Ω
                                 .
                              
                           
                        In the above
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   [
                                                   [
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         EM
                                                      
                                                   
                                                   ]
                                                   ]
                                                
                                                
                                                   ∂
                                                   H
                                                
                                             
                                          
                                       
                                    
                                    
                                       ijk
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ik
                                             
                                          
                                          
                                             
                                                H
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                δ
                                             
                                             
                                                jk
                                             
                                          
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   (
                                                   [
                                                   [
                                                   μ
                                                   ]
                                                   ]
                                                   H
                                                   )
                                                
                                                
                                                   ∂
                                                   [
                                                   [
                                                   ε
                                                   ]
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                    
                                       ijk
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 )
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 
                                    
                                       δ
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        Assuming the solutions 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                           
                         to be known, and associating the bilinear forms 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    vH
                                 
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    HH
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    Hv
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    Hr
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    rv
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    rH
                                 
                              
                           
                         in turn with the new directional derivatives stated above, the Newton–Raphson iteration can be stated as: Find 
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    v
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    r
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         such that
                           
                              (21a)
                              
                                 
                                    
                                       C
                                    
                                    
                                       vv
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       v
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       vH
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21b)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21c)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       HH
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       Hv
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       Hr
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21d)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       rv
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 .
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              0
                              )
                              ×
                              X
                           
                         with 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    [
                                    0
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              
                                 
                                    v
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              Z
                              ×
                              Y
                              (
                              f
                              
                                 
                                 
                                    D
                                 
                              
                              )
                              ×
                              X
                           
                        . Note that this reduces to (17) for a homogeneous isotropic conducting fluid without magnetostrictive effects. The Newton–Raphson scheme for a magnetostrictive material can be summarised as shown in Algorithm 2.
                           Algorithm 2
                           Newton–Raphson scheme for a magnetostrictive fluid. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                 for 
                                                   
                                                      m
                                                      =
                                                      0
                                                   
                                                 and TOL
                                             
                                          
                                          
                                             
                                                1: while 
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ,
                                                      ‖
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ,
                                                      ‖
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                   
                                                 and 
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      ‖
                                                      ⩾
                                                      TOL
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                2: Solve the linear system of Eq. (21) 
                                                
                                                   
                                                      →
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                3: Record the residual for step 
                                                   
                                                      m
                                                      →
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                4: Update the solution with Eq. (15) 
                                                
                                                   
                                                      →
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                5: 
                                                
                                                   
                                                      m
                                                      ←
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                6: end while
                                             
                                          
                                          
                                             
                                                7: return 
                                                
                                                   
                                                      v
                                                      ←
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ̂
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      H
                                                      ←
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                      ,
                                                      r
                                                      ←
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            [
                                                            m
                                                            +
                                                            1
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The hp-finite element discretisation of (17) and (21) follows similar lines to that already discussed in [17,26], where we employ the hp-finite element discretisation of Schöberl and Zaglmayr [35,40]. In the following, we discuss the discretisation for an unstructured tetrahedral discretisation for 
                        
                           d
                           =
                           3
                        
                     , the corresponding triangular discretisation for 
                        
                           d
                           =
                           2
                        
                      follows mostly by obvious simplifications. For this we consider a regular simplicial triangulation of 
                        
                           Ω
                        
                      denoted by 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                     , with the set of vertices 
                        
                           
                              
                                 V
                              
                              
                                 h
                              
                           
                        
                     , the set of edges 
                        
                           
                              
                                 E
                              
                              
                                 h
                              
                           
                        
                      and the set of faces 
                        
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                        
                      and recall the low-order vertex, high-order edge-face-cell based splitting of the hierarchic scalar 
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        
                      conforming finite element space
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                    ,
                                    p
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    X
                                 
                                 
                                    h
                                    ,
                                    1
                                 
                              
                              
                              ⊕
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       edges
                                       
                                       E
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    p
                                 
                                 
                                    E
                                 
                              
                              
                              ⊕
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       faces
                                       
                                       F
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    p
                                 
                                 
                                    F
                                 
                              
                              
                              ⊕
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       cells
                                       
                                       I
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    p
                                 
                                 
                                    I
                                 
                              
                              
                              ⊂
                              
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              (
                              Ω
                              )
                              ,
                           
                        
                     where 
                        
                           
                              
                                 X
                              
                              
                                 h
                                 ,
                                 1
                              
                           
                        
                      is the classical space of continuous piecewise linear hat functions and 
                        
                           
                              
                                 X
                              
                              
                                 p
                              
                              
                                 E
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 p
                              
                              
                                 F
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 p
                              
                              
                                 I
                              
                           
                        
                      denote its hierarchic edge, face and cell enrichment. In the case of a uniform polynomial degree we obtain the space of polynomials of total degree p, i.e. 
                        
                           
                              
                                 X
                              
                              
                                 h
                                 ,
                                 p
                              
                           
                           
                              
                                 |
                              
                              
                                 T
                              
                           
                           
                           ≔
                           
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                           (
                           T
                           )
                        
                      on each element 
                        
                           T
                           ∈
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                      employed. For problems in this work we require a discretisation of the vector 
                        
                           H
                           (
                           curl
                           )
                        
                      conforming space, employing the approach of Schöberl and Zaglmayr [35,40] this results in the splitting low order edge, high order edge-face-cell based splitting
                        
                           
                              Y
                              
                                 
                                 
                                    h
                                    ,
                                    p
                                 
                              
                              
                              ≔
                              
                              Y
                              
                                 
                                 
                                    h
                                    ,
                                    0
                                 
                              
                              ⊕
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       edges
                                       
                                       E
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              Y
                              
                                 
                                 
                                    p
                                 
                                 
                                    E
                                 
                              
                              ⊕
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       faces
                                       
                                       F
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              Y
                              
                                 
                                 
                                    p
                                 
                                 
                                    F
                                 
                              
                              ⊕
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       cells
                                       
                                       I
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              Y
                              
                                 
                                 
                                    p
                                 
                                 
                                    I
                                 
                              
                              ⊂
                              H
                              (
                              curl,
                              Ω
                              )
                              ,
                           
                        
                     where 
                        
                           Y
                           
                              
                              
                                 h
                                 ,
                                 0
                              
                           
                        
                      is the classical Nédélec element with continuous constant tangential components on edges and 
                        
                           Y
                           
                              
                              
                                 p
                              
                              
                                 E
                              
                           
                           ,
                           Y
                           
                              
                              
                                 p
                              
                              
                                 F
                              
                           
                           ,
                           Y
                           
                              
                              
                                 p
                              
                              
                                 I
                              
                           
                        
                      denote its hierarchic edge, face and cell enrichment. In addition, we set
                        
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                    ,
                                    p
                                 
                              
                              :
                              =
                              {
                              v
                              :
                              v
                              ∈
                              
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          h
                                          ,
                                          p
                                       
                                    
                                    )
                                 
                                 
                                    3
                                 
                              
                              }
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    Z
                                 
                                 
                                    h
                                    ,
                                    p
                                    -
                                    1
                                 
                              
                              :
                              =
                              
                                 
                                    Z
                                 
                                 
                                    h
                                    ,
                                    0
                                 
                              
                              ⊕
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       cells
                                       
                                       I
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    p
                                    -
                                    1
                                 
                                 
                                    I
                                 
                              
                              ⊂
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              ,
                           
                        
                     where 
                        
                           
                              
                                 Z
                              
                              
                                 h
                                 ,
                                 0
                              
                           
                        
                      is the space of classical scalar finite element space of piecewise constants. We present below the fully discretised version of (17), which must be solved at each Newton–Raphson iteration for a simple conducting fluid. Then, in Section 4.2, we present the corresponding discretised version of (21) for the case of a conducting magnetostrictive fluid.

The mth step of the discrete Newton–Raphson scheme for this fluid in 
                           
                              d
                              =
                              3
                           
                         is: Find 
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    v
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    H
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    r
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ∩
                              
                                 
                                    W
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                              ×
                              Z
                              ∩
                              
                                 
                                    Z
                                 
                                 
                                    hp
                                    -
                                    1
                                 
                              
                              ×
                              Y
                              (
                              0
                              )
                              ∩
                              Y
                              
                                 
                                 
                                    hp
                                    +
                                    1
                                 
                              
                              ×
                              X
                              ∩
                              
                                 
                                    X
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                           
                         such that
                           
                              (22a)
                              
                                 
                                    
                                       C
                                    
                                    
                                       vv
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       v
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       vH
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (22b)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (22c)
                              
                                 
                                    
                                       C
                                    
                                    
                                       HH
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       Hv
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       Hr
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (22d)
                              
                                 
                                    
                                       C
                                    
                                    
                                       rH
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 .
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ∩
                              
                                 
                                    W
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                              ×
                              Z
                              ∩
                              
                                 
                                    Z
                                 
                                 
                                    hp
                                    -
                                    1
                                 
                              
                              ×
                              Y
                              (
                              0
                              )
                              ∩
                              Y
                              
                                 
                                 
                                    hp
                                    +
                                    1
                                 
                              
                              ×
                              X
                              ∩
                              
                                 
                                    X
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                           
                        . The update equations are similar to those given in (15). It is important to note the need to use different sets of basis functions for the different fields but, also, the need to use different polynomial degrees. For 
                           
                              d
                              =
                              2
                           
                         triangular elements, the updates of velocity 
                           
                              
                                 
                                    δ
                                 
                                 
                                    v
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         and pressure 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         are approximated as polynomials of degree 
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    p
                                    -
                                    2
                                 
                              
                           
                         in order to satisfy the LBB condition [37]. For 
                           
                              d
                              =
                              3
                           
                        , the updates of velocity 
                           
                              
                                 
                                    δ
                                 
                                 
                                    v
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         and pressure 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         are approximated as polynomials of degree 
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    p
                                    -
                                    3
                                 
                              
                           
                         in order to satisfy the LBB condition for tetrahedral elements for this case [8,37]. The updates of the magnetic field 
                           
                              
                                 
                                    δ
                                 
                                 
                                    H
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         and the Lagrange multiplier 
                           
                              
                                 
                                    δ
                                 
                                 
                                    r
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                           
                         are selected to be 
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           
                         for both 
                           
                              d
                              =
                              2
                           
                         and 
                           
                              d
                              =
                              3
                           
                         
                        [8].

The mth step of the discrete Newton–Raphson scheme for a conducting fluid including magnetostrictive effects in 
                           
                              d
                              =
                              3
                           
                         is: Find 
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    v
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    H
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    r
                                    ,
                                    hp
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ∩
                              
                                 
                                    W
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                              ×
                              Z
                              ∩
                              
                                 
                                    Z
                                 
                                 
                                    hp
                                    -
                                    1
                                 
                              
                              ×
                              Y
                              (
                              0
                              )
                              ∩
                              Y
                              
                                 
                                 
                                    hp
                                    +
                                    1
                                 
                              
                              ×
                              X
                              ∩
                              
                                 
                                    X
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                           
                         such that
                           
                              (23a)
                              
                                 
                                    
                                       C
                                    
                                    
                                       vv
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       v
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       vH
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (23b)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ]
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (23c)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       HH
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       Hv
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       Hr
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (23d)
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       rv
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       hp
                                    
                                    
                                       δ
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       δ
                                    
                                 
                                 ;
                                 
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 )
                                 ,
                              
                           
                        for all 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    hp
                                 
                                 
                                    δ
                                 
                              
                              )
                              ∈
                              W
                              (
                              0
                              )
                              ∩
                              
                                 
                                    W
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                              ×
                              Z
                              ∩
                              
                                 
                                    Z
                                 
                                 
                                    hp
                                    -
                                    1
                                 
                              
                              ×
                              Y
                              (
                              0
                              )
                              ∩
                              Y
                              
                                 
                                 
                                    hp
                                    +
                                    1
                                 
                              
                              ×
                              X
                              ∩
                              
                                 
                                    X
                                 
                                 
                                    hp
                                    +
                                    2
                                 
                              
                           
                        . In the above, terms with a tilde are different from those in (22), which have been constructed in order to include magntostrictive effects, but do reduce to their previous forms in the case of a homogeneous isotropic conducting fluid. The polynomial orders are taken as described in Section 4.1.

A series of numerical examples are presented to benchmark our approach by applying it to the simulation of MHD problems in 
                        
                           d
                           =
                           2
                           ,
                           3
                        
                      with known analytical solutions. Then, the predictive capability of our approach is considered by applying it to the simulation of problems in 
                        
                           d
                           =
                           2
                           ,
                           3
                        
                     , which include non-homogeneous media and magnetostrictive effects, that do not have analytical solutions.

In order to verify the 
                           
                              d
                              =
                              2
                           
                         implementation, we apply the scheme to several well-known benchmarking problems. We start from a simplified linearised case with smooth and singular solutions. We then progress to the fully coupled problem, where a smooth problem and the well known Hartmann flow problem [18,9,15] are used for verification.

The first example consists of an L-shaped domain 
                              
                                 Ω
                                 =
                                 
                                    
                                       (
                                       -
                                       1
                                       ,
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ⧹
                                 (
                                 [
                                 0
                                 ,
                                 1
                                 )
                                 ×
                                 (
                                 -
                                 1
                                 ,
                                 0
                                 ]
                                 )
                              
                            on which we consider the solution of a linearised MHD problem [36] by considering 
                              
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 =
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 [
                                 [
                                 I
                                 ]
                                 ]
                              
                            and 
                              
                                 ρ
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 =
                                 1
                              
                           . For this linearised problem, only a single step of the Picard iteration scheme is required for which we set
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          H
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   
                                                      -
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    in
                                    
                                    Ω
                                    ,
                                 
                              
                           and choose 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            and 
                              
                                 g
                              
                            so that the analytical solution is [23]
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      v
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  -
                                                                  (
                                                                  y
                                                                  cos
                                                                  y
                                                                  +
                                                                  sin
                                                                  y
                                                                  )
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                                  sin
                                                                  
                                                                     
                                                                        ye
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                   
                                                
                                                =
                                                2
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      x
                                                   
                                                
                                                sin
                                                y
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      H
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  -
                                                                  (
                                                                  y
                                                                  cos
                                                                  y
                                                                  +
                                                                  sin
                                                                  y
                                                                  )
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                                  sin
                                                                  
                                                                     
                                                                        ye
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                =
                                                -
                                                sin
                                                π
                                                x
                                                
                                                sin
                                                π
                                                y
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           in 
                              
                                 Ω
                              
                           . Then, the boundary conditions are different to those in Algorithm 1 and are of the form 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                 
                              
                            on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            and 
                              
                                 n
                                 ×
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                 
                              
                            on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                           . As the analytical solution is smooth, we consider a fixed uniform mesh consisting of 382 triangular elements and apply uniform p-refinement with polynomial degrees 
                              
                                 p
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 6
                              
                           , where p refers to the degree of the 
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                              
                            conforming approximation and the degrees of the approximation for the other variables are chosen to satisfy the LBB constraints (see Section 4.1). Unless otherwise stated, we follow this convention for naming p in each of the following examples.

In Fig. 2
                           (a) we show the convergence of 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                           , which both indicate a downward sloping curve confirming the expected exponential convergence of p-refinement for this smooth problem. In Fig. 2(b) we show the computed streamlines for 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                              
                            for the converged solution.

We again consider the L-shaped domain described in the previous subsection for the linearised MHD problem with the same material parameters as described above. Let us consider a single step of the Picard iteration with
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          H
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    in
                                    
                                    Ω
                                    ,
                                 
                              
                           and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            and 
                              
                                 g
                              
                            selected so that the analytical solution is [23]
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      v
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ρ
                                                                           
                                                                           
                                                                              ̂
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        λ
                                                                     
                                                                  
                                                                  (
                                                                  (
                                                                  1
                                                                  +
                                                                  λ
                                                                  )
                                                                  sin
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  ψ
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  +
                                                                  cos
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  
                                                                     
                                                                        ψ
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ρ
                                                                           
                                                                           
                                                                              ̂
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        λ
                                                                     
                                                                  
                                                                  (
                                                                  -
                                                                  (
                                                                  1
                                                                  +
                                                                  λ
                                                                  )
                                                                  cos
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  ψ
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  +
                                                                  sin
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  
                                                                     
                                                                        ψ
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  (
                                                                  ϕ
                                                                  )
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                   
                                                
                                                =
                                                -
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                   
                                                   
                                                      λ
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      λ
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                ϕ
                                                )
                                                +
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      ‴
                                                   
                                                
                                                (
                                                ϕ
                                                )
                                                )
                                                /
                                                (
                                                1
                                                -
                                                λ
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      H
                                                   
                                                
                                                =
                                                ∇
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      /
                                                      3
                                                   
                                                
                                                sin
                                                (
                                                2
                                                /
                                                3
                                                ϕ
                                                )
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                       
                                    
                                 
                              
                           in 
                              
                                 Ω
                              
                            where
                              
                                 (26)
                                 
                                    ψ
                                    (
                                    ϕ
                                    )
                                    =
                                    sin
                                    (
                                    (
                                    1
                                    +
                                    λ
                                    )
                                    ϕ
                                    )
                                    cos
                                    (
                                    λ
                                    w
                                    )
                                    /
                                    (
                                    1
                                    +
                                    λ
                                    )
                                    -
                                    cos
                                    (
                                    (
                                    1
                                    +
                                    λ
                                    )
                                    ϕ
                                    )
                                    -
                                    sin
                                    (
                                    (
                                    1
                                    -
                                    λ
                                    )
                                    ϕ
                                    )
                                    cos
                                    (
                                    λ
                                    w
                                    )
                                    /
                                    (
                                    1
                                    -
                                    λ
                                    )
                                    +
                                    cos
                                    (
                                    (
                                    1
                                    -
                                    λ
                                    )
                                    ϕ
                                    )
                                    .
                                 
                              
                           In the above 
                              
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       ̂
                                    
                                 
                                 ,
                                 ϕ
                                 )
                              
                            represent the polar coordinates centred at 
                              
                                 x
                                 =
                                 0
                                 ,
                                 y
                                 =
                                 0
                              
                            and, for the case where 
                              
                                 ω
                                 =
                                 
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 π
                              
                            and 
                              
                                 λ
                                 ≈
                                 0.54448373678246
                              
                           , the analytical solution exhibits a strong magnetic singularity at the origin [23]. The boundary conditions are analogous to Section 5.1.1.

A series of meshes are constructed with geometric refinement towards the re-entrant corner (and the location of singularity), the geometric refinement factors are 
                              
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                              
                            and 6, respectively. Illustrations of typical meshes with grading factors 3 and 6, and 176 and 308 unstructured triangles, respectively, are shown in Fig. 3
                           .

On these meshes we apply uniform p-refinement with polynomial degrees 
                              
                                 p
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 6
                              
                            leading to the results shown in Fig. 4
                           (a) where the convergence of 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                            can be observed. As expected, a family of convergence curves are produced and each show a similar behaviour: initially p-refinement on particular grid produces a rapid convergence of the error, which then slows to an algebraic rate of convergence with further increments of p. By combining both h- and p-refinements the resulting error envelope is a downward sloping curve, confirming the expected exponential convergence for this problem with a strong singularity. Fig. 4(b) shows the computed streamlines for 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                              
                            for the converged solution. In Fig. 4(c) and (d), the computed contours for the x and y components of 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                              
                           , for the converged solution, are presented from which we can observe the strong singularity towards the re-entrant corner.

A fully coupled non-linear MHD problem with a known smooth analytical solution can be found in several references such as [18,9]. We use the former for benchmarking our fully coupled Newton–Raphson implementation summarised in Algorithm 1. The geometry consists of a square domain 
                              
                                 Ω
                                 =
                                 
                                    
                                       (
                                       -
                                       1
                                       ,
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           , and we construct the problem by setting the parameters as 
                              
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                                 =
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 c
                                 
                                    
                                       [
                                       [
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       ]
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       4
                                    
                                 
                              
                            and 
                              
                                 ρ
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 =
                                 1
                              
                           . The source terms 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 ,
                                 g
                              
                            are chosen so that the analytical solution is
                              
                                 (27)
                                 
                                    
                                       
                                          
                                          
                                             
                                                v
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                                =
                                                x
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                H
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  -
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                r
                                                =
                                                (
                                                1
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                (
                                                1
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           in 
                              
                                 Ω
                              
                            and the Dirichlet boundary conditions 
                              
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 v
                              
                            on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            and 
                              
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 H
                              
                            on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            are applied. From (27), we can deduce that, of the different fields, r is of the highest polynomial degree being bi-quadratic and, for triangular elements, this means that 
                              
                                 p
                                 =
                                 4
                              
                            
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                              
                            conforming elements are required to fully capture this field. Although 
                              
                                 H
                              
                            and 
                              
                                 v
                              
                            are quadratic functions, which can be captured with 
                              
                                 p
                                 =
                                 2
                              
                            
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                              
                            conforming and 
                              
                                 p
                                 =
                                 2
                              
                            
                           
                              
                                 H
                                 (
                                 curl
                                 )
                              
                            conforming elements, respectively, we expect that, due to the coupled nature of the problem, these fields will not be fully resolved until the degree is 
                              
                                 p
                                 =
                                 4
                              
                            (using our earlier naming convention).

For the fully coupled smooth problem, we consider performing hp-refinement with elements of uniform size 
                              
                                 h
                                 =
                                 0.6
                                 ,
                                 0.3
                                 ,
                                 0.15
                                 ,
                                 0.075
                              
                           , the finest mesh having 2048 unstructured triangular elements. Uniform p-refinement is applied with polynomial degrees 
                              
                                 p
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                              
                           , where the last p increment represents an intentional overkill to test the implementation.

In Fig. 5
                           (a) we show the computed quadratic convergence for updates 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                              
                            and the relative residual 
                              
                                 R
                                 =
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ‖
                                 /
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ‖
                              
                            for 
                              
                                 p
                                 =
                                 5
                              
                            elements, which implies the correct implementation of the Newton–Raphson method. Then, in Fig. 5(b) we show the convergence of hp-refinement for 
                              
                                 ‖
                                 v
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 ‖
                                 
                                    
                                       p
                                    
                                    
                                       ̂
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 H
                                 -
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                            with 
                              
                                 m
                                 =
                                 M
                              
                           , such that 
                              
                                 R
                                 ⩽
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       10
                                    
                                 
                              
                           , which indicate a downward sloping curve confirming the expected exponential convergence of p-refinement for each of the meshes considered. Note that, unless otherwise stated, this Newton–Raphson convergence criteria will be used in the following. As the analytical solution for r is bi-quadratic, the p-refinement should converge to machine precision with 
                              
                                 p
                                 =
                                 4
                              
                            for this problem, which is exactly exhibited in the figure.

The description of the 
                              
                                 d
                                 =
                                 2
                              
                            Hartmann flow problem can be found in [18,9] and this allows us to further benchmark our full Newton–Raphson scheme as the resulting solution satisfies both the linearised and the non-linear MHD equations. For this problem, the domain is set to be 
                              
                                 Ω
                                 =
                                 (
                                 0
                                 ,
                                 L
                                 )
                                 ×
                                 (
                                 -
                                 1
                                 ,
                                 1
                                 )
                              
                            with 
                              
                                 L
                                 ≫
                                 1
                              
                           , for which we choose 
                              
                                 L
                                 =
                                 10
                              
                           . The analytical solution corresponds to an unidirectional flow under constant pressure gradient 
                              
                                 -
                                 G
                              
                            in the x-direction with 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 g
                                 =
                                 0
                              
                           . In order to apply our scheme to the reference non-dimensional Hartmann flow problem, we set the parameters as 
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 =
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 ν
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 /
                                 ρ
                                 =
                                 0.1
                                 ,
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 ]
                                 ]
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 c
                                 /
                                 ρ
                                 =
                                 0.1
                                 ,
                                 Ha
                                 =
                                 10
                                 ,
                                 G
                                 =
                                 0.5
                                 ,
                                 ρ
                                 =
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 10
                              
                           . The analytical solution to this problem then corresponds to
                              
                                 (28)
                                 
                                    v
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            μ
                                                            ν
                                                            Ha
                                                            tanh
                                                            (
                                                            Ha
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                               -
                                                               
                                                                  
                                                                     cosh
                                                                     (
                                                                     yHa
                                                                     )
                                                                  
                                                                  
                                                                     cosh
                                                                     (
                                                                     Ha
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    H
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ρ
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     sinh
                                                                     (
                                                                     yHa
                                                                     )
                                                                  
                                                                  
                                                                     sinh
                                                                     (
                                                                     Ha
                                                                     )
                                                                  
                                                               
                                                               -
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̂
                                       
                                    
                                    =
                                    -
                                    Gx
                                    -
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          ρ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      sinh
                                                      (
                                                      yHa
                                                      )
                                                   
                                                   
                                                      sinh
                                                      (
                                                      Ha
                                                      )
                                                   
                                                
                                                -
                                                y
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    r
                                    =
                                    0
                                    .
                                 
                              
                           in 
                              
                                 Ω
                              
                           . We set 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                              
                            to be the boundaries corresponding to 
                              
                                 (
                                 0
                                 ,
                                 y
                                 )
                                 ,
                                 y
                                 ∈
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                            and 
                              
                                 (
                                 x
                                 ,
                                 ±
                                 1
                                 )
                                 ,
                                 x
                                 ∈
                                 (
                                 0
                                 ,
                                 L
                                 )
                              
                            and here we prescribe 
                              
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 v
                              
                            and we set 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            and 
                              
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 H
                              
                           , while on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 ∂
                                 Ω
                                 ⧹
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                              
                           , we prescribe 
                              
                                 
                                    
                                       t
                                    
                                    
                                       hp
                                    
                                 
                                 =
                                 t
                                 =
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 n
                              
                            (free velocity boundary), based on the above analytical solution.

As the analytical solution is smooth for this low Hartmann number, a single mesh consisting of 400 triangular elements is employed. On this mesh we consider both the linearised one step Picard [23] and the fully coupled non-linear Newton–Raphson schemes. For the one-step Picard scheme we solve the linearised problem, as described in [23], and for the Newton–Raphson scheme we apply Algorithm 1. In both cases, we apply uniform p-refinement with polynomial degrees 
                              
                                 p
                                 =
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 6
                                 ,
                                 7
                              
                            and show, in Fig. 6
                           (a), the typical quadratic convergence of the relative residual 
                              
                                 R
                                 =
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ‖
                                 /
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       H
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       r
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ‖
                              
                            for the Newton–Raphson iterations when uniform 
                              
                                 p
                                 =
                                 7
                              
                            elements are used. In Fig. 6(b), we show the convergence of 
                              
                                 ‖
                                 v
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 H
                                 -
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                            where M denotes the iteration of the converged solution for Newton–Raphson scheme and 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       H
                                       ,
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                            for the one-step Picard. Fig. 6(b), indicates that both schemes converge exponentially fast with p-refinement to the analytical solution.

Subsequently, we have considered the convergence of updates 
                              
                                 ‖
                                 v
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 ‖
                                 v
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 ‖
                                 
                                    
                                       p
                                    
                                    
                                       ̂
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 ‖
                                 H
                                 -
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       M
                                       ]
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       H
                                       (
                                       curl
                                       )
                                    
                                 
                              
                            for Hartmann numbers 
                              
                                 Ha
                                 =
                                 0.01
                                 ,
                                 1
                                 ,
                                 10
                                 ,
                                 10
                                 
                                    
                                       10
                                    
                                 
                              
                            under 
                              
                                 hp
                              
                           -refinements. These tabulated results are presented in full in [24], here we show only the case for 
                              
                                 Ha
                                 =
                                 10
                              
                            for 
                              
                                 h
                                 =
                                 0.25
                              
                            and 
                              
                                 h
                                 =
                                 0.125
                              
                            in Tables 1 and 2
                           
                           , respectively, which we compare with the convergence of the error stated in references [18,9].

Although the results shown in [18,9] are obtained with a different method and are presented for h-refinement only, we can compare the accuracy of the solutions with respect to the number of degrees of freedom (DOFs). Our hp-finite element scheme shows a significant improvement in terms of accuracy when compared to the reference solution. In particular, we can use much fewer DOFs yet still achieve the same level of accuracy, which indicates the high efficiency and high accuracy of the current approach. However, we also acknowledge that, ideally, if the data is available, the computational cost should not only be measured in terms of degrees of freedom as a hp-approach does result in matrices that are not as sparse as in pure h-refinement and there are additional computation costs associated with the generation of the basis functions and the evaluation of the elemental contributions. Nonetheless, these can be minimised by a careful implementation, see e.g. [24]. From the tables of convergence behaviour in [24], we also can conclude that, for higher Hartmann number, more DOFs are needed. This indicates that a high Hartmann number introduces strong coupling, steeper gradients as well as non-linearity into the system, which makes the flow behaviour much more challenging to capture.

The numerical solutions for the centreline profiles for x-component of the velocity and x-component of the magnetic field are illustrated in Fig. 7
                            with different Hartmann numbers. It transpires that, on the chosen mesh, the degree of the elements needs to be chosen as 
                              
                                 p
                                 =
                                 7
                              
                            to fully capture the behaviour of the strong coupling and the non-linearity of the MHD problem. The comparison between numerical and analytical solutions, which shows a good agreement, indicates the accuracy of the implementation. From the results, we can also see that, a high Hartmann number results in steeper gradients near the boundary, which are well captured by our hp-refinements.

After verifying our implementation, and in order to show the applicability of our approach to capture complex flow patterns, we now consider applying Algorithm 2 to solve a multiphase MHD flow, which consists of two different fluids. The geometry and mesh are shown in Fig. 8
                           . The mesh is refined near the inner droplet as we are interested in the behaviour between two different fluids.

The domain consists of 
                              
                                 Ω
                                 =
                                 (
                                 0
                                 ,
                                 2
                                 )
                                 ×
                                 (
                                 -
                                 1
                                 ,
                                 1
                                 )
                              
                            with 9 droplets, each being a circle with radius 
                              
                                 
                                    
                                       r
                                    
                                    
                                       in
                                    
                                 
                                 =
                                 0.1
                              
                            and equally separated inside the squared domain at positions 
                              
                                 (
                                 0.5
                                 ,
                                 -
                                 0.5
                                 )
                                 ,
                                 (
                                 0.5
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 0.5
                                 ,
                                 0.5
                                 )
                                 ,
                                 (
                                 1
                                 ,
                                 -
                                 0.5
                                 )
                                 ,
                                 (
                                 1
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 1
                                 ,
                                 0.5
                                 )
                                 ,
                                 (
                                 1.5
                                 ,
                                 -
                                 0.5
                                 )
                                 ,
                                 (
                                 1.5
                                 ,
                                 0
                                 )
                              
                            and 
                              
                                 (
                                 1.5
                                 ,
                                 0.5
                                 )
                              
                           . The Neumann boundary for the fluid part is 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 (
                                 2
                                 ,
                                 y
                                 )
                                 ,
                                 y
                                 ∈
                                 (
                                 -
                                 1
                                 ,
                                 1
                                 )
                              
                            with condition 
                              
                                 
                                    
                                       t
                                    
                                    
                                       hp
                                    
                                 
                                 =
                                 t
                                 =
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 n
                              
                            and the Dirichlet boundary for the fluid part 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 ∂
                                 Ω
                                 ⧹
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                              
                            with condition 
                              
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 (
                                 v
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                                 0
                                 )
                              
                           . For the magnetic field, the Dirichlet boundary conditions 
                              
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                              
                            are applied on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            where 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 H
                                 )
                              
                           . Note that v is the amplitude of input velocity and H is the amplitude of the magnetic field. In order to investigate the influence of the magnetic field on the multiphase problem, the amplitude H of the magnetic field is increased. The parameters for the inner and outer fluids are taken from [13,15] and shown in Table 3
                           . Here v can be obtained by the relation 
                              
                                 v
                                 =
                                 Re
                                 ×
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 /
                                 (
                                 2
                                 
                                    
                                       r
                                    
                                    
                                       in
                                    
                                 
                                 )
                              
                           , where 
                              
                                 Re
                                 =
                                 0.01
                              
                            is the Reynolds number without the magnetic field and in absence of the droplets.

With a mesh of 2910 unstructured triangular elements, we found, by uniformly incrementing the polynomial degree, that 
                              
                                 p
                                 =
                                 5
                              
                            is required in order to fully capture the complex fluid pattern. Several different magnetic amplitudes are applied, namely 
                              
                                 H
                                 =
                                 0.1
                                 ,
                                 0.2
                                 ,
                                 0.4
                              
                           , and the results of the streamlines for the multiphase problem and the quadratic convergence curve for the different magnetic fields are shown in Fig. 9
                           . The results shown in Fig. 9(a), (c), and (d) indicate the correct implementation of the Newton–Raphson scheme and in Fig. 9(b), (d), and (e) the influence of the magnetic field over the fluid flow pattern is illustrated. In particular, we see that as the magnitude of the magnetic field is increased, the flow pattern is substantially effected creating regions of low and high velocities in the vicinity of the conducting cylinders. This complex flow pattern would be impossible to be captured without the use of a higher order discretisation. Fig. 9 also indicates that the contrast of the magnetic permeability for the two different fluids could result in a complex flow pattern under a large magnetic field.

Next, we verify the 
                           
                              d
                              =
                              3
                           
                         implementation by applying the scheme to several well-known benchmarking problems. As we have already established the benefits of the Newton Raphson over the Picard iteration we consider only the former and use it to benchmark a lid-driven cavity with and without a magnetic field, a three dimensional extension of the Hartmann flow problem and, to finish, we show the predicative capability of the scheme by applying it to a multiphase MHD flow problem.

We first consider the standard lid-driven cavity problem for pure Navier–Stokes flow in the absence of a magnetic field on the cubic domain 
                              
                                 Ω
                                 =
                                 
                                    
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                    
                                       3
                                    
                                 
                              
                           . We define the surface 
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 1
                                 )
                                 ,
                                 x
                                 ,
                                 y
                                 ∈
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                            as 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                       (
                                       1
                                       )
                                    
                                 
                              
                            and the other boundary faces as 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 ∂
                                 Ω
                                 ⧹
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                       (
                                       1
                                       )
                                    
                                 
                              
                           . We impose the boundary conditions
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                v
                                                =
                                                (
                                                v
                                                ,
                                                0
                                                )
                                                
                                                on
                                                
                                                ∂
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                   
                                                      F
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                v
                                                =
                                                0
                                                
                                                on
                                                
                                                ∂
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                   
                                                      F
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           where v is the constant amplitude of the applied of the driving velocity. For this problem an unstructured mesh of 756 tetrahedral elements is generated on which uniform order 
                              
                                 p
                                 =
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 6
                              
                            elements are applied for 
                              
                                 Re
                                 =
                                 100
                                 ,
                                 p
                                 =
                                 4
                                 ,
                                 5
                                 ,
                                 6
                              
                            are applied for 
                              
                                 Re
                                 =
                                 400
                              
                            and 
                              
                                 p
                                 =
                                 6
                                 ,
                                 7
                                 ,
                                 8
                              
                            are applied for 
                              
                                 Re
                                 =
                                 1000
                              
                           .

Initially, we consider the flow pattern in the absence of a magnetic field. Fig. 10
                           (a), (c), and (e) shows the quadratic convergence of a suitably simplified version of the Newton–Raphson procedure given in Algorithm 1 to the previously stated criteria where 
                              
                                 R
                                 =
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 ‖
                                 /
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 ‖
                              
                            and the convergence of the updates variables 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       v
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                 
                              
                            are also presented for completeness. We can observe that, with an increasing Reynolds number, we need more iterations to converge. For 
                              
                                 Re
                                 =
                                 1000
                              
                           , an incremental approach using 2 increments has also been applied (see [24] for details). Note that the convergence shown in Fig. 10(e) is for the final increment for 
                              
                                 Re
                                 =
                                 1000
                              
                            with 
                              
                                 p
                                 =
                                 8
                              
                           . In Fig. 10(b), (d), and (f), the centreline profiles for 
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 0.5
                                 ,
                                 y
                                 ,
                                 0.5
                                 )
                              
                            for 
                              
                                 0
                                 ⩽
                                 y
                                 ≤
                                 1
                              
                            for 
                              
                                 Re
                                 =
                                 100
                                 ,
                                 400
                                 ,
                                 1000
                              
                            with p-refinement are presented and in Fig. 11
                            the corresponding streamlines are shown. The results show that as the degree of the polynomial order is increased, the solution converges to the reference solution. For the lower Reynolds number 
                              
                                 Re
                                 =
                                 100
                              
                            we can see that, with 
                              
                                 p
                                 =
                                 4
                              
                           , we can already accurately capture the fluid behaviour. For 
                              
                                 Re
                                 =
                                 400
                                 ,
                                 p
                                 =
                                 6
                              
                            is needed to fully solve the problem. For 
                              
                                 Re
                                 =
                                 1000
                              
                           , even with 
                              
                                 p
                                 =
                                 8
                              
                           , our computed solution is still slightly away from the reference solution. In this case local mesh refinement, combined with p-refinement could be applied, if desired, to improve the accuracy.

Secondly, we consider the case of the coupled MHD problem where, in addition to the fluid boundary conditions, we apply 
                              
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                              
                            on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            where we choose 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 )
                              
                           , in turn, as uniform magnetic fields. Here, in order to adapt our framework to the dimensionless schemes, we set the parameters as 
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 =
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 κ
                                 =
                                 ρ
                                 ,
                                 ν
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 /
                                 ρ
                                 =
                                 0.1
                                 ,
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 ]
                                 ]
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 c
                                 /
                                 ρ
                                 ,
                                 Ha
                                 =
                                 
                                    
                                       κ
                                       /
                                       ν
                                       
                                          
                                             ν
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           . The fluid parameters are summarised in Table 4
                            for the Hartmann number 
                              
                                 Ha
                                 =
                                 10
                              
                            with 
                              
                                 Re
                                 =
                                 1
                                 /
                                 ν
                                 =
                                 400
                              
                            and 
                              
                                 Rem
                                 =
                                 1
                                 /
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 40
                              
                            as [2]. The mesh of 6048 unstructured tetrahedra is employed and uniform 
                              
                                 p
                                 =
                                 4
                              
                            elements are used throughout. In Fig. 12
                           (a) and (c) we show the quadratic convergence of the Newton–Raphson procedure given in Algorithm 1 to the previously stated criteria and in Fig. 12(b) and (d), the centreline profiles of 
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 0.5
                                 ,
                                 y
                                 ,
                                 0.5
                                 )
                              
                            for 
                              
                                 0
                                 ⩽
                                 y
                                 ⩽
                                 1
                              
                            for 
                              
                                 Ha
                                 =
                                 10
                              
                            when 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 )
                              
                            are shown. In the latter cases, we also include the corresponding reference solution for the Navier–Stokes lid driven cavity problem with 
                              
                                 Re
                                 =
                                 400
                              
                            as a comparison. Illustrations of the computed streamlines for this problem are presented in Fig. 13
                           . Note that, for further increases in Hartmann number, we see an even greater departure of the flow field for the MHD problem from the flow field of the standard lid driven cavity problem [24].

The description of this problem can be found in [18,9] and consists of a rectangular duct given by 
                              
                                 Ω
                                 =
                                 (
                                 0
                                 ,
                                 L
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            with 
                              
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 ≪
                                 L
                              
                           . The source terms are 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 g
                                 =
                                 0
                              
                            and the analytical solutions is in the form of
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                v
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  v
                                                                  (
                                                                  y
                                                                  ,
                                                                  z
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                H
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  b
                                                                  (
                                                                  y
                                                                  ,
                                                                  z
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                                =
                                                -
                                                Gx
                                                +
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̂
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                y
                                                ,
                                                z
                                                )
                                                ,
                                                
                                                r
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           in 
                              
                                 Ω
                              
                            where
                              
                                 
                                    v
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    =
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    G
                                    
                                       
                                          ν
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             0
                                          
                                          
                                             +
                                             ∞
                                          
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    y
                                    )
                                    cos
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                    
                                    z
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    b
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             0
                                          
                                          
                                             +
                                             ∞
                                          
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    y
                                    )
                                    cos
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                    
                                    z
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    =
                                    -
                                    
                                       
                                          κ
                                          b
                                          
                                             
                                                (
                                                y
                                                ,
                                                z
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    10
                                    ,
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          2
                                          n
                                          +
                                          1
                                          )
                                          π
                                       
                                       
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       
                                          ν
                                       
                                       
                                          κ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             sinh
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             y
                                             )
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             sinh
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             y
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                Ha
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ±
                                    Ha
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      Ha
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    sinh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    sinh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    sinh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    cosh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    sinh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    cosh
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          -
                                          2
                                          G
                                       
                                       
                                          ν
                                          
                                             
                                                λ
                                             
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    sin
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                        

In order to again adapt our framework to the dimensionless Hartmann flow problem, we set the parameters as 
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 =
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 κ
                                 =
                                 ρ
                                 ,
                                 ν
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       ̂
                                    
                                 
                                 /
                                 ρ
                                 =
                                 0.1
                                 ,
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 ]
                                 ]
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                                 [
                                 [
                                 I
                                 ]
                                 ]
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 c
                                 /
                                 ρ
                                 ,
                                 Ha
                                 =
                                 
                                    
                                       κ
                                       /
                                       ν
                                       
                                          
                                             ν
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           . The fluid parameters for the three-dimensional Hartmann flow problem for different Hartmann numbers of 
                              
                                 Ha
                                 =
                                 0.01
                                 ,
                                 1
                                 ,
                                 10
                                 ,
                                 10
                                 
                                    
                                       10
                                    
                                 
                              
                            are shown in Table 5
                           . Then, following the literature [18,9,13], we consider the solution of this problems for the dimensionless quantities 
                              
                                 L
                                 =
                                 10
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 2
                              
                            and 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              
                           . The fluid Neumann boundary 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                              
                            is set as the face 
                              
                                 (
                                 10
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 ,
                                 (
                                 y
                                 ,
                                 z
                                 )
                                 ∈
                                 (
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            and the fluid Dirichlet boundary 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                              
                            as 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 ∂
                                 Ω
                                 ⧹
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                              
                            and, for the magnetic field, we set 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                           . Introducing 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 )
                              
                            the boundary conditions can be summarised as
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          hp
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    0
                                    
                                    on
                                    
                                    ∂
                                    
                                       
                                          Ω
                                       
                                       
                                          D
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          hp
                                       
                                    
                                    =
                                    (
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          F
                                       
                                    
                                    ]
                                    ]
                                    +
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          EM
                                       
                                    
                                    ]
                                    ]
                                    )
                                    n
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    n
                                    +
                                    [
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          EM
                                       
                                    
                                    ]
                                    ]
                                    n
                                    
                                    on
                                    
                                    ∂
                                    
                                       
                                          Ω
                                       
                                       
                                          N
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    n
                                    ×
                                    
                                       
                                          H
                                       
                                       
                                          hp
                                       
                                       
                                          [
                                          0
                                          ]
                                       
                                    
                                    =
                                    n
                                    ×
                                    
                                       
                                          H
                                       
                                       
                                          D
                                       
                                    
                                    
                                    on
                                    
                                    ∂
                                    
                                       
                                          Ω
                                       
                                       
                                          D
                                       
                                       
                                          M
                                       
                                    
                                    .
                                 
                              
                           
                        

The benchmarking is performed on an unstructured grid of 125 elements by performing uniform p-refinement. By uniformly increasing p until convergence was reached, it was deduced that using 
                              
                                 p
                                 =
                                 6
                              
                            on a mesh of 125 elements can capture the Hartmann flow pattern accurately for the Hartmann number up to 
                              
                                 Ha
                                 =
                                 10
                              
                           . By applying Algorithm 1 the Newton–Raphson procedure exhibits quadratic convergence similar to that shown in the previous cases, although, for higher Hartmann numbers, the number of iterations required to reach the aforementioned convergence criteria increases.

The centreline profiles of 
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                              
                            for 
                              
                                 -
                                 2
                                 ⩽
                                 y
                                 ⩽
                                 2
                              
                            are illustrated in Fig. 14
                            for the Hartmann numbers 
                              
                                 Ha
                                 =
                                 0.01
                                 ,
                                 1
                              
                            and 10. The comparison between the numerical solutions and the analytical solutions show a good agreement for the presented cases. For higher Hartmann numbers the flow patterns exhibit increasingly sharp gradients in the flow field close to the boundaries and, as discussed in [24] performing p-refinement alone on a coarse mesh of 125 tetrahedra is not sufficient to capture the flow pattern. In this case, h- and p-refinements must be combined.

The geometry of the multiphase MHD flow is shown in Fig. 15
                           , which is a rectangular duct given by 
                              
                                 Ω
                                 =
                                 (
                                 0
                                 ,
                                 L
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            with dimensionless coordinates 
                              
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 2
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                                 ,
                                 L
                                 =
                                 8
                              
                            containing a sphere with radius 
                              
                                 0.3
                              
                            at the point of 
                              
                                 (
                                 2
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              
                           . The source terms are such that 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 g
                                 =
                                 0
                              
                            and the fluid Neumann boundary condition 
                              
                                 
                                    
                                       t
                                    
                                    
                                       hp
                                    
                                 
                                 =
                                 t
                                 =
                                 [
                                 [
                                 
                                    
                                       σ
                                    
                                    
                                       EM
                                    
                                 
                                 ]
                                 ]
                                 n
                              
                            (free stream velocity) is applied at the face 
                              
                                 (
                                 8
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            with 
                              
                                 (
                                 y
                                 ,
                                 z
                                 )
                                 ∈
                                 (
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 (
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            and the fluid Dirichlet boundary conditions 
                              
                                 
                                    
                                       v
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       D
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       v
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0.001
                                 (
                                 2
                                 +
                                 y
                                 )
                                 (
                                 2
                                 -
                                 y
                                 )
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              
                            is a Poiseuille flow distribution in the x-direction. For the magnetic field, the boundary condition 
                              
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                    
                                       [
                                       0
                                       ]
                                    
                                 
                                 =
                                 n
                                 ×
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                              
                            is imposed on 
                              
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 ∂
                                 Ω
                              
                            where 
                              
                                 
                                    
                                       H
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 H
                                 ,
                                 0
                                 )
                              
                           . The parameters are taken to be same as those previously provided in Table 5, except that we assign the background fluid such that, in absence of the inclusion, the Hartmann number would be 
                              
                                 Ha
                                 =
                                 1
                              
                            and in absence of the background the Hartmann number would be 
                              
                                 Ha
                                 =
                                 10
                                 
                                    
                                       10
                                    
                                 
                              
                           . We fix the relative permeability of the background fluid to be 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rout
                                    
                                 
                                 =
                                 1
                              
                            whilst varying the relative permeability of the inner fluid droplet according to 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rin
                                    
                                 
                                 =
                                 0.01
                                 ,
                                 0.1
                                 ,
                                 1
                                 ,
                                 10
                              
                           , in turn. For both fluids we set 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 0
                              
                           .

By uniformly incrementing p on an unstructured grid of 1765 tetrahedral elements it was found that convergence is reached with 
                              
                                 p
                                 =
                                 4
                              
                            elements. As in previous cases, the application of Algorithm 2 results in a Newton–Raphson scheme that converges quadratically exhibiting a behaviour similar to that shown in earlier plots. In Fig. 16
                            we also present the centre line profiles for 
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 -
                                 1.5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 2.5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 -
                                 1.5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 2.5
                                 ,
                                 y
                                 ,
                                 0
                                 )
                              
                           , for 
                              
                                 -
                                 2
                                 ⩽
                                 y
                                 ⩽
                                 2
                              
                           , such that they represent the x-components of the flow field and magnetic field just before and just after the inclusion with 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rin
                                    
                                 
                                 =
                                 0.01
                                 ,
                                 0.1
                                 ,
                                 1
                                 ,
                                 10
                              
                           , in turn. Fig. 16(a) and (b) shows the centreline profiles for 
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                              
                            and Fig. 16(c) and (d) shows the centre line profile for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                              
                           . In these plots, the effects of including the sphere droplet and increasing permeability contrast can clearly be observed. Note that despite that 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 0
                              
                            in both fluids the distribution of 
                              
                                 [
                                 [
                                 
                                    
                                       μ
                                    
                                    
                                       r
                                    
                                 
                                 ]
                                 ]
                              
                            is still dependent on the strain rate for this problem.

The streamlines, which show the influence of the magnetic fields on the fluid pattern, are shown in Fig. 17
                            for different values of 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rin
                                    
                                 
                              
                           . From Fig. 17(c), when there is no contrast between the inner and background fluid, the flow pattern tends to that of the prescribed Poiseuille flow. However, with the presence of a permeability contrast, the flow pattern around the droplet is greatly affected by the magnetic field. This simple example illustrates that the gradient of the permeability, which forms an important role in magnetostriction, also plays a major role for the multiphase MHD problem. In order to resolve these complex flow patterns an hp-finite element scheme is essential without it such complex phenomena observed in this simulation cannot be recovered.

@&#CONCLUSIONS@&#

In this paper, we have extended our previous work [25,26] on the numerical simulation of two-dimensional non-conducting magnetostrictive fluids to the simulation of two- and three-dimensional conducting magnetostrictive fluids as well as multi-phase MHD problems. The coupled formulation is implemented in a monolithic manner and solved by means of a Newton–Raphson strategy in conjunction with consistent linearisation. A finite element discretisation employing hp-finite elements conforming to the spaces 
                        
                           H
                           (
                           curl
                           )
                           ,
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        
                      has been used leading to a non-trivial implementation. By the application of p-refinement, exponential convergence for problems with smooth benchmark solutions has been obtained, and by combining h- and p-refinements, exponential convergence for benchmark solutions with singularities due to sharp corners and edges has also been demonstrated. We have included further problems that show the predictive capability of the approach and the complex flow patterns that result in the presence of non-homogenous materials and the presence of magnetostrictive effects. Further work will include reducing the computational cost of our approach as well as exploring the role that magnetostriction plays in three dimensional MHD problems in greater detail.

@&#ACKNOWLEDGEMENTS@&#

The first author gratefully acknowledge the support of the College of Engineering, Swansea University in terms of a Zienkiewicz PhD studentship and the second author gratefully acknowledges the financial support received from EPSRC – United Kingdom in the form of the Grant EP/K023950/1. The third author acknowledges the support received through “The Leverhulme Prize” awarded by The Leverhulme Trust, UK.

@&#REFERENCES@&#

