@&#MAIN-TITLE@&#Symmetry-driven shape description for image retrieval

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We use rotation and reflection symmetries for structural shape description.


                        
                        
                           
                           The posterior shape similarity enhances the shape matching performance.


                        
                        
                           
                           Test results on public dataset show increased retrieval accuracy.


                        
                        
                           
                           Any other previous or future shape representation can be combined with our method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shape description

Shape matching

Regular pattern

@&#ABSTRACT@&#


               
               
                  We propose a novel symmetry-driven Bayesian framework to incorporate structural shape into conventional geometrical shape descriptor of an image indexing and retrieval. We use rotation and reflection symmetries for structural shape description. Symmetry detection on each shape image provides a qualitative and a quantitative categorization of the types and the degrees of symmetry level. The posterior shape similarity enhances the shape matching performance based on the symmetry structural discrimination. Experimental results show statistically significant improvement on retrieval accuracy over the state of the art methods on MPEG-7 data set.
               
            

@&#INTRODUCTION@&#

Shape matching is a challenging topic in computer vision. Various shape representations and matching methods have been studied, such as geometrical [1–5]/topological [6–9] and hierarchical [2,10,11]/partial-shape [12–14] descriptors. However, most of previous works concentrate on describing either geometrical or topological shape computing a similarity between two shapes based on their shape descriptors. Our key observation is that a shape cannot be represented solely by either a geometrical or a structural characteristic. Human recognizes a shape not only by its local and global geometrical variations, but also by a high-level understanding of the shape structure like symmetry. Symmetry is a good feature describing global structure of shapes. We immediately can tell the shape difference between butterfly and flower by saying that a flower has rotational symmetry. Among the four primitive symmetry types (Rotation, Reflection, Glide-reflection and Translation) [15], rotation and reflection symmetries are frequently found from the binary image of 2D shape of single object. Fig. 1
                      shows various shape examples from the MPEG7 shape dataset. We can figure out just by taking a look of the images that a shape from one category has its unique and discriminative characteristic in terms of symmetry and can be recognized without any further detailed geometrical shape investigation. Kurki and Saarinen [16] show by psychophysical techniques that rotational symmetry in shape attracts our attention more than other structure. Not only for rotation symmetry, regular structure of all other types of symmetry makes objects or shapes more perceptually salient than other part of an image [17]. Likewise symmetry plays an important role in discriminating structural shapes to each other in the presence of high intra class variance of geometrical shapes (Fig. 2
                     ).

Despite the important role of symmetry in shape description and recognition, there have been less interests in using symmetry features to represent shape structure and find the correspondence of shapes. This is partly because there have been relatively few robust symmetry detection algorithms. Skeleton-based shape representation methods use the symmetry of local points but they do not capture the global symmetry shape structure [7,8]. Recently, several rotations and reflection symmetry detection algorithms have been proposed [18,15,19–23] and evaluated [24]. Park et al. [24] show a potential of symmetry features on how they can contribute to the popular computer vision problems like object recognition.

In this research, we propose a new shape representation and matching framework by unifying structural shape features and conventional geometrical shapes. We employ but are not restricted to the rotation and reflection symmetries for structural shape representation. The contributions of our proposed algorithm includes; (1) the first symmetry shape representation for global structural shape description and (2) a novel framework of shape representation and matching unifying both structural and geometrical shape features of any previous method.

@&#RELATED WORK@&#

Geometrical information of a shape boundary is a core feature for shape representation and has been studied in many previous works [1–5]. Sebastian et al. [1] perform a curve fitting method based on the length and curvature for boundary shape matching. Ling and Jacobs [3] use inside shape distance instead of Euclidean distance. Belongie et al. [4] use shape contexts for shape matching and estimate the aligning transformation based on the correspondences. Then the distance between shapes is measured by both the matching error and the magnitude of the aligning transformation. Tu and Yuille [5] propose generative models and feature-based approach using EM algorithm.

Recently, many algorithms employ hierarchical or scale-space approaches [2,10,11]. Mokhtarian et al. [2] propose to use the curvature scale space for shape representation and matching. McNeill and Vijayakumar [10] introduce hierarchical procrustes matching that approximates a perceptual similarity between shapes based on segment matching from different scales. Ueda and Suzuki [11] build the convex/concave shape structure in scale-space and use dynamic programming for matching.

Some recent works [12–14] focus on the partial shape representation for robust matching with deformable shapes. Latecki and Lakimper [12] match shapes using their visual parts of contours. Lakaemper and Sobel [13] use a particle filter to find the optimal correspondences between parts of shapes. However, their experimental results show that the shape matching with single part of shape can detect wrong shape sharing a similar partial shape. Felzenszwalb and Schwartz [14] propose a hierarchical matching method of deformable shapes based on a shape tree. Their shape tree captures global geometrical properties of curvature in multi-resolution.

Another approach is the topological shape representation mostly using medial axis or skeleton based representations [6–9]. Maragos [6] introduces skeleton subsets in a scale-space. On the other hand, Bai and Liu [9] extract skeletons from a set of boundaries of multi-scale. Tari and Shah [7] define a local symmetry axes, however the term, symmetry, used in this context represents the characteristic of local points of the skeleton and does not imply the property of a global shape. Kimia et al. [8] also introduce a symmetry-based shape matching on their shock graph structure. It takes the advantage of locally symmetrical structure to get additional discrimination based on global structure information. Yang et al. [25] propose a learning method for a better metric through graph transduction that can be applied on the top of any existing algorithm. Layered graph matching [26] detects symmetric shapes under distortions or clutters but they only consider reflection type symmetry. Yang and Latecki [27] using affinity learning on a tensor product graph show best retrieval performance on MPEG-7 Dataset.

We propose a shape representation that has two levels of shape description: a structural shape level and geometrical shape level (Fig. 3
                     ). The structural shape feature provides a higher level of compositional shape description and provides further discrimination to the geometrical shape description by updating its similarity measure.

In our framework, we use structural shape descriptions such as rotation and reflection symmetries to improve the similarity measure computed from a geometrical shape descriptor. Symmetry is a scale, orientation and location invariant feature and a higher-level property that describes the compositional structure of shapes. With a pair of shape images, symmetry detection methods find the respective symmetry type and strength. Then we calculate the likelihood by multiplying their symmetry strength. On the other hand, we compute the similarity (distance) between two geometrical shape descriptors. Then the symmetry likelihood for each pair of shapes works as a weight on the geometrical similarity computing a new symmetry-driven similarity.

Among the four mathematically well defined 2D primitive symmetry types [15], rotation and reflection symmetries are good features to characterize the structural shape of a single object. Rotation symmetry can be categorized further by the cardinality and group type (dihedral (D
                     m, m>1) and cyclic (C
                     m, m>1)). Reflection symmetry is a bilateral symmetry (D
                     1) along a single symmetry axis. C
                     1 represents an identity that corresponds to an asymmetric shape. We detect the type and strength of each symmetry group from a 2D shape image using state-of-the-art symmetry group detection algorithms [28,19,20].

Rotation symmetry of 2D shape is detected by the Frieze-expansion and frequency analysis method [28] around the centroid point of a given shape. Input shape image is transformed into polar space building a Frieze-expansion pattern (FEP) (Fig. 4(b)) and one-dimensional horizontal discrete Fourier transform (DFT) is performed on upper rows of the FEP, respectively (Fig. 4(c)). Outstanding peak in DFT coefficient indicates the cardinality of rotation symmetry if it exists. Rotation symmetry strength (RSS) is calculated by the following formulations. Let p(r,l) be an R×L FEP expanded at the centroid point where r∈[1,R] and l∈[1,L]. L is the fixed number of Frieze-expansion steps and R is a normalized height of FEP. Then the spectral density, S(r,k), of the rth row of p(r,k) is
                           
                              (1)
                              
                                 
                                    S
                                    
                                       r
                                       k
                                    
                                    =
                                    
                                       
                                          P
                                          
                                             r
                                             k
                                          
                                       
                                       ¯
                                    
                                    P
                                    
                                       r
                                       k
                                    
                                    =
                                    a
                                    
                                       
                                          r
                                          k
                                       
                                       2
                                    
                                    +
                                    b
                                    
                                       
                                          r
                                          k
                                       
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    P
                                    
                                       r
                                       k
                                    
                                    =
                                    a
                                    
                                       r
                                       k
                                    
                                    +
                                    ib
                                    
                                       r
                                       k
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             l
                                             =
                                             0
                                          
                                          
                                             L
                                             −
                                             1
                                          
                                       
                                    
                                    
                                    p
                                    
                                       r
                                       l
                                    
                                    
                                       e
                                       
                                          −
                                          i
                                          
                                             
                                                
                                                   2
                                                   π
                                                
                                                L
                                             
                                          
                                          l
                                          
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     


                        P(r,k) is the kth coefficient of discrete Fourier transform (DFT) of p(r,k), 
                           
                              
                                 
                                    P
                                    
                                       r
                                       k
                                    
                                 
                                 ¯
                              
                              =
                              a
                              
                                 r
                                 k
                              
                              −
                              ib
                              
                                 r
                                 k
                              
                           
                        , a(r,k) is the real part and b(r,k) is the imaginary part of the DFT coefficient. Let j
                        =
                        k
                        peak if 
                           
                              S
                              
                                 r
                                 j
                              
                              ≥
                              mean
                              
                                 
                                    S
                                    
                                       r
                                       k
                                    
                                    |
                                    k
                                    =
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                          2
                                       
                                    
                                 
                              
                              +
                              std
                              
                                 
                                    S
                                    
                                       r
                                       k
                                    
                                    |
                                    k
                                    =
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                          2
                                       
                                    
                                 
                              
                           
                        . Let mean(S(r,j)) represent the mean value of all spectral density values and mean(S(r,j
                        peak)) represent the mean value of only peak values. Then rotation symmetry strength g
                        rot of a shape image is thus defined as:
                           
                              (3)
                              
                                 
                                    
                                       g
                                       rot
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   1
                                                
                                                R
                                             
                                          
                                          
                                          
                                             ρ
                                             r
                                          
                                          
                                             
                                                
                                                   mean
                                                   
                                                      
                                                         S
                                                         
                                                            r
                                                            
                                                               j
                                                               peak
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   mean
                                                   
                                                      
                                                         S
                                                         
                                                            r
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   1
                                                
                                                R
                                             
                                          
                                          
                                          
                                             ρ
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       ρ
                                       r
                                    
                                    =
                                    1
                                    ,
                                    
                                    if
                                    
                                    Mod
                                    
                                       
                                          
                                             j
                                             peak
                                          
                                          ,
                                          min
                                          
                                             
                                                j
                                                peak
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       ρ
                                       r
                                    
                                    =
                                    0
                                    ,
                                    
                                    otherwise
                                 
                              
                           
                        where, Mod (j
                        peak, min(j
                        peak)) is the Modulo operator, or j
                        peak mod min(j
                        peak).


                        Fig. 6
                        
                         shows several examples of rotation symmetry detection on the shape images of MPEG-7 dataset. Different cardinal numbers of rotation symmetry are considered as different symmetry groups in our framework, because the cardinality makes the difference in topological shape. However, rotation symmetry types (dihedral or cyclic) are not considered as different groups because they just affect the shape deformation without structural (topological) shape change.

In a binary image, reflection symmetry axis, if there exist, has to intersect the centroid point, because centroid is the intersection of all lines dividing shapes into two parts having equal moments (area in a binary image). We detect reflection symmetry axis intersecting the centroid of a given shape using the SIFT key point based algorithm [19] which shows robust reflection symmetry detection performance [24] (Fig. 5). However, the number of SIFT key points detected in a binary image is not enough to support a symmetry axis. We find the boundary of shapes first using a Canny edge detector (Fig. 5(b)). Symmetry axis is detected based on the key points found on this boundary. Given reflection symmetry axis, we calculate normalized reflection symmetry strength (gref
                        =exp(−|d|)) by taking an exponential of the absolute Euclidean distance d between left half and flipped right half image of the reflection symmetry axis. We allow a local orientation search range around the detected axis and minimize the normalized reflection symmetry strength in the local search range. Shapes having more than one reflection symmetry axes from a centroid point are already detected as a dihedral type of rotation symmetry in the previous section. We detect only pure bilateral reflection symmetry with a single symmetry axis by restricting the number of axis to one in the centroid point.

First, we build a symmetry-driven shape similarity framework with a pair of shape images. We update the geometrical shape similarity by the symmetry likelihoods using Bayesian framework. We define a symmetry strength matrix G
                     
                        i
                     
                     =[g
                     ref(i),
                     g
                     rot1(i),
                     g
                     rot2(i),
                     g
                     rot3(i),⋯] of the shape ui
                      where i∈[1,N]. g
                     rotm is the rotation symmetry strength value of D
                     m or C
                     m defined in Eq. (3) and g
                     ref is the reflection symmetry strength value of D
                     1. g
                     rot1 represents an identity group (C
                     1). Let wij
                      be a geometrical distance between two shapes ui
                      and uj
                     . Given observed symmetry strengths, G
                        i
                      and G
                        j
                      of ui
                      and uj
                      respectively, the posterior probability P(wij
                     |G
                        i
                     , G
                        j
                     ) of the symmetry-driven shape similarity is defined as follows.
                        
                           (4)
                           
                              
                                 P
                                 
                                    
                                       
                                          w
                                          ij
                                       
                                       |
                                       
                                          G
                                          i
                                       
                                       ,
                                       
                                          G
                                          j
                                       
                                    
                                 
                                 ∝
                                 P
                                 
                                    
                                       
                                          G
                                          i
                                       
                                       ,
                                       
                                          G
                                          j
                                       
                                       |
                                       
                                          w
                                          ij
                                       
                                    
                                 
                                 P
                                 
                                    
                                       w
                                       ij
                                    
                                 
                              
                           
                        
                     where P(w
                     
                        ij
                     )=
                     ϕ
                     
                        σ
                     (w
                     
                        ij
                     ) is the prior probability of the geometrical shape similarity between ui
                      and uj
                     . ϕ
                     
                        σ
                      is a 0-mean and σ standard deviation Gaussian distribution. Symmetry likelihood is defined by the symmetry strengths, Gi
                      and G
                        j
                      as follows.
                        
                           (5)
                           
                              
                                 P
                                 
                                    
                                       
                                          G
                                          i
                                       
                                       ,
                                       
                                          G
                                          j
                                       
                                       |
                                       
                                          w
                                          ij
                                       
                                    
                                 
                                 ∝
                                 
                                    G
                                    ij
                                 
                                 =
                                 
                                    G
                                    i
                                 
                                 ⋅
                                 
                                    G
                                    j
                                 
                                 =
                                 
                                    G
                                    j
                                 
                                 ⋅
                                 
                                    G
                                    i
                                 
                                 .
                              
                           
                        
                     
                  

Our framework combines multiple kernels obtained from different symmetry types and state of the art multiple kernel learning [29,30] methods can be applied to improve the retrieval performance. In this paper, we employ this simple but effective Bayesian framework to verify that symmetry is a very promising cue for shape description as a higher structure characterization and this can provide better discrimination between shape classes.

Now, we apply the framework to the shape matching problem of N images. We compute an N
                     ×
                     N normalized symmetry likelihood matrix M
                     
                        g
                     
                     =[m
                     
                        ij
                     
                     
                        g
                     ] of a symmetry type g
                     ∈{g
                     ref,g
                     rot1,g
                     rot2,g
                     rot3,⋯ as follows.
                        
                           (6)
                           
                              
                                 
                                    M
                                    g
                                 
                                 =
                                 
                                    
                                       g
                                       
                                          1
                                       
                                       ⋯
                                       g
                                       
                                          N
                                       
                                    
                                 
                                 ⋅
                                 
                                    
                                       g
                                       
                                          1
                                       
                                       ⋯
                                       g
                                       
                                          N
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

From the Bayes' law (Eq. (4)), we compute a new shape similarity matrix, 
                        
                           
                              
                                 W
                                 ˜
                              
                           
                           =
                           
                              
                                 
                                    w
                                    ˜
                                 
                                 ij
                              
                           
                        
                     , from the normalized symmetry likelihood matrix of all symmetry types M
                     =[∑
                        g
                     
                     
                     m
                     
                        ij
                     
                     
                        g
                     ] and the N
                     ×
                     N geometrical shape similarity matrix, W
                     =[w
                     
                        ij
                     ].
                        
                           (7)
                           
                              
                                 
                                    
                                       w
                                       ˜
                                    
                                    ij
                                 
                                 =
                                 
                                    
                                       
                                          w
                                          ij
                                          2
                                       
                                       −
                                       
                                          σ
                                          2
                                       
                                       ln
                                       
                                          
                                             
                                                
                                                   ∑
                                                   g
                                                
                                             
                                             
                                             
                                                m
                                                ij
                                                g
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          w
                                          ij
                                          2
                                       
                                       −
                                       
                                          σ
                                          2
                                       
                                       ln
                                       
                                          
                                             G
                                             ij
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

This formulation indicates that the distance between a pair of shapes is updated from their old distance and symmetry strength of the corresponding two shapes. We can decide the amount of symmetry feature portion in the framework by adjusting σ. We set σ
                     =1 for all our experiments. We can read shape matches from the updated symmetry-driven similarity matrix 
                        
                           
                              W
                              ˜
                           
                        
                     .

@&#EXPERIMENTAL RESULTS@&#

Our method is tested against three previous methods [3,25,33] on MPEG-7 shape set [35]. The dataset has 70 classes of 20 shapes each. Shape recognition rate is calculated by the so-called Bullseye test, where every image in the set is matched with all other images. Top 40 most similar candidates are counted and at most 20 of the 40 candidates will be correct hits. The ratio of the total number of correct hits with all images to the highest possible number of hits is the score that we calculate. Tables 1 and 2
                     
                      show the average retrieval accuracies of several previous works compared to our proposed algorithm. In Table 2, our method combined with the IDSC [3] shows 3.80% of average retrieval accuracy increase from the IDSC alone method and 3.75% of standard deviation decrease (85.40(18.37)%→89.34(14.53)%) over 70 classes. Fig. 7
                      shows the prior (W) and posterior (
                        
                           
                              W
                              ˜
                           
                        
                     ) similarity matrixes. Symmetry likelihood matrixes for each symmetry type are shown in Fig. 7. We also test our method combined with the IDSC+Mutual Graph method [33] which has shown the best retrieval accuracy improvement on the MPEG-7 dataset (96.42%).

Retrieval accuracies of each class of MPEG-7 dataset are plotted in Fig. 8
                     . In both our experiments, classes between 27th and 35th having outstanding rotation symmetry structures show the significant retrieval accuracy increases. On the other hand, we can observe lower retrieval accuracies than previous works in some classes such as 20th, 26th and 49th (Fig. 9
                     ). In these classes, some good geometrical matches are distracted by the symmetry feature with large inner-class variance (Fig. 11
                     
                     ). In Fig. 10, we can see how symmetry plays an important role in shape matching among geometrically very similar shape images. Fig. 10(a) is a good example where a conventional shape representation method fails in discriminating two similar shapes without any structural shape information like symmetry. Fig. 10(c) shows that reflection symmetry provides more discrimination between shapes. Fig. 10(d) shows a case where the symmetrical structure introduces wrong matches.

@&#CONCLUSION@&#

We propose the new symmetry-driven shape representation and matching method. We employ rotation and reflection symmetries together with previous geometrical shape representations building a unified structural and geometrical shape representation. Scale, orientation and location invariant symmetry detections are performed on a shape image to build the symmetry likelihood. Any other type of symmetry like translation or new structural features can be incrementally incorporated into our method simply by computing and adding corresponding likelihood into our Bayesian framework. However the recognition rate will depend on the ability of the symmetry detection methods. For instance, if symmetry detection method used in this framework cannot detect any skewed symmetry, skewed shape retrieval performance also will be limited. Experimental results on the public datasets show that the proposed method increases the retrieval accuracy of previous algorithms. Even though there is recent work showing better retrieval performance on MPEG-7 dataset such as [27], our work shows how symmetry cue can introduce additional discrimination on shape description. Not only previous methods we test with, any other previous algorithm can also be combined with our method. Similar framework is also valid for object recognition as long as symmetry detection methods robustly work on skewed objects in real world images.

@&#REFERENCES@&#

