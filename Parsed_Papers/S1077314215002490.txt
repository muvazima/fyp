@&#MAIN-TITLE@&#Higher-order segmentation via multicuts

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel and general formulation for hyper-graph correlation clustering.


                        
                        
                           
                           Any permutation invariant function can be included into a multicut problem.


                        
                        
                           
                           We provide a comparison of LP and ILP cutting plane methods and rounding procedures for the multicut problem.


                        
                        
                           
                           Many sparse Potts models can be solved to global optimality very efficient by the proposed method.


                        
                        
                           
                           The C++ implementations used in this manuscript is freely available online.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Discrete optimization

Multicut

Markov random fields

Higher-order graphical models

Polyhedral combinatorics

Partitioning

Correlation clustering

Global optimality

Image labeling

@&#ABSTRACT@&#


               
               
                  Multicuts enable to conveniently represent discrete graphical models for unsupervised and supervised image segmentation, in the case of local energy functions that exhibit symmetries. The basic Potts model and natural extensions thereof to higher-order models provide a prominent class of such objectives, that cover a broad range of segmentation problems relevant to image analysis and computer vision. We exhibit a way to systematically take into account such higher-order terms for computational inference. Furthermore, we present results of a comprehensive and competitive numerical evaluation of a variety of dedicated cutting-plane algorithms. Our approach enables the globally optimal evaluation of a significant subset of these models, without compromising runtime. Polynomially solvable relaxations are studied as well, along with advanced rounding schemes for post-processing.
               
            

@&#INTRODUCTION@&#

The segmentation problem, also known as partitioning, clustering, or grouping, is a fundamental problem of image analysis. Applications include unsupervised image partitioning [1,2], task-specific image partitioning [3], semantic image segmentation [4,5], and modularity clustering in network analysis [6].

Common problem representations are based on a graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                              ,
                           
                         where nodes V relate to raw data on an image grid or extracted feature vectors, and edges E define a neighborhood structure of the nodes. A segmentation of a graph can be represented either by

                           
                              (i)
                              assigning to each node v ∈ V a label, or by

a multicut given by a subset of cut edges E′ ⊆ E, resulting in a partition of the set of nodes V.

The segmentation problem is then to find a segmentation (node labeling or multicut) with minimal costs.

One commonly distinguishes supervised and unsupervised segmentation. In the former case, the number of classes represented by labels is known, together with a function measuring how likely features associated with nodes belong to each class. In the latter unsupervised case, such information is absent. This introduces ambiguities of the representation (i) since permuting the labels results in the same segmentation. Representation (ii) does not exhibit such symmetries and is therefore particularly appealing in the unsupervised case.

Accordingly, this paper focuses on the segmentation problem as a multicut problem, on the polyhedral representation of valid multicuts resulting in partitions of a given image [7–9], and on a computational approach to take into account the corresponding constraints efficiently.

Specifically, we consider objective functions for the segmentation problem of the form 
                           
                              J
                              
                                 (
                                 x
                                 )
                              
                              =
                              
                                 ∑
                                 f
                              
                              
                                 φ
                                 f
                              
                              
                                 (
                                 
                                    x
                                    
                                       n
                                       e
                                       (
                                       f
                                       )
                                    
                                 
                                 )
                              
                           
                         – see Section 2 for details – where all higher-order terms, i.e. terms depending on more than one variable, are invariant to label permutations. For second-order models this is equivalent to Potts models that may involve negative couplings between adjacent nodes. While cutting-plane based methods [10] have shown best performance on second-order Potts models with arbitrary couplings [11], we show that terms with order higher than two can be handled by additional auxiliary variables and few additional constraints that do not interfere with the constraints defining valid multicuts. Consequently, cutting-plane methods can be uniformly used for all models as we demonstrate by comprehensive numerical evaluations.

In this connection, the present paper provides a systematic comparison of different separation strategies for computer vision applications. In particular, we find that (i) odd-wheel inequalities do not tighten the relaxation as expected, in view of results for highly connected non-computer vision models [12], (ii) integer linear programming subroutines work overall best, but (iii) novel extensions for separation procedures as suggested in this paper are indispensable for efficient usage.

Taking these aspects into account improves runtime by at least a factor of 2.

We also consider the supervised segmentation problem, i.e. finding an optimal multicut with at most k labels, which is known as the multiway cut problem. Compared to the standard (I)LP representation of such problems our approach is considerably more memory efficient and able to provide globally optimal solutions for many computer vision problems in reasonable runtime [5,11,13]. Fig. 1
                         provides an overview and illustrations of the models studied in this paper.

@&#RELATED WORK@&#

In the unsupervised case, the multicut polytope has recently become a focal point of research in computer vision. Major aspects of current work include closedness constraints for image segmentation [2,14], contour completion [15], ensemble segmentation [15,16], and the convex hull of feasible multicuts from the optimization point of view [3,10,17].

Regarding the latter viewpoint, some authors considered primal linear program (LP) relaxations solved by cutting-plane methods [1,3]. Yarkony et al. [17] suggested a Lagrangian relaxation for planar graphs based on a problem decomposition into binary planar max-cut problems. Others [2,10,15,16] resorted to integer linear programs (ILPs) as inner-loop solver within the cutting-plane formulation. While this has exponential runtime in the worst case, it may be expected to work fast in many applications. However, a comparison of these methods and variants was missing so far.

In the supervised case, representation (i) above prevails for the image segmentation problem [18]. Accordingly, the marginal polytope has become a focal point of research with respect to relaxations and approximate inference for image labeling [19–21].

Alternatively, greedy move-making algorithms like α-expansion [22] or FastPD [23] have become established methods that are widely applied. Recently, FastPD has been generalized by [24] such that it can handle higher-order models.

Methods that solve the multiway cut problem 
                        [8] have been considered somewhat misleadingly as computationally intractable for computer vision problems [25]. While in general this problem is known to be NP-hard [26], for few special cases, e.g., for planar graphs, exact polynomial-time algorithms are known [27,28].

A connection of a special relaxation of the second-order multiway cut problem to variational approaches using anisotropic variants of total variation, and to the linear programming relaxation over the local polytope, has been pointed out by Osokin et al. [29] and Nieuwenhuis et al. [30]. We generalize this connection for positive and negative coupling strength in Theorem 7.1.

Recently, Kappes et al. [10] presented a cutting-plane approach to solve the multiway cut problem for various problem instances from computer vision. Globally optimal results for benchmark datasets were reported [5,13] that compare well also in terms of runtime to state-of-the-art methods for approximate inference. However, a detailed evaluation of different separating procedures, its generalization to the higher-order case as well as an analysis of the polyhedral relaxations were lacking.

From the modeling point of view, models with higher-order interactions between variables have become a focus of research in the last years. Due to their enhanced expressiveness, compared to commonly used pairwise models, more complex statistics and interactions between variables can be included into models, see [31] for a more detailed discussion. The main limitation of such higher-order models was and often still is the lack of efficient inference methods, especially compared to the fast methods available for second-order models.

In order to deal with the intrinsic complexity of higher-order terms, specialized solvers have been suggested that make use of internal structures of this functions, that can be utilized for faster inference. This includes reduction techniques for higher-order problems with two variables [32,33] which have been used to generalize fusion move [34] for higher-order models. For the class of (robust) Pn
                         Potts functions closed form reductions for the expansion and swap moves are known, that can be found under certain conditions in polynomial time by a min-st-cut [35,36]. Similar techniques are used in the case of functions that depend on the diversity of the set of labels that its arguments (variables) take, see [37] for further details. Furthermore, graph-cut based approaches has been proposed for co-occurrence statistics [38] and label costs [39]. For message passing methods efficient update rules have been proposed for higher-order Fields-of-Experts model [40], linear constraint potentials [41] and cardinality-based potentials [42]. For linear programming relaxations sparsity of the higher-order function has be used to reduce the number of dual variables [43,44].

In the present work we introduce a new class of higher-order functions that can be handled efficiently, namely label permutation invariant functions. These functions can be included in a much more efficient manner after a embedding of the original label space into a lower dimensional one. It is worth mentioning that the sparsity is independent on the number of labels. The class of label permutation invariant functions can be seen as a generalization of the Potts function and the reduction suggested by Kim et al. [1] as a special case, as we show in Section 4.4. The relation of label permutation invariant functions and Pn
                         Potts functions will be discussed in detail in Section 4.5.

Our label permutation invariant functions can also be used to model topology prior. As an example we show in Section 6.3.2 an prior that enforce that segments have to be included by not more than one other segment, see also Fig. 1(b). Delong et al. [45] suggest to solve this problem by introducing geometric interactions on the label space. While this allows a simple reduction to the second-order case, the inclusion is conditioned on the labels and not on the topology of the partition, e.g. the prior of Delong et al. [45] can not restrict the label space to any sequence of including rings, because this is a pure topological prior without label dependencies, see Section 6.3.2 for details.


                        
                           
                              1.
                              We present a general framework for multicut problems, which includes Potts models as a special case. For the first time, we systematically compare different types of cutting-plane methods for the multicut problem in connection with computer vision applications.

Our framework also includes higher-order problems based on a new class of so-called label permutation invariant (LPI) functions. This class comprises all functions that are invariant to label permutations and thus provides a natural generalization of Potts functions.

We present several separation procedures and algorithmic variants that lead to significant speedups. These methods are then able to solve the problems to optimality or to provide an approximative solution in guaranteed polynomial time with bounded integrality gap.

We prove that these relaxed problems are equivalent to linear programs that use standard relaxations of the marginal polytope for general second-order Potts models.

Comprehensive numerical evaluations demonstrate the basic properties of our approach and enable us to rank the different variants.

We start in Section 2 with the problem formulation followed by introducing multicuts and corresponding problem transformations in Section 3. In Section 4 we extend the framework to higher-order models and show how corresponding higher-order terms can be taken into account in a memory-efficient way by exploiting symmetries.

We detail separation procedures for finding violated constraints in Section 5 and show how they can be implemented efficiently. Rounding mechanisms are discussed in Section 5.3. We conclude the framework with our cutting-plane method presented in Section 5.4 and generalize the connection to linear programs over the local polytope in Section 5.5.

Finally, we provide numerical evaluations for a large number of different models in Section 6, including second- and higher-order models in the supervised and unsupervised case, followed by concluding remarks in Section 7.

We consider discrete energy minimization problems given in terms of a factor graph
                        
                           
                              G
                              =
                              (
                              V
                              ,
                              F
                              ,
                              E
                              )
                              ,
                           
                         that is a bipartite graph with a set of variable nodes 
                           
                              V
                              ,
                           
                         a set of factors 
                           
                              F
                              ,
                           
                         and a corresponding relation 
                           
                              E
                              ⊆
                              V
                              ×
                              F
                           
                         associating variables to factors, cf. [46].

Variable xv
                         assigned to node 
                           
                              v
                              ∈
                              V
                           
                         takes values in a discrete label-space Xv
                        . We use the shorthands 
                           
                              
                                 X
                                 A
                              
                              =
                              
                                 ⨂
                                 
                                    v
                                    ∈
                                    A
                                 
                              
                              
                                 X
                                 v
                              
                           
                         and 
                           
                              
                                 x
                                 A
                              
                              =
                              
                                 
                                    (
                                    
                                       x
                                       v
                                    
                                    )
                                 
                                 
                                    v
                                    ∈
                                    A
                                 
                              
                           
                         for 
                           
                              A
                              ⊆
                              V
                              ,
                           
                         in particular 
                           
                              X
                              =
                              
                                 X
                                 V
                              
                           
                         and 
                           
                              x
                              =
                              
                                 x
                                 V
                              
                           
                        . In cases where all Xv
                         are equal we denote this label set by L.

Each factor 
                           
                              f
                              ∈
                              F
                           
                         has an associated function 
                           
                              
                                 φ
                                 f
                              
                              :
                              
                                 X
                                 
                                    n
                                    e
                                    (
                                    f
                                    )
                                 
                              
                              →
                              R
                              ,
                           
                         where

                           
                              (1)
                              
                                 
                                    n
                                    e
                                    (
                                    f
                                    )
                                    :
                                    =
                                    {
                                    v
                                    ∈
                                    V
                                    ∣
                                    (
                                    v
                                    ,
                                    f
                                    )
                                    ∈
                                    E
                                    }
                                 
                              
                           
                        denotes the neighborhood of the factor f, i.e., x
                        
                           ne(f) are the variables comprising f. We define the order of a factor by the cardinality |ne(f)|, e.g., pairwise factors have order 2, and the order of a model by the maximal order among all factors. We denote the set of all factors of order 
                           
                              N
                              ∋
                              r
                              ≥
                              1
                           
                         by 
                           
                              F
                              r
                           
                        . The energy function of the discrete labeling problem is then given by

                           
                              (2)
                              
                                 
                                    J
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          F
                                       
                                    
                                    
                                       φ
                                       f
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             n
                                             e
                                             (
                                             f
                                             )
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where values of the variables x are also called labelings. We consider the problem to find a labeling with minimal energy, i.e.,

                           
                              (3)
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    ∈
                                    
                                       
                                          arg
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                    J
                                    
                                       (
                                       x
                                       )
                                    
                                    ,
                                 
                              
                           
                        for specific classes of energy functions.

By using factor graph models we take the structural property of energy functions explicitly into account. Additionally, we also consider properties of the functions φ
                           f
                        . Specifically, we assume that any function with order greater than one is invariant to label permutations.

                           Definition 2.1
                           Label permutation invariant functions


                           A function 
                                 
                                    φ
                                    :
                                    
                                       L
                                       N
                                    
                                    →
                                    R
                                 
                               is called invariant to label permutations if ∀x, x′ ∈ LN
                               with 
                                 
                                    
                                       x
                                       i
                                    
                                    =
                                    
                                       x
                                       j
                                    
                                    ⇔
                                    
                                       x
                                       i
                                       ′
                                    
                                    =
                                    
                                       x
                                       j
                                       ′
                                    
                                 
                               the equality 
                                 
                                    φ
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    φ
                                    
                                       (
                                       
                                          x
                                          ′
                                       
                                       )
                                    
                                 
                               holds.

Many problems of interest are covered by models involving functions of this class.

Below, we will use for any predicate τ the corresponding indicator function

                           
                              (4)
                              
                                 
                                    I
                                    
                                       (
                                       τ
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   τ
                                                   
                                                   is
                                                   
                                                   true
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the supervised case we deal with energy functions (2),

                           
                              (P1)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ∈
                                                   X
                                                
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   
                                                      F
                                                      1
                                                   
                                                
                                             
                                             
                                                φ
                                                f
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      n
                                                      e
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   r
                                                   ≥
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   
                                                      F
                                                      r
                                                   
                                                
                                             
                                             
                                                φ
                                                f
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      n
                                                      e
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where φ
                           f
                        ( · ) is permutation invariant for all factors 
                           
                              f
                              ∈
                              
                                 F
                                 r
                              
                              ,
                              
                              r
                              ≥
                              2
                           
                        . Second-order models of this kind are known as Potts models, with 
                           
                              
                                 F
                                 r
                              
                              =
                              ∅
                           
                         for r > 2 and

                           
                              
                                 
                                    
                                       φ
                                       f
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             n
                                             e
                                             (
                                             f
                                             )
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       β
                                       f
                                    
                                    
                                    I
                                    
                                       (
                                       
                                          x
                                          
                                             n
                                             e
                                             
                                                
                                                   (
                                                   f
                                                   )
                                                
                                                1
                                             
                                          
                                       
                                       ≠
                                       
                                          x
                                          
                                             n
                                             e
                                             
                                                
                                                   (
                                                   f
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    f
                                    ∈
                                    
                                       F
                                       2
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 β
                                 f
                              
                              ∈
                              R
                           
                         is the coupling constant of factor f, and 
                           
                              n
                              e
                              
                                 
                                    (
                                    f
                                    )
                                 
                                 i
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                           
                         denotes the ith neighbor of f. Note, that we do not restrict the models to βf
                         ≥ 0. We focus on related higher-order models separately in Section 4.

Contrary to the supervised problem (P1), in the unsupervised case the set of first-order factors is empty and the number of labels equals the number of variables:

                           
                              (P2)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         {
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         |
                                                         V
                                                         |
                                                         }
                                                      
                                                      
                                                         |
                                                         V
                                                         |
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   ≥
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   
                                                      F
                                                      r
                                                   
                                                
                                             
                                             
                                                φ
                                                f
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      n
                                                      e
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the second-order case, (P2) is known as the pairwise correlation clustering problem, where a set of nodes 
                           V
                         has to be partitioned into clusters such that the sum of the costs of node-pairs in different clusters is minimized.

                           
                              
                                 
                                    
                                       (
                                       P
                                       
                                          2
                                          ′
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         {
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         |
                                                         V
                                                         |
                                                         }
                                                      
                                                      
                                                         |
                                                         V
                                                         |
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   
                                                      F
                                                      2
                                                   
                                                
                                             
                                             
                                                β
                                                f
                                             
                                             I
                                             
                                                (
                                                
                                                   x
                                                   
                                                      n
                                                      e
                                                      
                                                         
                                                            (
                                                            f
                                                            )
                                                         
                                                         1
                                                      
                                                   
                                                
                                                ≠
                                                
                                                   x
                                                   
                                                      n
                                                      e
                                                      
                                                         
                                                            (
                                                            f
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                       
                                       
                                          
                                             
                                                β
                                                f
                                             
                                             ∈
                                             R
                                          
                                       
                                    
                                 
                              
                           
                        As shown in [10] for the second-order case, solving problem (P2) with solvers commonly used for problem (P1), e.g., TRWS [21], does not work, since the large state-space and label permutation invariant functions cause large sets of optimal solutions. We study in this paper efficient methods for solving both (P1) and (P2) in the general case.

For an undirected graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                              ,
                           
                         
                        E⊆V × V, let 
                           
                              {
                              
                                 S
                                 1
                              
                              ,
                              …
                              ,
                              
                                 S
                                 k
                              
                              }
                           
                         be a partition of V, i.e., 
                           
                              
                                 ⋃
                                 
                                    i
                                    =
                                    1
                                 
                                 k
                              
                              
                                 S
                                 i
                              
                              =
                              V
                              ,
                           
                        
                        
                           
                              
                                 S
                                 i
                              
                              ∩
                              
                                 S
                                 j
                              
                              =
                              ∅
                              ,
                           
                         and 
                           
                              
                                 S
                                 i
                              
                              ≠
                              ∅
                           
                        . We call the edge set

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                (
                                                
                                                   S
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   S
                                                   k
                                                
                                                )
                                             
                                             :
                                             =
                                             
                                                {
                                                u
                                                v
                                                ∈
                                                E
                                                ∣
                                                ∃
                                                i
                                                ≠
                                                j
                                                :
                                                u
                                                ∈
                                                
                                                   S
                                                   i
                                                
                                                
                                                
                                                   and
                                                
                                                
                                                v
                                                ∈
                                                
                                                   S
                                                   j
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        a multicut and the sets Si
                         the shores of the multicut. To obtain a polyhedral representation of multicuts, we define incidence vectors χ(E′) ∈ {0, 1}|E| for each subset E′⊆E:

                           
                              (6)
                              
                                 
                                    
                                       χ
                                       e
                                    
                                    
                                       (
                                       
                                          E
                                          ′
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      e
                                                      ∈
                                                      
                                                         E
                                                         ′
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      e
                                                      ∈
                                                      E
                                                      ∖
                                                      
                                                         E
                                                         ′
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The multicut polytope
                        
                           
                              MC
                              (
                              G
                              )
                           
                         then is given by the convex hull

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             MC
                                             (
                                             G
                                             )
                                             :
                                             =
                                          
                                       
                                       
                                          
                                             conv
                                             
                                                {
                                                χ
                                                (
                                                δ
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      S
                                                      k
                                                   
                                                   )
                                                
                                                )
                                                ∣
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                δ
                                                (
                                                
                                                   S
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   S
                                                   k
                                                
                                                )
                                                
                                                is
                                                
                                                a
                                                
                                                multicut
                                                
                                                of
                                                
                                                G
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        Fig. 2
                         shows an example. For further details on the geometry of this and related polytopes, we refer to [7].

The multicut problem is to find a multicut in a weighted undirected graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              ,
                              w
                              )
                              ,
                           
                        
                        
                           
                              w
                              ∈
                              
                                 R
                                 
                                    |
                                    E
                                    |
                                 
                              
                              ,
                           
                         for which the sum of the weights of edges cut is minimal. Since all vertices (extreme points) of the multicut polytope correspond to multicuts, this amounts to solving the linear program

                           
                              (P3)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   y
                                                   ∈
                                                   MC
                                                   (
                                                   G
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   e
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                w
                                                e
                                             
                                             
                                             
                                                y
                                                e
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        In order to apply linear programming techniques, we have to represent 
                           
                              MC
                              (
                              G
                              )
                           
                         as intersection of half-spaces given by a system of affine inequalities. Since the multicut problem is NP-hard [47], we cannot expect to find a system of polynomial size. To overcome this limitation, we make use of the fact that most of these affine inequalities are not required for a given objective and use only a subset of those. The iterative construction of this subset is described in Section 5.

Before discussing how problem (P3) can be solved efficiently, we show how the problems (P1) and (P2) can be transformed into problem (P3).

To reformulate problem (P2) in the second-order case into a multicut problem we make use of the correspondence between a partition and a multicut. A given factor graph 
                           G
                         defines an undirected weighted graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              ,
                              w
                              )
                           
                         with 
                           
                              V
                              =
                              V
                              ,
                           
                        
                        
                           
                              E
                              =
                              {
                              
                                 (
                                 n
                                 e
                                 
                                    
                                       (
                                       f
                                       )
                                    
                                    1
                                 
                                 ,
                                 n
                                 e
                                 
                                    
                                       (
                                       f
                                       )
                                    
                                    2
                                 
                                 )
                              
                              ∣
                              f
                              ∈
                              
                                 F
                                 2
                              
                              }
                              ,
                           
                         and 
                           
                              
                                 w
                                 e
                              
                              =
                              
                                 ∑
                                 
                                    f
                                    ∈
                                    
                                       F
                                       2
                                    
                                    ,
                                    n
                                    e
                                    
                                       (
                                       f
                                       )
                                    
                                    =
                                    e
                                 
                              
                              
                                 β
                                 f
                              
                           
                         for all e ∈ E. Accordingly, the cost of a multicut is the sum of all βf
                         over factors f connecting different shores, which equals the costs of (P2) – see [8] for a formal proof and Fig. 3
                        (b) for an illustration.

Concerning problem (P1) for the second-order case we assume without loss of generality that 
                           
                              
                                 X
                                 v
                              
                              =
                              L
                              =
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 L
                                 |
                                 }
                              
                           
                         for all 
                           
                              v
                              ∈
                              V
                           
                        . Any labeling x ∈ X defines a partition of 
                           V
                        . To write a second-order problem (P1) as a multicut problem (P3), we introduce additional terminal nodes 
                           
                              T
                              =
                              
                                 {
                                 
                                    t
                                    l
                                 
                                 ∣
                                 l
                                 ∈
                                 L
                                 }
                              
                              =
                              
                                 {
                                 
                                    t
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    t
                                    
                                       |
                                       L
                                       |
                                    
                                 
                                 }
                              
                           
                         and define the undirected graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         by 
                           
                              V
                              =
                              V
                              ∪
                              T
                              ,
                           
                        
                        
                           
                              E
                              =
                              
                                 {
                                 
                                    (
                                    n
                                    e
                                    
                                       
                                          (
                                          f
                                          )
                                       
                                       1
                                    
                                    ,
                                    n
                                    e
                                    
                                       
                                          (
                                          f
                                          )
                                       
                                       2
                                    
                                    )
                                 
                                 ∣
                                 f
                                 ∈
                                 
                                    F
                                    2
                                 
                                 }
                              
                              ∪
                              
                                 {
                                 
                                    (
                                    t
                                    ,
                                    v
                                    )
                                 
                                 ∣
                                 t
                                 ∈
                                 T
                                 ,
                                 v
                                 ∈
                                 V
                                 }
                              
                              
                                 ∪
                                 {
                              
                              
                                 (
                                 
                                    t
                                    i
                                 
                                 ,
                                 
                                    t
                                    j
                                 
                                 )
                              
                              ∣
                              1
                              ≤
                              i
                              <
                              j
                              ≤
                              
                                 |
                                 L
                                 |
                                 }
                                 ,
                              
                           
                         cf. Fig. 3(a). Thus each internal node 
                           
                              v
                              ∈
                              V
                           
                         is connected to all terminal nodes t ∈ T by terminal-edges (t, v).

The terminal nodes represent the |L| labels l ∈ L, and label l is assigned to variable xv
                         if the terminal-edge tlv is not part of the multicut, i.e., tl
                         and v are in the same shore. Since a single label only should be assigned to each variable, 
                           
                              |
                              L
                              |
                              −
                              1
                           
                         terminal-edges incident to each internal node v have to be part of the multicut. This is enforced by 
                           
                              |
                              V
                              |
                           
                         additional constraints given by (26) below where we take a closer look to classes of valid constraints. Edges between terminal nodes have weight 0 but are enforced to belong to different shores by additional constraints (27), which results in the so-called multiway cut polytope.

It remains to define the weights of terminal edges. Let 
                           
                              1
                              
                                 
                                    1
                                 
                                 ⊤
                              
                           
                         be the matrix of all ones and I be the identity matrix, both of size |L| × |L| and

                           
                              (8)
                              
                                 
                                    
                                       g
                                       v
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          n
                                          e
                                          
                                             (
                                             v
                                             )
                                          
                                          ∩
                                          
                                             F
                                             1
                                          
                                       
                                    
                                    
                                       φ
                                       f
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                    ,
                                    
                                    l
                                    ∈
                                    L
                                    .
                                 
                              
                           
                        Then the weights 
                           
                              
                                 w
                                 
                                    
                                       t
                                       l
                                    
                                    v
                                 
                              
                              ,
                           
                         
                        l ∈ L, v ∈ V, are given by

                           
                              (9)
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   w
                                                   
                                                      
                                                         t
                                                         1
                                                      
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   w
                                                   
                                                      
                                                         t
                                                         
                                                            |
                                                            L
                                                            |
                                                         
                                                      
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          L
                                          |
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       1
                                       
                                          1
                                          ⊤
                                       
                                       −
                                       I
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                      v
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                      v
                                                   
                                                   
                                                      (
                                                      |
                                                      L
                                                      |
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        As before we set 
                           
                              
                                 w
                                 e
                              
                              =
                              
                                 ∑
                                 
                                    f
                                    ∈
                                    
                                       F
                                       2
                                    
                                    ,
                                    n
                                    e
                                    
                                       (
                                       f
                                       )
                                    
                                    =
                                    e
                                 
                              
                              
                                 β
                                 f
                              
                           
                         for internal edges e.

We turn to higher-order models. First, we specify a class of higher-order functions which are invariant to label permutations, and show, after detailing a reduction approach, how such functions can be incorporated into a multicut framework. In its most general form, cf. Sections 4.1 and 4.3, the space complexity of representing these functions in an LP grows with the Bell number. Consequently, factors of an order more than ten are no longer tractable in this general form, cf. Table 1
                     . However, for important subclasses of label permutation invariant functions efficient LP-representations exist. We will exemplary consider one such subclass of functions that can be handled even when the function comprises an order larger than several hundreds in Section 4.4 and show an application with factors of order 651 in Section 6.2.3.

An important class of functions are label permutation invariant (LPI) functions, whose values only depend on the partitioning of the variables rather than on the labeling, as specified by Definition 2.1. They generalize Potts functions
                           1
                        
                        
                           1
                           The additional assumption that 
                                 
                                    
                                       α
                                       0
                                    
                                    
                                    
                                       or
                                    
                                    
                                    
                                       α
                                       1
                                    
                                    =
                                    0
                                 
                               can be ensured by a constant added to the function
                         
                        (10) in a natural way.

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            α
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            =
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            else
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In other words, they can be evaluated by just knowing for all variable-pairs if their labels are identical or not. The specific label of a single variable does not matter. Any function that is evaluated on 
                           
                              
                                 (
                                 I
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    =
                                    
                                       x
                                       j
                                    
                                    )
                                 
                                 )
                              
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 A
                              
                           
                         instead of xA
                         itself, as e.g. the Potts function, is a label permutation invariant function. A further property is that the complexity of evaluating and storing of label permutation invariant functions does not grow with the number of labels.

Each possible partition of N variables is uniquely represented by a binary vector over all 
                           
                              N
                              (
                              N
                              −
                              1
                              )
                              /
                              2
                           
                         variable-pairs. But not each binary vector 
                           
                              χ
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    N
                                    (
                                    N
                                    −
                                    1
                                    )
                                    /
                                    2
                                 
                              
                           
                         corresponds to a partition, cf. Fig. 2. The number of possible partitions is much smaller and given by the Bell numbers B(N) [48]. This observation raises the issue of an efficient representation of these functions, independent of the number of labels.

Let us denote for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              B
                              (
                              N
                              )
                           
                         by 
                           
                              
                                 χ
                                 i
                                 N
                              
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    N
                                    (
                                    N
                                    −
                                    1
                                    )
                                    /
                                    2
                                 
                              
                           
                         the indicator vector of the i-th partition of N variables. Furthermore, we define a mapping 
                           
                              
                                 τ
                                 N
                              
                              :
                              
                                 L
                                 N
                              
                              →
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    N
                                    (
                                    N
                                    −
                                    1
                                    )
                                    /
                                    2
                                 
                              
                           
                         from a variable-labeling to the partition indicator by

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                τ
                                                N
                                             
                                             
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            ≠
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            =
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             
                                             0
                                             <
                                             i
                                             <
                                             j
                                             <
                                             N
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With this we can represent any label permutation invariant function over 
                           
                              N
                              =
                              |
                              A
                              |
                           
                         variables parameterized by 
                           
                              β
                              ∈
                              
                                 R
                                 
                                    B
                                    (
                                    N
                                    )
                                 
                              
                              ,
                           
                         where βi
                         is the cost for the ith partition of the sub-graph over the node-set A,

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                
                                                   L
                                                   P
                                                   I
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   A
                                                
                                                |
                                                β
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                β
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                if
                                             
                                             
                                             
                                                τ
                                                
                                                   |
                                                   A
                                                   |
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                χ
                                                i
                                                
                                                   |
                                                   A
                                                   |
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        As example let us consider the node-set 
                           
                              A
                              =
                              {
                              1
                              ,
                              2
                              ,
                              3
                              }
                           
                        . There are 
                           
                              8
                              =
                              
                                 2
                                 3
                              
                           
                         different binary labelings of the edges between these nodes. Only 
                           
                              5
                              =
                              B
                              (
                              3
                              )
                           
                         of them form a valid partition and will therefore appear. We enumerate these valid partitions and assign to each a weight denoted by βi
                        . For a given node-labeling xA
                         we then can calculate its binary edge-labeling τ
                        |A|(x), which corresponds one-to-one to a partition, and return the cost βi
                         of this partition. Note that this function has only five parameters and does not dependent on the size of the label-space.

In order to incorporate label permutation invariant functions into our multicut framework, we introduce the following reduction theorem. The basic idea of this theorem is known in the field of integer nonlinear optimization, dating back to the work of Glover et al. [49], but seemed to be unknown in other fields of research as e.g. computer vision.

                           Theorem 4.1
                           Reduction theorem


                           
                              Any pseudo-Boolean function
                              
                                 
                                    g
                                    :
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       M
                                    
                                    →
                                    R
                                 
                               
                              given by
                              
                                 
                                    g
                                    
                                       (
                                       z
                                       )
                                    
                                    =
                                    
                                       ∏
                                       
                                          i
                                          ∈
                                          
                                             B
                                             +
                                          
                                       
                                    
                                    
                                       z
                                       i
                                    
                                    ·
                                    
                                       ∏
                                       
                                          i
                                          ∈
                                          
                                             B
                                             −
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          z
                                          i
                                       
                                       )
                                    
                                    ,
                                 
                               
                              with
                              
                                 
                                    
                                       |
                                    
                                    
                                       B
                                       +
                                    
                                    ∪
                                    
                                       B
                                       −
                                    
                                    
                                       |
                                       =
                                       M
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       B
                                       +
                                    
                                    ∩
                                    
                                       B
                                       −
                                    
                                    =
                                    ∅
                                    ,
                                 
                               
                              can be transformed into
                              
                                 
                                    
                                       (a)
                                    
                                    
                                       a single Boolean auxiliary variable s ∈ {0, 1} and two linear inequalities
                                       
                                          
                                             (13a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               min
                                                               
                                                                  z
                                                                  ∈
                                                                  
                                                                     
                                                                        {
                                                                        0
                                                                        ,
                                                                        1
                                                                        }
                                                                     
                                                                     M
                                                                  
                                                                  ,
                                                                  
                                                                  s
                                                                  ∈
                                                                  
                                                                     {
                                                                     0
                                                                     ,
                                                                     1
                                                                     }
                                                                  
                                                               
                                                            
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (13b)
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                            .
                                                            t
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            M
                                                            s
                                                            ≤
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     +
                                                                  
                                                               
                                                            
                                                            
                                                               z
                                                               i
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     −
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  z
                                                                  i
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (13c)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            s
                                                            ≥
                                                            1
                                                            −
                                                            M
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     +
                                                                  
                                                               
                                                            
                                                            
                                                               z
                                                               i
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     −
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  z
                                                                  i
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       or
                                    


                                       a single auxiliary variable s ∈ [0, 1] and
                                       
                                          
                                             M
                                             +
                                             1
                                          
                                        
                                       inequalities
                                       
                                          
                                             (14a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               min
                                                               
                                                                  z
                                                                  ∈
                                                                  
                                                                     
                                                                        {
                                                                        0
                                                                        ,
                                                                        1
                                                                        }
                                                                     
                                                                     M
                                                                  
                                                                  ,
                                                                  
                                                                  s
                                                                  ∈
                                                                  
                                                                     [
                                                                     0
                                                                     ,
                                                                     1
                                                                     ]
                                                                  
                                                               
                                                            
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (14b)
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                            .
                                                            t
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                            ≤
                                                            
                                                               z
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∀
                                                            i
                                                            ∈
                                                            
                                                               B
                                                               +
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (14c)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            s
                                                            ≤
                                                            (
                                                            1
                                                            −
                                                            
                                                               z
                                                               i
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∀
                                                            i
                                                            ∈
                                                            
                                                               B
                                                               −
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (14d)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            s
                                                            ≥
                                                            1
                                                            −
                                                            M
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     +
                                                                  
                                                               
                                                            
                                                            
                                                               z
                                                               i
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  
                                                                     B
                                                                     −
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  z
                                                                  i
                                                               
                                                               )
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

The function g(z) takes the value 1 if and only if 
                                 
                                    ∀
                                    i
                                    ∈
                                    
                                       B
                                       +
                                    
                                    :
                                    
                                    
                                       z
                                       i
                                    
                                    =
                                    1
                                 
                               and 
                                 
                                    ∀
                                    i
                                    ∈
                                    
                                       B
                                       −
                                    
                                    :
                                    
                                       z
                                       i
                                    
                                    =
                                    0
                                    ,
                                 
                               and otherwise 
                                 
                                    g
                                    (
                                    z
                                    )
                                    =
                                    0
                                 
                              . It remains to show that the systems of inequalities together with s ∈ {0, 1} or s ∈ [0, 1] restrict the feasible set such that 
                                 
                                    s
                                    =
                                    g
                                    (
                                    z
                                    )
                                 
                              .

Let k denote the number of vanishing terms of g(z)

                                 
                                    
                                       
                                          k
                                          =
                                          
                                             |
                                             
                                                {
                                                i
                                                ∈
                                                
                                                   B
                                                   +
                                                
                                                ∣
                                                
                                                   z
                                                   i
                                                
                                                =
                                                0
                                                }
                                             
                                             ∪
                                             
                                                {
                                                i
                                                ∈
                                                
                                                   B
                                                   −
                                                
                                                ∣
                                                
                                                   z
                                                   i
                                                
                                                =
                                                1
                                                }
                                             
                                             |
                                          
                                       
                                    
                                 
                              then:

                                 
                                    (a)
                                    Inequalities (13b) and (13c) imply

                                          
                                             (15)
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                            ≤
                                                            1
                                                            −
                                                            
                                                               k
                                                               M
                                                            
                                                            ,
                                                            
                                                            s
                                                            ≥
                                                            1
                                                            −
                                                            k
                                                            
                                                            
                                                               ⇒
                                                               
                                                                  s
                                                                  ∈
                                                                  {
                                                                  0
                                                                  ,
                                                                  1
                                                                  }
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                        =
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           if
                                                                        
                                                                        
                                                                        k
                                                                        =
                                                                        0
                                                                        ,
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        s
                                                                        =
                                                                        0
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           if
                                                                        
                                                                        
                                                                        k
                                                                        >
                                                                        0
                                                                        .
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Inequalities (14b)–(14d) yield

                                          
                                             (16)
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            14
                                                            b
                                                            )
                                                            −
                                                            (
                                                            14
                                                            c
                                                            )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⇒
                                                            s
                                                            ≤
                                                            0
                                                            
                                                            
                                                               ⇒
                                                               
                                                                  s
                                                                  ∈
                                                                  [
                                                                  0
                                                                  ,
                                                                  1
                                                                  ]
                                                               
                                                            
                                                            
                                                            s
                                                            =
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            k
                                                            >
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (17)
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            14
                                                            d
                                                            )
                                                            
                                                            
                                                            
                                                            
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⇒
                                                            s
                                                            ≥
                                                            1
                                                            
                                                            
                                                               ⇒
                                                               
                                                                  s
                                                                  ∈
                                                                  [
                                                                  0
                                                                  ,
                                                                  1
                                                                  ]
                                                               
                                                            
                                                            
                                                            s
                                                            =
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            k
                                                            =
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       □

A crucial observation is that case (b) of the reduction theorem implies integrality of s if all zi
                         ∈ {0, 1}, whereas in case (a) this has to be enforced separately by s ∈ {0, 1}. Consequently, case (b) leads to tighter relaxations by only enforcing s ∈ [0, 1].

While reduction (b) thus seems to be preferable, due to a lower number of constraints, reduction (a) can be nevertheless appealing for some (I)LP-solver techniques, e.g., dual simplex. The reason is that sometimes a single constraint (13b) is a less tight but a sufficient relaxation compared to several small constraints (14b) and (14c)
                        
                           2
                        
                        
                           2
                           Consider the case 
                                 
                                    
                                       B
                                       +
                                    
                                    =
                                    
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       z
                                       1
                                    
                                    =
                                    0.1
                                 
                               and 
                                 
                                    
                                       z
                                       1
                                    
                                    =
                                    0.3
                                 
                              . Eqs. (13b) and (14b) give s ≤ 2 and s ≤ 0.1, respectively.
                        . In our experiments, we therefore use all 
                           
                              M
                              +
                              2
                           
                         constraints (13b),(13c) and (14b), (14c) (note that (13c) equals (14d)), and let the solver choose the active constraint set.

In order to apply Theorem 4.1 to a label permutation invariant function (12) of order 
                           
                              N
                              =
                              |
                              A
                              |
                           
                         we rewrite it as a pseudo-Boolean function

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                
                                                   L
                                                   P
                                                   I
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   A
                                                
                                                |
                                                β
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   B
                                                   (
                                                   N
                                                   )
                                                
                                             
                                             
                                                β
                                                i
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         ∏
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               N
                                                               (
                                                               N
                                                               −
                                                               1
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                      l
                                                      
                                                         (
                                                         
                                                            
                                                               [
                                                               
                                                                  χ
                                                                  i
                                                                  N
                                                               
                                                               ]
                                                            
                                                            j
                                                         
                                                         ,
                                                         
                                                            
                                                               [
                                                               
                                                                  τ
                                                                  N
                                                               
                                                               
                                                                  (
                                                                  x
                                                                  )
                                                               
                                                               ]
                                                            
                                                            j
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      g
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         τ
                                                         N
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with

                           
                              (19)
                              
                                 
                                    l
                                    
                                       (
                                       
                                          b
                                          1
                                       
                                       ,
                                       
                                          b
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      b
                                                      2
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         b
                                                         1
                                                      
                                                      =
                                                      0
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                      2
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         b
                                                         1
                                                      
                                                      =
                                                      1
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We apply the reduction theorem to each of the B(N) binary functions 
                           
                              
                                 g
                                 i
                              
                              
                                 (
                                 z
                                 )
                              
                              ,
                              
                              z
                              =
                              
                                 τ
                                 N
                              
                              
                                 (
                                 x
                                 )
                              
                           
                        . Consequently, a function φ
                           LPI
                        (xA
                        |β) of order N requires B(N) auxiliary variables. These auxiliary variables are connected to the node-variables via the Boolean expressions l( ·, ·) in (19) and correspond to the edge-variables y used in the multicut representation (P3). By this, we also get rid of difficulties caused by ambiguities of the node-label representation of a partition.

If an expression l( ·, ·) has no corresponding edge e in G, we add this edge to G with weight zero.

Summing up, to include an label permutation invariant factor of order N into our multicut framework, we require at most 
                           
                              N
                              (
                              N
                              −
                              1
                              )
                              /
                              2
                           
                         edge variables, B(N) auxiliary variables, and 
                           
                              B
                              (
                              N
                              )
                              ·
                              (
                              N
                              (
                              N
                              −
                              1
                              )
                              /
                              2
                              +
                              2
                              )
                           
                         linear inequalities. These numbers are upper bounds, of course. In many cases more compact representations are obtained.

We observed in numerous experiments that additionally enforcing that all auxiliary variables corresponding to a higher-order term sum up to 1 significantly speeds up optimization. This entails to complement a single equality constraint for each higher-order term.


                        Fig. 4
                        (a) illustrates an example of a factor of order three. The reduction requires 
                           
                              B
                              (
                              3
                              )
                              =
                              5
                           
                         auxiliary variables corresponding to possible partitions and, correspondingly, they are denoted by 000, ..., 111 in the figure. Constraints generated by the reduction theorem relate these auxiliary variables to the original higher-order problem. A single additional edge shown dotted in Fig. 4(a), has to be added to the graph G in this example.

A subclass of label permutation invariant functions that can be handled more efficiently, are functions taking the value α
                        0 if all variables xA
                         with A⊆V have the same label (are in the same shore) and α
                        1 otherwise. We call such functions higher-order (HO) Potts functions since they constitute the simplest generalization of (second-order) Potts functions to the higher-order case. Such functions are general enough to model the costs of a hyper-graph partitioning, which was used in [1,50]. The cost for a hyper-edge is included in the overall cost function if the hyper-edge connects at least two shores:

                           
                              (20)
                              
                                 
                                    
                                       φ
                                       
                                          H
                                          O
                                          P
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          A
                                       
                                       |
                                       α
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                      0
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      ∀
                                                      i
                                                      ,
                                                      j
                                                      ∈
                                                      A
                                                      :
                                                      
                                                      
                                                         x
                                                         i
                                                      
                                                      =
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                      1
                                                   
                                                   ,
                                                
                                             
                                             
                                                else.
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We can reformulate such functions in a pseudo-Boolean form:

                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                
                                                   H
                                                   O
                                                   P
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   A
                                                
                                                |
                                                α
                                                )
                                             
                                             =
                                             
                                                α
                                                1
                                             
                                             +
                                             
                                                (
                                                
                                                   α
                                                   0
                                                
                                                −
                                                
                                                   α
                                                   1
                                                
                                                )
                                             
                                             
                                                ∏
                                                
                                                   e
                                                   ∈
                                                   
                                                      E
                                                      A
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   y
                                                   e
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where EA
                         is a subset of the edges of G that spans A. If 
                           
                              
                                 G
                                 A
                              
                              =
                              
                                 (
                                 A
                                 ,
                                 E
                                 ∩
                                 
                                    (
                                    A
                                    ×
                                    A
                                    )
                                 
                                 )
                              
                           
                         is disconnected we have to add some edges with weight 0. We point out our empirical observation that using a spanning graph that includes all edges of GA
                        , instead of an arbitrary spanning-tree, leads to shorter runtimes.

As before, we apply the reduction theorem to add a higher-order Potts function as part of a model at hand. This only requires a single auxiliary variable. Fig. 4(b) provides a sketch for a function of order three.


                        Table 1 shows the number auxiliary variables, size of auxiliary factors and number of additional constraints needed by the different reductions to add a HO-Potts Function with L labels and order N. Including a higher-order Potts function as a factor-table requires no additional variables but a factor with LN
                         entries. L · N constraints are only required when it is reformulated into an LP. When we use the generic reduction for LPI functions we make no use of all symmetries and need B(N) auxiliary variables and factors, together with 
                           
                              B
                              (
                              N
                              )
                              ·
                              (
                              N
                              +
                              2
                              )
                              +
                              1
                           
                         constraints. While no additional constraints are needed for including this into an LP, the Bell number B(N) makes this intractable for larger N’s. When using HO-Potts functions we need only one single auxiliary variable together with 
                           
                              N
                              +
                              2
                           
                         constraints. This is much smaller than all other alternatives and does not depend on the number of labels.

Another generalization of Potts functions for higher-order called PN
                         Potts (22) has been suggested by Kohli et al. [35].

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                x
                                                A
                                             
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            γ
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               if
                                                            
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            =
                                                            k
                                                            
                                                            ∀
                                                            i
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                      
                                                      
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                γ
                                                k
                                             
                                             ≤
                                             
                                                γ
                                                ¯
                                             
                                             ,
                                             
                                             ∀
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        The assumption that 
                           
                              
                                 γ
                                 k
                              
                              ≤
                              
                                 γ
                                 ¯
                              
                              
                              ∀
                              k
                           
                         ensures sub-modular auxiliary problems [35]. From a modeling point of view this is not necessary.

If all γk
                         are equal and 
                           
                              |
                              A
                              |
                              =
                              2
                              ,
                           
                         then (22) is equivalent to Potts function (10). When we enforce 
                           
                              
                                 γ
                                 k
                              
                              ≤
                              
                                 γ
                                 ¯
                              
                              
                              ∀
                              k
                           
                         it is equivalent to Potts function with positive coupling, denoted as Potts+ in Fig. 5
                        .

If γk
                         vary with k the function is no longer invariant to label permutation. However, Pn
                        -Potts functions are not powerful enough to model all label permutation invariant functions. For example Pn
                        -Potts functions assign to (1, 1, 1, 2, 3) and (1, 1, 1, 2, 2) always the same energy, but those are different partitions into 3 and 2 clusters, respectively. The same hold for robust Pn
                        -Potts functions (23) 
                        [35]
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                x
                                                A
                                             
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             min
                                             
                                                {
                                                
                                                   min
                                                   k
                                                
                                                
                                                   {
                                                   
                                                      γ
                                                      k
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         A
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         −
                                                         
                                                            γ
                                                            k
                                                         
                                                      
                                                      Q
                                                   
                                                   I
                                                   
                                                      (
                                                      
                                                         x
                                                         i
                                                      
                                                      ≠
                                                      k
                                                      )
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   γ
                                                   ¯
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             with
                                             
                                             
                                                γ
                                                k
                                             
                                             ≤
                                             
                                                γ
                                                ¯
                                             
                                             
                                             ∀
                                             k
                                             
                                             and
                                             
                                             Q
                                             <
                                             
                                                
                                                   |
                                                   A
                                                   |
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which cover a large subclass functions but still only a small subset of LPI functions.


                        Fig. 5 illustrate the relation between PN
                         Potts and LPI functions. Even if we would not enforce that 
                           
                              
                                 γ
                                 k
                              
                              ≤
                              
                                 γ
                                 ¯
                              
                              
                              ∀
                              k
                           
                         then PN
                        -Potts would not include all LPI functions. The intersection between PN
                        -Potts and label LPI-functions are HO-Potts functions (12). A reduction of a HO-Potts functions as Pn
                        -Potts function needs L auxiliary variables, L factors of size N and L of size 1. Constraints are only required when it is reformulated into an LP. Especially for large L this is much more expensive than the reduction introduced in Section 4.4. As for Potts functions the framework suggested in [35] does only cover cases where 
                           
                              
                                 γ
                                 k
                              
                              ≤
                              
                                 γ
                                 ¯
                              
                           
                        .

Determining a multicut with minimal costs is NP-hard in general [47]. However, if given data induce some structure then it is plausible to expect such problems to be easier solvable in practice, than problems without any structure.

We use a cutting-plane approach to iteratively tighten an outer relaxation of the form

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   arg
                                                   min
                                                
                                                
                                                   y
                                                   ∈
                                                   Y
                                                
                                             
                                             
                                                ∑
                                                
                                                   e
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                w
                                                e
                                             
                                             
                                             
                                                y
                                                e
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here, 
                           
                              Y
                              ⊇
                              MC
                              (
                              G
                              )
                           
                         is superset of the multicut polytope 
                           
                              MC
                              (
                              G
                              )
                           
                         (cf. (P3)) or 
                           
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    |
                                    E
                                    |
                                 
                              
                              ⊃
                              Y
                              ⊇
                              MC
                              
                                 (
                                 G
                                 )
                              
                              ∩
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    |
                                    E
                                    |
                                 
                              
                           
                         in the integer case. In each step we solve a problem relaxation in terms of a linear or integer linear program, detect violated constraints from a pre-specified finite list (cf. Section 5.2) and augment the constraint system accordingly. This separation procedure is repeated until no more violated constraints are found.

After each iteration we obtain a lower bound as the solution of the (I)LP and an upper bound by mapping the obtained solution to the set of feasible points (rounding, cf. Section 5.3).

We start with a polytope that enforces any edge-variable ye
                            to be lower and upper bounded by 0 and 1, respectively,

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                y
                                                e
                                             
                                          
                                          
                                             
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                e
                                                ∈
                                                E
                                             
                                          
                                       
                                    
                                 
                              
                           In presence of terminal nodes, we additionally enforce for each non-terminal node v ∈ V∖T that exactly one incident edge is not cut, i.e.,

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                |
                                                T
                                                |
                                                −
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   if
                                                
                                                
                                                T
                                                ≠
                                                ∅
                                                ,
                                                
                                                ∀
                                                v
                                                ∈
                                                V
                                                ∖
                                                T
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Furthermore, we add the compulsory constraints

                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                t
                                                ,
                                                
                                                   t
                                                   ′
                                                
                                                ∈
                                                T
                                                ,
                                                t
                                                ≠
                                                
                                                   t
                                                   ′
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           forcing different terminal nodes to belong to different shores.

A more restrictive alternative to (25) are the integer constraints

                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                y
                                                e
                                             
                                          
                                          
                                             
                                                ∈
                                                {
                                                0
                                                ,
                                                1
                                                }
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                e
                                                ∈
                                                E
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that not every vector y ∈ {0, 1}|E| belongs to the multicut polytope. Hence, even enforcing Boolean variable values may lead to inconsistent edge-labelings, cf. Fig. 6
                           , which will be discussed in more detail in the following subsection. In general, using constraints (28) renders inference problems more difficult. On the other hand, finding violated constraints can be much simpler for Boolean-valued variables than for less tight non-Boolean relaxations. This may well compensate the additional costs for solving an ILP instead of an LP
                              3
                           
                           
                              3
                              Note, sometimes solving the ILP is even faster than the LP.
                           .

The problem of inconsistent edge-labelings has been considered in the literature, either motivated by closing contours [2,15] or as tightening the multicut polytope relaxation via cycle constraints [1,9,10,12]. In both cases inconsistent cycles are detected. If integer constraints are enforced an inconsistent cycle is a cycle that contains exactly a single cut edge, which obviously violates transitivity. This can be generalized to the relaxed non-Boolean case ye
                            ∈ [0, 1] [9].

A system of cycle inequalities that necessarily has to be satisfied by consistent labelings, is given by

                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      e
                                                      ∈
                                                      P
                                                   
                                                
                                                
                                                   y
                                                   e
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                P
                                                ∈
                                                
                                                   Path
                                                
                                                
                                                (
                                                u
                                                ,
                                                v
                                                )
                                                ⊆
                                                E
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           It is well known [9] that if and only if the cycle {uv}∪P is chordless, then the constraint is facet-defining for the underlying polytope or, speaking less technically, “effective” for enforcing labeling consistency.

While for fully connected graphs, (29) can be represented by a polynomial number of triangle constraints [6,9,51], the separation procedure reduces to a sequence of shortest path problems in the general case [9]. Given y, the naive approach searches for each edge uv ∈ E the shortest path from u to v in the weighted graph 
                              
                                 
                                    G
                                    y
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    E
                                    ,
                                    y
                                    )
                                 
                              
                           . If this path is shorter than yuv
                           , then it represents the most violated constraint of the form (29) for uv. Using a basic implementation of Dijkstra (as we do) the cost for one search is O(|V|2). The cost can be reduced to 
                              
                                 O
                                 (
                                 |
                                 E
                                 |
                                 +
                                 |
                                 V
                                 |
                                 log
                                 |
                                 V
                                 |
                                 )
                              
                            by using Fibonacci heaps.

To reduce the number of shortest path searches we exploit the following three ideas:


                           Efficient bounds on the shortest path (B): Instead of searching for each edge uv ∈ E the shortest path from u to v in a positive weighted graph 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ,
                                 y
                                 )
                                 ,
                              
                            we can calculate a lower bound on the path length for all uv ∈ E in 
                              
                                 O
                                 (
                                 |
                                 E
                                 |
                                 +
                                 |
                                 V
                                 |
                                 )
                              
                           . To this end, we determine the connected components in the graph 
                              
                                 
                                    G
                                    ′
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       {
                                       e
                                       ∈
                                       E
                                       ∣
                                       
                                          y
                                          e
                                       
                                       <
                                       γ
                                       }
                                    
                                    )
                                 
                              
                           . If two nodes u, v ∈ V are not in the same connected component, the shortest path from u to v is greater than or equal to γ. Choosing 
                              
                                 γ
                                 =
                                 1
                              
                            yields a preprocessing procedure that enables to omit many shortest path searches. Furthermore, if the edge between two nodes has weight 0, this is obviously the shortest path since all edge-weights ye
                            are non-negative.


                           Shortest path in binary weighted graph (I): If the edge weights are either 0 or 1, then simple breadth-first search can be applied instead of the Dijkstra algorithm. The computational effort can be further reduced, as before but without additional costs, by restricting the search to the graph 
                              
                                 
                                    G
                                    0
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       {
                                       e
                                       ∈
                                       E
                                       ∣
                                       
                                          y
                                          e
                                       
                                       =
                                       0
                                       }
                                    
                                    )
                                 
                              
                           . Since any path including an edge with weight 1 cannot be shorter than the edge between the two nodes which is 0 or 1.


                           Finding chordless shortest paths/facet-defining constraints (F): A path between the two nodes forming an edge is called chordless if the cycle consisting of the path and the edge has no chord. Shortest path search can be easily extended so as to determine the shortest chordless paths: Every node except for the end-node is not updated by the Dijkstra algorithm if the path from this node to the starting node is chordal. This increases the costs by a factor bounded by |V|. In view of cycle constraints, the corresponding constraints are facet-defining.

Our experiments, discussed by Fig. 7
                            and in Section 6, spot that joint application of bounding procedures, facet-defining constraints (chordless paths) and dedicated search methods for binary weighted graphs, leads to better runtimes in nearly all cases.

In the supervised case we can further reduce the costs for shortest path searches based on the following lemma.

                              Lemma 5.1
                              
                                 In the presence of terminals there exists no cycle C with more than three nodes that is chordless and contains a terminal node.
                              

Let C be a cycle with more than three nodes that contains a terminal node t, and select an edge uv in C with u, v ≠ t. The tu, tv ∈ E by definition, hence the cycle is chordal.□

As a result of Lemma 5.1, we ignore all cycle constraint of a length greater than 3 that includes a terminal node. All facet-defining cycle constraints that include a terminal node are then given by

                              
                                 (30)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           together with (27). As a consequence we only have to search for general cycle constraints on the graph without terminal nodes, that has |T| · |V| fewer edges!

Calinescu et al. [52] suggested another class of non-facet-defining linear inequalities for the supervised case that further tightens the outer polytope relaxation:

                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   u
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      S
                                                   
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         t
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         v
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                S
                                                ⊆
                                                T
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Intuitively, these constraints enforce each non-terminal edge to be at least as “much cut” as all its terminal edge-pairs indicate. Since 
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       y
                                       
                                          t
                                          u
                                       
                                    
                                    −
                                    
                                       y
                                       
                                          t
                                          v
                                       
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            we only consider differences in the direction u → v. An alternative representation of (33) exploiting symmetry is

                              
                                 (34)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ≥
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   1
                                                   2
                                                
                                                
                                                   |
                                                   
                                                      y
                                                      
                                                         t
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         v
                                                      
                                                   
                                                   |
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In order to see why multi terminal constraints are useful, let us consider a tiny toy example of a model with two variables and four labels. Overall, the multiway cut polytope has eight terminal edges (t, 1)
                              t ∈ T
                           , (t, 2)
                              t ∈ T
                            and a single edge (1, 2) between the two nodes. We inspect few values of y and check if (33) is implied by (30)–(32) or not.


                           
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                          (29)–(31)
                                          (32)
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   0
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⇒
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⇒
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                      1
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⇒
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                   ≤
                                                   
                                                      3
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   
                                                      2
                                                      10
                                                   
                                                   ,
                                                   
                                                      3
                                                      10
                                                   
                                                   ,
                                                   
                                                      5
                                                      10
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   ,
                                                   
                                                      1
                                                      10
                                                   
                                                   ,
                                                   
                                                      2
                                                      10
                                                   
                                                   ,
                                                   
                                                      7
                                                      10
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⇒
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      10
                                                   
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                   ≤
                                                   
                                                      3
                                                      10
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      10
                                                   
                                                   ≤
                                                   
                                                      y
                                                      12
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the third example (row) above, multi terminal constraints tighten the relaxation. It can be shown that these constraints may tighten the relaxation only if at least four terminal nodes are present.

While cycle constraints are only sufficient to obtain optimal solutions if integer constraints are enforced, we may tighten the relaxation in the case ye
                            ∈ [0, 1] by adding more complex constraints.

One such a class of constraints for which the separation procedure can be carried out efficiently, are odd-wheel constraints. A wheel
                           
                              
                                 W
                                 =
                                 (
                                 
                                    V
                                    W
                                 
                                 ,
                                 
                                    E
                                    W
                                 
                                 )
                              
                            is a graph with a selected center node c ∈ VW
                           . All other nodes are connected with the center, and the remaining edges build a cycle containing all nodes in VW
                           ∖{c}. An odd-wheel is a wheel with an odd number of non-center nodes. The odd-wheel constraints are given by

                              
                                 (35)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      u
                                                      v
                                                      ∈
                                                      
                                                         E
                                                         W
                                                      
                                                      ,
                                                      u
                                                      ,
                                                      v
                                                      ≠
                                                      c
                                                   
                                                
                                                
                                                   w
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      v
                                                      ∈
                                                      
                                                         V
                                                         W
                                                      
                                                      ∖
                                                      
                                                         {
                                                         c
                                                         }
                                                      
                                                   
                                                
                                                
                                                   w
                                                   
                                                      c
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≤
                                                
                                                   ⌊
                                                   
                                                      
                                                         
                                                            ∥
                                                         
                                                         
                                                            V
                                                            W
                                                         
                                                         
                                                            |
                                                            −
                                                            1
                                                            |
                                                         
                                                      
                                                      2
                                                   
                                                   ⌋
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for all odd-wheels 
                              
                                 W
                                 =
                                 (
                                 
                                    V
                                    W
                                 
                                 ,
                                 
                                    E
                                    W
                                 
                                 )
                              
                           .

Deza et al. [53] proved that odd-wheel constraints are facet-defining for 
                              
                                 
                                    ∥
                                 
                                 
                                    V
                                    W
                                 
                                 
                                    |
                                    −
                                    1
                                    |
                                 
                                 ≥
                                 3
                              
                           . As described in detail by Deza and Laurent [54] and Nowozin [55], the search for violated odd-wheel constraints can be reduced to a polynomial number of shortest path searches, if the current solution does not violate any cycle constraints.

In our experiments, we found that with increasing sparsity, odd-wheel constraints tighten the relaxation less. This is intuitively plausible since in densely connected graphs significantly more odd-wheels exist that could be violated. Since the overall gain was not better than with the previously proposed methods, we did not spend time to search for heuristics to speed up computation, as we did for the cycle inequalities.

Relaxations of the integer-valued multicut problem yield solutions that may be fractional and therefore infeasible. The objective value then is a lower bound of the optimal value. The procedure to map an infeasible solution to the feasible set is called rounding. Furthermore, for the resulting multicut, a corresponding node-labeling has to be determined.


                           In the presence of terminal nodes, we assign to each node-variable the label of the terminal node to which it is connected by means of 
                              
                                 
                                    y
                                    
                                       t
                                       v
                                    
                                 
                                 =
                                 0
                              
                            in the integer-valued case. This idea extends to the general case by assigning to node v the label l with the lowest edge-value 
                              
                                 
                                    y
                                    
                                       
                                          t
                                          l
                                       
                                       v
                                    
                                 
                                 ,
                              
                            i.e., the nearest corner in the corresponding simplex, cf. Fig. 8
                           :

                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                x
                                                v
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      arg
                                                      min
                                                   
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                v
                                                ∈
                                                V
                                                ∖
                                                T
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           This heuristic nearest label rounding method has two drawbacks, however. Firstly, it does not provide any performance guarantee. Secondly, nearby nodes that favor two or more labels nearly equally might be randomly assigned to different labels due to numerical inaccuracy. This is particularly problematic in case of positive coupling strengths where homogeneously labeled regions are preferred.

Contrary to this local procedure, Calinescu et al. [52] suggested a randomized rounding procedure that provides optimality bounds for Potts models with positive coupling strengths. Given a threshold ρ ∈ [0, 1], they iterate over all labels in a fixed order and assign label l to node v if 
                              
                                 
                                    y
                                    
                                       
                                          t
                                          l
                                       
                                       v
                                    
                                 
                                 ≤
                                 ρ
                              
                            and no label was assigned to v before. In case no label was assigned to node v in the end, then the last label with respect to the ordering of the labels is assigned to v. This rounding procedure is sketched by Fig. 8(b).

A randomized rounding procedure would apply this for all ρ ∈ [0, 1] and select the labeling with the lowest energy. Since [0, 1] is uncountable, Călinescu et al. suggested a derandomized version. This is based on the observation that we only have to consider |V∖T| · |T| different threshold parameters, namely the values of the terminal edge variables ytv
                           . Since this set can still be quite large, we also consider a heuristic approximation that we call pseudo-derandomized rounding, using a small number of equidistant thresholds, in practice: 
                              
                                 0
                                 ,
                                 0.01
                                 ,
                                 0.02
                                 ,
                                 …
                                 ,
                                 0.99
                                 ,
                                 1
                              
                           .

Concerning tightness of the relaxation, Calinescu et al. [52] pointed out that the integrality ratio of the relaxed LP for the second-order multiway cut problem with positive coupling strengths, exploiting cycle, terminal and multi-terminal constraints, is 
                              
                                 
                                    3
                                    2
                                 
                                 −
                                 
                                    1
                                    k
                                 
                              
                           . This is superior to the α-expansion algorithm [22] and the work of Dahlhaus et al. [27], which guarantees only a ratio of 
                              
                                 2
                                 −
                                 
                                    2
                                    k
                                 
                              
                           . It is not known if these results can be extended for higher-order label permutation invariant functions.

Empirically, we observe for these types of models that derandomized rounding and pseudo-derandomized rounding usually lead to results that are slightly better than when using nearest label rounding. While pseudo-derandomization does empirically not give results worse than original derandomization, it is much faster, but does not come along with theoretical guarantees. Fig. 9
                            shows results for two instances taken from [5]. While for the synthetic instances rounding matters, for real world examples the differences are negligible.


                           In absence of terminal nodes, we compute in the integer-valued case the connected components of 
                              
                                 
                                    G
                                    0
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       {
                                       e
                                       ∈
                                       E
                                       ∣
                                       
                                          y
                                          e
                                       
                                       =
                                       0
                                       }
                                    
                                    )
                                 
                                 ,
                              
                            enumerate them by 
                              
                                 #
                                 C
                                 
                                    C
                                    
                                       G
                                       0
                                    
                                 
                                 ,
                              
                            and assign to each node-variable as label the number of its connected component

                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                x
                                                v
                                             
                                          
                                          
                                             
                                                =
                                                #
                                                C
                                                
                                                   C
                                                   
                                                      G
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                v
                                                ∈
                                                V
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           It is easy to see that the labeling-costs J(x) (2) are greater than or equal to the multicut costs 〈w, y〉 and equal if y is a valid multicut.

If y is not integral we first have to map y to a vertex of the multicut polytope. To this end, we determine the connected components of 
                              
                                 
                                    G
                                    
                                       ≤
                                       κ
                                    
                                 
                                 =
                                 
                                    (
                                    V
                                    ,
                                    
                                       {
                                       e
                                       ∈
                                       E
                                       ∣
                                       
                                          y
                                          e
                                       
                                       ≤
                                       κ
                                       }
                                    
                                    )
                                 
                              
                            and define the feasible projection 
                              
                                 y
                                 ^
                              
                            by

                              
                                 (38)
                                 
                                    
                                       
                                          
                                             y
                                             ^
                                          
                                          
                                             u
                                             v
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         #
                                                         C
                                                         
                                                            C
                                                            
                                                               G
                                                               
                                                                  ≤
                                                                  κ
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         =
                                                         #
                                                         C
                                                         
                                                            C
                                                            
                                                               G
                                                               
                                                                  ≤
                                                                  κ
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            v
                                                            )
                                                         
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   else.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The labeling then is given by

                              
                                 (39)
                                 
                                    
                                       
                                          
                                             
                                                x
                                                v
                                             
                                          
                                          
                                             
                                                =
                                                #
                                                C
                                                
                                                   C
                                                   
                                                      G
                                                      
                                                         ≤
                                                         κ
                                                      
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                v
                                                ∈
                                                V
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Since the connected component procedure tends to remove dangling edges, it seems to be reasonable to select κ smaller than 0.5. This was empirically confirmed by our experiments. Fig. 10
                           
                           
                            shows the relative error of the rounded solutions after enforcing cycle constraints for different problem-classes with various values of κ.

It is worth to mention that the multicut problem is APX-hard [56,57] and that a rounding procedure with a worst case integrality gap of the linear program of Ω(log (|V|)) exists. While it seems that the corresponding proof can be extended to higher-order multicuts, an integrality gap guarantee of log (|V|) is not enough in real applications. This is why we did not further investigate this issue in the present work.


                        Algorithm 1
                         provides a compact description of our complete multicut approach, summarizing the present section. In addition to the specification of the objective function in terms of a factor graph model 
                           
                              G
                              ,
                           
                         we expect a proper
                           4
                        
                        
                           4
                           A list of separation procedures is called proper if the separation procedures that are included once are also included when proceeding further down the list. For proper lists the obtained relaxation is well-defined. All lists used in our experiments are proper.
                         list of separation procedure sets 
                           S
                         as input parameters. For example, 
                           
                              S
                              1
                           
                         could represent simple cycle constraints separation, 
                           
                              S
                              2
                           
                         integrality constraints, and 
                           
                              S
                              3
                           
                         cycle constraints separation specialized to integer solutions.

As specified by Algorithm 1, we construct the weighted undirected graph G, introduce auxiliary variables for higher-order factors (as detailed in previous sections), and initialize the constraint set 
                           C
                         by a simple outer relaxation of the feasible set.

For each separation procedure set in the list 
                           
                              S
                              ,
                           
                         we apply all separation procedures in 
                           
                              S
                              i
                           
                         to find violated constraints and add these to 
                           C
                         until no more are found. Then we proceed with the next set 
                           
                              S
                              
                                 i
                                 +
                                 1
                              
                           
                        .

The (integer) linear program in line 6 is solved by CPLEX 12.2, a standard off-the-shelf LP-solver. Finally, we compute an optimal node-labeling x ∈ X from the multicut solution y.

The implementation of Algorithm 1 turned out to be involved, due to several subtle pitfalls necessitating some care. We therefore made our code publicly available
                           5
                        
                        
                           5
                           
                              https://github.com/opengm/opengm.
                        . Furthermore, when solving the (I)LP one should not expect that the solution is feasible. Sometimes we observe negative values of ye
                         and therefore project solutions always to [0, 1]|E|. Also Boolean constraints were sometimes slightly violated. Most importantly, due to numerical reasons, constraints should only be added if they are significantly violated, i.e., the constraint a ≤ b is only added if 
                           
                              a
                              ≤
                              b
                              −
                              ϵ
                           
                         does not hold. Ignoring this may not only lead to infinite loops for some instances, but may also significantly increase runtime. The parameter ϵ should be chosen depending on the precisions of the (I)LP solver. We use 
                           
                              ϵ
                              =
                              
                                 10
                                 
                                    −
                                    8
                                 
                              
                           
                        .

A major line of research considers relaxations of the marginal polytope to approximately solve problem P1. For the local polytope relaxation [19] of second-order models it is known that the local multiway cut relaxation (42) is equivalent if either the labeling is binary [58] or the coupling w is positive [29].

We generalize this results for real valued couplings. This gives a interesting connection between local polytope and multiway cut relaxation and allows us to rank our relaxations. As the proof is very technical, we add the corresponding Theorem 7.1 and its proof in the appendix.

@&#EXPERIMENTS@&#

We implemented the separation procedures and reduction methods described above using C++ and the OpenGM2-library [59] for the factor graph representation, and CPLEX for solving ILPs and LPs in the inner loop of the iteration.

Our multicut approach encompasses a variety of algorithms which differ in the used inequalities, in the separation procedures, and in the order these procedures are applied. The abbreviations for single separation procedures are listed as Table 2
                        .

For example, MC-CFB-I-CIF indicates:

                           
                              •
                              application of the multicut algorithm (MC) based on

searching for violated facet-defining cycle inequalities (CF) using bounding (B),

enforcing integer constraints (I), and finally

searching for facet-defining cycle inequalities violated by the current Boolean solution (CIF), based on Breadth-First-Search instead of the Dijkstra algorithm (cf. Section 5.2.3).

We report for each dataset results averaged over all its instances:

                           
                              1.
                              the mean
                                    6
                                 
                                 
                                    6
                                    Averaged over all instances of this dataset.
                                  runtime: runtime,

the mean
                                    6
                                  value (energy) of the integer solution after rounding: value,

the mean
                                    6
                                  lower bound, given by the solution of the relaxed problem: bound,

how often the method found an integer solution with an objective value not larger than 
                                    
                                       10
                                       
                                          −
                                          6
                                       
                                    
                                  compared to the overall best method for this instance: best
                                 
                                    7
                                 
                                 
                                    7
                                    Note, that 0 means that the method has never found the best solution among all methods or has never verified optimal solution. Of course, this does not mean that solutions provided by this method are poor. Performing slightly worse than optimal already returns the value 0.
                                 , and

how often the method provided a gap between the objective value of the integer solution and the lower bound, that was smaller than 
                                    
                                       10
                                       
                                          −
                                          6
                                       
                                    
                                 : ver. opt
                                 
                                    7
                                 , which we interpret as globally optimal for our instances.

if available we also evaluate on an application specific loss, e.g. Variation of Information (VI) [60], Rand Index (RI) [61], and Pixel Accuracy (PA).

In the unsupervised case, we compared the proposed methods with our implementation of the Kernighan–Lin (KL) algorithm [62] for the second-order case, as well as with iterative conditional mode (ICM) [63] and Lazy Flipper (LF) [64]. For planar graphs, an optimal segmentation with only four labels exists, and methods for the supervised case can be applied.

In the supervised case, we compared with TRWS [21], Max Product Linear Programming with no (MPLP) [65] and with cycle-inequalities MPLP-C [66,67], α-expansion [22] and FastPD [23] – using in each case code provided by the respective authors of these papers. Furthermore, we compared to commercial LP- and ILP-solvers in the nodal domain, LBP, TRBP, and α-fusion, as provided by OpenGM2 The considered datasets are sumarized in Table 3
                        and are discussed next.

For numerical evaluation we generate 10 synthetic Potts instances (synth-potts). The models have a underlying grid structured (4 neighbors) with 32 × 32 variables with 10 labels each. Unary terms are uniformly sample from [0, 1] and the coupling of the pairwise Potts terms are uniformly sampled from 
                              
                                 [
                                 −
                                 1
                                 ,
                                 1
                                 ]
                              
                           . Results averaged over all instances are shown in Table 4
                           
                           
                           
                           . MC-T-MT and LP solve both the local polytope relaxation. TRWS and MPLP stops too early or get stuck in local fixed points, which can be seen by the worse bound. When we add cycle constraints, MPLP-C performs slightly better in terms of the lower bound but of cost of significant higher runtime. While the differences in the averaged value are mainly caused by more involved rounding used by MPLP-C, the better bound might be caused by a tighter relaxation. Contrary to our approach MPLP-C also considers violated odd-cycle-constraints on binary partitions of the label spaces, which additionally tightens the polytope for models with more than 2 labels. However, when we add integer constraints after our cut phases the optimum is found for 9 of 10 cases and for the remaining one some additional integer terminal constraints guarantee to find the global optimal solution. MC-T-MT-CFB-I-TI is 100 times faster than the ILP and 10 times faster than MPLP-C. Latter even is not able to find optimal solutions in all cases.

The probabilistic image segmentation framework was suggested by Andres et al. [2] and belongs to the class of unsupervised image segmentation problems. These problem instances involve 
                              
                                 156
                                 −
                                 3764
                              
                            superpixels. For all pairs of adjacent superpixels, the likelihood that their common part of the superpixel boundary is part of the segmentation, is learned offline by a random forest. This results in a Potts model with positive and negative coupling constraints. While the connection to Potts models is not mentioned in [2], they use a similar optimization scheme as in the present work. They introduced a higher-order model as well as a second-order one. They have been made publicly available in [11] and [5], respectively.


                           Second-order case. As shown in Table 5, for this dataset (image-seg), we profit from using ILP subproblems. This reduces the mean runtime to less than 3 s and is therefore empirically faster than LP-based cutting-plane methods and the heuristic KL-algorithm. ICM and LF perform worse than KL. With increasing search space LF outperforms KL. For a search-depth greater than 1 we make use of the fact that the instances are planar and an optimal solution with four labels exists. The same trick is used to make TRWS applicable. Additionally, we fix the first variable and initialize messages randomly. Even this does not help to prevent TRWS from running into poor local fix-points. In both cases the label reduction is marked by the postfix L4.

Concerning the multicut approach, odd-wheel constraints only marginally improve the results. LP-based cutting-plane methods find the optimal solution for 35 of 100 instances and are slower than ILP-based methods, too.


                           Higher-order case. The third-order models (image-seg
                           3) from [2] are hard to solve with relaxations, hence rounding becomes more important, cf. Fig. 10. The additional third-order factors favor smooth boundary continuation. Since this sometimes conflicts with local boundary probabilities, the problem becomes more involved.

As shown in Table 6, local search methods give better results than relaxed solutions after rounding. Our exact multicut scheme was able to solve all instances to optimality. Notably, one instance was significantly harder than all others and took more than half of the overall runtime for MC-I-C and MC-I-CFB.

Overall, a few instances are significantly harder than others.

Compared to the second-order model the Variation of Information (VI) [60] and Rand Index (RI) [61] are worse. The reason might be a to strong regularization with the boundary continuation which results in segmentation that does not fit with the BSD-ground-truth well.

The hierarchical image segmentation framework was suggested by Kim et al. [1] and also belongs to the class of unsupervised image segmentation problems. Contrary to the work of Andres et al. [2], they learn their model-parameters by a structured support vector machine (S-SVM). Furthermore, higher-order Potts terms force selected regions to belong to the same cluster. The 715 instances of this dataset (corr-clust), published as part of [5], contain factors of order up to a few hundred and 122–651 variables.

The results are summarized as Table 7. Surprisingly, our LP-based methods perform better than the original algorithm used in [1], even though the algorithms are identical. Maybe this was caused by the different LP solver they used, or by some floating-point problems inside their separation procedure. The use of odd-wheel constraints marginally improves the results. Best results are obtained by using integer cutting-planes after having solved the LP. The use of the bounding as part of the post-processing reduces runtime by a factor of 2. The differences to only using facet-defining constraints are negligible.

We also considered a clustering problem from outside the field of computer vision, which contrary to the previous models considered so far, involves a fully connected graph. Modularity clustering [6] means the problem of clustering an undirected unweighted graph into ”meaningful” subsets, which amounts to optimization problems related to fully connected Potts model. For our experiments, we used the datasets
                              8
                           
                           
                              8
                              
                                 http://www-personal.umich.edu/~mejn/netdata/.
                            
                           dolphins, football, karate, and lesmis (mod-clust), with 62, 115, 34, and 77 data-points, respectively.

As shown in Table 8
                           , for modularity clustering, the use of facet-defining inequalities as well as odd-wheel constraints significantly improves the results. We attribute this to the high connectivity of the graph. In such dense graphs more likely violated odd-wheel inequalities exist. Likewise, more non-facet-defining cycle inequalities exist as well, and adding those only blows up the system of inequalities.

As observed by Nowozin and Jegelka [12], odd-wheel inequalities usually tighten sufficiently the polytope. Furthermore, we observed for this dataset, as in [12], numerical problems if the allowed feasibility and optimality tolerances were set to large. However, the experiments showed that our proposed integer cycle inequalities perform better than odd-wheel separation, especially if we start from the LP-relaxation with cycle inequalities, cf. Table 8.

An elementary approach to supervised image segmentation, or image labeling, is to apply locally a statistical classifier, trained offline beforehand, to raw image data or to locally extracted image features. This is complemented by a non-local prior term, the most common form of which favors short boundaries of the segments partitioning the image domain. Such terms can be approximated by pairwise Potts terms [69] and lead to an energy function of the form

                              
                                 (40)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      f
                                                      ∈
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                −
                                                log
                                                
                                                   (
                                                   
                                                      p
                                                      
                                                         n
                                                         e
                                                         (
                                                         f
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            n
                                                            e
                                                            (
                                                            f
                                                            )
                                                         
                                                      
                                                      |
                                                      I
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      f
                                                      ∈
                                                      
                                                         F
                                                         2
                                                      
                                                   
                                                
                                                β
                                                
                                                I
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         n
                                                         e
                                                         
                                                            
                                                               (
                                                               f
                                                               )
                                                            
                                                            1
                                                         
                                                      
                                                   
                                                   ≠
                                                   
                                                      x
                                                      
                                                         n
                                                         e
                                                         
                                                            
                                                               (
                                                               f
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           As recently shown by Kappes et al. [13], such models can be evaluated globally optimal and very fast by first determining partial optimality, leading to a reduced inference problem in terms of remaining unlabelled connected image components, followed by solving each of these smaller problems independently.

We use “*” to mark when these preprocessing steps were applied and “†” to mark whenever the memory requirement exceeded 12 GB.

As dataset (color-seg) we used the color segmentation instances of Alahari et al. [68]. The results are summarized as Table 9
                           
                           .

While standard (I)LP solvers often suffer from their large memory requirements, the multicut approach outperformed all other approaches. Since for all instances the local polytope relaxation returned optimal integer solutions, MC-T-MT could solve them in polynomial time. When we resorted to the model reduction *, the subproblems became small for these problem instances, and (I)LP solvers could be conveniently applied. Our multicut approach then was only marginally faster. Despite global optimality, however, the runtime was comparable to algorithms for approximate inference that do not guarantee global optimality.

We studied image segmentation with junction regularization as problem instances that benefit from the application of higher-order generalized Potts functions.

Rather than merely penalizing the boundary length of segments, this approach aims at improving segmentation results by additionally penalizing points where the boundaries of three or more segments meet:

                              
                                 (41)
                                 
                                    
                                       
                                          φ
                                          I
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          ,
                                          
                                             x
                                             3
                                          
                                          ,
                                          
                                             x
                                             4
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      λ
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         |
                                                         {
                                                         
                                                            x
                                                            1
                                                         
                                                         ,
                                                         
                                                            x
                                                            2
                                                         
                                                         ,
                                                         
                                                            x
                                                            3
                                                         
                                                         ,
                                                         
                                                            x
                                                            4
                                                         
                                                         }
                                                         |
                                                         >
                                                         2
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   else.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The overall cost for labeling then is given by

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      f
                                                      ∈
                                                      
                                                         F
                                                         1
                                                      
                                                   
                                                
                                                
                                                   φ
                                                   f
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         n
                                                         e
                                                         (
                                                         f
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      f
                                                      ∈
                                                      
                                                         F
                                                         2
                                                      
                                                   
                                                
                                                
                                                   φ
                                                   f
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         n
                                                         e
                                                         (
                                                         f
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      f
                                                      ∈
                                                      
                                                         F
                                                         4
                                                      
                                                   
                                                
                                                
                                                   φ
                                                   I
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         n
                                                         e
                                                         (
                                                         f
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where φ1 denotes the L
                           1-norm of the difference between intensity of a pixel and a pixel-label, φ2 the same second-order terms as in the pairwise case, and 
                              
                                 F
                                 4
                              
                            the set of all factors over four pixels that build a cycle in the image grid.

Setting λ to 0 yields standard second-order model with boundary length regularization, whereas setting λ → ∞ yields a model that enforces segments to be surrounded by one single segment, without fixing the topology of the inclusion as done by Delong et al. [45]. Contrary to [45] our model “learns” the geometric interaction “contain” 
                           [45] locally online and allows furthermore to use different and unknown “containing rules” in different regions instead a single global one.


                           Fig. 1(b) illustrates this property of the model. The standard second-order approach, cf. Fig. 1(b), middle, produces many small artefacts inside “U” and “C” and opens the surrounding segment right of “C”. Invoking the fourth-order regularizer, cf. Fig. 1(b), bottom, eliminates many of these artefacts and results in a significantly better segmentation.

The results of an empirical evaluation for 10 synthetic 32 × 32 images (synth-inclusion) are summarized as Table 10. Fig. 13
                            show exemplary segmentation results. Additionally, we give the relative number of correct labeled pixels as pixel accuracy (PA). Even a labeling with high energy can have a high PA, as happens for MPLP. This is caused by some variables, with wrong labels that causes a high energy but count marginal for the PA.

Approximate inference methods performed quite good, but among those only LBP-LF2 (Lazy Flipper initialed with the solution of LBP) was able to provide nearly optimal results. While the multicut approach is on par when relaxations were considered, it became quite slow compared to a ILP applied to labeling in the nodal domain, when a globally optimal solution was enforced.

We believe there are two major reasons: First, the relaxation “prefers” less integral solutions due to the higher-order terms and therefore becomes harder to solve for LP-based methods. Second, we observe that CPLEX solves the ILP mainly by branching and probing in order to avoid solving LPs. This is also the reason why ILP is faster than LP.

While an in-depth study of such aspects is beyond the scope of the present paper, our findings indicate ways to further improve the multicut approach in such advanced settings.

@&#CONCLUSION@&#

We presented an approach based on multicuts to solve a broad range of supervised and unsupervised segmentation problems to optimality in reasonable runtime. We showed, in particular, how to extend the approach higher-order models based on a class of label invariant functions that generalize Potts functions in a natural way. Such models enable to model higher-order interactions and topological priors concisely by taking its symmetries into account.

We devised several dedicated separation procedures and demonstrated a corresponding significant impact on runtime. A systematic comparison of different cutting-plane procedures for computer vision applications enabled us to improve runtimes for all models compared to the state of the art. A discussion of polynomially solvable relaxations of the unsupervised segmentation problems complemented our study, together with advanced rounding schemes.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by the German Research Foundation (DFG) within the program “Spatio-/Temporal Graphical Models and Applications in Image Analysis”, grant GRK 1653.


                     
                        Theorem 7.1
                        
                           For second-order Potts models with arbitrary coupling constraints
                           
                              
                                 w
                                 ∈
                                 
                                    R
                                    N
                                 
                              
                            
                           the optima of the LP over the local multiway cut relaxation in 
                           
                              (42)
                           
                           
                              
                                 (42)
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   y
                                                   ∈
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             
                                                〈
                                                w
                                                ,
                                                y
                                                〉
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                =
                                                
                                                   |
                                                   T
                                                   |
                                                
                                                −
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                   f
                                                
                                                T
                                                ≠
                                                ∅
                                                ,
                                                
                                                ∀
                                                v
                                                ∈
                                                V
                                                ∖
                                                T
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                (
                                                26
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                
                                                =
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                t
                                                ,
                                                
                                                   t
                                                   ′
                                                
                                                ∈
                                                T
                                                ,
                                                t
                                                ≠
                                                
                                                   t
                                                   ′
                                                
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                
                                                   (
                                                   27
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                ≥
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                (
                                                30
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ≥
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                (
                                                31
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      t
                                                      v
                                                   
                                                
                                                +
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ≥
                                                
                                                   y
                                                   
                                                      t
                                                      u
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                
                                                t
                                                ∈
                                                T
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                (
                                                32
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ≥
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      S
                                                   
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         t
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         v
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                v
                                                ∈
                                                E
                                                ,
                                                S
                                                ⊆
                                                T
                                                
                                                
                                                   c
                                                   .
                                                   f
                                                   .
                                                
                                                
                                                (
                                                33
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           is equivalent to the optima of LP over the local polytope relaxation 
                           
                              (43)
                           
                           
                              
                                 (43)
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   μ
                                                   ∈
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             
                                                〈
                                                θ
                                                ,
                                                μ
                                                〉
                                                .
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      ∈
                                                      
                                                         X
                                                         i
                                                      
                                                   
                                                
                                                
                                                   μ
                                                   
                                                      i
                                                      ;
                                                      
                                                         x
                                                         i
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                ∀
                                                i
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      ∈
                                                      
                                                         X
                                                         i
                                                      
                                                   
                                                
                                                
                                                   μ
                                                   
                                                      i
                                                      j
                                                      ;
                                                      
                                                         x
                                                         i
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                                =
                                                
                                                   μ
                                                   
                                                      j
                                                      ;
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                f
                                                ∈
                                                
                                                   F
                                                   2
                                                
                                                ,
                                                
                                                   {
                                                   i
                                                   ,
                                                   j
                                                   }
                                                
                                                =
                                                
                                                   ne
                                                
                                                
                                                
                                                   (
                                                   f
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                      ∈
                                                      
                                                         X
                                                         j
                                                      
                                                   
                                                
                                                
                                                   μ
                                                   
                                                      i
                                                      j
                                                      ;
                                                      
                                                         x
                                                         i
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                
                                                =
                                                
                                                   μ
                                                   
                                                      i
                                                      ;
                                                      
                                                         x
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                f
                                                ∈
                                                
                                                   F
                                                   2
                                                
                                                ,
                                                
                                                   {
                                                   i
                                                   ,
                                                   j
                                                   }
                                                
                                                =
                                                
                                                   ne
                                                
                                                
                                                
                                                   (
                                                   f
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By construction of the multiway cut problem we have

                              
                                 (44)
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                
                                                   u
                                                   ;
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                =
                                                1
                                                −
                                                
                                                   y
                                                   
                                                      
                                                         t
                                                         i
                                                      
                                                      ,
                                                      u
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                u
                                                ∈
                                                V
                                                ,
                                                i
                                                ∈
                                                
                                                   X
                                                   u
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where ti
                            ∈ T denotes the terminal node belonging to label i ∈ Xu
                           .

Instead of optimizing over μ
                           
                              u; i
                            for all u ∈ V and xu
                            ∈ Xu
                            we show that for any fixed 
                              
                                 
                                    μ
                                    
                                       u
                                       ;
                                       i
                                    
                                 
                                 
                                 ∀
                                 u
                                 ∈
                                 V
                                 ,
                                 i
                                 ∈
                                 
                                    X
                                    u
                                 
                              
                            problem (42) and (43) have the same minima. For fixed unary variables the problem splits in several small terms, which can be treated independently. What is left to show is that for any

                              
                                 
                                    
                                       
                                          θ
                                          
                                             u
                                             v
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         u
                                                         v
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      u
                                                      ≠
                                                      v
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      u
                                                      =
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    w
                                    
                                       u
                                       v
                                    
                                 
                                 ∈
                                 R
                              
                            the following equality holds:

                              
                                 (45)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      μ
                                                      
                                                         u
                                                         v
                                                      
                                                   
                                                
                                                
                                                   〈
                                                   
                                                      θ
                                                      
                                                         u
                                                         v
                                                      
                                                   
                                                   ,
                                                   
                                                      μ
                                                      
                                                         u
                                                         v
                                                      
                                                   
                                                   〉
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (46)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                
                                                
                                                
                                                   ∑
                                                   i
                                                
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      j
                                                   
                                                
                                                =
                                                
                                                   μ
                                                   
                                                      v
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                
                                                   X
                                                   v
                                                
                                                ,
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   ∑
                                                   j
                                                
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      j
                                                   
                                                
                                                =
                                                
                                                   μ
                                                   
                                                      u
                                                      ,
                                                      i
                                                   
                                                
                                                
                                                ∀
                                                i
                                                ∈
                                                
                                                   X
                                                   u
                                                
                                                ,
                                                
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      j
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      
                                                         y
                                                         
                                                            u
                                                            v
                                                         
                                                      
                                                      ∈
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                   
                                                
                                                w
                                                ·
                                                
                                                   y
                                                   
                                                      u
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                
                                                
                                                (
                                                26
                                                )
                                                ,
                                                (
                                                27
                                                )
                                                ,
                                                (
                                                30
                                                )
                                                −
                                                (
                                                32
                                                )
                                                ,
                                                (
                                                33
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Case 1 (
                           wuv
                            ≥ 0):
                        

This has been shown by Osokin et al. [29].


                           Case 2 (
                           wuv
                            < 0):
                        

The variable yuv
                            is only upper bounded by [0, 1] and (29). Furthermore y can be substituted by μ with (44). Hence the the optimal value of (46) 
                           yuv
                            is

                              
                                 (47)
                                 
                                    
                                       
                                          
                                             
                                                (
                                                46
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   =
                                                   
                                                      (
                                                      30
                                                      )
                                                   
                                                
                                                
                                                   w
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ·
                                                min
                                                
                                                   {
                                                   1
                                                   ,
                                                   
                                                      min
                                                      i
                                                   
                                                   
                                                      {
                                                      
                                                         (
                                                         
                                                            y
                                                            
                                                               u
                                                               ,
                                                               
                                                                  t
                                                                  i
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            y
                                                            
                                                               v
                                                               ,
                                                               
                                                                  t
                                                                  i
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (48)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   =
                                                   
                                                      (
                                                      44
                                                      )
                                                   
                                                
                                                
                                                   w
                                                   
                                                      u
                                                      v
                                                   
                                                
                                                ·
                                                min
                                                
                                                   {
                                                   1
                                                   ,
                                                   
                                                      min
                                                      i
                                                   
                                                   
                                                      {
                                                      2
                                                      −
                                                      
                                                         (
                                                         
                                                            μ
                                                            
                                                               u
                                                               ,
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            μ
                                                            
                                                               v
                                                               ,
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           □


                     Inequality (i): 
                     (45) ≥ (46)
                  

For this proof we will use the following observation:

                        Lemma 7.1
                        
                           Let us consider problem 
                           
                              (45)
                           
                           . If
                           
                              
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                                 >
                                 1
                              
                            
                           then
                           
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ,
                                       i
                                       i
                                    
                                 
                                 ≥
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                                 −
                                 1
                              
                           
                           .
                        

Let 
                              
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                                 >
                                 1
                              
                            and w.l.o.g. μ
                           
                              u, i
                            > μ
                           
                              v, i
                           . Then we have μ
                           
                              u, i
                            > 0.5 and 
                              
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 >
                                 1
                                 −
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                              
                           . Latter causes that we have to put some mass of μ
                           
                              u, i
                            on the main diagonal of Q since we can assign to the non-diagonal elements only 
                              
                                 1
                                 −
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                              
                           . At least the difference 
                              
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 −
                                 
                                    (
                                    1
                                    −
                                    
                                       μ
                                       
                                          v
                                          ,
                                          i
                                       
                                    
                                    )
                                 
                              
                            has to be put on the main diagonal entry μ
                           
                              uv, ii
                           .□

Using Lemma 7.1 we obtain the inequality:

                        
                           (49)
                           
                              
                                 
                                    
                                       
                                          (
                                          45
                                          )
                                       
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             1
                                             −
                                             
                                                ∑
                                                i
                                             
                                             
                                                μ
                                                
                                                   u
                                                   v
                                                   ,
                                                   i
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                          
                                          
                                             (
                                             45
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (50)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ≥
                                             
                                                L
                                                e
                                                m
                                                m
                                                a
                                                7.1
                                             
                                          
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             1
                                             −
                                             
                                                ∑
                                                i
                                             
                                             max
                                             
                                                {
                                                0
                                                ,
                                                
                                                   μ
                                                   
                                                      u
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   μ
                                                   
                                                      v
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                1
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             1
                                             −
                                             
                                                max
                                                i
                                             
                                             max
                                             
                                                {
                                                0
                                                ,
                                                
                                                   μ
                                                   
                                                      u
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   μ
                                                   
                                                      v
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                1
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (52)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             1
                                             +
                                             
                                                min
                                                i
                                             
                                             min
                                             
                                                {
                                                0
                                                ,
                                                −
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         u
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      μ
                                                      
                                                         v
                                                         ,
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                +
                                                1
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (53)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             
                                                min
                                                i
                                             
                                             min
                                             
                                                {
                                                1
                                                ,
                                                2
                                                −
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         u
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      μ
                                                      
                                                         v
                                                         ,
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (54)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          (
                                          46
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     Inequality (ii): 
                     (45) ≤ (46)
                  

We will use the following observations next:

Let 
                        
                           
                              i
                              *
                           
                           =
                           arg
                           
                              max
                              i
                           
                           
                              (
                              
                                 μ
                                 
                                    u
                                    ,
                                    i
                                 
                              
                              +
                              
                                 μ
                                 
                                    v
                                    ,
                                    i
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (a)
                           If 
                                 
                                    
                                       max
                                       i
                                    
                                    
                                       (
                                       
                                          μ
                                          
                                             u
                                             ,
                                             i
                                          
                                       
                                       +
                                       
                                          μ
                                          
                                             v
                                             ,
                                             i
                                          
                                       
                                       )
                                    
                                    <
                                    1
                                    ,
                                 
                               then 
                                 
                                    ∀
                                    i
                                    :
                                    (
                                    
                                       μ
                                       
                                          u
                                          ,
                                          i
                                       
                                    
                                    +
                                    
                                       μ
                                       
                                          v
                                          ,
                                          i
                                       
                                    
                                    )
                                    <
                                    1
                                 
                              .

If 
                                 
                                    
                                       max
                                       i
                                    
                                    
                                       (
                                       
                                          μ
                                          
                                             u
                                             ,
                                             i
                                          
                                       
                                       +
                                       
                                          μ
                                          
                                             v
                                             ,
                                             i
                                          
                                       
                                       )
                                    
                                    >
                                    1
                                    ,
                                 
                               then 
                                 
                                    ∀
                                    i
                                    ≠
                                    
                                       i
                                       *
                                    
                                    :
                                    
                                       (
                                       
                                          μ
                                          
                                             u
                                             ,
                                             i
                                          
                                       
                                       +
                                       
                                          μ
                                          
                                             v
                                             ,
                                             i
                                          
                                       
                                       )
                                    
                                    <
                                    1
                                 
                              .


                           Problem 
                           
                              (45)
                            
                           with the additional constraints
                           
                              
                                 (55)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ,
                                                      i
                                                      i
                                                   
                                                
                                                =
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   
                                                      μ
                                                      
                                                         u
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      μ
                                                      
                                                         v
                                                         ,
                                                         i
                                                      
                                                   
                                                   −
                                                   1
                                                   }
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                i
                                                ∈
                                                
                                                   X
                                                   v
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           has still a feasible solution.
                        

We split the proof in to cases:


                           Case 1:
                           
                              
                                 
                                    max
                                    i
                                 
                                 
                                    (
                                    
                                       μ
                                       
                                          u
                                          ,
                                          i
                                       
                                    
                                    +
                                    
                                       μ
                                       
                                          v
                                          ,
                                          i
                                       
                                    
                                    )
                                 
                                 >
                                 1
                              
                           
                        

Let 
                              
                                 
                                    i
                                    *
                                 
                                 =
                                 arg
                                 
                                    max
                                    i
                                 
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                                 ,
                              
                            then

                              
                                 
                                    
                                       
                                          μ
                                          
                                             u
                                             v
                                             ;
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                         i
                                                      
                                                      
                                                         μ
                                                         
                                                            u
                                                            ,
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         μ
                                                         
                                                            v
                                                            ,
                                                            i
                                                         
                                                      
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      i
                                                      =
                                                      
                                                         i
                                                         *
                                                      
                                                      
                                                      
                                                         and
                                                      
                                                      
                                                      j
                                                      =
                                                      
                                                         i
                                                         *
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         u
                                                         ;
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      i
                                                      ≠
                                                      
                                                         i
                                                         *
                                                      
                                                      
                                                      
                                                         and
                                                      
                                                      
                                                      j
                                                      =
                                                      
                                                         i
                                                         *
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         v
                                                         ;
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      i
                                                      =
                                                      
                                                         i
                                                         *
                                                      
                                                      
                                                      
                                                         and
                                                      
                                                      
                                                      j
                                                      ≠
                                                      
                                                         i
                                                         *
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      else
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           is a feasible solution.


                           Case 2:
                           
                              
                                 
                                    max
                                    i
                                 
                                 
                                    μ
                                    
                                       u
                                       ,
                                       i
                                    
                                 
                                 +
                                 
                                    μ
                                    
                                       v
                                       ,
                                       i
                                    
                                 
                                 <
                                 =
                                 1
                              
                           
                        

Let us start with any feasible solution μ
                           0 of (45) and define a sequence of transitions 
                              
                                 
                                    μ
                                    n
                                 
                                 →
                                 
                                    μ
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                              
                            which will end in a μm
                            that fulfill the additionally constraints (
                              
                                 ∀
                                 i
                                 :
                                 
                                    μ
                                    
                                       u
                                       v
                                       ;
                                       i
                                       i
                                    
                                 
                                 =
                                 0
                              
                           ), too.


                           Initial point (
                           μo
                           
                           : As shown in [29] a feasible point 
                              
                                 μ
                                 
                                    u
                                    v
                                    ,
                                    i
                                    i
                                 
                                 0
                              
                            of (45) with 
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ,
                                       i
                                       i
                                    
                                    0
                                 
                                 =
                                 min
                                 
                                    {
                                    
                                       μ
                                       
                                          u
                                          ;
                                          i
                                       
                                    
                                    ,
                                    
                                       μ
                                       
                                          v
                                          ;
                                          j
                                       
                                    
                                    }
                                 
                              
                            exists.


                           Transition (
                           
                              
                                 
                                    μ
                                    n
                                 
                                 →
                                 
                                    μ
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           
                           ): For any tuple (a, b, a′, b′) and 
                              
                                 δ
                                 ≤
                                 min
                                 {
                                 m
                                 
                                    u
                                    
                                       u
                                       v
                                       ;
                                       a
                                       b
                                    
                                    n
                                 
                                 ,
                                 m
                                 
                                    u
                                    
                                       u
                                       v
                                       ;
                                       
                                          a
                                          ′
                                       
                                       
                                          b
                                          ′
                                       
                                    
                                    n
                                 
                                 }
                              
                            the transition

                              
                                 
                                    
                                       
                                          μ
                                          
                                             u
                                             v
                                             ;
                                             i
                                             j
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            u
                                                            v
                                                            ;
                                                            i
                                                            j
                                                         
                                                         n
                                                      
                                                      −
                                                      δ
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      i
                                                      =
                                                      a
                                                      ∧
                                                      j
                                                      =
                                                      b
                                                      
                                                      
                                                         or
                                                      
                                                      
                                                      i
                                                      =
                                                      
                                                         a
                                                         ′
                                                      
                                                      ∧
                                                      j
                                                      =
                                                      
                                                         b
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            u
                                                            v
                                                            ;
                                                            i
                                                            j
                                                         
                                                         n
                                                      
                                                      +
                                                      δ
                                                   
                                                
                                                
                                                   
                                                      
                                                         if
                                                      
                                                      
                                                      i
                                                      =
                                                      a
                                                      ∧
                                                      j
                                                      =
                                                      
                                                         b
                                                         ′
                                                      
                                                      
                                                      
                                                         or
                                                      
                                                      
                                                      i
                                                      =
                                                      
                                                         a
                                                         ′
                                                      
                                                      ∧
                                                      j
                                                      =
                                                      b
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         u
                                                         v
                                                         ;
                                                         i
                                                         j
                                                      
                                                      n
                                                   
                                                
                                                
                                                   
                                                      else
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           stays in the feasible set, because all values remain non-negative and row- and column-sums does not change.


                           Sequence of transitions: When μn
                            has a non-zero diagonal element 
                              
                                 μ
                                 
                                    u
                                    v
                                    ;
                                    i
                                    i
                                 
                                 n
                              
                            then there exist a pair (i′, j′) with i ≠ i′, j ≠ j′ and 
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ;
                                       
                                          i
                                          ′
                                       
                                       
                                          j
                                          ′
                                       
                                    
                                    n
                                 
                                 >
                                 0
                                 ,
                              
                            because

                              
                                 (56)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      (
                                                      a
                                                      ,
                                                      b
                                                      )
                                                      ,
                                                      a
                                                      =
                                                      i
                                                      
                                                         or
                                                      
                                                      b
                                                      =
                                                      j
                                                   
                                                
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      a
                                                      b
                                                   
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      i
                                                   
                                                   n
                                                
                                                +
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         u
                                                         ,
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      
                                                         u
                                                         v
                                                         ;
                                                         i
                                                         i
                                                      
                                                      n
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         v
                                                         ,
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      
                                                         u
                                                         v
                                                         ;
                                                         i
                                                         i
                                                      
                                                      n
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (57)
                                 
                                    
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   μ
                                                   
                                                      u
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   μ
                                                   
                                                      v
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      i
                                                   
                                                   n
                                                
                                                ≥
                                                1
                                                −
                                                
                                                   μ
                                                   
                                                      u
                                                      v
                                                      ;
                                                      i
                                                      i
                                                   
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           After the transition on (i, j, i′, j′) with maximal δ, either 
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ;
                                       i
                                       i
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                              
                            or 
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ;
                                       
                                          i
                                          ′
                                       
                                       
                                          i
                                          ′
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                              
                           . So, each non-zero diagonal element 
                              
                                 
                                    μ
                                    
                                       u
                                       v
                                       ;
                                       i
                                       i
                                    
                                    n
                                 
                                 ,
                              
                            can be made zero by a finite number of transitions. We will end up with a point μm
                            that fulfill (45) and have zero diagonal element 
                              
                                 μ
                                 
                                    u
                                    v
                                    ;
                                    i
                                    i
                                 
                                 n
                              
                           .□

Using Lemma 7.2 we obtain the inequality:

                        
                           (58)
                           
                              
                                 
                                    
                                       
                                          (
                                          45
                                          )
                                       
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          
                                             (
                                             1
                                             −
                                             
                                                ∑
                                                i
                                             
                                             
                                                μ
                                                
                                                   u
                                                   v
                                                   ,
                                                   i
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                          
                                             (
                                             45
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (59)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ≤
                                             
                                                L
                                                e
                                                m
                                                m
                                                a
                                                2
                                             
                                          
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          (
                                          1
                                          −
                                          max
                                          
                                             {
                                             0
                                             ,
                                             
                                                max
                                                i
                                             
                                             
                                                (
                                                
                                                   μ
                                                   
                                                      u
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   μ
                                                   
                                                      v
                                                      ,
                                                      i
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (60)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          
                                             w
                                             
                                                u
                                                v
                                             
                                          
                                          ·
                                          min
                                          
                                             {
                                             1
                                             ,
                                             
                                                min
                                                i
                                             
                                             
                                                {
                                                2
                                                −
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         u
                                                         ,
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      μ
                                                      
                                                         v
                                                         ,
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (61)
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          (
                                          46
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                  

Inequality (i) and inequality (ii) together imply that (45)
                     
                        =
                      
                     (46)
                  

@&#REFERENCES@&#

