@&#MAIN-TITLE@&#A multi-timescale cross-layer approach for wireless ad hoc networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a cross-layer problem of congestion control, link delay, and power control.


                        
                        
                           
                           Subproblems are successively solved by the Lagrange duality techniques.


                        
                        
                           
                           The design can be implemented distributedly and adheres to the timescale difference.


                        
                        
                           
                           We conduct simulations on MTSRENUM and compare it to the current frameworks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-timescale

Rate control

Packet delay

Power allocation

Lossy links

Fast-fading channels

@&#ABSTRACT@&#


               
               
                  Conventionally, cross-layer designs with same timescale updates can work well; however, there is a difference in layers’ timescales and each layer normally operates at its corresponding timescale when implemented in real systems. To respect this issue, in this article, we introduce a multi-timescale cross-layer design along with three sets of constraints: congestion control, link delay, and power control and with the objective of maximizing the overall utility and minimizing the total link delay and power consumption. The proposed procedure can be implemented in a distributed fashion, which not only guarantees truly optimal solutions to the underlying problem, but also adheres to the natural timescale difference among layers. Finally, the numerical results further solidify the efficacies of our proposal compared to the current frameworks.
               
            

@&#INTRODUCTION@&#

Flow control in wired networks was firstly modeled as a network utility maximization (NUM) paradigm [1,2], as follows:

                        
                           (1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             max
                                             
                                                x
                                                ≥
                                                0
                                             
                                          
                                          
                                             ∑
                                             s
                                          
                                          
                                             
                                                U
                                             
                                             
                                                s
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          s.t.
                                          
                                          R
                                          x
                                          ≤
                                          c
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where x is the source rate vector, R is the routing matrix, and c is the fixed link capacity vector. In wireless networks, however, the link capacities c might be changed due to characteristics of wireless channel [3,4]. Accordingly the problem (1) should be solved using Cross-Layer Designs (CLDs) by decomposing into subproblems, each of which corresponds to a layer. In fact, CLDs are essentially needed for wireless networks since CLDs can improve the network performance and reliability, for example, increasing throughput and reducing latency and bit error rate [5].

There exist lots of works mainly focusing on CLDs for wireless networks [3,5–11]. In [8], they not only considered a congestion control problem but also examined the effects of the lossy feature on the power control and link delay, namely Rate-Effective NUM (RENUM), with constraints on rate outage probability, data rate reduction, and delay-constrained traffics by taking them into consideration of the objective function. The rate outage probability is, however, based on the approximated form; therefore, RENUM may just produce suboptimal solutions to the problem [9]. In [12], we studied a cross-layer design which can guarantee the globally optimal solutions to the RENUM. However, a common limitation of these works is that optimization variables at different layers are all updated simultaneously.

Each one of the five-layers in the TCP/IP network model takes its own networking functionalities and adheres to the distinct timescale. For an extreme example, the PHYsical layer (PHY) roles are to perform functions of power control and rate adaptation, while admission control, multi-flow control, and congestion control are performed at the transport layer. Practically, the TRANsport (TRAN) layer is executed on the second timescale, while the data link control/MAC (DLC/MAC) layer and the PHY layer are executed on the scale of, respectively, milliseconds and microseconds. The precise timescales offer significant benefits of convergence speed and network performance [11]. Multi-timescale CLDs can be found in [11,13–21]. The authors in [11,16] developed joint CLDs of congestion control and power allocation, which adheres to the natural timescale separation between rapid power control updates and slower end-to-end rate adjustments. In [13], the authors reported that using the standard subgradient method in tackling the joint problem of MAC scheduling and congestion control might be not suitable for some circumstances [19–21], for example, if the utility function is not concave at all primal variables such as time-share proportions of the allowed schedules in the case [13], the primal variables may be oscillated, which can be avoided by proposing a two-timescale adaptive method. Nevertheless, no mentioned literature [11,13–21] has concurrently addressed the following issues (1) fast-fading, (2) lossy features of wireless networks, and (3) link delay requirement.

In this paper, we study the problem of rate control, link delay, and power allocation for Wireless Ad Hoc NETworks (WANETs). Our objective is to find a cross-layer design that maximizes the overall utility and minimizes the total link delay and power consumption subject to constraints on outage probability, delay requirement and flow rate conservation, which not only guarantees globally optimal solutions to the underlying problem, but also adheres to the difference in layers’ timescales. In a nutshell, the summary of features and contributions offered by our proposal are listed, as follows:

                        
                           •
                           In Section 3, we present the network model and then formulate a joint optimization problem. Since the original optimization problem is non-convex, we first cast the underlying one into a convex one by auxiliary variables and log-transformations and then prove the convexity and strong duality properties of the transformed problem.

We explore our proposed procedure, namely, Multi-TimeScale RENUM (MTSRENUM) in Section 4 and make use of the primal vertical decomposition in order to derive three timescale-based subproblems: the Short-TimeScale (STS) subproblem (power control), the Mid-TimeScale (MTS) subproblem (link delay control), and the Long-TimeScale (LTS) subproblem (congestion control). Because the convexity and strong duality hold for the new optimization subproblems, each subproblem can be successively and optimally solved by the conventional duality technique and updated at its adhered timescale.

The convergence of the proposed algorithm MTSRENUM is guaranteed, which is proven in Section 4.4.

Simulation results in Section 5 confirm that our cross-layer design can provide large gains over the current frameworks. More specifically, by comparing the multi-timescale CLDs with their same-timescale counterparts, CLDs with multi-timescale controls illustrate the improvement in the convergence speed. In addition, it is observed that the MTSRENUM algorithm is better than the others in terms of suffered delay, consumed power, transmission rate as well as the trade-off between the aggregated effective rate and suffered delay and consumed power.

In the next section, we provide an overview of the state of the art related to CLDs and multi-timescale controls.

@&#RELATED WORK@&#

Lots of literature whose principle focus on designing optimal CLD policies have been proposed [1–3,5–12,22–25], ranging from wired networks to wireless networks. The seminal researches on network resource allocation in wireline networks have been extensively investigated in [1,2]. A survey on and challenges of CLDs in wireless networks can be found in [5,26]. In [5], the authors elaborated that CLDs can be categorized as non-manager and manager methods according to how to share information in one node and as centralized and distributed algorithms based on how to share cross-layer information among all nodes in a network. On another perspective, by the update timescale of the network, cross-layer designs can be classified into two groups: multi-timescale-based method and same-timescale-based method.

Most of popular works are the same-timescale methods. In [3], the author presented a distributed power algorithm coupling with the existing congestion control protocols in order to increase end-to-end throughput and energy efficiency of the network. In this work, the high signal-to-interference-ratio (SIR) approximation, i.e., SIR is assumed to be much higher than 1, is considered in order to cast the underlying non-convex problem into a convex one; however, this assumption just suits to the scenario where the wireless channels change very slowly while it may cause serious performance degradation in fast-fading wireless channels. Similar to [3], Papandriopoulos et al. [6] developed a distributed cross-layer design without any approximation that can attain the globally optimal solutions of link transmit powers and source rates for a mobile ad hoc network. A framework of congestion control and power allocation with an outage probability in fast-faded wireless channels has been studied in [9]. In [7], the authors firstly investigated the “leaky-pipe” flow model, called ENUM, where the transmission rate of a flow decreases along its route. Followed from [7], Guo et al. [8] proposed the RENUM framework, where the transmit power and link delay are also the optimization variables. In [10], the authors considered the problem of congestion control in interference-limited wireless networks with power control, namely ENUM with Power control (ENUMP). However, all of these works are assumed to execute at the same timescale, that of course leads to serious challenges.
                  

Some recent works are devoted to the multi-timescale controls [11,13–21]. In [11], the authors considered a cross-layer design for congestion control and power control, respecting two timescales of the TRAN layer and PHY layer. In [15], the authors proposed a novel scheme, namely Multi-Period NUM/Adaptive Modulation (MPNUM/AP), which deals with optimal control policies at the PHY layer and upper layers at different timescales and can be solved by exploiting the Markov decision process. Literature [18] investigated a joint problem of rate adaption, power control and spectrum allocation in OFDMA-based multi-hop cognitive radio networks. The problem is decomposed into subproblems in which the spectrum allocation subproblem is updated centrally at the slower timescale compared to the others. A problem of congestion control and transmission scheduling in spatial-reuse time division multiple access wireless networks is studied in [19] and that problem with the self-interference constraints, i.e., which is defined as the interference between different links of a same flow along a multihop path [20] and the constraints on rate requirements as minimal in wireless mesh networks is further developed in [21]. It is stated in [19–21] that the conventional primal-dual approach cannot be used when considering the scheduling since (1) the primal-dual method assumes that all end-to-end links are active simultaneously while actually, only some links are active in an iteration due to the self-interference constraint (2) finding the optimum of the scheduling problem at every iteration requires a computational effort. To avoid these hurdles, they considered the cross-decomposition technique, which can be briefly described as the following. For a given end-to-end rate allocation, the scheduling and power updates are solved optimally through the traditional primal-dual technique at the slow-timescale. Then, with obtained solutions of the scheduling and power, end-to-end rates are updated based on the standard flow optimization problem [1] at the fast-timescale. However, in [19–21], the authors just elaborated the two-timescale cross-layer designs but did not examine them mathematically. In addition, as stated earlier, none of them has mutually addressed (1) fast-fading, (2) lossy features of wireless networks, and (3) link delay requirement.

We consider a WANET with L logical links and S sources. Let 
                           
                              
                                 Φ
                                 s
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 S
                                 }
                              
                           
                         and 
                           
                              
                                 Ψ
                                 l
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 L
                                 }
                              
                           
                         denote sets of sources and links, respectively. Let L(s) be the set of links that flow s uses and S(l) be the set of sources using link l. An example of a WANET is shown in Fig. 1, where there are five mobile nodes, four links 
                           
                              
                                 Ψ
                                 l
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 }
                              
                              ,
                           
                         four flows, each of which belongs to a source, then 
                           
                              
                                 Φ
                                 s
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 }
                              
                           
                        . Accordingly, L(3), the set of links that flows 3 uses, is {3, 4}, and similarly, S(3), the set of sources using link 3, is {2, 3, 4}.

In this work, we assume that sources generate only elastic traffic, for example, file transfer, e-mail, Telnet, by which each flow associates with a strictly concave, nondecreasing, continuously differentiable utility function. The work involving an integration of heterogeneous traffic, i.e., elastic traffic and inelastic traffic, is not our focus in this paper and is saved for extending works. We consider a well-known family of utility functions that has been discussed in [27]
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                U
                                                s
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                
                                                )
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     1
                                                                     −
                                                                     α
                                                                  
                                                               
                                                               
                                                                  1
                                                                  −
                                                                  α
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               α
                                                               ≥
                                                               0
                                                            
                                                            ,
                                                            
                                                            
                                                               α
                                                               ≠
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ln
                                                            (
                                                            
                                                               x
                                                               s
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                               =
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where parameter α corresponding to different properties of the utility function is the degree of fairness. The utility function can be interpreted as the satisfaction of source s at data rate xs
                        . In particular, the utility function is optimal fairness with α → 0, proportional fairness with α → 1, harmonic mean fairness with α → 2, and max-min fairness with α → ∞.

The instantaneous capacity on link l is modeled using the Shannon capacity 
                           
                              
                                 C
                                 l
                              
                              
                                 (
                                 P
                                 )
                              
                              =
                              W
                              log
                              
                                 (
                                 1
                                 +
                                 ζ
                                 
                                    γ
                                    l
                                 
                                 
                                    (
                                    P
                                    )
                                 
                                 )
                              
                              ,
                           
                         where 
                           P
                         is a vector of transmission powers, W is the baseband bandwidth, and ζ is the “SINR-gap” depending on particular modulation, coding scheme, and bit-error-rate. The instantaneous SINR is as

                           
                              
                                 
                                    
                                       γ
                                       l
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             p
                                             l
                                          
                                          
                                             G
                                             
                                                l
                                                l
                                             
                                          
                                          
                                             F
                                             
                                                l
                                                l
                                             
                                          
                                       
                                       
                                          
                                             σ
                                             l
                                             2
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ≠
                                                l
                                             
                                          
                                          
                                             p
                                             k
                                          
                                          
                                             G
                                             
                                                l
                                                k
                                             
                                          
                                          
                                             F
                                             
                                                l
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              σ
                              l
                              2
                           
                         is the thermal noise power at the receiver on link l and GlkFlk
                         is the instantaneous channel gain from the transmitter on link k to the receiver on link l. Each GlkFlk
                         consists of a slow-fading channel gain Glk
                         and a fast-fading channel gain Flk
                        .

Similar to [9], we consider the non-light-of-sight propagation where we can use the Rayleigh fast-fading model. For fast-fading wireless channels, the channel fades change very fast within milliseconds [24]; therefore, instead of using instantaneous SINR, we consider the average link SINR and capacity by utilizing the statistics of the SINR γl
                        . Then

                           
                              
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       l
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             p
                                             l
                                          
                                          
                                             G
                                             
                                                l
                                                l
                                             
                                          
                                          
                                             F
                                             
                                                l
                                                l
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             σ
                                             l
                                             2
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ≠
                                                l
                                             
                                          
                                          
                                             p
                                             k
                                          
                                          
                                             G
                                             
                                                l
                                                k
                                             
                                          
                                          
                                             F
                                             
                                                l
                                                k
                                             
                                          
                                          ]
                                       
                                    
                                    =
                                    
                                       
                                          
                                             p
                                             l
                                          
                                          
                                             G
                                             
                                                l
                                                l
                                             
                                          
                                       
                                       
                                          
                                             σ
                                             l
                                             2
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ≠
                                                l
                                             
                                          
                                          
                                             p
                                             k
                                          
                                          
                                             G
                                             
                                                l
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where exponentially random variables Flk
                         are assumed to be independent and identically distributed (i.i.d) and 
                           
                              E
                              [
                              
                                 F
                                 
                                    l
                                    k
                                 
                              
                              ]
                              =
                              1
                              ,
                           
                         ∀k. Accordingly, 
                           
                              
                                 
                                    C
                                    ¯
                                 
                                 l
                              
                              
                                 (
                                 P
                                 )
                              
                              =
                              W
                              log
                              
                                 (
                                 1
                                 +
                                 ζ
                                 
                                    
                                       γ
                                       ¯
                                    
                                    l
                                 
                                 
                                    (
                                    P
                                    )
                                 
                                 )
                              
                           
                        . Hence, if we use the network topology as in Fig. 1, the instantaneous SINR of, for example, link 3 and its corresponding average SINR are 
                           
                              
                                 γ
                                 3
                              
                              
                                 (
                                 P
                                 )
                              
                              =
                              
                                 p
                                 3
                              
                              
                                 G
                                 33
                              
                              
                                 F
                                 33
                              
                              /
                              
                                 (
                                 
                                    σ
                                    3
                                    2
                                 
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       4
                                       }
                                    
                                 
                                 
                                    p
                                    k
                                 
                                 
                                    G
                                    
                                       3
                                       k
                                    
                                 
                                 
                                    F
                                    
                                       3
                                       k
                                    
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                    ¯
                                 
                                 3
                              
                              
                                 (
                                 P
                                 )
                              
                              =
                              
                                 p
                                 3
                              
                              
                                 G
                                 33
                              
                              /
                              
                                 (
                                 
                                    σ
                                    3
                                    2
                                 
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       4
                                       }
                                    
                                 
                                 
                                    p
                                    k
                                 
                                 
                                    G
                                    
                                       3
                                       k
                                    
                                 
                                 )
                              
                              ,
                           
                         respectively.

We consider the delay as a optimization variable. Generally, each link delay is the sum of four components: processing delay, queuing delay, transmission delay, and propagation delay. In this paper, the processing delay and propagation delay are supposed to be zero.

Each link is modeled as a M/M/1 queuing system. Let τ(l) be the sum of the transmission delay and queuing delay on link l. The average packet delay
                           1
                        
                        
                           1
                           According to Little’s result [28], the average delay can be shown to be the average aggregate queue length divided by the average aggregate arrival rate.
                         
                        [8,28] on link l is 
                           
                              E
                              
                                 (
                                 τ
                                 
                                    (
                                    l
                                    )
                                 
                                 )
                              
                              =
                              K
                              /
                              
                                 (
                                 
                                    C
                                    l
                                 
                                 
                                    (
                                    P
                                    )
                                 
                                 −
                                 
                                    ∑
                                    
                                       s
                                       ∈
                                       S
                                       (
                                       l
                                       )
                                    
                                 
                                 
                                    x
                                    
                                       s
                                    
                                    l
                                 
                                 )
                              
                              ,
                           
                         where K (bits) is the mean of exponentially distributed rate of the input Poisson process and 
                           
                              x
                              
                                 s
                              
                              l
                           
                         is the transmission rate of flow s on link l. The link delay is required not to exceed the upper bound of the link delay threshold 
                           
                              
                                 υ
                                 l
                              
                              ,
                           
                         i.e., we have 
                           
                              E
                              
                                 (
                                 τ
                                 
                                    (
                                    l
                                    )
                                 
                                 )
                              
                              ≤
                              
                                 υ
                                 l
                              
                           
                        . Therefore,

                           
                              (2)
                              
                                 
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          S
                                          (
                                          l
                                          )
                                       
                                    
                                    
                                       x
                                       
                                          s
                                       
                                       l
                                    
                                    ≤
                                    
                                       C
                                       l
                                    
                                    
                                       (
                                       P
                                       )
                                    
                                    −
                                    
                                       K
                                       
                                          υ
                                          l
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Once channel states change, it is required to re-track the instant SINR and compelled to rerun the algorithm to seek the optimal solutions. For fast-fading networks where the channel might change very fast, it is not efficient and impractical. To overcome this issue, we consider the outage probability [29], which is 
                           
                              Pr
                              (
                              
                                 γ
                                 l
                              
                              ≤
                              
                                 γ
                                 l
                                 
                                    t
                                    h
                                 
                              
                              )
                           
                         where 
                           
                              γ
                              l
                              
                                 t
                                 h
                              
                           
                         is a target minimum SINR that below which performance becomes unacceptable.

The outage probability is rewritten as 
                           
                              Pr
                              
                                 (
                                 
                                    γ
                                    l
                                 
                                 ≤
                                 
                                    γ
                                    l
                                    
                                       t
                                       h
                                    
                                 
                                 )
                              
                              =
                              1
                              −
                              
                                 ϕ
                                 l
                              
                              
                                 (
                                 P
                                 )
                              
                              ,
                           
                         where ϕl
                        (
                           P
                        ) can be regarded as the degradation of data rate over link l. With the outage probability, the optimal solution to the problem does not need to change when the channel state wanders from one fading state to another one for a fraction of time. In the Rayleigh fading model, the closed-from expression [6,24] of ϕl
                        (
                           P
                        ) is given as

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                l
                                             
                                             
                                                (
                                                P
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Pr
                                             
                                                (
                                                1
                                                >
                                                
                                                   
                                                      γ
                                                      l
                                                      
                                                         t
                                                         h
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         l
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            l
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ≠
                                                         l
                                                      
                                                   
                                                   
                                                      p
                                                      k
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      σ
                                                      l
                                                      2
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             exp
                                             
                                                (
                                                −
                                                
                                                   
                                                      
                                                         σ
                                                         l
                                                         2
                                                      
                                                      
                                                         γ
                                                         l
                                                         
                                                            t
                                                            h
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         l
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            l
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                ∏
                                                
                                                   k
                                                   ≠
                                                   l
                                                
                                             
                                             
                                                1
                                                
                                                   1
                                                   +
                                                   
                                                      γ
                                                      l
                                                      
                                                         t
                                                         h
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                            k
                                                         
                                                         
                                                            G
                                                            
                                                               l
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                            l
                                                         
                                                         
                                                            G
                                                            
                                                               l
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           
                              Pr
                              
                                 (
                                 
                                    γ
                                    l
                                 
                                 ≤
                                 
                                    γ
                                    l
                                    
                                       t
                                       h
                                    
                                 
                                 )
                              
                              ≤
                              
                                 ϵ
                                 l
                              
                              ,
                           
                         which with (3) results in Eq. (4) as

                           
                              (4)
                              
                                 
                                    
                                       ∏
                                       
                                          k
                                          ≠
                                          l
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          γ
                                          l
                                          
                                             t
                                             h
                                          
                                       
                                       
                                          
                                             
                                                p
                                                k
                                             
                                             
                                                G
                                                
                                                   l
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                p
                                                l
                                             
                                             
                                                G
                                                
                                                   l
                                                   l
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ≤
                                    
                                       Ω
                                       l
                                    
                                    
                                       (
                                       
                                          p
                                          l
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 Ω
                                 l
                              
                              
                                 (
                                 
                                    p
                                    l
                                 
                                 )
                              
                              =
                              
                                 
                                    (
                                    1
                                    −
                                    
                                       ϵ
                                       l
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              exp
                              
                                 (
                                 −
                                 
                                    
                                       
                                          σ
                                          l
                                          2
                                       
                                       
                                          γ
                                          l
                                          
                                             t
                                             h
                                          
                                       
                                    
                                    
                                       
                                          p
                                          l
                                       
                                       
                                          G
                                          
                                             l
                                             l
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        .

We consider the leaky-pipe flow model [7], where the flow rate of each flow changes hop by hop and decrease along its route. For a flow s, the effective rate ys
                         at the destination is computed as the multiplication of the outage probability on links that flow s traverses and the injection rate xs
                        , i.e., 
                           
                              
                                 y
                                 s
                              
                              =
                              
                                 x
                                 s
                              
                              
                                 ∏
                                 
                                    l
                                    ∈
                                    L
                                    (
                                    s
                                    )
                                 
                              
                              
                                 [
                                 1
                                 −
                                 Pr
                                 
                                    (
                                    l
                                    ,
                                    
                                       γ
                                       l
                                    
                                    )
                                 
                                 ]
                              
                           
                        . Specifically, we assume that data generated by source s travels Hs
                         hops and the data rate reduces along Hs
                         hops before reaching the destination. The data rate at link i of flow s is 
                           
                              x
                              s
                              i
                           
                         and given by

                           
                              (5)
                              
                                 
                                    
                                       x
                                       s
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       x
                                       s
                                       i
                                    
                                    
                                       (
                                       1
                                       −
                                       Pr
                                       
                                          (
                                          l
                                          (
                                          s
                                          ,
                                          i
                                          )
                                          )
                                       
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       H
                                       s
                                    
                                    ,
                                 
                              
                           
                        where Pr(l(s, i)) is the outage probability on link i, Eq. (5) is referred to the constraint on flow rate conservation.

From the constraints (2), (4), and (5), feasible region of power and flow rate, and the optimization objective intending to maximize the overall effective utility and minimize total consumed power and link delay, the optimization problem is considered, as follows:

                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      x
                                                      
                                                         s
                                                      
                                                      l
                                                   
                                                   ,
                                                   
                                                      p
                                                      l
                                                   
                                                   ,
                                                   
                                                      υ
                                                      l
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      Φ
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                   
                                                      
                                                         H
                                                         s
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ω
                                                1
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      Ψ
                                                      l
                                                   
                                                
                                             
                                             
                                                p
                                                l
                                             
                                             −
                                             
                                                ω
                                                2
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      Ψ
                                                      l
                                                   
                                                
                                             
                                             
                                                υ
                                                l
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                             χ
                                             =
                                             
                                                {
                                                
                                                   x
                                                   
                                                      s
                                                   
                                                   l
                                                
                                                
                                                   |
                                                
                                                
                                                   x
                                                   
                                                      s
                                                   
                                                   
                                                      l
                                                      min
                                                   
                                                
                                                ≤
                                                
                                                   x
                                                   
                                                      s
                                                   
                                                   l
                                                
                                                ≤
                                                
                                                   x
                                                   s
                                                   
                                                      l
                                                      max
                                                   
                                                
                                                }
                                             
                                             
                                             ∀
                                             s
                                             ,
                                             l
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             Γ
                                             =
                                             
                                                {
                                                
                                                   p
                                                   l
                                                
                                                
                                                   |
                                                
                                                
                                                   p
                                                   l
                                                   min
                                                
                                                ≤
                                                
                                                   p
                                                   l
                                                
                                                ≤
                                                
                                                   p
                                                   l
                                                   max
                                                
                                                }
                                             
                                             
                                             ∀
                                             l
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                ∏
                                                
                                                   k
                                                   ≠
                                                   l
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                
                                                   γ
                                                   l
                                                   
                                                      t
                                                      h
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                         k
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         l
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            l
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                Ω
                                                l
                                             
                                             
                                                (
                                                
                                                   p
                                                   l
                                                
                                                )
                                             
                                             
                                             ∀
                                             l
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             
                                                x
                                                
                                                   s
                                                
                                                l
                                             
                                             ≤
                                             
                                                C
                                                l
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ¯
                                                   
                                                   l
                                                
                                                
                                                   (
                                                   P
                                                   )
                                                
                                                )
                                             
                                             −
                                             
                                                K
                                                
                                                   υ
                                                   l
                                                
                                             
                                             
                                             ∀
                                             l
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                x
                                                s
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             ≤
                                             
                                                x
                                                s
                                                i
                                             
                                             
                                                (
                                                1
                                                −
                                                Pr
                                                
                                                   (
                                                   l
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   )
                                                
                                                )
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             ,
                                             ∀
                                             s
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ω
                        1 and ω
                        2 are prices per unit of consumed power and suffered delay, respectively.

The problem (6) is not an jointly convex problem in terms of 
                           
                              (
                              
                                 x
                                 
                                    s
                                 
                                 l
                              
                              ,
                              
                                 p
                                 l
                              
                              ,
                              
                                 υ
                                 l
                              
                              )
                           
                         due to the third and fifth constraints. Consequently, the locally optimal solution may be not the globally optimal solution and the KKT conditions is just necessary, not sufficient for solution optimality [30]. To ease (6), it is converted to a new one, as follows:

                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      l
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                         ^
                                                      
                                                      l
                                                   
                                                   ,
                                                   
                                                      
                                                         υ
                                                         ^
                                                      
                                                      l
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      Φ
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                (
                                                
                                                   e
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      
                                                         
                                                            H
                                                            s
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ω
                                                1
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      Ψ
                                                      l
                                                   
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             −
                                             
                                                ω
                                                2
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      Ψ
                                                      l
                                                   
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ≠
                                                   l
                                                
                                             
                                             log
                                             
                                                (
                                                1
                                                +
                                                
                                                   γ
                                                   l
                                                   
                                                      t
                                                      h
                                                   
                                                
                                                
                                                   
                                                      
                                                         e
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            k
                                                         
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            l
                                                         
                                                      
                                                      
                                                         G
                                                         
                                                            l
                                                            l
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ≤
                                             log
                                             
                                                Ω
                                                l
                                             
                                             
                                                (
                                                
                                                   e
                                                   
                                                      
                                                         p
                                                         ^
                                                      
                                                      l
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                ∀
                                                l
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   l
                                                
                                             
                                             ≤
                                             
                                                C
                                                l
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ¯
                                                   
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         P
                                                         ^
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             −
                                             
                                                K
                                                
                                                   e
                                                   
                                                      
                                                         υ
                                                         ^
                                                      
                                                      l
                                                   
                                                
                                             
                                             
                                             
                                                ∀
                                                l
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             ≤
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                i
                                             
                                             −
                                             
                                                ψ
                                                
                                                   l
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   ^
                                                
                                                )
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             ,
                                             ∀
                                             s
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where auxiliary variables and transformation are:

                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   s
                                                
                                                l
                                             
                                             =
                                             
                                                e
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   
                                                      s
                                                   
                                                   l
                                                
                                             
                                             ,
                                             
                                             
                                                χ
                                                ^
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   
                                                      s
                                                   
                                                   l
                                                
                                                
                                                   |
                                                   log
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      s
                                                      
                                                         l
                                                         min
                                                      
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   l
                                                
                                                ≤
                                                log
                                                
                                                   (
                                                   
                                                      x
                                                      s
                                                      
                                                         l
                                                         max
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                p
                                                l
                                             
                                             =
                                             
                                                e
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             ,
                                             
                                             
                                                Γ
                                                ^
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                                
                                                   |
                                                   log
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      l
                                                      min
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                                ≤
                                                log
                                                
                                                   (
                                                   
                                                      p
                                                      l
                                                      max
                                                   
                                                   )
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                υ
                                                l
                                             
                                             =
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                s
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             ≤
                                             
                                                x
                                                s
                                                i
                                             
                                             ϕ
                                             
                                                (
                                                l
                                                (
                                                s
                                                ,
                                                i
                                                )
                                                )
                                             
                                             ,
                                             
                                             
                                                ψ
                                                
                                                   l
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   ^
                                                
                                                )
                                             
                                             =
                                             −
                                             log
                                             
                                                (
                                                ϕ
                                                
                                                   (
                                                   l
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The minus sign in (10) denotes the reduction of the effective rate compared with the injection rate on a link. For simplicity, 
                           
                              
                                 C
                                 l
                              
                              
                                 (
                                 
                                    
                                       γ
                                       ¯
                                    
                                    l
                                 
                                 
                                    (
                                    
                                       e
                                       
                                          P
                                          ^
                                       
                                    
                                    )
                                 
                                 )
                              
                           
                         is adequately represented by 
                           
                              
                                 C
                                 l
                              
                              
                                 (
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       ^
                                    
                                    l
                                 
                                 )
                              
                           
                         or 
                           
                              
                                 C
                                 l
                              
                              
                                 (
                                 
                                    e
                                    
                                       P
                                       ^
                                    
                                 
                                 )
                              
                           
                         which means that we are dealing with the average SINR.

To prove Us
                        (exp (.)) is a concave function, we make an assumption as 
                           
                              
                                 
                                    
                                       d
                                       2
                                    
                                    
                                       U
                                       s
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       )
                                    
                                 
                                 
                                    d
                                    
                                       x
                                       
                                          s
                                       
                                       2
                                    
                                 
                              
                              
                                 x
                                 s
                              
                              +
                              
                                 
                                    d
                                    
                                       U
                                       s
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       )
                                    
                                 
                                 
                                    d
                                    
                                       x
                                       s
                                    
                                 
                              
                              <
                              0
                           
                        . This assumption is realistic and satisfied if we use α-fair utility function with the fair index α > 1; in case of 
                           
                              α
                              =
                              1
                              ,
                           
                         i.e., the log-utility function, the assumption now becomes 
                           
                              
                                 
                                    
                                       d
                                       2
                                    
                                    
                                       U
                                       s
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       )
                                    
                                 
                                 
                                    d
                                    
                                       x
                                       
                                          s
                                       
                                       2
                                    
                                 
                              
                              
                                 x
                                 s
                              
                              +
                              
                                 
                                    d
                                    
                                       U
                                       s
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       )
                                    
                                 
                                 
                                    d
                                    
                                       x
                                       s
                                    
                                 
                              
                              ≤
                              0
                           
                         
                        [9,10,31]. In addition, we need the Lemmas 1 and2 to show convexity and strong duality of the problem (7).

                           Lemma 1
                           
                              
                                 (7)
                               
                              is a convex optimization problem.
                           

See Appendix A.□


                              Strong duality holds for the problem 
                              
                                 (7)
                              
                              .
                           

There exist feasible solutions 
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       l
                                    
                                    ∈
                                    
                                       χ
                                       ^
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                          ^
                                       
                                       l
                                    
                                    ∈
                                    
                                       Γ
                                       ^
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       υ
                                       ^
                                    
                                    l
                                 
                               that the constraints (8)–(10) hold with strict inequalities. Accordingly, Slater’s condition holds [30]. Moreover, the problem is convex (Lemma 1), so strong duality holds.□

In [12], we presented the nRENUM algorithm which can guarantee the globally optimal solutions to the problem (7). However, updates in nRENUM are all executed on the same timescale. Concretely, this work assumes that parameters are computed online and updated simultaneously, requires synchronization, and coordination among layers. In practice, there is a difference in timescales among layers to ease implementations of NUM. The link delay is normally updated at the millisecond timescale, that is the slow timescale update. In the meanwhile, update timescales of congestion control and power control are, respectively, the second scale and the microsecond scale. Moreover, the same timescale operation might create more signaling overhead and stems the system convergence [11]. That is why our focus is in studying the NUM framework considering the difference in layers’ timescales in WANETs. In the next section, our design is described in detail.

This section presents an attractive aspect to solve the optimization problem (7). We make use of the primal decomposition and difference in layers’ timescales to derive three subproblems. For each subproblem, we define the dual problem, which are solved by exploiting the gradient method. Here, subproblems are the resource control subproblem executed on the short-timescale t
                     1, the delay control subproblem derived at the mid-timescale t
                     2 and the congestion control subproblem executed on the long-timescale t
                     3.

Instead of directly solving the problem (7), we first consider the STS subproblem that aims to minimize the transmit power for a given rate vector 
                        
                           {
                           
                              x
                              ^
                           
                           =
                           
                              
                                 x
                                 ^
                              
                              s
                              l
                           
                           |
                           
                              
                                 x
                                 ^
                              
                              s
                              l
                           
                           ∈
                           
                              χ
                              ^
                           
                           ,
                           s
                           ∈
                           
                              Φ
                              s
                           
                           ,
                           l
                           ∈
                           
                              Ψ
                              l
                           
                           }
                        
                      and link delay vector 
                        
                           {
                           
                              
                                 υ
                              
                              ^
                           
                           =
                           
                              
                                 υ
                                 ^
                              
                              l
                           
                           |
                           l
                           ∈
                           
                              Ψ
                              l
                           
                           }
                        
                     .

                        
                           (14)
                           
                              
                                 
                                    
                                    
                                       
                                          STS:
                                          
                                          
                                             max
                                             
                                                
                                                   p
                                                   ^
                                                
                                                l
                                             
                                          
                                          
                                          −
                                          
                                             ω
                                             1
                                          
                                          
                                             ∑
                                             
                                                l
                                                ∈
                                                
                                                   Ψ
                                                   l
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   p
                                                   ^
                                                
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s.t.
                                          
                                          
                                          
                                             
                                                p
                                                ^
                                             
                                             l
                                          
                                          ∈
                                          
                                             
                                                Γ
                                                ^
                                             
                                             l
                                          
                                          
                                          
                                             ∀
                                             l
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             ∑
                                             
                                                k
                                                ≠
                                                l
                                             
                                          
                                          log
                                          
                                             (
                                             1
                                             +
                                             
                                                γ
                                                l
                                                
                                                   t
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         k
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         l
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         l
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ≤
                                          log
                                          
                                             Ω
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                          
                                             ∀
                                             l
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                                (
                                                l
                                                )
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                l
                                             
                                          
                                          ≤
                                          
                                             C
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   P
                                                   ^
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             K
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                             
                                          
                                          
                                          
                                             ∀
                                             l
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          ≤
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             i
                                          
                                          −
                                          
                                             ψ
                                             
                                                l
                                                (
                                                s
                                                ,
                                                i
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                ^
                                             
                                             )
                                          
                                          
                                          
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             ,
                                             ∀
                                             s
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Solving the subproblem (14) at the short-timescale t
                     1, we can obtain the minimum cost 
                        
                           φ
                           (
                           
                              t
                              1
                           
                           
                              (
                              P
                              )
                           
                           )
                        
                      in term of transmit power and the optimal power vector 
                        
                           
                              P
                              *
                           
                           
                              (
                              
                                 t
                                 1
                              
                              )
                           
                        
                     . Then, the MTS subproblem which intends to minimize the total link average delay for a given source rate vector 
                        
                           {
                           
                              x
                              ^
                           
                           =
                           
                              
                                 x
                                 ^
                              
                              s
                              l
                           
                           |
                           
                              
                                 x
                                 ^
                              
                              s
                              l
                           
                           ∈
                           
                              χ
                              ^
                           
                           ,
                           s
                           ∈
                           
                              Φ
                              s
                           
                           ,
                           l
                           ∈
                           
                              Ψ
                              l
                           
                           }
                           ,
                        
                      the optimum cost 
                        
                           φ
                           (
                           
                              t
                              1
                           
                           
                              (
                              P
                              )
                           
                           )
                           ,
                        
                      and the optimal power 
                        
                           
                              P
                              *
                           
                           
                              (
                              
                                 t
                                 1
                              
                              )
                           
                        
                      is considered at the timescale t
                     2, as follows:

                        
                           (15)
                           
                              
                                 
                                    
                                    
                                       
                                          MTS:
                                          
                                          
                                             max
                                             
                                                
                                                   υ
                                                   ^
                                                
                                                l
                                             
                                          
                                          
                                          −
                                          
                                             ω
                                             2
                                          
                                          
                                             ∑
                                             
                                                l
                                                ∈
                                                
                                                   Ψ
                                                   l
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   υ
                                                   ^
                                                
                                                l
                                             
                                          
                                          −
                                          φ
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             
                                                (
                                                P
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                    
                                       
                                          s.t.
                                          
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                                (
                                                l
                                                )
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                l
                                             
                                          
                                          ≤
                                          
                                             C
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      P
                                                      ^
                                                   
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             K
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                             
                                          
                                          
                                          
                                             ∀
                                             l
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly, by solving the subproblem (15) we obtain the minimum cost 
                        
                           φ
                           (
                           
                              t
                              2
                           
                           
                              (
                              
                                 υ
                              
                              ,
                              
                                 t
                                 1
                              
                              
                                 (
                                 P
                                 )
                              
                              )
                           
                           )
                        
                      in term of both transmission power and link average delay and the optimal link delay vector 
                        
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           =
                           
                              
                                 [
                                 
                                    υ
                                    1
                                    *
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    υ
                                    L
                                    *
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                                 ]
                              
                              T
                           
                        
                     . Finally, the TRAN layer subproblem which aims at maximizing the total effective utility for the given minimum cost 
                        
                           φ
                           (
                           
                              t
                              2
                           
                           
                              (
                              
                                 υ
                              
                              ,
                              
                                 t
                                 1
                              
                              
                                 (
                                 P
                                 )
                              
                              )
                           
                           )
                           ,
                        
                      the optimal vectors 
                        
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                        
                      and 
                        
                           
                              P
                              *
                           
                           
                              (
                              
                                 t
                                 1
                              
                              )
                           
                        
                      is considered at the timescale t
                     3 as

                        
                           (17)
                           
                              
                                 
                                    
                                    
                                       
                                          LTS:
                                          
                                          
                                             max
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                l
                                             
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                
                                                   Φ
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                s
                                             
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   
                                                      
                                                         H
                                                         s
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          −
                                          φ
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             
                                                (
                                                υ
                                                ,
                                                
                                                   t
                                                   1
                                                
                                                
                                                   (
                                                   P
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s.t.
                                          
                                          
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             l
                                          
                                          ∈
                                          
                                             χ
                                             ^
                                          
                                          
                                          ∀
                                          s
                                          ,
                                          l
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                                (
                                                l
                                                )
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                l
                                             
                                          
                                          ≤
                                          
                                             C
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      P
                                                      ^
                                                   
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             K
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                   *
                                                
                                             
                                          
                                          
                                          
                                             ∀
                                             l
                                          
                                          .
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          ≤
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             i
                                          
                                          −
                                          
                                             ψ
                                             
                                                l
                                                (
                                                s
                                                ,
                                                i
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ^
                                                
                                                *
                                             
                                             )
                                          
                                          
                                          
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             ,
                                             ∀
                                             s
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The update timescale of the LTS subproblem is much slower than that of the MTS subproblem and both of them are much slower than that of the STS subproblem. Accordingly, for given vectors 
                        
                           x
                           ^
                        
                      and 
                        
                           
                              
                                 υ
                              
                              ^
                           
                           ,
                        
                      optimizing the STS subproblem can be well treated to be instantaneous, and is also true for the MTS subproblem for a given 
                        
                           x
                           ^
                        
                     .

                        Lemma 3
                        
                           Convexity and strong duality properties hold for the new optimization subproblems.
                        

As convexity and strong duality of the optimization problem (7) are proved in Lemmas 1 and2, three optimization subproblems (14), (15), (17) and their constraints are derived without any modifications. As a result, convexity and strong duality property hold for three subproblems.□

We first define the Lagrangian, as follows:

                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                L
                                                p
                                             
                                             
                                                (
                                                
                                                   P
                                                   ^
                                                
                                                ,
                                                
                                                   λ
                                                
                                                ,
                                                
                                                   μ
                                                
                                                ,
                                                
                                                   ν
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                             
                                                ∑
                                                s
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   H
                                                   s
                                                
                                             
                                             
                                                ν
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   i
                                                
                                                −
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   ψ
                                                   
                                                      l
                                                      (
                                                      s
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      ^
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                λ
                                                l
                                             
                                             
                                                (
                                                log
                                                
                                                   Ω
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      k
                                                      ≠
                                                      l
                                                   
                                                
                                                log
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      γ
                                                      l
                                                      
                                                         t
                                                         h
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                            
                                                               
                                                                  p
                                                                  ^
                                                               
                                                               k
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               l
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            e
                                                            
                                                               
                                                                  p
                                                                  ^
                                                               
                                                               l
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               l
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                μ
                                                l
                                             
                                             
                                                (
                                                
                                                   C
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         P
                                                         ^
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                                
                                                   e
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      l
                                                   
                                                
                                                −
                                                
                                                   K
                                                   
                                                      e
                                                      
                                                         
                                                            υ
                                                            ^
                                                         
                                                         l
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ω
                                                1
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                e
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           λ, μ
                        , and 
                           ν
                         are the Lagrange multipliers. Then, we define the Lagrange dual function gP
                        (
                           λ, μ, ν
                        ) as

                           
                              
                                 
                                    
                                       g
                                       P
                                    
                                    
                                       (
                                       
                                          λ
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    =
                                    
                                       max
                                       
                                          P
                                          ^
                                       
                                    
                                    
                                       L
                                       p
                                    
                                    
                                       (
                                       
                                          P
                                          ^
                                       
                                       ,
                                       
                                          λ
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        which can be specified as the maximum of the Lagrangian (18) over the primal variable 
                           
                              P
                              ^
                           
                        . Accordingly, that leads to

                           
                              (19)
                              
                                 
                                    
                                       min
                                       
                                          
                                             λ
                                          
                                          ,
                                          
                                             μ
                                          
                                          ,
                                          
                                             ν
                                          
                                       
                                    
                                    
                                       g
                                       P
                                    
                                    
                                       (
                                       
                                          λ
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        The dual problem (19) is a convex problem. We can use the primal-dual method to develop the STS iterative subalgorithm, as follows.


                        Power allocation:
                           2
                        
                        
                           2
                           Notation [x]
                                 Γ
                               is the projection of x on the set Γ.
                         the link transmit power is updated by

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                l
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            M
                                                            l
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            (
                                                            
                                                               λ
                                                               l
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               ν
                                                               s
                                                               l
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            σ
                                                            l
                                                            2
                                                         
                                                         
                                                            m
                                                            l
                                                            
                                                               t
                                                               h
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ≠
                                                               l
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               k
                                                               l
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               A
                                                               
                                                                  k
                                                                  l
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               m
                                                               k
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  1
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ω
                                                            1
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                Γ
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 M
                                 n
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              W
                              
                                 μ
                                 n
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              
                                 
                                    ζ
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    1
                                    +
                                    ζ
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     


                        
                           
                              
                                 m
                                 n
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    
                                       G
                                       
                                          n
                                          n
                                       
                                    
                                    
                                       p
                                       n
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                              
                              
                                 M
                                 n
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              
                                 m
                                 n
                                 
                                    t
                                    h
                                 
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                       
                                          t
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    
                                       G
                                       
                                          n
                                          n
                                       
                                    
                                    
                                       p
                                       n
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                         and


                        
                           
                              
                                 A
                                 
                                    k
                                    l
                                 
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    λ
                                    k
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 +
                                 
                                    ν
                                    s
                                    k
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 )
                              
                              
                                 
                                    
                                       m
                                       k
                                       
                                          t
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       G
                                       
                                          k
                                          l
                                       
                                    
                                    
                                       m
                                       k
                                       
                                          t
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    
                                       p
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                 
                              
                           
                        .


                        Lagrange multipliers:
                           3
                        
                        
                           3
                           
                              
                                 
                                    
                                       
                                          [
                                          z
                                          ]
                                       
                                       +
                                    
                                    =
                                    max
                                    
                                       {
                                       z
                                       ,
                                       0
                                       }
                                    
                                 
                              .
                        
                     


                        Outage prices: each link l updates its dual variable λl
                         as

                           
                              (21)
                              
                                 
                                    
                                       λ
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             λ
                                             l
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          −
                                          
                                             δ
                                             p
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          ∇
                                          
                                             g
                                             P
                                             
                                                (
                                                
                                                   λ
                                                   l
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          ]
                                       
                                       +
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 g
                                 P
                                 
                                    (
                                    
                                       λ
                                       l
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    k
                                    ≠
                                    l
                                 
                              
                              log
                              
                                 (
                                 1
                                 +
                                 
                                    γ
                                    l
                                    
                                       t
                                       h
                                    
                                 
                                 
                                    
                                       
                                          e
                                          
                                             
                                                
                                                   p
                                                   ^
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       
                                          G
                                          
                                             l
                                             k
                                          
                                       
                                    
                                    
                                       
                                          e
                                          
                                             
                                                
                                                   p
                                                   ^
                                                
                                                l
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       
                                          G
                                          
                                             l
                                             l
                                          
                                       
                                    
                                 
                                 )
                              
                              −
                              log
                              
                                 Ω
                                 l
                              
                              
                                 (
                                 
                                    e
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          l
                                       
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                           
                        .


                        Delay prices: the dual variable 
                           
                              
                                 μ
                                 l
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 +
                                 1
                                 )
                              
                           
                         can be updated as

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                l
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   [
                                                   
                                                      μ
                                                      l
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      δ
                                                      p
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   ∇
                                                   
                                                      g
                                                      P
                                                      
                                                         (
                                                         
                                                            μ
                                                            l
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                +
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 g
                                 P
                                 
                                    (
                                    
                                       μ
                                       l
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    s
                                    ∈
                                    S
                                    (
                                    l
                                    )
                                 
                              
                              
                                 e
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       
                                          s
                                       
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                              
                              −
                              
                                 C
                                 l
                              
                              
                                 (
                                 
                                    e
                                    
                                       
                                          P
                                          ^
                                       
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                              +
                              
                                 K
                                 
                                    e
                                    
                                       
                                          
                                             υ
                                             ^
                                          
                                          l
                                       
                                       
                                          (
                                          
                                             t
                                             2
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        .


                        Lossy prices: at each link i of flow s, 
                           
                              ν
                              s
                              i
                           
                         can be updated by

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                ν
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                +
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   [
                                                   
                                                      ν
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      δ
                                                      p
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   ∇
                                                   
                                                      g
                                                      P
                                                      
                                                         (
                                                         
                                                            ν
                                                            s
                                                            i
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               1
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                +
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 g
                                 P
                                 
                                    (
                                    
                                       ν
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    1
                                 
                                 )
                              
                              =
                              
                                 
                                    x
                                    ^
                                 
                                 s
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              −
                              
                                 
                                    x
                                    ^
                                 
                                 s
                                 i
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              +
                              
                                 ψ
                                 
                                    l
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    P
                                    ^
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 )
                              
                           
                        .

                           Remark 1
                           
                              
                                 
                                    •
                                    Here, transmission power and its dual variables of the STS subproblem are updated for given link delay 
                                          
                                             
                                                
                                                   υ
                                                   ^
                                                
                                                l
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                          
                                        and data rate 
                                          
                                             {
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   t
                                                   3
                                                
                                                )
                                             
                                             |
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             }
                                          
                                       .

The STS iterative subalgorithm can be implemented distributedly through message passing (e.g., 
                                          
                                             
                                                m
                                                k
                                                
                                                   t
                                                   h
                                                
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             ,
                                          
                                        
                                       mk
                                       (t
                                       1), λk
                                       (t
                                       1) and 
                                          
                                             
                                                ν
                                                s
                                                k
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                          
                                       ).

The Lagrangian of subproblem (15) is defined as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                                ,
                                                
                                                   μ
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             
                                                ω
                                                2
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                e
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             −
                                             φ
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                
                                                   (
                                                   P
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                μ
                                                l
                                             
                                             
                                                (
                                                
                                                   C
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         
                                                            P
                                                            ^
                                                         
                                                         *
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                                
                                                   e
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      l
                                                   
                                                
                                                −
                                                
                                                   K
                                                   
                                                      e
                                                      
                                                         
                                                            υ
                                                            l
                                                         
                                                         ^
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           μ
                         is the delay price for the constraint (16). The dual function and the dual problem are, respectively, as follows.

                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                g
                                                
                                                   υ
                                                
                                             
                                             
                                                (
                                                
                                                   μ
                                                
                                                )
                                             
                                             =
                                             
                                                max
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                             
                                             
                                                L
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                                ,
                                                
                                                   μ
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   μ
                                                
                                             
                                             
                                             
                                                g
                                                
                                                   υ
                                                
                                             
                                             
                                                (
                                                
                                                   μ
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Making use of the gradient method, we consider the following MTS iterative subalgorithm.


                        Link average delays: at each link l, 
                           
                              υ
                              l
                           
                         can be updated as

                           
                              (24)
                              
                                 
                                    
                                       υ
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             μ
                                             l
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          
                                             K
                                             
                                                ω
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                        Delay prices: at each link l, the dual price can be updated as

                           
                              
                                 
                                    
                                       μ
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             μ
                                             l
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          −
                                          
                                             δ
                                             υ
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ∇
                                          
                                             g
                                             
                                                
                                                   υ
                                                
                                             
                                             
                                                (
                                                
                                                   μ
                                                   l
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ]
                                       
                                       +
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              δ
                              υ
                           
                         is a positive step size and

                           
                              
                                 
                                    ∇
                                    
                                       g
                                       
                                          
                                             υ
                                          
                                       
                                       
                                          (
                                          
                                             μ
                                             l
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       C
                                       l
                                    
                                    
                                       (
                                       
                                          e
                                          
                                             
                                                
                                                   P
                                                   ^
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   
                                                      υ
                                                   
                                                   ^
                                                
                                                
                                                   (
                                                   
                                                      t
                                                      2
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          S
                                          (
                                          l
                                          )
                                       
                                    
                                    
                                       e
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             l
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       K
                                       
                                          e
                                          
                                             
                                                
                                                   υ
                                                   l
                                                
                                                ^
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                    ^
                                 
                                 *
                              
                              
                                 (
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                                 )
                              
                           
                         is the optimal transmission power vector obtained from the STS iterative subalgorithm.

                           Remark 2
                           
                              
                                 
                                    •
                                    The link delay update (24) depends on only local information on delay prices. Consequently, the MTS subalgorithm can be implemented distributedly.

The link delay and delay price of the MTS subproblem are updated for given the optimal solutions obtained from the STS iterative subalgorithm and given data rate 
                                          
                                             {
                                             
                                                
                                                   x
                                                   ^
                                                
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   t
                                                   3
                                                
                                                )
                                             
                                             |
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                H
                                                s
                                             
                                             }
                                          
                                       .

Similar to Sections 4.1 and 4.2, we first construct the Lagrangian for the LTS subproblem, as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   x
                                                   ^
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   ^
                                                
                                                ,
                                                
                                                   μ
                                                
                                                ,
                                                
                                                   ν
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      Φ
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                (
                                                
                                                   e
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      
                                                         
                                                            H
                                                            s
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             φ
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                
                                                   (
                                                   υ
                                                   ,
                                                   
                                                      t
                                                      1
                                                   
                                                   
                                                      (
                                                      P
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                l
                                             
                                             
                                                μ
                                                l
                                             
                                             
                                                (
                                                
                                                   C
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         
                                                            P
                                                            ^
                                                         
                                                         *
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   K
                                                   
                                                      e
                                                      
                                                         
                                                            υ
                                                            ^
                                                         
                                                         l
                                                         *
                                                      
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                      (
                                                      l
                                                      )
                                                   
                                                
                                                
                                                   e
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      s
                                                      l
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                s
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   H
                                                   s
                                                
                                             
                                             
                                                ν
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   i
                                                
                                                −
                                                
                                                   ψ
                                                   
                                                      l
                                                      (
                                                      s
                                                      ,
                                                      i
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ^
                                                      
                                                      *
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Then the dual function is given as

                           
                              
                                 
                                    
                                       g
                                       x
                                    
                                    
                                       (
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    =
                                    
                                       max
                                       
                                          x
                                          ^
                                       
                                    
                                    
                                       L
                                       
                                          x
                                          ^
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ^
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Accordingly, the dual problem is, as follows:

                           
                              (25)
                              
                                 
                                    
                                       min
                                       
                                          
                                             μ
                                          
                                          ,
                                          
                                             ν
                                          
                                       
                                    
                                    
                                       g
                                       x
                                    
                                    
                                       (
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Similar to the previous subsections, we exploit the gradient method to solve the dual problem (25) and develop the following LTS iterative subalgorithm.


                        Data rate:

The data rate at link i of flow s, can be updated, as follows:

                           
                              
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                x
                                                ^
                                             
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          +
                                          
                                             δ
                                             x
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          ∇
                                          
                                             g
                                             
                                                x
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          ]
                                       
                                       
                                          χ
                                          ^
                                       
                                    
                                    ,
                                 
                              
                           
                        where δx
                         is a positive scalar step size and 
                           
                              ∇
                              
                                 g
                                 
                                    x
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       i
                                    
                                    )
                                 
                              
                           
                         is the gradient of 
                           
                              L
                              
                                 x
                                 ^
                              
                           
                         with respect to 
                           
                              
                                 x
                                 ^
                              
                              s
                              i
                           
                         and specified by 
                           
                              ∇
                              
                                 g
                                 
                                    x
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       i
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              =
                              
                                 ν
                                 s
                                 i
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              −
                              
                                 ν
                                 s
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              −
                              
                                 μ
                                 
                                    l
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                              
                              
                                 e
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                              
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 H
                                 s
                              
                           
                        . For 
                           
                              i
                              =
                              
                                 H
                                 s
                              
                              +
                              1
                              ,
                           
                        
                        
                           
                              ∇
                              
                                 g
                                 x
                              
                              
                                 (
                                 
                                    
                                       x
                                       ^
                                    
                                    s
                                    i
                                 
                                 )
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              =
                              
                                 U
                                 s
                                 
                                    
                                    ′
                                 
                              
                              
                                 (
                                 
                                    e
                                    
                                       
                                          
                                             x
                                             ^
                                          
                                          s
                                          
                                             
                                                H
                                                s
                                             
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             t
                                             3
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                              
                                 e
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       
                                          
                                             H
                                             s
                                          
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                              
                              −
                              
                                 ν
                                 s
                                 
                                    H
                                    s
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                           
                        .


                        Delay prices: each link l update its delay price μl
                        (t
                        3) as

                           
                              
                                 
                                    
                                       μ
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             μ
                                             l
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          −
                                          
                                             δ
                                             x
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          ∇
                                          
                                             g
                                             x
                                             
                                                (
                                                
                                                   μ
                                                   l
                                                
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          ]
                                       
                                       +
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 g
                                 
                                    x
                                 
                                 
                                    (
                                    
                                       μ
                                       l
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              =
                              
                                 C
                                 l
                              
                              
                                 (
                                 
                                    e
                                    
                                       
                                          
                                             P
                                             ^
                                          
                                          *
                                       
                                       
                                          (
                                          
                                             x
                                             ^
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                              −
                              
                                 K
                                 
                                    e
                                    
                                       
                                          
                                             υ
                                             ^
                                          
                                          l
                                          *
                                       
                                       
                                          (
                                          
                                             x
                                             ^
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                              −
                              
                                 ∑
                                 
                                    s
                                    ∈
                                    S
                                    (
                                    l
                                    )
                                 
                              
                              
                                 e
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       l
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                     


                        Lossy prices: at each link i of source s, the lossy price 
                           
                              
                                 ν
                                 s
                                 i
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                           
                         is updated by

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ν
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   t
                                                   3
                                                
                                                +
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   [
                                                   
                                                      ν
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         3
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      δ
                                                      x
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         3
                                                      
                                                      )
                                                   
                                                   ∇
                                                   
                                                      g
                                                      
                                                         x
                                                      
                                                      
                                                         (
                                                         
                                                            ν
                                                            s
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                         3
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                +
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 g
                                 
                                    x
                                 
                                 
                                    (
                                    
                                       ν
                                       s
                                       i
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              =
                              
                                 
                                    x
                                    ^
                                 
                                 s
                                 i
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              −
                              
                                 
                                    x
                                    ^
                                 
                                 s
                                 
                                    i
                                    +
                                    1
                                 
                              
                              
                                 (
                                 
                                    t
                                    3
                                 
                                 )
                              
                              −
                              
                                 ψ
                                 
                                    l
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    
                                       P
                                       ^
                                    
                                    *
                                 
                                 
                                    (
                                    
                                       x
                                       ^
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                    )
                                 
                                 )
                              
                              .
                           
                        
                        
                           Remark 3
                           
                              
                                 
                                    •
                                    The link rate, effective rate and dual variables can be updated based on the optimal solutions obtained from the STS subalgorithm and the MTS subalgorithm.

The LTS subalgorithm can be implemented distributively through message passing (i.e., dual variables) among links and sources.

To summarize, the key aspect of the MTSRENUM iterative algorithm is illustrated in Algorithm 1
                        .

The MTSRENUM algorithm can be regarded as a tight loop in which the STS, MTS and LTS subalgorithms respond to the inner loop, the mid loop and the outer loop, respectively. The STS subalgorithm operates at the short-timescale t
                        1 for given data rate and delay vectors. The mid loop is updated at the mid-timescale t
                        2 for a given data rate vector, optimal solutions obtained from the STS subalgorithm. The last one is executed on the timescale t
                        3 for stable link delay vector, stable power vector and the corresponding prices.

We now analyze the convergence of the STS subalgorithm. Denote 
                           
                              P
                              *
                           
                         as the optimal solutions to the STS subproblem and ‖.‖ as the Euclidean distance. We have the following theorem.

                           Theorem 4 Convergence of the STS subalgorithm
                           
                              Let
                              
                                 
                                    P
                                    (
                                    0
                                    )
                                    ∈
                                    Γ
                                    ,
                                 
                              
                              
                                 
                                    
                                       λ
                                    
                                    (
                                    
                                       t
                                       1
                                    
                                    =
                                    0
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       μ
                                    
                                    (
                                    
                                       t
                                       1
                                    
                                    =
                                    0
                                    )
                                    ,
                                 
                               
                              and
                              
                                 
                                    
                                       ν
                                    
                                    (
                                    
                                       t
                                       1
                                    
                                    =
                                    0
                                    )
                                 
                               
                              are initial values of power and dual variables. Here,
                              
                                 
                                    P
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                    ,
                                 
                               
                              
                                 λ
                              (t
                              1), 
                                 μ
                              (t
                              1), and 
                              
                                 ν
                              (t
                              1) are the sequences generated by 
                              
                                 (20)–(23)
                              
                              . With the chosen step size satisfying the diminishing rule (i.e., δt
                               ≥ 0, 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          0
                                       
                                       ∞
                                    
                                    
                                       δ
                                       t
                                    
                                    =
                                    ∞
                                    ,
                                 
                              
                              
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          0
                                       
                                       ∞
                                    
                                    
                                       
                                          (
                                          
                                             δ
                                             t
                                          
                                          )
                                       
                                       2
                                    
                                    <
                                    ∞
                                 
                              
                              ), there actually exists a sufficiently large T
                              1 
                              that ∀t
                              1 ≥ T
                              1, 
                                 
                                    P
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    ,
                                    
                                       λ
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    ,
                                    
                                       μ
                                    
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    ,
                                 
                               
                              and 
                              
                                 ν
                              (t
                              1) converge to the globally optimal points such that
                              
                                 
                                    
                                       lim
                                       
                                          
                                             t
                                             1
                                          
                                          
                                             →
                                             T
                                             |
                                             T
                                             >
                                          
                                          
                                             T
                                             1
                                          
                                       
                                    
                                    
                                       ∥
                                       P
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          )
                                       
                                       −
                                       
                                          P
                                          *
                                       
                                       
                                          (
                                          
                                             t
                                             1
                                          
                                          )
                                       
                                       ∥
                                    
                                    <
                                    
                                       ϵ
                                       
                                          t
                                          1
                                       
                                    
                                 
                               
                              for any
                              
                                 
                                    
                                       ϵ
                                       
                                          t
                                          1
                                       
                                    
                                    >
                                    0
                                 
                              
                              .
                           

The proof is omitted, see [32].□

Next, we carry out the convergence of the MTS subalgorithm as provided in the Theorem 5.

                           Theorem 5 Convergence of the MTS subalgorithm
                           
                              For each link delay vector and given data rate vector, the STS subalgorithm is assumed to converge instantaneously. Here
                              
                                 
                                    
                                       υ
                                    
                                    (
                                    0
                                    )
                                 
                               
                              and 
                              
                                 μ
                              (0) are initial values of link delays and its delay prices. Let
                              
                                 
                                    
                                       υ
                                    
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                               
                              and 
                              
                                 μ
                              (t
                              2) are the sequences generated by the MTS subalgorithm. There exists a set
                              
                                 
                                    Ω
                                    
                                       t
                                       2
                                    
                                    *
                                 
                               
                              and a sufficiently large T
                              2 
                              such that
                              
                                 
                                    
                                       υ
                                    
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                               
                              approaches
                              
                                 
                                    Ω
                                    
                                       t
                                       2
                                    
                                    *
                                 
                               
                              and the smallest distance from
                              
                                 
                                    
                                       υ
                                    
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                               
                              to any point in
                              
                                 
                                    
                                       Ω
                                       
                                          t
                                          2
                                       
                                       *
                                    
                                    ,
                                 
                               
                              i.e.,
                              
                                 
                                    dist
                                    
                                       (
                                       
                                          υ
                                       
                                       
                                          (
                                          
                                             t
                                             2
                                          
                                          )
                                       
                                       ,
                                       
                                          Ω
                                          
                                             t
                                             2
                                          
                                          *
                                       
                                       )
                                    
                                    =
                                    
                                       inf
                                       
                                          
                                             
                                                υ
                                             
                                             *
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ∈
                                          
                                             Ω
                                             
                                                t
                                                2
                                             
                                             *
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          υ
                                       
                                       
                                          (
                                          
                                             t
                                             2
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             υ
                                          
                                          *
                                       
                                       
                                          (
                                          
                                             t
                                             2
                                          
                                          )
                                       
                                       ∥
                                    
                                    <
                                    
                                       ϵ
                                       
                                          t
                                          2
                                       
                                    
                                 
                               
                              as t > T
                              2 
                              for any
                              
                                 
                                    
                                       ϵ
                                       
                                          t
                                          2
                                       
                                    
                                    >
                                    0
                                 
                              
                              .
                           

See Appendix B.□

Finally, we study the convergence of the LTS subalgorithm.

                           Theorem 6 Convergence of the LTS subalgorithm
                           
                              For each data rate vector, as assumed that the STS and MTS subalgorithms instantly converge. Here,
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    ∈
                                    
                                       χ
                                       ^
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       μ
                                    
                                    (
                                    
                                       t
                                       3
                                    
                                    =
                                    0
                                    )
                                    ,
                                 
                               
                              and
                              
                                 
                                    
                                       ν
                                    
                                    (
                                    
                                       t
                                       3
                                    
                                    =
                                    0
                                    )
                                 
                               
                              are initial values. Let
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                    ,
                                 
                               
                              
                                 μ
                              (t
                              3), and 
                              
                                 ν
                              (t
                              3) are the sequences generated by the STS subalgorithm. There exists a set
                              
                                 
                                    Ω
                                    
                                       t
                                       3
                                    
                                    *
                                 
                               
                              and a sufficiently large T
                              3 
                              such that
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                               
                              approaches
                              
                                 
                                    Ω
                                    
                                       t
                                       3
                                    
                                    *
                                 
                               
                              and the smallest distance from
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       (
                                       
                                          t
                                          3
                                       
                                       )
                                    
                                 
                               
                              to any point in
                              
                                 
                                    
                                       Ω
                                       
                                          t
                                          3
                                       
                                       *
                                    
                                    ,
                                 
                               
                              i.e.,
                              
                                 
                                    dist
                                    
                                       (
                                       
                                          x
                                          ^
                                       
                                       
                                          (
                                          
                                             t
                                             3
                                          
                                          )
                                       
                                       ,
                                       
                                          Ω
                                          
                                             t
                                             3
                                          
                                          *
                                       
                                       )
                                    
                                    =
                                    
                                       inf
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             *
                                          
                                          
                                             (
                                             
                                                t
                                                3
                                             
                                             )
                                          
                                          ∈
                                          
                                             Ω
                                             
                                                t
                                                3
                                             
                                             *
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          x
                                          ^
                                       
                                       
                                          (
                                          
                                             t
                                             3
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             x
                                             ^
                                          
                                          *
                                       
                                       
                                          (
                                          
                                             t
                                             3
                                          
                                          )
                                       
                                       ∥
                                    
                                    <
                                    
                                       ϵ
                                       
                                          t
                                          3
                                       
                                    
                                 
                               
                              as t > T
                              3 
                              for any
                              
                                 
                                    
                                       ϵ
                                       
                                          t
                                          3
                                       
                                    
                                    >
                                    0
                                 
                              
                              .
                           

Similar to the one of Theorem 5, therefore omitted.□

In this section, we evaluate the proposed method with numerical examples, where we highlight comparative results in terms of convergence speed, power consumption, flow delay, injection rate and effective rate. We then compare our schemes with the alternative frameworks [7,8,10–12].

                  

We consider a network with topology illustrated in Fig. 1. Equidistantly, nodes are positioned at d = 50 m. The outage probability and SINR thresholds are set to (0.20, 0.20, 0.20, 0.20) and (1.0, 1.0, 1.0, 1.0), respectively. The fast-fading channel gain is assumed to be i.i.d. while the slow-fading channel gain is 
                           
                              
                                 g
                                 
                                    l
                                    k
                                 
                              
                              =
                              
                                 g
                                 0
                              
                              
                                 
                                    (
                                    
                                       d
                                       
                                          l
                                          k
                                       
                                    
                                    /
                                    50
                                    )
                                 
                                 
                                    −
                                    AF
                                 
                              
                              ,
                           
                         where dlk
                         is the distance between transmitter of link k to receiver of link l, 
                           
                              AF
                              =
                              4
                           
                         is the path loss attenuation factor, and g
                        0 is the reference channel gain at a distance 50 m and meets a condition that the average receive SINR at 50 m is 30 dB. The power spectral density of white noise is further assumed to be 
                           −
                        50 dBm/Hz. Without loss of generality, weights ω
                        1 and ω
                        2 are assumed to be 1. Unless other specified, we consider α-fair utility function 
                           
                              
                                 U
                                 s
                              
                              
                                 (
                                 
                                    x
                                    s
                                 
                                 )
                              
                              =
                              
                                 
                                    (
                                    1
                                    −
                                    α
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 x
                                 
                                    1
                                    −
                                    α
                                 
                              
                           
                         with 
                           
                              α
                              =
                              5
                           
                        .

We first define the certainty-equivalent margin (CEM) of link l as the ratio of the average SINR 
                           
                              
                                 γ
                                 ¯
                              
                              l
                           
                         to the threshold SINR 
                           
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                              ,
                           
                         i.e., 
                           
                              CEM
                              =
                              
                                 
                                    γ
                                    ¯
                                 
                                 l
                              
                              /
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                           
                        . According to the relationship between CEM and outage probability [9,24], the upper and the lower bounds of the outage probability is given, as follows:

                           
                              (26)
                              
                                 
                                    
                                       1
                                       
                                          1
                                          +
                                          CEM
                                       
                                    
                                    ≤
                                    Pr
                                    
                                       (
                                       
                                          γ
                                          l
                                       
                                       ≤
                                       
                                          γ
                                          l
                                          
                                             t
                                             h
                                          
                                       
                                       )
                                    
                                    ≤
                                    1
                                    −
                                    
                                       e
                                       
                                          −
                                          1
                                          /
                                          CEM
                                       
                                    
                                    .
                                 
                              
                           
                        For simplicity, we consider the lower bound of (26) which with the condition of the rate outage probabiity ϵ
                           l
                         results in

                           
                              (27)
                              
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       
                                          l
                                       
                                       
                                          t
                                          h
                                       
                                    
                                    ≤
                                    
                                       
                                          γ
                                          ¯
                                       
                                       l
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                    ¯
                                 
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                              =
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                              
                                 (
                                 1
                                 /
                                 
                                    ϵ
                                    l
                                 
                                 −
                                 1
                                 )
                              
                           
                        . From this point, we construct the new optimization problem with the outage probability replaced by (27). Similar to [12], the updates of new optimization problem are exactly the same forms, excepting for power and outage price which are updated, as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                l
                                             
                                             
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            λ
                                                            l
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         +
                                                         
                                                            M
                                                            l
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  ν
                                                                  s
                                                                  l
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                               
                                                                  γ
                                                                  l
                                                                  
                                                                     t
                                                                     h
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     γ
                                                                     ¯
                                                                  
                                                                  l
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                               +
                                                               
                                                                  γ
                                                                  l
                                                                  
                                                                     t
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ω
                                                            1
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ≠
                                                               l
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               k
                                                               l
                                                            
                                                         
                                                         
                                                            m
                                                            k
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                Γ
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 M
                                 n
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              W
                              
                                 μ
                                 n
                              
                              
                                 (
                                 t
                                 )
                              
                              
                                 
                                    ζ
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    1
                                    +
                                    ζ
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     


                        
                           
                              
                                 m
                                 n
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                          ¯
                                       
                                       n
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    
                                       G
                                       
                                          n
                                          n
                                       
                                    
                                    
                                       p
                                       n
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                              
                                 (
                                 
                                    λ
                                    n
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    μ
                                    n
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    M
                                    n
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          ν
                                          s
                                          n
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          γ
                                          n
                                          
                                             t
                                             h
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                             ¯
                                          
                                          n
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       +
                                       
                                          γ
                                          n
                                          
                                             t
                                             h
                                          
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                     


                        
                           
                              
                                 λ
                                 l
                              
                              
                                 (
                                 t
                                 +
                                 1
                                 )
                              
                              =
                              
                                 
                                    [
                                    
                                       λ
                                       l
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    δ
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       (
                                       log
                                       
                                          (
                                          
                                             
                                                γ
                                                ¯
                                             
                                             l
                                             
                                                t
                                                h
                                             
                                          
                                          )
                                       
                                       −
                                       log
                                       
                                          (
                                          
                                             
                                                γ
                                                ¯
                                             
                                             l
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                    ]
                                 
                                 +
                              
                              ,
                           
                         and


                        
                           
                              
                                 ψ
                                 
                                    l
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    P
                                    ^
                                 
                                 )
                              
                              =
                              −
                              log
                              
                                 (
                                 
                                    ϕ
                                    
                                       l
                                       (
                                       s
                                       ,
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       P
                                       ^
                                    
                                    )
                                 
                                 )
                              
                              ,
                           
                         where 
                           
                              
                                 ϕ
                                 
                                    l
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    P
                                    ^
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          γ
                                          ^
                                       
                                       l
                                    
                                    
                                       (
                                       
                                          P
                                          ^
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          γ
                                          ^
                                       
                                       l
                                    
                                    
                                       (
                                       
                                          P
                                          ^
                                       
                                       )
                                    
                                    +
                                    
                                       γ
                                       
                                          l
                                       
                                       
                                          t
                                          h
                                       
                                    
                                 
                              
                           
                        . We call the new resulting schemes, near-optimal nRENUM (nRENUM-NOP) and MTSRENUM-NOP algorithms.
                     

Secondly, we show the results of nRENUM [12], MTSRENUM, nRENUM-NOP, and MTSRENUM-NOP in order to capture the significant effects of the near-optimal schemes and timescales on the performance. Fig. 2a–d represent performance comparisons among these above algorithms in terms of flow-3 effective rate, total power consumption, flow-3 delay, and link delay, respectively. These figures indicate that MTSRENUM and nRENUM, nRENUM-NOP and MTSRENUM-NOP in turn have almost the same performance. However, since MTSRENUM and MTSRENUM-NOP consider the difference in layers’ timescales, they can improve the convergence speed in comparison with the corresponding same-timescale-based algorithms (nRENUM and nRENUM-NOP, respectively). Fig. 2d reveals the performance comparison of link-3 and link-4 delays. We can see from Fig. 2d that link-3 delays converge slower than these of corresponding link-4 delays. This can be explained that there are three flows through link 3 and it is, therefore, highly affected by outage probability variations due to channel fadings. Moreover, nRENUM and MTSRENUM outperform near-optimal schemes in effective rates, flow delays, and link delays and they all have almost the same level of power consumption. This is suitable since nRENUM and MTSRENUM require much more message-passing (see [12]) to update power control than near-optimal schemes which require only mn
                        (t). Actually, there exists a trade-off between performance and signaling overhead, this is, however, not a concern of this paper.

To further confirm the improvement in the convergence speed of MTSRENUM compared to that of nRENUM, we make use of a stopping criterion, as the following:

                           
                              
                                 
                                    
                                       max
                                       
                                          l
                                          ∈
                                          
                                             Ψ
                                             l
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             
                                                p
                                                l
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                p
                                                l
                                             
                                             
                                                (
                                                t
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                p
                                                l
                                             
                                             
                                                (
                                                t
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       |
                                    
                                    <
                                    
                                       ɛ
                                    
                                    ,
                                 
                              
                           
                        where ε is an arbitrarily small number used to stop the algorithms. Table 1
                         shows the number of iterations needed for convergence of MTSRENUM and nRENUM. We can see that when the stopping criterion becomes more strict, the number of iterations increase almost linearly and the increase rate of nRENUM is much higher than that of MTSRENUM. It is in addition observed that in all cases, MTSRENUM converges faster than nRENUM since in MTSRENUM, the difference in layers’ timescales is considered; which was already validated in [11] for the case where the joint cross-layer design of congestion control and power allocation in slow-fading wireless multihop networks is investigated.

Finally, we compare the performance of MTSRENUM, RENUM, ENUMP, ENUM, and the algorithm proposed in [11], which is called MTSAlgA, to further show MTSRENUM’s improvements and reliabilities. To evaluate [7,10], we set 
                           
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                              =
                              1.0
                           
                         and 
                           
                              
                                 
                                    γ
                                    ¯
                                 
                                 l
                              
                              =
                              2.25
                              *
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                           
                        . Fig. 3a and b illustrate the comparison of the injection rates and effective rates, respectively. It is observed that the effective rates reduce and become smaller and smaller along the routes when compared to the injection rates. In addition, a flow traversing a larger number of hops suffers higher data rate loss than that of a flow traveling less hops (e.g. flow 1 traverses 1 link and flow 3 travels 2 links). It is due to the lossy nature of wireless links. Fig. 3c and d depict that MTSRENUM significantly outperforms RENUM in terms of power consumption and flow delays. This is since the constraint on rate outage probability in RENUM reduces the original solution region and uses the approximated form. In a meanwhile, the rate outage probability constraint in MTSRENUM is in the rightly closed-form; therefore, MTSRENUM can guarantee the globally optimal solutions. Moreover, the framework [8] does not take into consideration the SINR threshold 
                           
                              
                                 γ
                                 
                                    l
                                 
                                 
                                    t
                                    h
                                 
                              
                              ,
                           
                         so RENUM cannot vary the SINR threshold for different links to get the appropriately optimal solutions. Obviously, ENUMP efficiently and effectively performs in terms of the injection rates and effective rates over RENUM and MTSRENUM; however, a serious drawback of ENUMP is that it consumes much more powers than these of RENUM and MTSRENUM. The reasons are that (1) the transmission power and link average delay are taken into consideration of both RENUM and MTSRENUM; therefore, they try to balance the overall profit between the gained network benefit and total consumed power and suffered delay. These trade-offs can be parameterized by weights ω
                        1 and ω
                        2, which are assumed to be 1 for simplicity (2) ENUMP does not consider the transmission power in the objective function and fix rigidly links’ SINR and (3) since ENUMP problem is to maximize the overall utility and the transmission power is just varied appropriately to maximize its utility, ENUMP maybe yields higher rates, i.e., injection rate and effective rate, compared to RENUM and MTSRENUM with the great sacrifice to the consumed power. Another observation shown in Fig. 3a and b is that ENUM yields less injection rates and effective rates than the others do. This is because ENUM does not consider 
                           
                              γ
                              
                                 l
                              
                              
                                 t
                                 h
                              
                           
                         and each link does not adjust its transmission power even through the channel quality is slow and still generate low data rates. Moreover, the transmit power and link delay are not the optimization variables and ENUM does not analyze the effects of the lossy feature on powers and delays. In contrast to the others, MTSAlgA yields the highest values in term of injection rate and effective rate; however, the total consumed power by MTSAlgA is largest. We can explain these observations as (1) the network model in [11] is slowly varying-fading while in the others, the link rate outage is taken into consideration to capture effects of fast-fading channels; therefore, the transmit power in MTSRENUM, RENUM, ENUMP can be used more appropriately and effectively to compensate for the link outage and (2) because of the participation of the new optimization variable, average link delay, in MTSRENUM and RENUM and of the rate outage constraints in these frameworks, links’ effective capacity reduce and then the flow rates (injection rate and effective rate) generated by these procedures are lower than flow rates of MTSAlgA. We in addition see that the convergence speed of MTSAlgA is fastest. Besides considering the difference in layers’ timescale, it is also since the constraints on flow rate conservation and/or the constraints on link rate outage in MTSRENUM, RENUM, ENUMP, and ENUM make the optimization problems more complicated than [11].

This paper studied a cross-layer problem in wireless ad hoc networks. The non-convex formulated optimization problem is converted to a convex one by log-transformed and auxiliary variables. We called the resulting design MTSRENUM where the timescale difference is taken into consideration. We made use of the primal decomposition to derive three subproblems. Each subproblem can be solved by the duality techniques and updated in the distinct timescale. We proved the convergence of each scheme. Through simulation, we demonstrated that our design can achieve significant improvements.

As a future direction for the current work, we will consider a cross-layer optimization of congestion control, scheduling and power control in OFDMA-based fast-fading wireless multi-hop networks. In addition, we will try to validate the network-wide performance of the proposed method by implementing it in the network simulator NS-2 [33].

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Dr. Thong Huynh and Ph.D candidate Hoang-Hiep Nguyen at the Computer Networks Lab, Inje University for their constructive discussions and insightful comments. This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Science and Technology (2011-0024888).

We have

                        
                           
                              
                                 
                                    
                                       
                                          d
                                          2
                                       
                                       
                                          u
                                          s
                                       
                                       
                                          (
                                          
                                             e
                                             
                                                x
                                                s
                                             
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       
                                          x
                                          s
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    e
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             d
                                             2
                                          
                                          
                                             U
                                             s
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                       
                                       
                                          d
                                          
                                             x
                                             s
                                             2
                                          
                                       
                                    
                                    
                                       x
                                       s
                                    
                                    +
                                    
                                       
                                          d
                                          
                                             U
                                             s
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                       
                                       
                                          d
                                          
                                             x
                                             s
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     Since 
                        
                           
                              
                                 
                                    d
                                    2
                                 
                                 
                                    U
                                    s
                                 
                                 
                                    (
                                    
                                       x
                                       s
                                    
                                    )
                                 
                              
                              
                                 d
                                 
                                    x
                                    s
                                    2
                                 
                              
                           
                           
                              x
                              s
                           
                           +
                           
                              
                                 d
                                 
                                    U
                                    s
                                 
                                 
                                    (
                                    
                                       x
                                       s
                                    
                                    )
                                 
                              
                              
                                 d
                                 
                                    x
                                    s
                                 
                              
                           
                           <
                           0
                        
                      is assumed to be negative, we have 
                        
                           
                              
                                 
                                    d
                                    2
                                 
                                 
                                    f
                                    x
                                 
                                 
                                    (
                                    
                                       x
                                       s
                                    
                                    )
                                 
                              
                              
                                 d
                                 
                                    x
                                    s
                                    2
                                 
                              
                           
                           <
                           0
                        
                     . As a result, Us
                     (exp (.)) is a strictly concave function. Since the objective function is separate in terms of 
                        
                           
                              
                                 p
                                 ^
                              
                              l
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 υ
                                 ^
                              
                              l
                           
                           ,
                        
                      and 
                        
                           
                              
                                 x
                                 ^
                              
                              s
                              
                                 
                                    H
                                    s
                                 
                                 +
                                 1
                              
                           
                           ,
                        
                      it is a concave function in 
                        
                           
                              
                                 x
                                 ^
                              
                              s
                              
                                 
                                    H
                                    s
                                 
                                 +
                                 1
                              
                           
                           ,
                        
                     
                     
                        
                           
                              p
                              ^
                           
                           l
                        
                      and 
                        
                           
                              υ
                              ^
                           
                           l
                        
                     . Constraints (11) and (12) are line-segments, so they are convex. For the first constraint, its Hessian [9] meets the inequality that 
                        
                           
                              v
                              T
                           
                           
                              ∇
                              2
                           
                           
                              f
                              l
                           
                           
                              (
                              
                                 P
                                 ^
                              
                              )
                           
                           v
                           ≥
                           0
                        
                     . Consequently, the constraint (8) is convex in 
                        
                           P
                           ^
                        
                     .

Let 
                        
                           
                              f
                              l
                           
                           
                              (
                              
                                 P
                                 ^
                              
                              ,
                              
                                 
                                    υ
                                    ^
                                 
                                 l
                              
                              )
                           
                           =
                           
                              C
                              l
                           
                           
                              (
                              
                                 e
                                 
                                    P
                                    ^
                                 
                              
                              )
                           
                           −
                           
                              K
                              
                                 e
                                 
                                    
                                       υ
                                       ^
                                    
                                    l
                                 
                              
                           
                        
                     . The Hessian of the right-hand side of constraint (9) in 
                        
                           
                              υ
                              ^
                           
                           l
                        
                      is 
                        
                           
                              ∇
                              2
                           
                           
                              f
                              l
                              
                                 (
                                 
                                    
                                       υ
                                       ^
                                    
                                    l
                                 
                                 )
                              
                           
                           
                              (
                              
                                 P
                                 ^
                              
                              ,
                              
                                 
                                    υ
                                    ^
                                 
                                 l
                              
                              )
                           
                           =
                           −
                           K
                           /
                           
                              e
                              
                                 
                                    υ
                                    ^
                                 
                                 l
                              
                           
                        
                      which is nonpositive. We now define 
                        
                           f
                           
                              (
                              x
                              )
                           
                           =
                           log
                           (
                           
                              
                                 γ
                                 ¯
                              
                              l
                           
                           
                              (
                              
                                 P
                                 ^
                              
                              )
                           
                           )
                        
                      and f(x) can be reformed as follows:

                        
                           
                              
                                 f
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 log
                                 
                                    (
                                    exp
                                    
                                       (
                                       
                                          
                                             p
                                             ^
                                          
                                          l
                                       
                                       )
                                    
                                    
                                       G
                                       
                                          l
                                          l
                                       
                                    
                                    )
                                 
                                 −
                                 log
                                 
                                    (
                                    
                                       σ
                                       l
                                       2
                                    
                                    +
                                    
                                       ∑
                                       
                                          k
                                          ≠
                                          l
                                       
                                    
                                    exp
                                    
                                       (
                                       
                                          
                                             p
                                             ^
                                          
                                          k
                                       
                                       )
                                    
                                    
                                       G
                                       
                                          l
                                          k
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     Clearly, it is a concave function in 
                        
                           P
                           ^
                        
                      due to the sum of linear and log-sum-exp terms. According to [30], composition with an affine mapping, 
                        
                           f
                           (
                           1
                           +
                           ζ
                           x
                           )
                           ,
                        
                      is also concave. We therefore conclude that the constraint (9) is concave. The remaining work is to prove the right-hand side of (10) is concave in 
                        
                           P
                           ^
                        
                     .

We have 
                        
                           
                              ψ
                              
                                 l
                                 (
                                 s
                                 ,
                                 i
                                 )
                              
                           
                           
                              (
                              
                                 P
                                 ^
                              
                              )
                           
                           =
                           −
                           log
                           
                              (
                              ϕ
                              
                                 (
                                 l
                                 (
                                 s
                                 ,
                                 i
                                 )
                                 )
                              
                              )
                           
                        
                      according to Eq. (13) which can be rewritten as

                        
                           
                              
                                 
                                    ψ
                                    
                                       l
                                       (
                                       s
                                       ,
                                       i
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       P
                                       ^
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          σ
                                          l
                                          2
                                       
                                       
                                          γ
                                          l
                                          
                                             t
                                             h
                                          
                                       
                                    
                                    
                                       
                                          e
                                          
                                             
                                                p
                                                ^
                                             
                                             l
                                          
                                       
                                       
                                          G
                                          
                                             l
                                             l
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       k
                                       ≠
                                       l
                                    
                                 
                                 log
                                 
                                    (
                                    1
                                    +
                                    
                                       γ
                                       l
                                       
                                          t
                                          h
                                       
                                    
                                    
                                       
                                          
                                             e
                                             
                                                
                                                   p
                                                   ^
                                                
                                                k
                                             
                                          
                                          
                                             G
                                             
                                                l
                                                k
                                             
                                          
                                       
                                       
                                          
                                             e
                                             
                                                
                                                   p
                                                   ^
                                                
                                                l
                                             
                                          
                                          
                                             G
                                             
                                                l
                                                l
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     In the above equation, it is clear that the first term is convex in 
                        
                           P
                           ^
                        
                     . The Hessian of the second term is just the Hessian of the left-hand side of constraint (8). Thus, the right-hand side of constraint (10) is concave. Consequently, we finally state that (7) is a convex optimization problem.

Recall that 
                        
                           L
                           (
                           
                              P
                              ^
                           
                           ,
                           
                              
                                 υ
                              
                              ^
                           
                           ,
                           
                              x
                              ^
                           
                           ,
                           
                              λ
                           
                           ,
                           
                              μ
                           
                           ,
                           
                              ν
                           
                           )
                        
                      is the Lagrangian of the underlying problem. For a given data rate vector, we make use of the duality techniques to define 
                        
                           g
                           (
                           
                              
                                 υ
                              
                              ^
                           
                           )
                           ,
                        
                      as follows:

                        
                           
                              
                                 g
                                 
                                    (
                                    
                                       
                                          υ
                                       
                                       ^
                                    
                                    )
                                 
                                 =
                                 
                                    min
                                    
                                       
                                          λ
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                    
                                 
                                 D
                                 
                                    (
                                    
                                       
                                          υ
                                       
                                       ^
                                    
                                    ,
                                    
                                       λ
                                    
                                    ,
                                    
                                       μ
                                    
                                    ,
                                    
                                       ν
                                    
                                    )
                                 
                                 =
                                 
                                    min
                                    
                                       
                                          λ
                                       
                                       ,
                                       
                                          μ
                                       
                                       ,
                                       
                                          ν
                                       
                                    
                                 
                                 
                                    max
                                    
                                       P
                                       ^
                                    
                                 
                                 L
                                 
                                    (
                                    
                                       P
                                       ^
                                    
                                    ,
                                    
                                       
                                          υ
                                       
                                       ^
                                    
                                    ,
                                    
                                       x
                                       ^
                                    
                                    ,
                                    
                                       λ
                                    
                                    ,
                                    
                                       μ
                                    
                                    ,
                                    
                                       ν
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     The Danskin’s theorem [34,35] gives 
                        
                           
                              
                                 d
                                 g
                                 (
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                                 )
                              
                              
                                 d
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                              
                           
                           =
                           
                              D
                              ˙
                           
                           
                              (
                              
                                 
                                    υ
                                 
                                 ^
                              
                              ,
                              
                                 
                                    λ
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    μ
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    ν
                                 
                                 ¯
                              
                              )
                           
                           ,
                        
                      where 
                        
                           
                              
                                 λ
                              
                              ¯
                           
                           ,
                           
                              
                                 μ
                              
                              ¯
                           
                           ,
                           
                              
                                 ν
                              
                              ¯
                           
                        
                      achieve the minimum of 
                        
                           g
                           (
                           
                              
                                 υ
                              
                              ^
                           
                           )
                        
                      and

                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                             ˙
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                ^
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                ¯
                                             
                                             ,
                                             
                                                
                                                   μ
                                                
                                                ¯
                                             
                                             ,
                                             
                                                
                                                   ν
                                                
                                                ¯
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          =
                                          −
                                          
                                             ω
                                             2
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                                ˙
                                             
                                          
                                          −
                                          
                                             min
                                             
                                                
                                                   λ
                                                
                                                ,
                                                
                                                   μ
                                                
                                                ,
                                                
                                                   ν
                                                
                                             
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             μ
                                             l
                                          
                                          
                                             K
                                             
                                                e
                                                
                                                   
                                                      
                                                         υ
                                                         ^
                                                      
                                                      l
                                                   
                                                   ˙
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          =
                                          −
                                          
                                             ω
                                             2
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      υ
                                                      ^
                                                   
                                                   l
                                                
                                                ˙
                                             
                                          
                                          −
                                          
                                             ∑
                                             l
                                          
                                          
                                             
                                                μ
                                                ¯
                                             
                                             l
                                          
                                          
                                             K
                                             
                                                e
                                                
                                                   
                                                      
                                                         υ
                                                         ^
                                                      
                                                      l
                                                   
                                                   ˙
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     We recall the delay update in the MTS iterative subalgorithm, as follows:

                        
                           
                              
                                 
                                    υ
                                    l
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    +
                                    1
                                    )
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          μ
                                          l
                                       
                                       
                                          (
                                          
                                             t
                                             2
                                          
                                          )
                                       
                                       
                                          K
                                          
                                             ω
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     It is fairly straightforward to see that 
                        
                           
                              
                                 
                                    υ
                                    ^
                                 
                                 l
                              
                              ˙
                           
                           
                              μ
                              l
                           
                           ≥
                           0
                        
                      which with (B.1) leads to 
                        
                           
                              
                                 d
                                 g
                                 (
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                                 )
                              
                              
                                 d
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                              
                           
                           ≤
                           −
                           
                              ∑
                              l
                           
                           
                              
                                 μ
                                 ¯
                              
                              l
                           
                           
                              K
                              
                                 e
                                 
                                    
                                       
                                          υ
                                          ^
                                       
                                       l
                                    
                                    ˙
                                 
                              
                           
                        
                      or 
                        
                           
                              
                                 d
                                 g
                                 (
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                                 )
                              
                              
                                 d
                                 
                                    
                                       υ
                                    
                                    ^
                                 
                              
                           
                           ≤
                           0
                           ,
                        
                      i.e., 
                        
                           
                              g
                              ˙
                           
                           
                              (
                              
                                 
                                    υ
                                 
                                 ^
                              
                              )
                           
                           ≥
                           0
                        
                     . Invoking Lasalle’s invariance principle [36], the sequence 
                        
                           
                              υ
                              l
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                        
                      generated by the MTS iterative subalgorithm converges to the largest invariant set inside or an equilibrium 
                        
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                        
                      such that Ω
                     *(t
                     2) 
                        
                           {
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           :
                           
                              g
                              ˙
                           
                           
                              (
                              
                                 
                                    υ
                                 
                                 *
                              
                              
                                 (
                                 
                                    t
                                    2
                                 
                                 )
                              
                              )
                           
                           =
                           0
                           }
                        
                      and the following property holds: 
                        
                           ∀
                           
                              ϵ
                              
                                 t
                                 2
                              
                           
                           >
                           0
                           ,
                        
                      ∃T
                     2, ∀t > T
                     2, 
                        
                           dist
                           
                              (
                              
                                 υ
                              
                              
                                 (
                                 
                                    t
                                    2
                                 
                                 )
                              
                              ,
                              
                                 Ω
                                 
                                    t
                                    2
                                 
                                 *
                              
                              )
                           
                           =
                           
                              inf
                              
                                 
                                    
                                       υ
                                    
                                    *
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                                 ∈
                                 
                                    Ω
                                    
                                       t
                                       2
                                    
                                    *
                                 
                              
                           
                           
                              ∥
                              
                                 υ
                              
                              
                                 (
                                 
                                    t
                                    2
                                 
                                 )
                              
                              −
                              
                                 
                                    υ
                                 
                                 *
                              
                              
                                 (
                                 
                                    t
                                    2
                                 
                                 )
                              
                              ∥
                           
                           <
                           
                              ϵ
                              
                                 t
                                 2
                              
                           
                        
                     . Therefore, the convergence of the MTS iterative subalgorithm is guaranteed. We now prove that the largest invariant set Ω
                     *(t
                     2) also solves the optimization problem (7).

Since the STS and MTS iterative subalgorithms are assumed to be converged instantaneously for a given data rate vector, in this case we only set the presence of power and link delay. For each 
                        
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           ,
                        
                      let 
                        
                           P
                           (
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           )
                           ,
                        
                     
                     
                        
                           
                              λ
                           
                           (
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           )
                           ,
                        
                     
                     
                        
                           
                              μ
                           
                           (
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           )
                           ,
                        
                      and 
                        
                           
                              ν
                           
                           (
                           
                              
                                 υ
                              
                              *
                           
                           
                              (
                              
                                 t
                                 2
                              
                              )
                           
                           )
                        
                      are the optimal solutions to the STS iterative subalgorithm. Making use of the duality and KKT optimality conditions [30] for the STS subproblem we have

                        
                           (B.2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             P
                                             ^
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             argmax
                                             
                                                P
                                                ^
                                             
                                          
                                          {
                                          −
                                          
                                             ω
                                             1
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             e
                                             
                                                
                                                   p
                                                   ^
                                                
                                                l
                                             
                                          
                                          +
                                          
                                             ∑
                                             l
                                          
                                          
                                             λ
                                             l
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          log
                                          
                                             Ω
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             λ
                                             l
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          log
                                          
                                             (
                                             1
                                             +
                                             
                                                γ
                                                l
                                                
                                                   t
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         k
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         l
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         l
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             l
                                          
                                          
                                             μ
                                             l
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             C
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   P
                                                   ^
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             s
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                H
                                                s
                                             
                                          
                                          
                                             ν
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                υ
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             ψ
                                             
                                                l
                                                (
                                                s
                                                ,
                                                i
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                ^
                                             
                                             )
                                          
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.3)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             l
                                          
                                          
                                             λ
                                             l
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          (
                                          
                                             ∑
                                             
                                                k
                                                ≠
                                                l
                                             
                                          
                                          log
                                          
                                             (
                                             1
                                             +
                                             
                                                γ
                                                l
                                                
                                                   t
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            k
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  υ
                                                               
                                                               *
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  2
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      e
                                                      
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            l
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  υ
                                                               
                                                               *
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  2
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         l
                                                         l
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          log
                                          
                                             Ω
                                             l
                                          
                                          
                                             (
                                             
                                                e
                                                
                                                   
                                                      
                                                         p
                                                         ^
                                                      
                                                      l
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            υ
                                                         
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                            2
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             l
                                          
                                          
                                             μ
                                             l
                                          
                                          
                                             (
                                             
                                                
                                                   υ
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                   (
                                                   l
                                                   )
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   s
                                                   l
                                                
                                             
                                             −
                                             
                                                C
                                                l
                                             
                                             
                                                (
                                                
                                                   e
                                                   
                                                      
                                                         P
                                                         ^
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               υ
                                                            
                                                            *
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               2
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                K
                                                
                                                   e
                                                   
                                                      
                                                         
                                                            
                                                               υ
                                                            
                                                            ^
                                                         
                                                         l
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                            2
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.5)
                           
                              
                                 
                                    ∑
                                    s
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       H
                                       s
                                    
                                 
                                 
                                    ν
                                    s
                                    i
                                 
                                 
                                    (
                                    
                                       
                                          υ
                                       
                                       *
                                    
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          x
                                          ^
                                       
                                       s
                                       i
                                    
                                    +
                                    
                                       ψ
                                       
                                          l
                                          (
                                          s
                                          ,
                                          i
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          P
                                          ^
                                       
                                       
                                          (
                                          
                                             
                                                υ
                                             
                                             *
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     It can be seen that (B.2)–(B.5) are the optimality conditions for the optimization problem (7). As a consequence, we finally state that the MTS iterative subalgorithm also solves the underlying problem.

@&#REFERENCES@&#

