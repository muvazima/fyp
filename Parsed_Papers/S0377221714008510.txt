@&#MAIN-TITLE@&#Robust transmission expansion planning

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We derive optimal transmission expansion plans for an electric energy system.


                        
                        
                           
                           Uncertainty is accounted for by a two-stage adaptive robust optimization problem.


                        
                        
                           
                           The resulting three-level model is solved by a cutting-plane decomposition method.


                        
                        
                           
                           The transmission plan is very conditioned by the budget and the uncertainty level.


                        
                        
                           
                           The new strategic lines to be built do not follow an incremental order.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Adaptive robust optimization

Complementarity

OR in energy

Transmission expansion

Two-stage

@&#ABSTRACT@&#


               
               
                  The work reported in this paper addresses the problem of transmission expansion planning under uncertainty in an electric energy system. We consider different sources of uncertainty, including future demand growth and the availability of generation facilities, which are characterized for different regions within the electric energy system. An adaptive robust optimization model is used to derive the investment decisions that minimizes the system’s total costs by anticipating the worst case realization of the uncertain parameters within an uncertainty set. The proposed formulation materializes on a mixed-integer three-level optimization problem whose lower-level problem can be replaced by its KKT optimality conditions. The resulting mixed-integer bilevel model is efficiently solved by decomposition using a cutting plane algorithm. A realistic case study is used to illustrate the working of the proposed technique, and to analyze the relationship between the optimal transmission investment plans, the investment budget and the level of supply security at the different regions of the network.
               
            

@&#INTRODUCTION@&#

Within an electric industry context, Transmission Expansion Planning (TEP) refers to the decision-making process faced by a Transmission System Operator (TSO) to resolve on the best way to expand or reinforce an existing electricity transmission network. De Dios et al. (2007) provide an industry perspective of this important decision-making problem. The TSO is the publicly controlled entity in charge of operating, maintaining, reinforcing and expanding the electricity transmission network within a given jurisdiction. TSOs in the different European countries are coordinated through ENTSO-E (ENTSO-E, 2013). In the US, TSOs have generally more limited attributes than TSOs in Europe, and are generally referred to as Regional Transmission Organizations (RTOs). Well-known RTOs in the US are PJM (PJM Interconnection, 2013), and the Midwest Independent System Operator (Midwest Independent System Operator, 2013).

The aging of the electrical transmission infrastructure is nowadays apparent in many electric energy systems throughout the world, as pointed out in the MIT technical report (MIT Energy Initiative, 2011). Therefore, it is most needed the development of mathematical models and computation tools to help TSOs to make effective decisions regarding the improvement and updating of the electricity transmission infrastructure. Such decisions have to be made under great uncertainty due to the uncertain nature of both the electrical demand growth and the stochastic production of some generation facilities, such as wind- or solar-based units. This uncertainty has both spatial and temporal dimensions as demands and production facilities are located at different geographical sites, and the demand and the stochastic production are both temporally correlated (Baringo and Conejo, 2013). Additionally, uncertainty pertaining to equipment failure also affects the operation (Bouffard et al., 2005) and thus the expansion/reinforcement planning of the transmission network.

Transmission planning decision-making involves usually a planning horizon of approximately 10 years with revisions every 2 years, as described, for instance, in De Dios et al. (2007). Nevertheless, this planning horizon might be shortened or lengthened depending on construction, environmental or policy considerations. Building time for transmission facilities are much shorter that such times for production facilities and range between 6 months and 2 years. Therefore TEP is a medium-term expansion planning problem with a smaller level of uncertainty than that involved in the investment in production facilities. Moreover, the planning exercise should account for the entire life of the infrastructure to be built. However, using a year-by-year representation of investment decisions may result in a very complex and computationally intractable model. In order to ensure tractability while keeping the model accurate enough, one or few target years are usually selected for the planning exercise and annualized investment costs are considered (see for instance De la Torre, 2008; Garcés et al., 2009; Jabr, 2013; Sauma and Oren, 2006). Nevertheless, properly capturing the effect of the uncertain parameters on the investment outcomes is critical to achieve effective transmission investment plans.

The pioneering work on transmission expansion planning is reported in Garver (1970), while relevant contributions based on mathematical programming are due to Pereira and his collaborators in Brazil, e.g., Monticelli et al. (1982),Pereira and Pinto (1985) and Binato et al. (2001). Relevant heuristics have been developed by Romero and his collaborators, e.g., Romero (1996). Stochastic programming is used, among other works, in De la Torre (2008) and Villumsen and Philpott (2013). Modeling explicitly a market environment in the decision-making process is addressed in Garcés et al. (2009), while an interesting game-theoretical approach is proposed in Sauma and Oren (2006).

Infrastructure is generally designed to be able to operate correctly under the worst plausible condition, e.g., a bridge should withstand a maximum weight under adverse climate conditions and a sea breakwater should withstand the strongest plausible wave. Thus, traditionally, any infrastructure is designed considering solely the worst plausible condition of future operation. In fact, regarding electricity transmission expansion planning, this is common practice.

Note that on a daily or hourly basis, the objective in electricity systems is generally minimizing expected operating costs. This is mainly because, in general, the different sources of uncertainty that are present in the system can be predicted accurately in the short-term, e.g., level of demand, wind power production, equipment availability, etc., and thus the probability of occurrence of an unforeseen event, with a high potential damage, is very small.

However, this framework drastically changes when the operation of the system is seen years in advance, and planning decisions, like transmission expansion, need to be made. In this case, there is a high uncertainty about which would be the operating conditions within the lifetime of the new infrastructure (30–50 years ahead). Moreover, these investment decisions are in general irrevocable because of their high investment costs.

Therefore, infrastructures must be designed so that they perform well under extreme operating conditions. Note that this is generally guaranteed by ensuring the correct functioning of the system under the worst possible operating condition.

However, the worst future condition is unknown and we have to cope properly with this uncertainty with real reliability and economic consequences. If we are conservative and design a transmission system around a worse-than-actual condition, we end up building a stronger transmission system than needed at higher cost. If we, conversely, design a transmission system around a better-than-actual worst-case, we build a transmission system unable to withstand the actual worst condition, resulting in collapse or losses. To confront this challenge, we propose describing uncertainty through plausible robust sets. These sets are meant to represent a range of possible worst-case outcomes for use in infrastructure planning.

Additionally, we need to ensure that the future transmission system will be able to withstand the worst plausible operation condition, hence we will work on robust optimization approaches, i.e., approaches that guarantee worst case protection within a plausible uncertainty set. Moreover, since the robust sets that we use are parameterized through a set of conservatism parameters, we are able to characterize the critical tradeoff security vs. cost and generate an array of efficient design solutions for the decision-maker to choose.

Adaptive robust optimization (ARO) (Bertsimas et al., 2011) allows modeling decision making under uncertainty with recourse. For transmission expansion problems, ARO involves three steps: investment decision making pursuing maximum social welfare, worst uncertainty realization within a plausible uncertainty set that respects the physics of the problem, and operation decision making to mitigate the negative effect to the uncertainty realization and to achieve maximum social welfare. Traditional robust optimization techniques (Soyster, 1973) do not allow for controlling the level of robustness, i.e., conservatism, of the solution attained, which is a major drawback; however the work in Bertsimas et al. (2011) introduces formulations that make it possible to control the level of robustness of the solutions attained. Such formulations allow developing valuable planning tools, which are relevant in practice.

ARO has two important advantages with respect to stochastic programming models that generally require a large number of scenarios to represent the uncertainty involved (Gabrel et al., 2013). On one hand, scenarios need not to be generated, and since generating scenarios, based on statistics distributions or others, may entails a crude approximation on the description of the uncertain parameters, not needing scenarios is an advantage. Instead, robust sets are used in ARO models (Bertsimas and Brown, 2009), and constructing such sets is generally much simpler than generating scenarios. On the other hand, an ARO model has commonly a moderate size, which does not grow with the number of scenarios, and thus, computational tractability is not at stake. On the contrary, the size of a stochastic programming model grows with the number of scenarios, which may result in intractability; and often, a large number of scenarios is needed to accurately represent the uncertain parameters.

A recent application of ARO to transmission expansion planning is reported in Jabr (2013). This approach is similar to the one presented in this paper but differs in the solution methodology, the technical features of the proposed model, and the type of analysis performed. First of all, a Benders decomposition scheme, which requires the computation of dual variables, is used in Jabr (2013) to solve the ARO problem while we apply a constraint-and-column generation method solely based on primal cuts. Second, the uncertainty budget used in Jabr (2013) limits the number of uncertain parameters that are allowed to change. The subproblem is then simplified assuming that all the uncertain parameters need to be equal to their upper or lower limits in the worst case scenario. However, the uncertainty budget considered in this work is more general since we just limit the level of variation of the uncertain parameters within the robust set, which also allows characterizing regional uncertainty budgets. Third, Jabr (2013) does not account for the investment budget while part of our study is focused on analyzing the effect that this budget has on the optimal transmission planning. Finally, we also study in detail how an increase of the uncertainty level and/or the investment budget reconfigures the optimal set of lines to be built.

To tackle the transmission expansion planning problem, we propose a novel adaptive robust optimization model that includes the features below:

                        
                           1.
                           The objective is to minimize the system’s investment cost plus the worst possible operating costs (under different levels of conservatism) over the considered planning horizon.

Uncertain parameters involving demand growth, stochastic generation levels and equipment failures are described using a robust set.

The level of robustness is controlled using a variety of physically-based budget constraints over the robust set.

The three-level decision framework considered involves (i) making investment decisions pursuing minimum total cost, (ii) worst uncertainty realization within the plausible uncertainty set, and (ii) implementation of operation decisions pursuing minimum total cost.

Mathematically, the proposed model materializes in a min-max-min problem apparently hard to solve. However, using the optimality condition of the right-hand-side min problem, the two inner problems (max-min) can be merged into a single max problem. This results in a final min-max problem with bilinear terms that can be efficiently linearized and solved until optimality by implementing a decomposition algorithm. A constraint-and-column generation approach is used, as in Zeng and Zhao (2013), which results in an efficient solution algorithm.

A relevant feature of the proposed model is that it allows parameterizing the optimal investment plan with respect to both the level of robustness and the available budget. This is an important piece of information for TSO practitioners, as it allows representing the tradeoff among alternative investment policies.

The contributions of the model and algorithm proposed in this paper are threefold:

                        
                           1.
                           Adaptive robust optimization is used to efficiently solve the transmission expansion planning problem of an electric energy system.

The proposed adaptive robust approach renders an efficient solution algorithm that allows parameterizing the optimal solution as a function of the level of robustness per region of the system and the available investment budget.

The analysis carried out on a realistic case study illustrates the relevance of the proposed model to derive informed transmission investment plans, and to characterize the tradeoff risk vs. cost.

This document is organized as follows. Section 2 describes a compact formulation of the adaptive robust transmission investment model. A more detailed formulation is presented at Section 3, which explicitly considers the different technical features of the electric energy system and its associated uncertainties. The solution technique adopted to solve the ARO model is introduced in Section 4. Section 5 presents a comprehensive analysis of the results obtained from a realistic case study. Finally, some relevant conclusions are drawn in Section 6.

The deterministic version of the transmission expansion problem considered in this paper can be represented by the following linear formulation,

                           
                              (1a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                             
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             
                                                b
                                                T
                                             
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                c
                                                T
                                             
                                             x
                                             ≤
                                             Π
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1c)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             A
                                             x
                                             +
                                             B
                                             y
                                             =
                                             E
                                             
                                                d
                                                ¯
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1d)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             F
                                             x
                                             +
                                             G
                                             y
                                             ≤
                                             K
                                             
                                                d
                                                ¯
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1e)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                l
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function (1a) represents the minimization of the system’s total costs, including transmission line investment costs (c
                        T
                        x) and operating costs (b
                        T
                        y). The transmission investment decision variables are gathered in vector x. Note that vector x is binary to represent the build/not-build nature of each investment decision. Similarly, vector y refers to the operating decision variables which are assumed to be continuous. These operating variables include power production from each generating unit, load shedding per node and power line flows. Constraint (1b) ensures that the total investment costs do not exceed the available budget Π. The equality constraints related to the system’s operations (e.g., the power balance at each node of the network) are considered in (1c), while constraint (1d) accounts for the inequality conditions, e.g., upper and lower power outputs for each generating units. It should be emphasized that the operation constraints (1c) and (1d), depend on both x and y, which implies that the transmission investment decisions alter the configuration of the transmission network and thus the operation of the system.

To move to a stochastic model, we assume that vector d includes all the model’s uncertain parameters, i.e., demand load levels and available generation resources. These uncertainties influence the operation of the system through constraints (1c) and (1d). Note that in the deterministic model (1) the uncertain vector d is fixed to its expected value 
                           
                              d
                              ¯
                           
                        .

In this section we extend the deterministic formulation (1) by considering the uncertain nature of vector d. Our purpose is to find the optimal transmission expansion planing x, which best performs in terms of costs, but anticipating the worst possible realization of the uncertain vector of parameters d. In particular, we formulate the adaptive robust optimization (ARO) version of problem (1). In broad terms, the adaptive model can be described as follows:

                           
                              1.
                              The best transmission expansion planning x is sought by minimizing the system’s total costs. This is done by anticipating that, right after this decision is made,

“nature” will behave in the worst possible manner. Thus, assuming that x is fixed, nature will select the realization of the uncertain parameters d that maximizes the system’s operating cost. This is done by anticipating that, right after the worst uncertainty outcome is realized,

the system will try to adapt to it. Thus, assuming that x and d are fixed, the system operator will select the optimal decision variables y in order to minimize the system’s operating costs.

It is important to note that this sequence of decisions is consistent with the real-world planning and operations of electric energy systems. In general, transmission investment decisions are the first ones to be made (on a medium-term basis). Then, depending on the operating conditions, which can be identified as the different realizations of the uncertainty, the system operator would select the best actions to minimize the operating costs.

The above hierarchical structure is represented by the following three-level optimization problem:

                           
                              (2a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                x
                                             
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             
                                                max
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                             
                                             
                                                min
                                                
                                                   y
                                                   ∈
                                                   
                                                      Ω
                                                      (
                                                      x
                                                      ,
                                                      d
                                                      )
                                                   
                                                
                                             
                                             
                                                b
                                                T
                                             
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                c
                                                T
                                             
                                             x
                                             ≤
                                             Π
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2c)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                l
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The worst case realization of the uncertainty and the successive adaptive action is considered in the max-min problem 
                           
                              
                                 max
                                 
                                    d
                                    ∈
                                    D
                                 
                              
                              
                              
                                 min
                                 
                                    y
                                    ∈
                                    
                                       Ω
                                       (
                                       x
                                       ,
                                       d
                                       )
                                    
                                 
                              
                              
                                 b
                                 T
                              
                              y
                           
                        . Note that d ∈ D defines the uncertainty set and Ω(x, d) = {y: Ax + By = Ed, Fx + Gy ≤ Kd} ensures the feasibility of the operating decision variables y for each x and d.

It is important to note that a careful definition of the uncertainty set D is crucial for an effective representation of the uncertainty involved. In order to define D, we consider a polyhedral uncertainty set similar to the one used in Bertsimas and Sim (2002) and Bertsimas and Sim (2004). Such uncertainty set is described by the following constraints:

                              
                                 (3a)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   d
                                                   k
                                                
                                                ∈
                                                
                                                   [
                                                   
                                                      d
                                                      
                                                         k
                                                      
                                                      min
                                                   
                                                   ,
                                                   
                                                      d
                                                      
                                                         k
                                                      
                                                      max
                                                   
                                                   ]
                                                
                                                
                                                ∀
                                                k
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3b)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            
                                                               Υ
                                                               r
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         d
                                                         
                                                            k
                                                         
                                                         ref
                                                      
                                                      −
                                                      
                                                         d
                                                         k
                                                      
                                                      |
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            
                                                               Υ
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            d
                                                            
                                                               k
                                                            
                                                            max
                                                         
                                                         −
                                                         
                                                            d
                                                            k
                                                            min
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   Γ
                                                   r
                                                
                                                ,
                                                
                                                ∀
                                                r
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

where dk
                            is the kth component of vector d. Parameters 
                              
                                 d
                                 
                                    k
                                 
                                 min
                              
                            and 
                              
                                 d
                                 
                                    k
                                 
                                 max
                              
                            are upper and lower bounds for dk
                           , while Γ
                           r is denoted as the uncertainty budget. Index r refers to the region of the transmission network considered, so that k ∈ ϒr denotes the demand loads or generation units k, located at region r.

Note that values for Γ
                           r lie within the range 0 ≤ Γ
                           r ≤ 1. In particular, Γ
                           r = 0 implies 
                              
                                 
                                    d
                                    k
                                 
                                 =
                                 
                                    d
                                    
                                       k
                                    
                                    ref
                                 
                                 
                                 ∀
                                 k
                                 ,
                              
                            so that no uncertainty is considered, while Γ
                           r = 1 allows dk
                            adopting any value within the interval 
                              
                                 
                                    d
                                    
                                       k
                                    
                                    min
                                 
                                 ≤
                                 
                                    d
                                    k
                                 
                                 ≤
                                 
                                    d
                                    
                                       k
                                    
                                    max
                                 
                                 ,
                              
                            which can be understood as the maximum level of uncertainty.

Parameter 
                              
                                 
                                    d
                                    k
                                    ref
                                 
                                 ∈
                                 
                                    [
                                    
                                       d
                                       
                                          k
                                       
                                       min
                                    
                                    ,
                                    
                                       d
                                       
                                          k
                                       
                                       max
                                    
                                    ]
                                 
                              
                            is used as a reference to measure the total amount of deviations of the uncertain parameter. In this paper we have considered that, when modeling demand uncertainty, 
                              
                                 
                                    d
                                    k
                                    ref
                                 
                                 =
                                 
                                    d
                                    
                                       k
                                    
                                    min
                                 
                                 ,
                              
                            and for the case of generation capacity uncertainty, then 
                              
                                 
                                    d
                                    k
                                    ref
                                 
                                 =
                                 
                                    d
                                    
                                       k
                                    
                                    max
                                 
                              
                           . Section 3 shows how this selection results in not using the absolute value in (3b), so that (3) can be formulated as a linear set of constraints. Specifically, Section 3.4 provides some guidelines on how 
                              
                                 d
                                 
                                    k
                                 
                                 min
                              
                            and 
                              
                                 d
                                 
                                    k
                                 
                                 max
                              
                            can be estimated based on historical data. Furthermore, instead of estimating Γ
                           r and fix it to a certain value, Γ
                           r is used in this paper as a parameter to analyze the impact of different levels of uncertainty in the system’s costs.

The detailed adaptive robust formulation of the transmission expansion problem used in this paper is provided below:

                        
                           (4a)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             min
                                             
                                                x
                                                
                                                   n
                                                   m
                                                
                                                L
                                             
                                          
                                          
                                          
                                             max
                                             
                                                
                                                   P
                                                   j
                                                   D
                                                
                                                ,
                                                
                                                   P
                                                   
                                                      i
                                                   
                                                   Gmax
                                                
                                             
                                          
                                          
                                          
                                             min
                                             
                                                
                                                   P
                                                   i
                                                   G
                                                
                                                ,
                                                L
                                                
                                                   S
                                                   n
                                                
                                                ,
                                                
                                                   δ
                                                   n
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   n
                                                   ,
                                                   m
                                                   )
                                                
                                                ∈
                                                
                                                   Ω
                                                   new
                                                
                                             
                                          
                                          
                                          
                                          
                                             c
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          +
                                          σ
                                          
                                             (
                                             
                                                ∑
                                                i
                                             
                                             
                                                c
                                                i
                                                G
                                             
                                             
                                                P
                                                i
                                                G
                                             
                                             +
                                             
                                                ∑
                                                n
                                             
                                             
                                                p
                                                n
                                             
                                             L
                                             
                                                S
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4b)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          s.t.
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   Ψ
                                                   n
                                                
                                             
                                          
                                          
                                             P
                                             j
                                             D
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   Ψ
                                                   n
                                                
                                             
                                          
                                          
                                             P
                                             i
                                             G
                                          
                                          +
                                          
                                             ∑
                                             m
                                          
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          
                                             B
                                             
                                                n
                                                m
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                n
                                             
                                             −
                                             
                                                δ
                                                m
                                             
                                             )
                                          
                                          =
                                          L
                                          
                                             S
                                             n
                                          
                                          
                                          ∀
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4c)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          
                                             B
                                             
                                                n
                                                m
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                n
                                             
                                             −
                                             
                                                δ
                                                m
                                             
                                             )
                                          
                                          ≤
                                          
                                             P
                                             
                                                n
                                                m
                                             
                                             Lmax
                                          
                                          
                                          ∀
                                          n
                                          ,
                                          ∀
                                          m
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4d)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          0
                                          ≤
                                          L
                                          
                                             S
                                             n
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   Ψ
                                                   n
                                                
                                             
                                          
                                          
                                             P
                                             j
                                             D
                                          
                                          
                                          ∀
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4e)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          0
                                          ≤
                                          
                                             P
                                             i
                                             G
                                          
                                          ≤
                                          
                                             P
                                             
                                                i
                                             
                                             Gmax
                                          
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4f)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             δ
                                             1
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4g)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          s.t.
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          0
                                          ≤
                                          
                                             P
                                             
                                                i
                                             
                                             Gmax
                                          
                                          ≤
                                          
                                             
                                                P
                                                ^
                                             
                                             i
                                             Gmax
                                          
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4h)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         Υ
                                                         r
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ^
                                                      
                                                      i
                                                      Gmax
                                                   
                                                   −
                                                   
                                                      P
                                                      
                                                         i
                                                      
                                                      Gmax
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         Υ
                                                         r
                                                      
                                                   
                                                
                                                
                                                   
                                                      P
                                                      ^
                                                   
                                                   i
                                                   Gmax
                                                
                                             
                                          
                                          ≤
                                          
                                             Γ
                                             r
                                             G
                                          
                                          
                                          ∀
                                          r
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4i)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             P
                                             j
                                             Dmin
                                          
                                          ≤
                                          
                                             P
                                             j
                                             D
                                          
                                          ≤
                                          
                                             P
                                             j
                                             Dmax
                                          
                                          
                                          ∀
                                          j
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4j)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         Υ
                                                         r
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      j
                                                      D
                                                   
                                                   −
                                                   
                                                      P
                                                      
                                                         j
                                                      
                                                      Dmin
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         Υ
                                                         r
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      j
                                                      Dmax
                                                   
                                                   −
                                                   
                                                      P
                                                      j
                                                      Dmin
                                                   
                                                   )
                                                
                                             
                                          
                                          ≤
                                          
                                             Γ
                                             r
                                             D
                                          
                                          
                                          ∀
                                          r
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4k)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          s.t.
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   n
                                                   ,
                                                   m
                                                   )
                                                
                                                ∈
                                                
                                                   Ω
                                                   new
                                                
                                             
                                          
                                          
                                             c
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          ≤
                                          
                                             Π
                                             Lmax
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4l)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          n
                                          ,
                                          
                                          ∀
                                          m
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4m)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          =
                                          
                                             x
                                             
                                                m
                                                n
                                             
                                             L
                                          
                                          
                                          ∀
                                          n
                                          ,
                                          
                                          ∀
                                          m
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4n)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             
                                                n
                                                m
                                             
                                             L
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                             
                                                (
                                                n
                                                ,
                                                m
                                                )
                                             
                                             ∈
                                             
                                                Ω
                                                old
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The above three-level optimization problem is equivalent to (2), where the different decision variables can be identified as: x = 
                        
                           {
                           
                              x
                              
                                 n
                                 m
                              
                              L
                           
                           }
                           ,
                        
                      
                     d = 
                        
                           {
                           
                              P
                              j
                              D
                           
                           ,
                           
                              P
                              
                                 i
                              
                              Gmax
                           
                           }
                        
                      and y = 
                        
                           {
                           
                              P
                              i
                              G
                           
                           ,
                           
                              LS
                              n
                           
                           ,
                           
                              δ
                              n
                           
                           }
                        
                     .

Objective function (4a) represents the total system costs: the sum of the total transmission investment costs and the operating ones. Parameter 
                        
                           c
                           
                              n
                              m
                           
                           L
                        
                      is the annualized investment cost for the line connecting nodes n and m, and 
                        
                           x
                           
                              n
                              m
                           
                           L
                        
                      is the binary decision variable of the upper-level problem associated with this line (
                        
                           
                              x
                              
                                 n
                                 m
                              
                              L
                           
                           =
                           1
                           /
                           0
                        
                      if the line is built/not-built). Total operating costs include: (a) the generation costs from all units, and (b) the load shedding costs associated with all unserved loads. The generating cost of each unit i is computed as the production cost 
                        
                           c
                           i
                           G
                        
                      of that unit i times its produced energy 
                        
                           
                              P
                              i
                              G
                           
                           ,
                        
                      while the shedding cost at node n is computed as the unserved energy cost pn
                      at that node times the unserved energy at that same node, LSn. Note that σ is a weighting/discount factor to make investment and operation costs comparable.

A detailed description of the constraints included on each of the three optimization levels in (4) is presented within the following three subsections.

Constraints (4k)–(4n) are equivalent to (2b) and (2c), where Π
                        Lmax is the transmission investment budget. Ω
                        old and Ω
                        new are the sets of existing and new transmission lines, respectively, e.g., (n, m) ∈ Ω
                        old represents the existing lines connecting nodes n and m.

The uncertainty set d ∈ D in (2), which is further described in (3), is represented by constraints (4g)–(4j). As previously indicated, two sources of uncertainty are considered in this work:

                           
                              1.
                              The available production capacity 
                                    
                                       P
                                       
                                          i
                                       
                                       Gmax
                                    
                                  of each generating unit i. We assume that the level of availability of each generating unit depends on several stochastic conditions, such as equipment failures or, if i is a renewable unit, on future weather conditions (sun radiation or wind speed). Constraint (4g) ensures that the available production capacity of unit i is not greater than its total installed capacity 
                                    
                                       
                                          P
                                          ^
                                       
                                       i
                                       Gmax
                                    
                                 . The total deviations of the available capacities with respect to the installed ones is bounded in (4h) by the uncertainty budget 
                                    
                                       Γ
                                       r
                                       G
                                    
                                 . Note that this limit is imposed per region r, which allows a more flexible and realistic treatment of the uncertainties, i.e., we distinguish between regions that integrate different production technologies and that are characterized by different uncertainty sources. In these cases, i/j ∈ ϒr identifies the generation units or demand loads that are located in region r. Observe also that a case 
                                    
                                       
                                          P
                                          
                                             i
                                          
                                          Gmax
                                       
                                       =
                                       0
                                    
                                  corresponds to the failure of unit i.

The load level 
                                    
                                       P
                                       j
                                       D
                                    
                                  for each demand j. Note that this uncertainty is characterized not only by the short-term variabilities of the electricity demand but, since transmission investment is a medium-term decision, it also accounts for longer-term dynamics such as uncertain demand growths. Constraint (4i) enforces the demand load levels to lay between the bounds 
                                    
                                       P
                                       j
                                       Dmin
                                    
                                  and 
                                    
                                       P
                                       j
                                       Dmax
                                    
                                 . The uncertainty budget for the demand load is also defined per region by (4j) so that 
                                    
                                       Γ
                                       r
                                       D
                                    
                                  is the demand uncertainty budget for region r.

Comparing (4g)–(4j) with (3) we observe that 
                           
                              
                                 d
                                 k
                                 ref
                              
                              ∼
                              
                                 
                                    P
                                    ^
                                 
                                 i
                                 Gmax
                              
                              ,
                           
                         for the case of energy generation, and 
                           
                              
                                 d
                                 k
                                 ref
                              
                              ∼
                              
                                 P
                                 j
                                 Dmin
                              
                           
                         for the demands. The election of these references to quantify the total generation and demand variations allows not using the nonlinear absolute value in (3b). This can be verified by noticing that the worst realization of “nature” would seek, for a fixed network configuration, to cause the maximum level of load shedding (and thus the maximum operating costs). Therefore, it will try to make the generation capacity 
                           
                              P
                              
                                 i
                              
                              Gmax
                           
                         to be as lower as possible with respect to 
                           
                              
                                 P
                                 ^
                              
                              i
                              Gmax
                           
                         and the demand load 
                           
                              P
                              j
                              D
                           
                         to be as higher as possible with respect to 
                           
                              P
                              j
                              Dmin
                           
                        .

It is important to note that model (4) is general enough to account for complex interactions, including correlation effects among demand loads and generation levels. Moreover, since the demand and production uncertainty sets (4g)–(4j) encompass 1 year of operation, such sets allow accounting simultaneously for hourly, daily, weekly and monthly seasonality.

For instance, consider that for region r of a given electric energy system, we have observed from historical data that it is highly improbable to face hours where the wind farms produce at their maximum installed capacity while the demand load is at minimum. To model such circumstance, we can combine the uncertainty budget constraints (4h) and (4j) as follows:

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   Υ
                                                   r
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ^
                                                
                                                i
                                                Gmax
                                             
                                             −
                                             
                                                P
                                                
                                                   i
                                                
                                                Gmax
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   Υ
                                                   r
                                                
                                             
                                          
                                          
                                             
                                                P
                                                ^
                                             
                                             i
                                             Gmax
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   Υ
                                                   r
                                                
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                j
                                                D
                                             
                                             −
                                             
                                                P
                                                
                                                   j
                                                
                                                Dmin
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   Υ
                                                   r
                                                
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                j
                                                Dmax
                                             
                                             −
                                             
                                                P
                                                j
                                                Dmin
                                             
                                             )
                                          
                                       
                                    
                                    ≤
                                    
                                       Γ
                                       r
                                       GD
                                    
                                    
                                    ∀
                                    r
                                 
                              
                           
                        where 
                           
                              Γ
                              r
                              GD
                           
                         takes values between 0 and 1, so that, for the considered region r, if the demand deviations are high, then the available capacity deviations need to be low. Similarly, if the available capacity deviations are high, then the demand deviations need to be low.

Constraints (4b)–(4f) are equivalent to the set Ω(x, d) in (2), which defines the feasible region for the operating decision variables. These variables are the energy produced 
                           
                              P
                              i
                              G
                           
                         by each generating unit i, the load shedding LSn at each node n of the network, the angle δn
                         at node n.

Model (4) embeds a dc linear representation of the network energy flows. Equation (4b) imposes the energy balance at each node of the network where Bnm
                         represents the electrical susceptance of the line connecting nodes n and m, while δn
                         is the angle of bus n. Ψn
                         is the set of the generation units i and demands j that are located at node n. The maximum capacity of the line connecting nodes n and m, i.e., 
                           
                              
                                 P
                                 
                                    n
                                    m
                                 
                                 Lmax
                              
                              ,
                           
                         is enforced by (4c). Constraint (4d) ensures that the total load shedding at node n is non-negative and no greater that the total load at that node. Similarly, (4e) bounds the energy production for generating unit i. Finally, (4f) selects the first node as the reference one by fixing its voltage angle to zero.

Note that the upper-level decision variables, 
                           
                              
                                 x
                                 
                                    n
                                    m
                                 
                                 L
                              
                              ,
                           
                         as well as the medium-level ones, 
                           
                              P
                              j
                              D
                           
                         and 
                           
                              
                                 P
                                 
                                    i
                                 
                                 Gmax
                              
                              ,
                           
                         are included in constraints (4b)–(4f) and thus they influence the lower-level problem, i.e., the minimization of the operating costs. Observe also that the investment decision variable 
                           
                              x
                              
                                 n
                                 m
                              
                              L
                           
                         multiplies the node’s angles δn
                         at (4b) and (4c). However, since the investment decision is a binary variable, these products can be linearized without approximation as follows.

Let us define Δnm
                         = δn
                         − δm
                        . The bilinear term to be linearized is then 
                           
                              
                                 γ
                                 
                                    n
                                    m
                                 
                              
                              =
                              
                                 x
                                 
                                    n
                                    m
                                 
                                 L
                              
                              
                                 Δ
                                 
                                    n
                                    m
                                 
                              
                              ,
                           
                         where 
                           
                              x
                              
                                 n
                                 m
                              
                              L
                           
                         is a binary variable. Note that the bilinear term 
                           
                              
                                 x
                                 
                                    n
                                    m
                                 
                                 L
                              
                              
                                 Δ
                                 
                                    n
                                    m
                                 
                              
                              ,
                           
                         regardless of the sing of Δnm
                        , can be replaced by the following linear constraints:

                           
                              (6a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                x
                                                
                                                   n
                                                   m
                                                
                                                L
                                             
                                             M
                                             ≤
                                             
                                                γ
                                                
                                                   n
                                                   m
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   n
                                                   m
                                                
                                                L
                                             
                                             M
                                             
                                             ∀
                                             n
                                             ,
                                             ∀
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      x
                                                      
                                                         n
                                                         m
                                                      
                                                      L
                                                   
                                                
                                                )
                                             
                                             M
                                             ≤
                                             
                                                Δ
                                                
                                                   n
                                                   m
                                                
                                             
                                             −
                                             
                                                γ
                                                
                                                   n
                                                   m
                                                
                                             
                                             ≤
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      x
                                                      
                                                         n
                                                         m
                                                      
                                                      L
                                                   
                                                
                                                )
                                             
                                             M
                                             
                                             ∀
                                             n
                                             ,
                                             ∀
                                             m
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where M is a large enough constant. Note that by implementing this linearization we can linearly formulate Ω(x, d) as stated in (2).

The appropriate selection of robust uncertainty sets is currently an active area of research, see for instance Bertsimas and Brown (2009),Bertsimas et al. (2013),Bandi and Bertsimas (2012) and Ben-Tal et al. (2013). These approaches make use of available data (thus, the denomination data-driven) to build uncertainty sets that ensure a probability guarantee, i.e., regardless of the data distribution these approaches guarantee that the resulting set contains the random variable for a given confidence level. However, more often than not the formulation of the resulting sets is complex and often nonlinear, which makes difficult their use in large scale problems. This is specially so for the case for two-stage adaptive formulations, like the model presented in this work. Thus, these techniques are not used in this paper.

Nevertheless, it is still possible to define appropriate polyhedral uncertainty sets by using available data. Fig. 1
                         exemplifies how the uncertainty sets can be built based on historical time series. For instance, consider that we seek to expand the transmission network so that the resulting electricity system is robust for year 2020. To this end, we need to estimate the future load intervals P
                        Dmin and P
                        Dmax for the hourly demand, as well as the maximum installed capacity of the different technologies 
                           
                              
                                 P
                                 ^
                              
                              Gmax
                           
                        . For the sake of simplicity, consider also an electricity generation mix including just wind power units and combined-cycle gas turbines. Fig. 1(a) represents the total hourly demand load in the Spanish electricity system OMIE (OMIE, 2013) for years 2007–2013. Based on this data and applying different statistical techniques (which are out of the scope of this paper) we can estimate the values of P
                        Dmin and P
                        Dmax for the target year 2020. Additionally, note that Δ
                        D in Fig. 1(a) can be used to account for additional factors that may alter the future demand; for instance, a large scale integration of electric vehicles.

Similarly, the data corresponding to the hourly power generation from wind units (Fig. 1(b)) and combined cycle gas turbines (Fig. 1(c)) can be used to estimate their future installed capacity 
                           
                              
                                 P
                                 ^
                              
                              Gmax
                           
                        . Note again that Δ
                        G in Fig. 1(b) can be introduced to model unexpected factors altering the installed capacity, such as regulatory changes or random failures.

We should emphasize that Fig. 1 represents the aggregate results for the Spanish system. However, similar time series can be obtained, and similar prediction analysis can be carried out, for a given demand node or region, or for a specific generation unit or set of units.

From Fig. 1 we can observe that both the demand and the power generation behavior over time are characterized by non-constant mean and variance processes. In particular, it can be shown that these time series are highly influenced by seasonality (daily, weekly and others) and by the current meteorological conditions. Some forecasting tools that can tackle this stochastic nature are ARIMA, GARCH, dynamic factors or transfer function models (Alonso et al., 2011; Nogales and Conejo, 2006, among others). The idea is to use these models to forecast, under different confidence levels, the behavior of both the demand and the production capacities during the considered target year. Then, we can use such predictions to derive appropriate upper and lower bounds: P
                        Dmax, P
                        Dmin and P
                        Gmax (dashed lines in Fig. 1). For instance, P
                        Dmax and P
                        Dmin can be selected as specific sample distribution quantiles, where the sample includes all the hourly demand predictions for the target year.

In general, two-stage adaptive robust models are difficult to tackle because their multilevel optimization structure often renders NP-hard problems. There are several solution algorithms specifically designed to address these problems, which can be viewed as extensions of Benders’ decomposition. In these methods, the fist stage objective function is gradually reconstructed using dual information from the second stage problem (Bertsimas et al., 2013; Jabr, 2013; Jiang et al., 2013; Thiele et al., 2010; Zhao and Zeng, 2012).

In this paper we have implemented a cutting plane strategy solely based on primal cuts, i.e., it involves only primal decision variables. Some preliminary studies suggest that this algorithm, usually referred to as constraint-and-column generation method, performs computationally better than a Bender’s algorithm that is based on dual information. Convergence guarantee and other properties of this method are analyzed in Zeng and Zhao (2013),Zhao and Zeng (2012),Jiang et al. (2012),Jiang et al. (2013).

Therefore, the three-level adaptive robust transmission expansion problem (4) is solved by decomposing it into a master problem and a subproblem that interchange primal information until convergence to an optimal solution is achieved.

For clarity, in the following subsections we use the compact formulation (1) introduced in Section 2.

The subproblem associated with (2) is

                           
                              (7)
                              
                                 
                                    
                                       max
                                       
                                          d
                                          ∈
                                          D
                                       
                                    
                                    
                                    
                                       min
                                       
                                          y
                                          ∈
                                          
                                             Ω
                                             (
                                             
                                                x
                                                *
                                             
                                             ,
                                             d
                                             )
                                          
                                       
                                    
                                    
                                       b
                                       T
                                    
                                    y
                                 
                              
                           
                        where the investment decisions are assumed to be fixed to x*, which are obtained from the solution of the master problem at each iteration of the algorithm.

Bilevel problem (7) can be converted into an equivalent single-level problem by replacing the lower-level problem by its equivalent Karush–Kuhn–Tucker (KKT) conditions (which are necessary and sufficient conditions for optimality since the lower-level problem is linear and thus convex on its decision variables y). The resulting single-level problem is

                           
                              (8a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   d
                                                   ,
                                                   y
                                                
                                             
                                             
                                             
                                                b
                                                T
                                             
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             H
                                             d
                                             ≤
                                             h
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8c)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             b
                                             +
                                             
                                                G
                                                T
                                             
                                             μ
                                             +
                                             
                                                B
                                                T
                                             
                                             λ
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8d)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             A
                                             
                                                x
                                                *
                                             
                                             +
                                             B
                                             y
                                             =
                                             E
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8e)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             K
                                             d
                                             −
                                             F
                                             
                                                x
                                                *
                                             
                                             −
                                             G
                                             y
                                             ⊥
                                             μ
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8f)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             λ
                                             
                                             :
                                             
                                             free
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where λ and μ are the dual variable vectors associated with conditions Ax* + By = Ed and Fx* + Gy ≤ Hd, respectively.

Constraint (8b) represents the matrix formulation of the uncertainty set d ∈ D, stated in (4g)–(4j). Equation (8c) results from differentiating the Lagrangian of the lower-level problem (4a)–(4f) with respect to the lower-level variables, and (8d) gathers the equality constraints (4b) and (4f). Constraint (8e) is the complementarity condition, equivalent to the set of constraints: Fx* + Gy − Kd ≤ 0, μ ≥ 0 and μ
                        T(Fx* + Gy − Kd) = 0. Note that this nonlinear complementarity condition can be linearized by using the generally well-behaved Fortuny-Amat (Fortuny-Amat and McCarl, 1981) transformation (9), which renders:

                           
                              (9a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             K
                                             d
                                             −
                                             F
                                             
                                                x
                                                *
                                             
                                             −
                                             G
                                             y
                                             ≤
                                             z
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             μ
                                             ≤
                                             (
                                             1
                                             −
                                             z
                                             )
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where z a vector of binary variables and M a sufficiently large constant.

Replacing (8e) by the set of conditions (9) results in a MILP subproblem that can be solve efficiently by using standard branch-and-cut solvers. For the considered problem in this paper, we have experiences no numerical issues using the Fortuny-Amat transformation.

Considering a Bender’s framework, the master problem is then formulated as follows:

                           
                              (10a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ,
                                                   
                                                      y
                                                      p
                                                   
                                                   ,
                                                   η
                                                
                                             
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             η
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                c
                                                T
                                             
                                             x
                                             ≤
                                             Π
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10c)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             η
                                             ≥
                                             
                                                b
                                                T
                                             
                                             
                                                y
                                                p
                                             
                                             
                                             ∀
                                             
                                                p
                                                ≤
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10d)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             A
                                             x
                                             +
                                             B
                                             
                                                y
                                                p
                                             
                                             =
                                             E
                                             
                                                d
                                                p
                                                *
                                             
                                             
                                             ∀
                                             
                                                p
                                                ≤
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10e)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             F
                                             x
                                             +
                                             G
                                             
                                                y
                                                p
                                             
                                             ≤
                                             K
                                             
                                                d
                                                p
                                                *
                                             
                                             
                                             ∀
                                             
                                                p
                                                ≤
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10f)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                l
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        
                     

where k is the iteration index and p = 1, …, k.

The optimization variables of master problem (10) are the auxiliary variable η, the operating decisions yp
                        , one per iteration of the algorithm, and the investment decisions x. Parameters 
                           
                              d
                              
                                 p
                              
                              *
                           
                         are considered fixed in the master problem. Note that 
                           
                              d
                              
                                 p
                              
                              *
                           
                         is the optimal value of the uncertain parameter, which is obtained from the subproblem at each iteration of the algorithm. For this reason, problem (10) can be viewed as a deterministic problem similar to (1) where 
                           
                              
                                 d
                                 ¯
                              
                              ∼
                              
                                 d
                                 p
                                 *
                              
                           
                        .

Additionally, master problem (10) incorporates a new set of constraints (10c)–(10e) at each iteration k of the algorithm. Note that this is done in a Bender’s decomposition fashion. However, it should be remarked that, opposed to the conventional Benders’ approach, these new constraints only include primal decision variables (primal cuts). Observe also that master problem (10) is a MILP that, similarly to subproblem (8), can be solved efficiently using standard branch-and-cut solvers.

By taking into account the master problem and the subproblem defined in the previous subsections, the considered constraint-and-column generation algorithm is described in the following:

                           
                              
                                 Step 0
                              
                              Fix the Lower Bound (LB) to LB = -∞, the Upper Bound (UB) to UB = ∞ and the iteration counter to k = 0.

If k = 0 solve the master problem (10) without including constraints (10c)–(10e). Otherwise, solve the complete version of master problem (10). Obtain the optimal solution 
                                    
                                       {
                                       
                                          x
                                          *
                                       
                                       ,
                                       
                                          η
                                          *
                                       
                                       ,
                                       
                                          y
                                          p
                                          *
                                       
                                       }
                                    
                                  and update the lower bound as

                                    
                                       
                                          
                                             LB
                                             =
                                             
                                                c
                                                T
                                             
                                             
                                                x
                                                *
                                             
                                             +
                                             
                                                η
                                                *
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Solve subproblem (8) by considering the optimal value x* obtained in Step 1 as a parameter. Obtain the optimal solution {d*, y*}, and update the upper bound as

                                    
                                       
                                          
                                             UB
                                             =
                                             min
                                             
                                                {
                                                UB
                                                ,
                                                
                                                   c
                                                   T
                                                
                                                
                                                   x
                                                   *
                                                
                                                +
                                                
                                                   b
                                                   T
                                                
                                                
                                                   y
                                                   *
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              

If 
                                    
                                       (
                                       UB
                                       −
                                       LB
                                       )
                                       /
                                       UB
                                       ≤
                                       ϵ
                                       ,
                                    
                                  return x* and terminate. Otherwise, update k ← k + 1 and set 
                                    
                                       
                                          d
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                          
                                          *
                                       
                                       =
                                       
                                          d
                                          *
                                       
                                       ,
                                    
                                  where d* is the optimal solution obtained in Step 2. Continue with Step 1.

As previously indicated, Zeng and Zhao (2013),Zhao and Zeng (2012) and Jiang et al. (2013) provide a convergence proofs of this type of algorithms, as well as an analysis of its convergence properties.

In this section we comprehensively analyze a realistic case-study.

The system considered in this case study is based on the 24-node RTS (Grigg et al., 1996), which is depicted in Fig. 2
                        .

The system has 24 nodes that are connected through 34 transmission lines. Technical data for these transmission lines is provided in Table 1
                        , which includes their maximum transmission capacity and their electrical susceptance (physical parameter). We assume that the capacities of the lines connecting the northern and southern regions (dashed lines in Fig. 2) of the system are significantly lower than those of the rest of lines. This is purposely done to provoke congestion in these lines and thus obtaining a system that would benefit from investment in transmission facilities.

Data regarding candidate lines to be potentially built is provided in Table 2
                        . Note that the last column gives the annualized investment costs for each of these lines.

Additionally, 18 production units and 17 demand loads are distributed throughout the system. Table 3
                         provides data for these units and demands. Note that each production unit is characterized by its location on the network (second column), its maximum generation capacity 
                           
                              
                                 P
                                 ^
                              
                              i
                              Gmax
                           
                         (third column) and its generation costs 
                           
                              c
                              i
                              G
                           
                         (fourth column). Similarly, each demand load is characterized by its location on the network (sixth column), its expected value 
                           
                              
                                 P
                                 ¯
                              
                              j
                              D
                           
                         (seventh column) and the load shedding cost pn
                         of its corresponding node (eighth column).

In this case study, we do not directly implement any of the prediction techniques indicated in Section 3.4 since such techniques are out of the scope of this work, however, to be as general as possible, we assume that the load limits for any demand j are expressed as 
                           
                              
                                 P
                                 j
                                 Dmax
                              
                              =
                              
                                 (
                                 1
                                 +
                                 
                                    
                                       ɛ
                                    
                                    j
                                 
                                 )
                              
                              
                                 
                                    P
                                    ¯
                                 
                                 j
                                 D
                              
                           
                         and 
                           
                              
                                 P
                                 j
                                 Dmin
                              
                              =
                              
                                 (
                                 1
                                 −
                                 
                                    
                                       ɛ
                                    
                                    j
                                 
                                 )
                              
                              
                                 
                                    P
                                    ¯
                                 
                                 j
                                 D
                              
                           
                        . In particular, in this case study we consider that ɛ is always fixed to ɛ = 0.25, ∀j, so that the different uncertainty levels, for both generation and demands, are tuned up by varying 
                           
                              Γ
                              r
                              G
                           
                         and 
                           
                              
                                 Γ
                                 r
                                 D
                              
                              ,
                           
                         respectively.

Moreover, in order to study the impact of uncertainties, we divide the system into two different regions, as depicted in Fig. 2, which are characterized as follows.

                           
                              
                                 Region 1
                              
                              
                                 (grey area): Significant uncertainty on the demand level, and no uncertainty on the available generation capacity.


                                 (white area): No uncertainty on the demand level, and high uncertainty on the available generation capacity.

Region 1 may represent a geographical area of the system where most of the generation is already built and the future demand is difficult to predict (e.g., an eventual demand increase due to a city expansion). Conversely, Region 2 may represent a geographical area with almost no demand, or with demand that can be very well predicted (industrial site), and high uncertainty on the generation capacity because of uncertain future availability of production units (e.g., due to failures, environmental regulation, etc.)

We fix parameter σ in (4a) to σ = 8760, which is the total number of hours in 1 year. This allows considering the same scale for both operation costs (hourly basis) and annualized investment costs.

We consider that, the uncertainty budgets for generation and demand in Region 1 are 
                           
                              
                                 Γ
                                 1
                                 G
                              
                              =
                              0
                           
                         and 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              0.4
                              ,
                           
                         respectively. Similarly, we consider that Region 2 is characterized by 
                           
                              
                                 Γ
                                 2
                                 G
                              
                              =
                              0.4
                           
                         and 
                           
                              
                                 Γ
                                 2
                                 D
                              
                              =
                              0
                           
                        . Note that these budgets are coherent with the uncertainty assumptions made for each region.

Finally, the adjustment of constants M must take into account that their value should be sufficiently large to properly model the complementarity conditions (8e), but not too large so that the product binary × M does not pose any numerical difficulty. In particular, due to the nature of the linearized constraints, constants M can be classified into two types: (a) the constants M that are used to bound primal variables, whose values can be easily selected based on their physical nature; and (b) the constants M that are used to bound dual variables. This selection can be more complicated since dual variables are usually difficult to interpret. In order to tackle this problem, the heuristic method proposed in Ruiz and Conejo (2009) was implemented to tuned-up these constants.

@&#RESULTS@&#


                        Table 4
                         presents the transmission expansion results for four different levels of investment budget Π
                        Lmax and for two network designs, a deterministic one in which the transmission decisions are planned assuming average values of the uncertain parameters, and a robust one which is obtained by solving the ARO model proposed in this paper. Row 3 gives the generation costs (
                           
                              
                                 ∑
                                 i
                              
                              
                                 c
                                 i
                                 G
                              
                              
                                 P
                                 i
                                 G
                              
                           
                        ) for the worst case scenario (WC), i.e., the generation cost for the scenario that renders the highest total cost, and row 4 provides the average generation costs (Av.) that result from simulating the system with 1000 realizations of the uncertain parameters. Note that these scenarios are generated to be consistent with the robust sets considered in this example. Rows 5 and 6 contain the load-shedding costs (∑
                           n
                        
                        pnLSn
                        ), while the investment costs (
                           
                              
                                 ∑
                                 
                                    
                                       (
                                       n
                                       ,
                                       m
                                       )
                                    
                                    ∈
                                    
                                       Ω
                                       new
                                    
                                 
                              
                              
                                 c
                                 
                                    n
                                    m
                                 
                                 L
                              
                              
                                 x
                                 
                                    n
                                    m
                                 
                                 L
                              
                           
                        ) are presented in row 7. Finally the total system costs are presented in rows 8–10, which also include the 90-percentile value (90 percent) resulting from the scenarios considered. Finally, the last row identifies the new lines to be built for each of the cases analyzed.

For the deterministic case, no lines are built for any of the cases considered because the original network capacity is enough to deal with the expected values of the uncertain parameters. This implies that the results do not change with the investment budget.

As expected, in the robust case the investment costs increase with the investment budget as additional lines are built. The new lines help to reduce congestion, which allows increasing the total energy production, and thus its generation costs (both average and worst case values). However, this increment is compensated by a decrease in load shedding costs, as can be observed from the total system costs. Also, note that as the investment budget increases, the addition of new lines does not follow an incremental pattern, i.e., a higher budget may result in a completely different set of new lines to be built. For instance, line 9–15 is built for an investment budget of Π
                        Lmax = 1.5 million dollars but it is replaced by line 1–18 if the budget is increased to Π
                        Lmax=2.5 million dollars.

By comparing the deterministic network with the robust one we can conclude that the later performs better in terms of costs. This is observed not only for the worst case realization of the uncertain parameters, but also for the average behavior when facing random scenarios.

The impact of the level of uncertainty on transmission planning is illustrated in Table 5
                        . The proposed model is solved for different levels of uncertainty, which is modeled by varying the budget parameters 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              ,
                           
                         while assuming 
                           
                              
                                 Γ
                                 1
                                 G
                              
                              =
                              
                                 Γ
                                 2
                                 D
                              
                              =
                              0
                              ,
                           
                         and a fixed investment budget of Π
                        Lmax = $2.25 million. Again, we compare the performance of the deterministic transmission planning with the robust one in terms of worst case and average case values.


                        Table 5 shows that load-shedding costs increase with the level of uncertainty in the system for both deterministic and robust approaches. This is so because, as shown in Section 3, a higher level of uncertainty is translated into comparatively worse possible realizations of the uncertain parameters, i.e., an available generation capacity even lower, and a demand load level even higher. Generating costs generally increase with 
                           
                              Γ
                              1
                              D
                           
                         as more energy production is needed to supply the demand in Region 1. However, this is not a general trend since 
                           
                              Γ
                              2
                              G
                           
                         also increases, which limits the available generation capacity in Region 2. For the robust model, a higher level of uncertainty increases the need to build new lines, as observed from the investment costs. Finally, as expected, the total system cost increases with the level of uncertainty 
                           
                              Γ
                              1
                              D
                           
                         and 
                           
                              Γ
                              2
                              G
                           
                        . Moreover, the non-incremental nature of the expansion plan can also be observed by increasing the uncertainty level. Note that line 3–14 is built for the cases in which 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              =
                              0.3
                           
                         and 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              =
                              0.4
                              ,
                           
                         but not if the uncertainty level increases to 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              =
                              0.5
                           
                        .

Again, the comparison between the two approaches indicates that, as we increase the uncertainty in the system, the robust approach renders comparatively lower total costs. It is relevant to note that if 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              =
                              0.3
                              ,
                           
                         the average total cost is the same for the deterministic and the robust cases. Despite of this, the deterministic network is less appropriated from the TSO perspective since both the worst case and the 90-percentile value of the total cost are higher for the deterministic network than for the robust one.

The above analysis is easily extended to consider the combined impact of the investment budget and the uncertainty level in the transmission expansion plan. Figs. 3
                        –6
                         represent each of the system’s costs that result from solving problem (4) for different investment budgets and uncertainty levels in the system, where it is assumed that 
                           
                              
                                 Γ
                                 1
                                 G
                              
                              =
                              
                                 Γ
                                 2
                                 D
                              
                              =
                              0
                           
                        .

The transmission investment costs are depicted in Fig. 3. Both the investment budget and the uncertainty level increase the level of investment in the system. As indicated in this figure, each flat area corresponds to one particular set of new transmission lines to be built. Note that these sets can dramatically change with marginal increments of the uncertainty level or the investment budget, which illustrates again the non incremental nature of the investment decisions.

It is important to note that this is a relevant result since real-world transmission systems expand following an incremental order. Therefore, the type of analysis illustrated in Fig. 3 can assists TSOs to identify, for a given investment budget, which are the most important lines to be built in the system. For instance, assuming that the investment budget is $6 million, then the first line to be built is line 3–14, because it is always optimal for the range 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              ≥
                              0.25
                           
                        . Then the second candidate line to be built is 9–15, because it is optimal for 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              ≥
                              0.35
                           
                        . However, the election between lines 1–18 or 1–22 would depend on the decision maker criteria regarding the assumed uncertainty level, i.e., note that line 1–18 is optimal for 
                           
                              0.35
                              ≤
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              ≤
                              0.39
                           
                         while line 1–22 is optimal for 
                           
                              0.39
                              <
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                              ≤
                              0.35
                           
                        .

From Fig. 3 we can infer that from investment budgets greater than 3 million dollars, no additional transmission lines are built, so that the budget constraint (4k) is no longer binding. This is verified for investment budgets up to 8 million dollars, which is a value higher than the sum of the investment cost of all the candidate lines (that is 7 million dollars). Therefore, the investment decisions for budgets greater than 3 million dollars are identical to those made with an unlimited budget.

The system generating costs are depicted in Fig. 4
                        . In general, energy generation, and thus its associated costs, increases with the investment budget and with the systems’ level of uncertainty. However, note that for values of 
                           
                              
                                 Γ
                                 1
                                 D
                              
                              =
                              
                                 Γ
                                 2
                                 G
                              
                           
                         close to 0.5, the generating costs may decrease due to a lower level of available generation capacity.

As expected, load-shedding costs increase (Fig. 5
                        ) with the uncertainty level and decrease as the investment budget increases. However, note that this general trend may be locally altered with high levels of uncertainty and low transmission investment levels. This can be explained by noting that the worst case scenario aims to maximize the operating cost, which are the sum of the generating (Fig. 4) and load shedding costs (Fig. 5). Thus, there can be cases where a lower level of non served demand combined with a higher generation level may result in comparatively higher operating costs.

Finally, the total system cost, which is obtained combining investment, generating and load-shedding costs, are depicted in Fig. 6. Note that the total cost presents an smooth behavior, decreasing with the investment budget and increasing with the uncertainty level.

The different problems of the case study presented in this paper were solved by CPLEX 12.1.0 (The Solver Manuals. GAMS/CPLEX, 2013) under GAMS (General Algebraic Modeling System, 2013) on a Sun Fire X4600M2 with 8 Quad-Core processors running at 2.9 gigahertz and 256 gigabytes of RAM. The constraint-and-column generation algorithm described at Section 4.3 is run until convergence is reached, enforcing a tolerance level of ε = 1e − 7 percent. Fig. 7
                         presents the computational time, in seconds, required to solve each of the instances considered, i.e., each bar provides the required time for a given combination of the investment budget and system’s uncertainty level.

Note that the computational time mostly depends on the uncertainty level assumed for the system. This is because the uncertainty budget highly conditions the feasibility region of subproblem (8) in Step 2 of the decomposition algorithm, which is the most computationally demanding step of the proposed algorithm (Section 4.3). In any case, for the considered 24-node test system, the individual computational time never exceeded 10 minutes (600 seconds).

In order to complement this study, two additional larger networks have been analyzed. These networks are obtained, as indicated in Grigg et al. (1996), by replicating the 24-node RTS system considered previously. Thus, RTS 48 and RTS 72 refer to networks of 48 and 72 nodes, respectively. The results for these networks are reported in Table 6
                        . The second row contains the number of iterations needed by the proposed constraint-and-column generation algorithm. Rows 3–6 provide computational information pertaining to the subproblem: number of continuous variables, number of binary variables, number of equations, and average time needed for its resolution. Similar information, but referred to the last iteration of the master problem is provided in rows 7–10. The total time needed to solve each system is given in the last column.

As can be observed, only two or three iterations are needed to solve any of these larger systems. Note that total computational time is highly conditioned by the size of the subproblem. In general, the master problem does not present any computational challenge since it only incorporates a small number of primal cuts (small number of iterations). However, as we increase the subproblem complexity by adding new nodes, the computational time increases exponentially.

The exponential growth of the computational time with the problem size is a common feature of branch-and-cut algorithms, like the one used in this work (CPLEX; The Solver Manuals. GAMS/CPLEX, 2013), when addressing MILP problems. The increase of binary variables needed to linearize the KKT conditions and the bilinear products increase exponentially the number of potential “cuts” of the solver and thus the time needed to solve the problem.

@&#CONCLUSIONS@&#

A two-stage adaptive robust optimization model is used to derive optimal transmission expansion plans for an electric energy system.

The proposed formulation allows representing different degrees of uncertainties affecting different regions of the system, which may involve demand levels, available generation capacities, or a combination of these. Moreover, historical data is used to design realistic uncertainty sets.

The resulting optimal transmission expansion plan is the one that minimizes the total system’s costs (investment and operating costs) under the worst possible realization of the uncertain parameters within an uncertainty set.

The proposed formulation consists in a mixed-integer three-level optimization problem that can be reformulated as a bilevel one. This is done by replacing the lower-level problem by its KKT optimality conditions.

The resulting min-max problem is solved by using a cutting-plane decomposition method. The analysis of the computational burden associated to this method shows that it can be successfully implemented within a transmission expansion framework.

Results indicate that the investment decisions on transmission facilities as well as the subsequent operation of the system are highly conditioned by the investment budget, and by the level of uncertainty predicted for the system.

In general, a higher level of uncertainty translates into worse possible realizations of the uncertain parameters and thus into higher operating costs, i.e., the load shedding costs are increased by lower available generation capacities and higher demand load levels. However, as the investment budget increases, these negative effects can be mitigated by installing new strategic transmission lines that reinforce the existing transmission network and reduce the level of unserved energy in the system.

It is important to note that the selection of these lines does not follow an incremental order, so that a marginal increase on either the uncertainty level or in the investment budget may result in a significantly different set of optimal lines to be built. Thus, the proposed methodology is of interest for transmission system operators to assist them on their decision making.

@&#ACKNOWLEDGMENTS@&#

The authors would like to acknowledge the input provided by the editor and the anonymous referees. Their insightful observations have notably contributed to improve the quality of this work.

@&#REFERENCES@&#

