@&#MAIN-TITLE@&#Characterization of analysis-suitable T-splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the analysis suitable T-spline spaces as a piecewise polynomials space.


                        
                        
                           
                           We characterize the difference between two neighboring polynomial expressions.


                        
                        
                           
                           We study when the space can be described by smoothness conditions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

T-splines

Piecewise polynomial characterization

Smoothness conditions

Isogeometric analysis

Computer aided design

@&#ABSTRACT@&#


               
               
                  In this article we provide the characterization of analysis suitable T-spline spaces (Beirão da Veiga et al., 2013) as the space of piecewise polynomials with appropriate linear constrains on the subdomain interfaces. We describe AST-meshes for which the linear constrains are equivalent to smoothness conditions and provide examples showing that this is not always the case.
               
            

@&#INTRODUCTION@&#

IsoGeometric Analysis (IGA) is a recent numerical technique for solving partial differential equations (PDEs) proposed by T.J.R. Hughes et al. (2005). The key feature of IGA is that the PDE solution is approximated by B-splines or Non-Uniform Rational B-Splines (NURBS) that are commonly used to represent the domain geometry in Computer Aided Design (CAD). Many recent papers in the engineering literature deal with IGA in different applicative areas such as fluid dynamics, structural mechanics, and electromagnetics (see Cottrell et al., 2009 and the references therein). Smoothness of B-splines and NURBS shape functions is also beneficial for PDE approximation, compared to classical 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      continuity of standard finite elements, and it allows new methods enjoying properties which would be hard to obtain with finite elements (e.g., see Buffa et al., 2011 and Evans and Hughes, 2013a, 2013b, 2013c).

Tensor-product B-splines or NURBS, often adopted in CAD and IGA, limit flexibility in mesh generation and refinement. However, local refinement strategies in IGA are possible thanks to the non-tensor product extensions of B-splines, such as T-splines (Sederberg et al., 2004, 2003), LR-splines (Dokken et al., 2013), hierarchical splines (Vuong et al., 2011) and polynomial splines over T-meshes (Deng et al., 2008). The focus of this paper is on T-splines. T-spline shape functions are constructed from a T-mesh, they are individually tensor-product of univariate B-splines, but the T-mesh breaks the global tensor-product structure by allowing so-called T-junctions.

T-splines have been recognized as a promising tool for IGA in Bazilevs et al. (2010) and have been the object of growing interest in the literature: Beirão da Veiga et al. (2011), Buffa et al. (2010), Dörfel et al. (2010), Li and Scott (2011), Li et al. (2012), Scott et al. (2012), Wang et al. (2011). More recently, in Li et al. (2012) 
                     analysis-suitable (AS) T-splines have been defined: AST-splines are a sub-class of T-splines having fundamental mathematical properties needed in a PDE solver. Linear independence of AST-splines blending functions has been first shown in Li et al. (2012) for the bi-cubic case. In Beirão da Veiga et al. (2013), AST-splines are generalized to arbitrary degree and it is shown that the condition of being AS, which is mainly a condition on the connectivity of the T-mesh, is equivalent to the fact that the T-spline basis functions admit a dual basis that can be constructed as in the tensor-product setting. As a corollary, the T-spline space enjoys the optimal approximation properties of standard (tensor-product) B-splines spaces. Still, one key part of the theory of T-splines is incomplete: the characterization of the T-spline space is known only for the special case of T-meshes with simple lines (Li and Scott, 2014).

By characterization here we mean the identification of the T-spline space as the space of piecewise polynomial with respect to a mesh (the so-called polynomial-mesh) with some constraints at the mesh edges, for example smoothness constraints. Our goal in this paper is to prove this result.

T-spline characterization is an important mathematical target per se but it is also a useful tool for other results. For example, the isogeometric vector fields proposed in Buffa et al. (2014) for electromagnetic problems are based on AST-splines and their properties depends on the characterization. Furthermore, a complete theory of approximation properties of T-spline spaces in the context if isogeometric analysis will benefit from the characterization proposed here, see Beirão da Veiga et al. (2014).

For our T-spline characterization we adopt a general technique that is based on the previous works of Billera (1988) and Mourrain (2014) and Pettersen (2013). The main tool is homology, first used in Billera (1988) to study the dimension of spline spaces on triangular meshes, later generalized by Mourrain (2014) to rectangular elements and by Pettersen (2013) to higher dimension cubes. The results of Mourrain (2014) and Pettersen (2013) have been extensively used in Dokken et al. (2013) to study LR-splines. In this paper we further extend Mourrain (2014), Pettersen (2013) in order to represent more general smoothness conditions that arise with T-splines.

The outline of the paper is as follows. After some preliminary notation and definitions of Section 2, we introduce the concept of T-mesh, AST-mesh, T-splines in Section 3. In Section 4 we define a space of piecewise polynomial functions with constraints at the mesh lines. These constraints may represent smoothness properties or more general conditions. Then we express the dimension of such a space in terms of the dimension of a homology space, and then we are able to show that, for the kind of constraints that are of interests when dealing with T-spline spaces, we can prove that the dimension of the homology space is indeed zero. Therefore the formula simplifies and the dimension of the piecewise polynomial space is related to the T-mesh topology. In Section 5 we show that the dimension of the T-spline space is the same, and finally that the T-spline space coincides with the piecewise polynomial space. Section 6 contains some example in which the proposed characterization is computed explicitly. In Section 7 we discuss some cases where the characterization can be simplified to smoothness conditions on the inter-element edges. The details are in Theorem 7.1.

Unluckily our result is technical and the proof is decomposed in many small lemmas. In order to facilitate the comprehension of the main ideas of the proof we include a map in Fig. 1
                     .

In this section we cover the background material on meshes and B-splines. It is also a review of the notation used afterwards. In this paper we study spaces of bivariate piecewise polynomials. For our purposes the degree of the polynomials can be considered fixed at the beginning. We denote by 
                        
                           
                              P
                           
                           
                              p
                           
                        
                        =
                        
                           
                              P
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              )
                           
                        
                      the space of polynomials in 
                        x
                        ,
                        y
                      of degree 
                        
                           
                              p
                           
                           
                              x
                           
                        
                      with respect of x and 
                        
                           
                              p
                           
                           
                              y
                           
                        
                      with respect of y. We will use 
                        
                           
                              P
                           
                           
                              p
                           
                        
                      to denote the space of univariate polynomials of degree p.

In order to avoid writing tedious specifications of the behavior of the piecewise polynomials on the interfaces between subdomains we will consider them as representatives of a class of Lebesgue-measurable functions.


                        
                           Definition 2.1
                           A knot-vector Θ is a finite non-decreasing sequence of real numbers 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ]
                              . The multiplicity of ζ in Θ is
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             Θ
                                          
                                       
                                       (
                                       ζ
                                       )
                                       =
                                       #
                                       {
                                       i
                                       :
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       ζ
                                       }
                                       .
                                    
                                 
                               A knot-vector is said to be p-open when for all ζ, it holds 
                                 0
                                 ≤
                                 
                                    
                                       m
                                    
                                    
                                       Θ
                                    
                                 
                                 (
                                 ζ
                                 )
                                 ≤
                                 p
                                 +
                                 1
                               and 
                                 m
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 m
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 p
                                 +
                                 1
                              . A local-knot-vector of degree p is a knot-vector Θ composed of 
                                 p
                                 +
                                 2
                               knots 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       +
                                       2
                                    
                                 
                                 ]
                               such that 
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       +
                                       2
                                    
                                 
                              . A knot θ is internal to a knot-vector 
                                 Θ
                                 =
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ]
                               if 
                                 θ
                                 ≠
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 θ
                                 ≠
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              .

Note that given a p-open knot-vector 
                           Θ
                           =
                           [
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           ≤
                           ⋯
                           ≤
                           
                              
                                 θ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           ]
                         then all the sub-knot-vectors of the form 
                           [
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           ≤
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           ≤
                           ⋯
                           ≤
                           
                              
                                 θ
                              
                              
                                 i
                                 +
                                 p
                                 +
                                 1
                              
                           
                           ]
                         are local-knot-vectors of degree p. All the knot vectors considered in this paper will be sub-vectors of a p-open knot-vector and thus all their sub-sequences of 
                           p
                           +
                           2
                         knots will be local-knot-vectors.


                        
                           Definition 2.2
                           Two knot-vectors 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       s
                                    
                                 
                                 ]
                               and 
                                 [
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       t
                                    
                                 
                                 ]
                               
                              overlap if there exists a sequence of real numbers 
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                               and two integers k, l such that 
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       +
                                       k
                                    
                                 
                              , 
                                 1
                                 ≤
                                 i
                                 ≤
                                 s
                               and 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       +
                                       l
                                    
                                 
                              , 
                                 1
                                 ≤
                                 i
                                 ≤
                                 t
                              .

Univariate B-splines are piecewise polynomial functions 
                           R
                           →
                           R
                         associated to local knot-vectors. There exist different, but equivalent definitions of B-splines. In Chapter IX of de Boor (2001) they are defined using a recurrence relation; in Chapter 4 of Schumaker (2007) they are defined using divided differences. The important properties of the B-spline 
                           B
                           [
                           Θ
                           ]
                         associated to 
                           Θ
                           =
                           [
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 p
                                 +
                                 2
                              
                           
                           ]
                         are
                           
                              1.
                              for all 
                                    i
                                    :
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    <
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                  it holds that
                                    
                                       
                                          B
                                          [
                                          Θ
                                          ]
                                          
                                             
                                                |
                                             
                                             
                                                [
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                          
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                          ;
                                       
                                    
                                 
                              

the support of 
                                    B
                                    [
                                    Θ
                                    ]
                                  is
                                    
                                       
                                          supp
                                          
                                          B
                                          [
                                          Θ
                                          ]
                                          =
                                          [
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                p
                                                +
                                                2
                                             
                                          
                                          ]
                                          ;
                                       
                                    
                                 
                              

for all 
                                    ζ
                                    ∈
                                    R
                                 , 
                                    B
                                    [
                                    Θ
                                    ]
                                  is 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    ζ
                                    )
                                  where 
                                    k
                                    =
                                    p
                                    −
                                    m
                                    (
                                    ζ
                                    )
                                  and by convention 
                                    
                                       
                                          C
                                       
                                       
                                          −
                                          1
                                       
                                    
                                  means discontinuous.


                        
                           Definition 2.3
                           The spline space associated to a knot-vector 
                                 Θ
                                 =
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ]
                               is
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             Θ
                                          
                                       
                                       =
                                       span
                                       {
                                       B
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                             +
                                             p
                                             +
                                             1
                                          
                                       
                                       ]
                                       :
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       p
                                       }
                                       .
                                    
                                 
                              
                           

The restriction to each non-trivial interval 
                           [
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                         of the spline space of degree p associated to a knot-vector 
                           Θ
                           =
                           [
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           ]
                         is a subspace of 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                        . We can characterize it explicitly as
                           
                              (1)
                              
                                 
                                    
                                       S
                                    
                                    
                                       Θ
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ]
                                    
                                 
                                 =
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                    
                                       +
                                    
                                 
                                 :
                                 j
                                 ≤
                                 i
                                 }
                                 ∩
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 :
                                 j
                                 ≥
                                 i
                                 +
                                 1
                                 }
                                 ,
                              
                           
                         where
                           
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       p
                                       −
                                       #
                                       {
                                       j
                                       <
                                       i
                                       :
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                              
                           
                         and
                           
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       p
                                       −
                                       #
                                       {
                                       j
                                       >
                                       i
                                       :
                                       
                                          
                                             θ
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 .
                              
                           
                        
                     

Bivariate B-spline functions of degree 
                           p
                           =
                           (
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                           )
                         are defined as a product of two univariate B-splines respectively of degree 
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                        :
                           
                              
                                 B
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                                 [
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 B
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                                 (
                                 x
                                 )
                                 B
                                 [
                                 
                                    
                                       ξ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                                 (
                                 y
                                 )
                                 .
                              
                           
                        
                     


                        
                           Definition 2.4
                           A box in 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                               is a Cartesian product
                                 
                                    
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                       =
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                       ×
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                               where 
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ]
                               is a closed interval (can be empty). Boxes can have different dimensions: 2 for rectangles, 1 for vertical or horizontal edges, 0 for vertexes. The boundary of a box 
                                 η
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                               is
                                 
                                    
                                       ∂
                                       η
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   }
                                                   ×
                                                   [
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                   ∪
                                                   [
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ]
                                                   ×
                                                   {
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   }
                                                
                                                
                                                   dim
                                                   ⁡
                                                   η
                                                   =
                                                   2
                                                
                                             
                                             
                                                
                                                   {
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   ,
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   }
                                                
                                                
                                                   dim
                                                   ⁡
                                                   η
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   ∅
                                                
                                                
                                                   dim
                                                   ⁡
                                                   η
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                               The interior of box η is
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       η
                                       ∖
                                       ∂
                                       η
                                       .
                                    
                                 
                              
                           

Usually boxes are denoted by Greek letters such as 
                           α
                           ,
                           β
                           ,
                           γ
                           ,
                           η
                        .


                        
                           Definition 2.5
                           Let 
                                 Ω
                                 =
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 ×
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ]
                               then a box-mesh 
                              
                                 Q
                               on Ω is a collection of boxes with the following properties. Let 
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 Q
                                 )
                                 =
                                 {
                                 η
                                 ∈
                                 Q
                                 :
                                 dim
                                 ⁡
                                 η
                                 =
                                 k
                                 }
                               then
                                 
                                    1.
                                    they cover Ω:
                                          
                                             
                                                
                                                   ⋃
                                                   
                                                      η
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      Q
                                                      )
                                                   
                                                
                                                η
                                                =
                                                Ω
                                                ;
                                             
                                          
                                       
                                    

boxes of the same dimension do not overlap: 
                                          ∀
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                η
                                             
                                             
                                                2
                                             
                                          
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          Q
                                          )
                                       ,
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                ∅
                                                ;
                                             
                                          
                                       
                                    

the edges are compatible with the rectangles:
                                          
                                             
                                                
                                                   ⋃
                                                   
                                                      η
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Q
                                                      )
                                                   
                                                
                                                η
                                                =
                                                
                                                   ⋃
                                                   
                                                      η
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      Q
                                                      )
                                                   
                                                
                                                ∂
                                                η
                                             
                                          
                                        and 
                                          ∀
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Q
                                          )
                                       , 
                                          
                                             
                                                η
                                             
                                             
                                                2
                                             
                                          
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Q
                                          )
                                       , 
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          ∩
                                          
                                             
                                                η
                                             
                                             
                                                2
                                             
                                          
                                        is either ∅, 
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                        or a vertex;

the vertexes are compatible with the edges:
                                          
                                             
                                                
                                                   ⋃
                                                   
                                                      η
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      (
                                                      Q
                                                      )
                                                   
                                                
                                                η
                                                =
                                                
                                                   ⋃
                                                   
                                                      η
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Q
                                                      )
                                                   
                                                
                                                ∂
                                                η
                                             
                                          
                                        and 
                                          ∀
                                          
                                             
                                                η
                                             
                                             
                                                0
                                             
                                          
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          Q
                                          )
                                       , 
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Q
                                          )
                                       , 
                                          
                                             
                                                η
                                             
                                             
                                                0
                                             
                                          
                                          ∩
                                          
                                             
                                                η
                                             
                                             
                                                1
                                             
                                          
                                        is either ∅ or 
                                          
                                             
                                                η
                                             
                                             
                                                0
                                             
                                          
                                       ;

Due to the difference between 
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                         we need to distinguish between horizontal and vertical edges. Let the sets of horizontal edges be 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 h
                              
                           
                           (
                           Q
                           )
                         and that of vertical edges be 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                           (
                           Q
                           )
                        . The corresponding sets of internal edges are 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 h
                              
                           
                           (
                           Q
                           )
                         and 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 v
                              
                           
                           (
                           Q
                           )
                        .


                        
                           Definition 2.6
                           The valence of 
                                 β
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 Q
                                 )
                               is 
                                 V
                                 (
                                 β
                                 )
                                 =
                                 #
                                 {
                                 α
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Q
                                 )
                                 :
                                 β
                                 ⊂
                                 α
                                 }
                              . For all 
                                 β
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 Q
                                 )
                               its valence is in 
                                 {
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 }
                              .

If 
                                 V
                                 (
                                 β
                                 )
                                 =
                                 2
                               and β is not a corner of Ω then β is said to be a valence 2 T-junction. It can be either horizontal or vertical depending on whether the missing incident edges are horizontal or vertical.

If 
                                 V
                                 (
                                 β
                                 )
                                 =
                                 3
                               then β is said to be a T-junction. It can be either horizontal or vertical depending on whether it misses a horizontal, respectively vertical, incident edge.


                        
                           Definition 2.7
                           The horizontal skeleton of a partition 
                                 Q
                               is
                                 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       Q
                                       )
                                       =
                                       
                                          ⋃
                                          
                                             η
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             Q
                                             )
                                             ∪
                                             
                                                
                                                   F
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             Q
                                             )
                                          
                                       
                                       η
                                       .
                                    
                                 
                               The vertical skeleton is
                                 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       Q
                                       )
                                       =
                                       
                                          ⋃
                                          
                                             η
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                                
                                                   v
                                                
                                             
                                             (
                                             Q
                                             )
                                             ∪
                                             
                                                
                                                   F
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             Q
                                             )
                                          
                                       
                                       η
                                       .
                                    
                                 
                               The skeleton of a partition is
                                 
                                    
                                       
                                          SK
                                       
                                       (
                                       Q
                                       )
                                       =
                                       
                                          
                                             SK
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       Q
                                       )
                                       ∪
                                       
                                          
                                             SK
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       Q
                                       )
                                       .
                                    
                                 
                              
                           

Note that horizontal valence 2 T-junctions correspond to isolated points in 
                           
                              
                                 SK
                              
                              
                                 h
                              
                           
                           (
                           Q
                           )
                        , but are not seen in 
                           
                              SK
                           
                           (
                           Q
                           )
                         as they are contained in some edge. Thus it is impossible to recover 
                           Q
                         from 
                           
                              SK
                           
                           (
                           Q
                           )
                         while it is possible if both 
                           
                              
                                 SK
                              
                              
                                 h
                              
                           
                           (
                           Q
                           )
                         and 
                           
                              
                                 SK
                              
                              
                                 v
                              
                           
                           (
                           Q
                           )
                         are provided.


                        
                           Definition 2.8
                           A maximal horizontal line ℓ for a box-mesh 
                                 Q
                               is a maximal edge (can be degenerate i.e. a vertex) contained in 
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                              . The set of maximal horizontal lines is 
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                              . We define similarly maximal vertical lines and 
                                 
                                    
                                       L
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 Q
                                 )
                              . The set of maximal lines is 
                                 L
                                 (
                                 Q
                                 )
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                                 ∪
                                 
                                    
                                       L
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 Q
                                 )
                              .

Note that maximal lines can either be maximal edges of 
                           
                              SK
                           
                           (
                           Q
                           )
                         that ends with two T-junctions or degenerate edges that correspond to valence 2 T-junctions. Vice versa each T-junction is an extreme of a maximal line and each valence 2 T-junction is a maximal line.


                        
                           Definition 2.9
                           A box-mesh 
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                               is a refinement of 
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                               when they are defined on the same domain, 
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       SK
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       SK
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 )
                              .


                        
                           Definition 2.10
                           Given a box-mesh 
                                 Q
                               and a segment α such that 
                                 ∂
                                 α
                                 ⊂
                                 
                                    SK
                                 
                                 (
                                 Q
                                 )
                               define 
                                 Q
                                 +
                                 α
                               to be the coarsest refinement of 
                                 Q
                               whose skeleton is 
                                 
                                    SK
                                 
                                 (
                                 Q
                                 )
                                 ∪
                                 α
                              . Given a vertex 
                                 β
                                 ⊂
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                                 ∖
                                 
                                    
                                       SK
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 Q
                                 )
                               (respectively 
                                 β
                                 ⊂
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                                 ∖
                                 
                                    
                                       SK
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Q
                                 )
                              ) define 
                                 Q
                                 +
                                 β
                               to be the coarsest refinement of 
                                 Q
                               for which 
                                 
                                    
                                       SK
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 Q
                                 )
                                 ⊃
                                 β
                               (respectively 
                                 
                                    
                                       SK
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 Q
                                 )
                                 ⊃
                                 β
                              ).

When describing a T-spline space we will use three different meshes: the index T-meshes, the extended index T-meshes and the polynomial mesh. All of these are box-meshes. Given a partition 
                           P
                         of Ω in rectangles we canonically associate to it the coarsest box-mesh whose rectangles are in 
                           P
                        . More precisely the mesh defined by
                           
                              
                                 Q
                                 =
                                 {
                                 
                                    
                                       η
                                    
                                    
                                       q
                                    
                                 
                                 :
                                 q
                                 ∈
                                 Ω
                                 }
                                 ,
                              
                           
                         where
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       q
                                    
                                 
                                 =
                                 
                                    ⋂
                                    
                                       
                                          η
                                          ∈
                                          P
                                          ∪
                                          {
                                          ∂
                                          Ω
                                          }
                                          :
                                       
                                       
                                          q
                                          ∈
                                          η
                                       
                                    
                                 
                                 η
                                 .
                              
                           
                         Note that the canonical construction provides always box-meshes that do not have any valence 2 T-junction.

T-spline spaces are usually described in the physical domain. This is not appropriate for our purposes and thus we restrict our description to the index-T-mesh. Index T-meshes are box-meshes whose skeleton is contained in 
                        Z
                        ×
                        Z
                     . They are instrumental in the description of a T-spline space because the generators of the space are associated to topological features of the index-T-mesh: the anchors. More details can be found in Beirão da Veiga et al. (2013).


                     
                        Definition 3.1
                        An index-T-mesh is a pair 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              =
                              (
                              Q
                              ,
                              Ξ
                              )
                            where
                              
                                 1.
                                 
                                    
                                       Q
                                     is a box-mesh on 
                                       Ω
                                       =
                                       [
                                       1
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                       ]
                                       ×
                                       [
                                       1
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             y
                                          
                                       
                                       ]
                                     such that all vertexes 
                                       β
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       Q
                                       )
                                     are contained in 
                                       
                                          
                                             Z
                                          
                                          
                                             2
                                          
                                       
                                     and satisfying
                                       
                                          
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             }
                                             ×
                                             [
                                             1
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             ]
                                             ⊂
                                             
                                                SK
                                             
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             1
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             ]
                                             ×
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             }
                                             ⊂
                                             
                                                SK
                                             
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                             ;
                                          
                                       
                                    
                                 

Ξ is a continuous function 
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                     of the form: 
                                       Ξ
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          (
                                          
                                             
                                                Ξ
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          x
                                          )
                                          ,
                                          
                                             
                                                Ξ
                                             
                                             
                                                y
                                             
                                          
                                          (
                                          y
                                          )
                                          )
                                       
                                    , where 
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       :
                                       R
                                       →
                                       R
                                     are monotone increasing functions such that 
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       [
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                       ]
                                       )
                                     is a 
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    -open knot-vector and 
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       [
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             y
                                          
                                       
                                       ]
                                       )
                                     is a 
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    -open knot-vector.

Since we will never deal with T-meshes in the physical domain we will drop the index specification in the next sections; i.e., by convention we write T-mesh and we mean index-T-mesh. We will use 
                        Q
                      and Ξ as conventional names for the components of all index-T-meshes and they will be specified only when their name differs. We will also use symbols and operations that are defined for box-meshes when dealing with index-T-meshes. In these cases we mean that they are applied to the underlying box-mesh. For instance we will use 
                        
                           
                              F
                           
                           
                              k
                           
                        
                        (
                        
                           
                              M
                           
                           
                              T
                           
                        
                        )
                      instead of 
                        
                           
                              F
                           
                           
                              k
                           
                        
                        (
                        Q
                        )
                     , 
                        
                           SK
                        
                        (
                        
                           
                              M
                           
                           
                              T
                           
                        
                        )
                      instead of 
                        
                           SK
                        
                        (
                        Q
                        )
                      and 
                        
                           
                              M
                           
                           
                              T
                           
                        
                        +
                        α
                      for the index-T-mesh 
                        (
                        Q
                        +
                        α
                        ,
                        Ξ
                        )
                     .


                     
                        Definition 3.2
                        The active region of an index-T-mesh 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            is
                              
                                 
                                    
                                       AR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    
                                       [
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                       ]
                                    
                                    ×
                                    
                                       [
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        


                     
                        Definition 3.3
                        Given an index-T-mesh 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            the corresponding set of anchors is
                              
                                 
                                    A
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                {
                                                η
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                :
                                                η
                                                ⊂
                                                
                                                   AR
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                }
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                 are odd
                                             
                                          
                                          
                                             
                                                {
                                                η
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                :
                                                η
                                                ⊂
                                                
                                                   AR
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                }
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                 even
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                 odd
                                             
                                          
                                          
                                             
                                                {
                                                η
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      v
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                :
                                                η
                                                ⊂
                                                
                                                   AR
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                }
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                 odd
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                 even
                                             
                                          
                                          
                                             
                                                {
                                                η
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                :
                                                η
                                                ⊂
                                                
                                                   AR
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                }
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                 are even
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We also assume the following properties for all index-T-meshes. While the assumptions are not strictly necessary they allow for simpler definitions and reduce the number of special cases. The following assumptions also exclude the possibility that two different index-T-meshes have the same set of anchors.


                     
                        Assumption 3.4
                        
                           
                              
                                 1.
                                 if 
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                     is odd no element contains two horizontal facing T-junctions at the same ordinate (either of valence 2 or 3), similarly if 
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                     is odd no element contains two vertical facing T-junctions at the same abscissa;

if 
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                     is even there is no horizontal valence 2 T-junction, similarly if 
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                     is even there is no vertical valence 2 T-junction;

there is no T-junction η (either of valence 2 or 3) contained in 
                                       Ω
                                       ∖
                                       
                                          AR
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                     except for the extremes of the lines in Definition 3.1.

To each anchor is associated a bivariate B-spline whose local knot-vectors are defined as follows.


                     
                        Definition 3.5
                        Let 
                              η
                              =
                              [
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ]
                              ×
                              [
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ]
                            be an anchor in 
                              A
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                           . The B-spline associated to η is
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          η
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    B
                                    [
                                    
                                       
                                          Ξ
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          x
                                       
                                    
                                    )
                                    ]
                                    [
                                    
                                       
                                          Ξ
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          y
                                       
                                    
                                    )
                                    ]
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                              
                            where 
                              
                                 
                                    I
                                 
                                 
                                    x
                                 
                              
                            is the horizontal local index vector and is defined by
                              
                                 1.
                                 
                                    
                                       ∀
                                       x
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                       
                                    , 
                                       {
                                       x
                                       }
                                       ×
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                       ⊂
                                       
                                          
                                             SK
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    ;


                                    
                                       #
                                       {
                                       x
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                       
                                       :
                                       x
                                       <
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       }
                                       =
                                       #
                                       {
                                       x
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                       
                                       :
                                       x
                                       >
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       }
                                       =
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    ;


                                    
                                       max
                                       ⁡
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       min
                                       ⁡
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                       
                                     is minimal;


                     
                        Definition 3.6
                        The T-spline space associated to an index-T-mesh 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            is
                              
                                 
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                B
                                             
                                             
                                                η
                                             
                                          
                                          }
                                       
                                       
                                          η
                                          ∈
                                          A
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Definition 3.7
                        The polynomial-mesh associated to an index-T-mesh 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            is the coarsest box-mesh 
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                            on 
                              Ξ
                              (
                              Ω
                              )
                            such that for all 
                              f
                              ∈
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                           , 
                              e
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            it holds 
                              f
                              
                                 
                                    |
                                 
                                 
                                    e
                                 
                              
                            is a polynomial in 
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           .

To avoid confusion between the meshes in index space and those in the parameter spaces (index-T-meshes and polynomial-meshes) we use different font styles. The same polynomial-mesh and T-spline space can correspond to many different index-T-meshes. When this happens we say that the index-T-meshes are equivalent. This is formalized in the following definition. 
                        Definition 3.8
                        Two index-T-meshes 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            are equivalent when there exists an invertible map 
                              Θ
                              :
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                            such that
                              
                                 1.
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       {
                                       Θ
                                       (
                                       η
                                       )
                                       :
                                       η
                                       ∈
                                       Q
                                       }
                                    ;


                                    
                                       
                                          AR
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       Θ
                                       (
                                       
                                          AR
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       )
                                    ;


                                    
                                       ∀
                                       η
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    , 
                                       Ξ
                                       (
                                       η
                                       )
                                       =
                                       
                                          
                                             Ξ
                                          
                                          
                                             ′
                                          
                                       
                                       ∘
                                       Θ
                                       (
                                       η
                                       )
                                    .

Conditions 1, 2 imply that there is a one-to-one correspondence of the anchors, and condition 3 implies that the same B-spline is associated to two corresponding anchors. Based on the definition of equivalent index-T-meshes is the definition of refinement of index-T-meshes.


                     
                        Definition 3.9
                        An index-T-mesh 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            is a refinement of 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            when there exists 
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                            equivalent to 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            and such that 
                              
                                 
                                    Q
                                 
                                 
                                    ′
                                 
                              
                            is a refinement of 
                              
                                 
                                    Q
                                 
                                 
                                    ¯
                                 
                              
                           .


                        Analysis-suitable T-meshes are a class of T-meshes for which fundamental properties are guaranteed on the associated T-spline spaces. These are the T-meshes adopted in isogeometric analysis. We need the preliminary concept of extensions of T-junctions.


                        
                           Definition 3.10
                           Let 
                                 ℓ
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                               be a maximal horizontal line in 
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                              . If 
                                 a
                                 ≠
                                 1
                               and 
                                 b
                                 ≠
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                               we define the begin extension beg
                              ℓ and the end extension end
                              ℓ as the horizontal edges (possibly degenerate) with ordinate 
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                               having the following properties:
                                 
                                    1.
                                    the end points of beg
                                       ℓ and end
                                       ℓ are in the mesh skeleton, i.e. 
                                          ∂
                                          beg
                                          
                                          ℓ
                                          ,
                                          ∂
                                          end
                                          
                                          ℓ
                                          ⊂
                                          
                                             
                                                SK
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       ;


                                       
                                          #
                                          {
                                          α
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          +
                                          beg
                                          
                                          ℓ
                                          )
                                          :
                                          α
                                          ⊂
                                          beg
                                          
                                          ℓ
                                          }
                                          =
                                          #
                                          {
                                          α
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          +
                                          end
                                          
                                          ℓ
                                          )
                                          :
                                          α
                                          ⊂
                                          end
                                          
                                          ℓ
                                          }
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       ;

let 
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                        the edges contained in beg
                                       ℓ, then
                                          
                                             
                                                #
                                                {
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                :
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊂
                                                {
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                :
                                                x
                                                ≤
                                                a
                                                }
                                                }
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      2
                                                   
                                                   ⌉
                                                
                                                ;
                                             
                                          
                                       
                                    

let 
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                        the edges contained in end
                                       ℓ, then
                                          
                                             
                                                #
                                                {
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                :
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊂
                                                {
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                :
                                                x
                                                ≥
                                                b
                                                }
                                                }
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      2
                                                   
                                                   ⌉
                                                
                                                .
                                             
                                          
                                       
                                    

Note that the extensions of a maximal line are well defined only under Assumption 3.4. Otherwise more care would be needed for lines whose end points are outside of the active region. In the T-spline literature the extensions are often defined as the union of two pieces: the face extension and the edge extension. This is not needed here.


                        
                           Definition 3.11
                           The extended-mesh associated to an index-T-mesh 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               is the box-mesh 
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                               whose horizontal and vertical skeletons are respectively
                                 
                                    
                                       
                                          
                                             SK
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       =
                                       
                                          ⋃
                                          
                                             ℓ
                                             ∈
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ext
                                       
                                       ℓ
                                       ,
                                       
                                       
                                          
                                             SK
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       =
                                       
                                          ⋃
                                          
                                             ℓ
                                             ∈
                                             
                                                
                                                   L
                                                
                                                
                                                   v
                                                
                                             
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ext
                                       
                                       ℓ
                                       .
                                    
                                 
                              
                           

By construction 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                         does not contain any valence 2 T-junctions.


                        
                           Definition 3.12
                           An index-T-mesh 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               is analysis-suitable when for all pairs of maximal lines 
                                 
                                    
                                       ℓ
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       ℓ
                                    
                                    
                                       v
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               the intersections of their extensions is empty:
                                 
                                    
                                       (
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             h
                                          
                                       
                                       ∪
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             h
                                          
                                       
                                       )
                                       ∩
                                       (
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             v
                                          
                                       
                                       ∪
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             v
                                          
                                       
                                       )
                                       =
                                       ∅
                                       .
                                    
                                 
                               Analysis-suitable index-T-mesh is shortened in AST-mesh.

Contrarily to general T-meshes, AST-meshes provide important guarantees on the associated spline space. For instance the existence of continuous uniformly bounded dual functionals on the set of generators (Beirão da Veiga et al., 2013). This fact has many consequences. Those necessary for our characterization are reported in the following theorem. We refer to Beirão da Veiga et al. (2013) for the proof.


                        
                           Theorem 3.13
                           
                              For all AST-mesh 
                              
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                              
                              , the following hold:
                              
                                 
                                    1.
                                    
                                       the set 
                                       
                                          {
                                          
                                             
                                                B
                                             
                                             
                                                η
                                             
                                          
                                          :
                                          η
                                          ∈
                                          A
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                          }
                                        
                                       is a basis of 
                                       
                                          T
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                       ;
                                    


                                       the polynomial-mesh 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                        
                                       associated to 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                        
                                       is the box-mesh associated to the following partition of 
                                       
                                          Ξ
                                          (
                                          Ω
                                          )
                                       
                                       
                                          
                                             
                                                P
                                                =
                                                {
                                                e
                                                =
                                                Ξ
                                                (
                                                η
                                                )
                                                :
                                                η
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      E
                                                   
                                                
                                                )
                                                 and 
                                                dim
                                                ⁡
                                                e
                                                =
                                                2
                                                }
                                                .
                                             
                                          
                                       
                                    

In this section we will introduce a general framework for the description of piecewise polynomial spaces with linear constrains at the mesh edges. In particular we define constraints that characterize AST-spline spaces. The characterization will be proved in Section 5.


                     
                        Definition 4.1
                        Let 
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                            be a box-mesh on Ω and 
                              J
                            a function from the set of internal edges (i.e. 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                           ) to the set of subspaces of 
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           . Then we define
                              
                                 
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                f
                                                :
                                                Ω
                                                →
                                                R
                                                ,
                                                ∀
                                                e
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                ,
                                                
                                                f
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      e
                                                   
                                                
                                                 is a polynomial in 
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                ,
                                                a
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                :
                                                a
                                                =
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                
                                                f
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                −
                                                f
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ∈
                                                J
                                                (
                                                a
                                                )
                                             
                                          
                                       
                                       }
                                    
                                 
                              
                            where 
                              f
                              
                                 
                                    |
                                 
                                 
                                    e
                                 
                              
                            is the globally defined polynomial that equals f on e.

As an example consider a partition consisting in two rectangles 
                        
                           
                              e
                           
                           
                              1
                           
                        
                        =
                        [
                        −
                        1
                        ,
                        0
                        ]
                        ×
                        [
                        0
                        ,
                        1
                        ]
                      and 
                        
                           
                              e
                           
                           
                              2
                           
                        
                        =
                        [
                        0
                        ,
                        1
                        ]
                        ×
                        [
                        0
                        ,
                        1
                        ]
                      and let 
                        Q
                      be the associated box-mesh. Then 
                        
                           
                              F
                           
                           
                              1
                           
                           
                              I
                           
                        
                        (
                        Q
                        )
                      contains only 
                        a
                        =
                        {
                        0
                        }
                        ×
                        [
                        0
                        ,
                        1
                        ]
                     . With the choice 
                        J
                        (
                        a
                        )
                        =
                        
                           
                              P
                           
                           
                              p
                           
                        
                      the space 
                        S
                        (
                        Q
                        ,
                        J
                        )
                      is the space of discontinuous piecewise polynomials. On the other extreme for 
                        J
                        (
                        a
                        )
                        =
                        {
                        0
                        }
                      we obtain the space of global polynomials on 
                        [
                        −
                        1
                        ,
                        1
                        ]
                        ×
                        [
                        0
                        ,
                        1
                        ]
                     . The space of 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      piecewise polynomial is obtained by setting 
                        J
                        (
                        a
                        )
                        =
                        {
                        ψ
                        (
                        x
                        ,
                        y
                        )
                        ∈
                        
                           
                              P
                           
                           
                              p
                           
                        
                        :
                        ψ
                        (
                        0
                        ,
                        y
                        )
                        =
                        0
                        }
                        =
                        {
                        x
                        ψ
                        (
                        x
                        ,
                        y
                        )
                        :
                        ψ
                        ∈
                        
                           
                              P
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              −
                              1
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              )
                           
                        
                        }
                     . Higher order 
                        
                           
                              C
                           
                           
                              k
                           
                        
                      smoothness across a can be expressed by 
                        J
                        (
                        a
                        )
                        =
                        {
                        ψ
                        (
                        x
                        ,
                        y
                        )
                        ∈
                        
                           
                              P
                           
                           
                              p
                           
                        
                        :
                        
                           
                              ψ
                           
                           
                              (
                              s
                              )
                           
                        
                        (
                        0
                        ,
                        y
                        )
                        =
                        0
                        ,
                        ∀
                        s
                        ≤
                        k
                        }
                        =
                        {
                        
                           
                              x
                           
                           
                              k
                              +
                              1
                           
                        
                        ψ
                        (
                        x
                        ,
                        y
                        )
                        :
                        ψ
                        ∈
                        
                           
                              P
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              −
                              k
                              −
                              1
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              )
                           
                        
                        }
                     . Conditions that do not correspond to 
                        
                           
                              C
                           
                           
                              k
                           
                        
                      smoothness can be obtained with different choices of 
                        J
                      and will be used to characterize 
                        T
                        (
                        
                           
                              M
                           
                           
                              T
                           
                        
                        )
                     .

In this section we associate a map 
                           J
                         to an AST-mesh 
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                         in such a way that 
                           T
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                           =
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                        . The proof of the equality in Section 5 is the main result in this paper. We compute 
                           J
                         for some AST-meshes in Section 6.

Remember form Theorem 3.13 that for AST-meshes the polynomial-mesh 
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                         is obtained by mapping the extended-mesh 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                         through Ξ. When defining 
                           J
                         on edges of 
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                         we will consider the set of edges of 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                         whose image through Ξ contains it. More in detail we start by associating the polynomial space 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           (
                           α
                           )
                         to every pair 
                           (
                           α
                           ,
                           ℓ
                           )
                         with 
                           α
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         and 
                           ℓ
                           ∈
                           L
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                        . Then we define 
                           J
                           (
                           a
                           )
                         for 
                           a
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         by combining all the spaces associated to pairs 
                           (
                           α
                           ,
                           ℓ
                           )
                         with 
                           Ξ
                           (
                           α
                           )
                           ⊃
                           a
                         in a way that mimics the multiplicity of knots in the knot-vector.

We need to use pairs because an edge 
                           α
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         can be contained in the extension of many extended maximal lines. The simplest example is when two T-junctions face one another at the same ordinate as in the following picture.
                           
                              
                           
                        
                     

More complex example can be drawn. In general the maximal number of horizontal maximal lines 
                           
                              
                                 ℓ
                              
                              
                                 i
                              
                           
                         such that extℓ contains a given edge α depends on the degree and is 
                           ⌊
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 2
                              
                              2
                           
                           ⌋
                        . The limit case for 
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           =
                           5
                         is illustrated in the following picture where the horizontal span of each extended maximal lines is highlighted by a corresponding line at a lower ordinate.
                           
                              
                           
                        
                     

Given a horizontal maximal line 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         we define an auxiliary function 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           :
                           {
                           α
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                           }
                           →
                           {
                           subspaces of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           }
                        . Similarly to each vertical maximal line 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         we associate 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           :
                           {
                           α
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 v
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                           }
                           →
                           {
                           subspaces of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                              
                           
                           }
                        .


                        
                           Definition 4.2
                           Let 
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                              , 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                                 ,
                                 …
                                 ,
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                              , with 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              , be the vertexes of 
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                               contained in extℓ and 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                               be edge in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               between 
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                               and 
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                              . Let 
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       Θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ]
                              . Then for all 
                                 α
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                              
                              
                                 
                                    (2)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   {
                                                   0
                                                   }
                                                
                                                
                                                   α
                                                   ⊄
                                                   
                                                      ext
                                                   
                                                   ℓ
                                                   ∨
                                                   dim
                                                   ⁡
                                                   Ξ
                                                   (
                                                   α
                                                   )
                                                   <
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                                
                                                   α
                                                   =
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∧
                                                   dim
                                                   ⁡
                                                   Ξ
                                                   (
                                                   α
                                                   )
                                                   =
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                               where 
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                               is 
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       B
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       ]
                                       (
                                       x
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                              . We define similarly 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                               for vertical lines.

From the above definition it follows that
                           
                              (3)
                              
                                 {
                                 0
                                 }
                                 ⊊
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊊
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⇔
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⊂
                                 (
                                 beg
                                 
                                 ℓ
                                 ∪
                                 end
                                 
                                 ℓ
                                 )
                                 .
                              
                           
                        
                     

When there is only an edge 
                           α
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         such that 
                           Ξ
                           (
                           α
                           )
                           ⊃
                           a
                         we are describing the jump of T-spline functions through a multiplicity one mesh line, thus the jump is contained in
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 }
                              
                           
                         and more precisely in
                           
                              
                                 
                                    ∑
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 α
                                 )
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 }
                              
                           
                         When more edges α of 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         are mapped onto the same a then the jump of the polynomial expression of a T-spline across a can have lower order in 
                           (
                           y
                           −
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           )
                        . For instance in the tensor product case the jump of the polynomial expression of the T-space generators across a is contained in
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       1
                                       −
                                       k
                                    
                                 
                                 :
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 μ
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                                 .
                              
                           
                         In our setting the problem is complicated by the fact that we want to be sharp in order to characterize the space. Thus we want to count different multiplicity for different subspaces of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                        . To achieve this we first prove that given 
                           a
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         we can express all the 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           (
                           α
                           )
                         with 
                           Ξ
                           (
                           α
                           )
                           ⊃
                           a
                         as generated by a subset of common basis. In this way we can associate the multiplicity to the elements of the common basis and obtain a coherent definition of 
                           J
                           (
                           a
                           )
                        .


                        
                           Lemma 4.3
                           
                              Let 
                              
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               
                              be an AST-mesh and 
                              
                                 a
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               
                              be an edge. Let 
                              
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               
                              be the edges such that 
                              
                                 Ξ
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊃
                                 a
                              
                              . Then there exists a basis Ψ of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               
                              such that for all 
                              
                                 ℓ
                                 ∈
                                 L
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               
                              and 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ℓ
                                             ,
                                             k
                                          
                                       
                                    
                                 
                               
                              where 
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                               
                              is a subset of Ψ. Similarly for a vertical edge 
                              
                                 g
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               
                              and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       m
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               
                              there exists a basis Φ of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               
                              such that for all 
                              
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               
                              and 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             ℓ
                                             ,
                                             k
                                          
                                       
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                                 ⊂
                                 Φ
                              
                              .
                           


                        
                           Proof
                           The proof is detailed for a horizontal 
                                 a
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                              .

For many pairs 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 ℓ
                                 )
                               the choice of Ψ is not relevant. This is the case of 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⊄
                                 ℓ
                               and 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⊂
                                 ℓ
                                 ∖
                                 (
                                 beg
                                 
                                 ℓ
                                 ∪
                                 end
                                 
                                 ℓ
                                 )
                               that correspond respectively to 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 {
                                 0
                                 }
                               and 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                              .

For each ℓ and 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⊂
                                 beg
                                 
                                 ℓ
                                 ∪
                                 end
                                 
                                 ℓ
                               the space 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                               is the restriction to 
                                 [
                                 a
                                 ,
                                 b
                                 ]
                               of the spline space 
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                               where 
                                 
                                    
                                       Θ
                                    
                                    
                                       ℓ
                                    
                                 
                               is the knot-vector described in Definition 4.2. Using the characterization in Equation (1) of the restriction of spline spaces we deduce that 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                               depends only on the knots corresponding to vertexes lying in the extensions of ℓ that contain 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                              . Let 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               be the knot-vector containing these knots.

The existence of Ψ is implied by the fact that all the 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               overlap i.e. that there exists a knot-vector Θ such that all the 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               are formed by consecutive knots of Θ and 
                                 
                                    
                                       S
                                    
                                    
                                       Θ
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                              . We prove this property by contradiction.

Assume there are two maximal lines 
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                               in 
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               for which 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               does not overlap with 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              . Then 
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                               cannot have the same ordinate. Otherwise the vertexes contained in the intersection of the extensions would be the same. Since 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               does not overlap with 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               then either there exists an internal knot (Definition 2.1) 
                                 
                                    
                                       θ
                                    
                                    
                                       ¯
                                    
                                 
                               in 
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               with 
                                 
                                    
                                       m
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 <
                                 
                                    
                                       m
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               or vice versa. In the first case it follows that there is a vertex in 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               contained in 
                                 
                                    ext
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                               and corresponding to 
                                 
                                    
                                       θ
                                    
                                    
                                       ¯
                                    
                                 
                               that is not vertically aligned with any vertex contained in 
                                 
                                    ext
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              . This is impossible because this vertex is on a horizontal extension and thus cannot be on any vertical extension. Since 
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 [
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 )
                               is a 
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                              -open knot-vector (Definition 3.1) there are at most 
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                               integers in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               and thus there is not enough space for a vertical extension (
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                               vertexes) to be contained in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 a
                                 )
                                 ∖
                                 (
                                 
                                    ext
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 
                                    ext
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              . It follows that there is a corresponding vertex contained in 
                                 
                                    ext
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              . Similarly in the other case.

From the above reasoning it follows that Θ can be constructed by taking the image by 
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                               of the abscissa of the vertical lines that intersect the extensions of horizontal lines ℓ such that 
                                 Ξ
                                 (
                                 
                                    ext
                                 
                                 ℓ
                                 )
                                 ⊃
                                 a
                               and then completing it to a 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              -open knot-vector. Other choices of Θ are possible and will be used to guarantee additional properties of the common basis. □

We will use the notation of Lemma 4.3 as a convention. Given a horizontal edge 
                           a
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         we will call 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 n
                              
                           
                         the edges in 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         whose images contain a. Ψ will be used for common basis associated to horizontal edges, 
                           
                              
                                 Ψ
                              
                              
                                 ℓ
                                 ,
                                 k
                              
                           
                         as its subset that generates 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           )
                        . Similarly given a vertical edge 
                           g
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         we will call 
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 γ
                              
                              
                                 m
                              
                           
                         the edges in 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         whose image contains g. Φ will be the name of common basis associated to vertical edges, 
                           
                              
                                 Φ
                              
                              
                                 ℓ
                                 ,
                                 k
                              
                           
                         its subset that generates 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           (
                           
                              
                                 γ
                              
                              
                                 k
                              
                           
                           )
                        . We also define 
                           
                              
                                 Ψ
                              
                              
                                 k
                              
                           
                           ⊂
                           Ψ
                         and 
                           
                              
                                 Φ
                              
                              
                                 k
                              
                           
                           ⊂
                           Φ
                         by
                           
                              (6)
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    ⋃
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    ⋃
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                                 .
                              
                           
                        
                     

Note that in Equations (6) and (7) the unions are disjoint. Consider 
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                         and two horizontal lines 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         and let 
                           
                              
                                 Θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 2
                              
                           
                         are the knot-vectors from Definition 4.2. If there is a basis 
                           ψ
                           ∈
                           
                              
                                 Ψ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 k
                              
                           
                           ∩
                           
                              
                                 Ψ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 k
                              
                           
                         it follows that the knots in the local-knot-vector of ψ are contained in both 
                           
                              
                                 Θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 2
                              
                           
                        . Thus the corresponding 
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           +
                           2
                         vertexes are contained in both 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                         and 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         and thus (since the extensions contain 
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           +
                           1
                         vertexes) 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         are not disjoint and are the same maximal line. It follows that for all 
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                           ∈
                           Ψ
                        
                        
                           
                              
                                 #
                                 {
                                 (
                                 ℓ
                                 ,
                                 k
                                 )
                                 :
                                 
                                    
                                       Ψ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                                 ∋
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 =
                                 #
                                 {
                                 k
                                 :
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                                 ∋
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 ,
                              
                           
                         and similarly for all 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           ∈
                           Φ
                        
                        
                           
                              
                                 #
                                 {
                                 (
                                 ℓ
                                 ,
                                 k
                                 )
                                 :
                                 
                                    
                                       Φ
                                    
                                    
                                       ℓ
                                       ,
                                       k
                                    
                                 
                                 ∋
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 =
                                 #
                                 {
                                 k
                                 :
                                 
                                    
                                       Φ
                                    
                                    
                                       k
                                    
                                 
                                 ∋
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 .
                              
                           
                         The above remark justify the following definition.


                        
                           Definition 4.4
                           Let 
                                 a
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                              , 
                                 Ψ
                                 =
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 }
                               and 
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                                 ⊂
                                 Ψ
                               as in Equation (6) then
                                 
                                    (8)
                                    
                                       J
                                       (
                                       a
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   ψ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             x
                                             )
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   t
                                                
                                             
                                             }
                                          
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ;
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ≥
                                             t
                                             ≥
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             −
                                             #
                                             {
                                             k
                                             :
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   k
                                                
                                             
                                             ∋
                                             
                                                
                                                   ψ
                                                
                                                
                                                   i
                                                
                                             
                                             }
                                          
                                       
                                       .
                                    
                                 
                               Similarly for 
                                 g
                                 =
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                                 ×
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                       ,
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               define
                                 
                                    (9)
                                    
                                       J
                                       (
                                       g
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             y
                                             )
                                             }
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ≥
                                             s
                                             ≥
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             −
                                             #
                                             {
                                             k
                                             :
                                             
                                                
                                                   Φ
                                                
                                                
                                                   k
                                                
                                             
                                             ∋
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   j
                                                
                                             
                                             }
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Note that for all 
                           a
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         the dimension of 
                           J
                           (
                           a
                           )
                         equals the sum of the dimensions of the 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                           (
                           α
                           )
                        , more precisely if
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 {
                                 (
                                 α
                                 ,
                                 ℓ
                                 )
                                 :
                                 α
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 Ξ
                                 (
                                 α
                                 )
                                 ⊃
                                 a
                                 ,
                                 
                                 ℓ
                                 ∈
                                 L
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 }
                              
                           
                         then
                           
                              (10)
                              
                                 dim
                                 ⁡
                                 J
                                 (
                                 a
                                 )
                                 =
                                 
                                    ∑
                                    
                                       (
                                       α
                                       ,
                                       ℓ
                                       )
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 α
                                 )
                                 .
                              
                           
                         Indeed, assuming a is horizontal, 
                           dim
                           ⁡
                           J
                           (
                           a
                           )
                         would be smaller only if for some i 
                        
                           #
                           {
                           k
                           :
                           
                              
                                 Ψ
                              
                              
                                 k
                              
                           
                           ∋
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                           }
                           >
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                           +
                           1
                        . This is impossible because there are at most 
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                           +
                           1
                         integers in 
                           
                              
                                 Ξ
                              
                              
                                 y
                              
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           )
                        .

We now provide a dimension formula for spaces of the form 
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                        . We follow the approach introduced by Billera (1988) in order to study the dimension of spline spaces on triangular meshes. Mourrain and Pettersen extended Billera theory to rectangular elements (and higher dimension cubes) (Mourrain, 2014; Pettersen, 2013). In this paper we further extend the theory in order to represent the more general smoothness conditions that are needed to deal with AST-spline spaces. In the resulting formula there are homological terms that we prove to be 0 our case, i.e. when 
                           J
                         is defined from and AST-mesh as in Definition 4.4. To study the dimension of 
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                         we construct a set of auxiliary vector spaces, linear maps, and then use homological techniques.

The first step is to define, for 
                           i
                           ∈
                           Z
                         the vector space
                           
                              (11)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       p
                                    
                                 
                                 ⊗
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                                 ≅
                                 
                                    ⨁
                                    
                                       η
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       p
                                    
                                 
                                 .
                              
                           
                         Thus an element of 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         is a vector of polynomials in 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                         in which each component corresponds to a box in 
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                        . It follows that 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         is {0} for 
                           i
                           >
                           2
                         or 
                           i
                           <
                           0
                        . Equivalently it is possible to think of an element of 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         as a mapping from 
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         to 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                        . This justify our abuse of the restriction operator to indicate the component corresponding to a rectangle, edge or vertex. For instance, given 
                           f
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , 
                           f
                           
                              
                                 |
                              
                              
                                 e
                              
                           
                         is the polynomial component of f corresponding to the rectangle e. Similarly given 
                           g
                           ∈
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        , 
                           g
                           
                              
                                 |
                              
                              
                                 a
                              
                           
                         is the polynomial corresponding to the edge a.


                        
                           Definition 4.5
                           The boundary operator 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                               is the linear operator defined on the basis by
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                          
                                       
                                       ψ
                                       ⊗
                                       e
                                       =
                                       
                                          ∑
                                          
                                             
                                                a
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                :
                                             
                                             
                                                a
                                                ⊂
                                                e
                                             
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                             ,
                                             a
                                          
                                       
                                       ψ
                                       ⊗
                                       a
                                       ,
                                    
                                 
                               where 
                                 e
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                              , 
                                 ψ
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       p
                                    
                                 
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                       ,
                                       a
                                    
                                 
                               is either 1 or −1 depending on the orientation. Let 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                    
                                 
                               be the lowest dimensional affine subspace of 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                               containing e and 
                                 
                                    
                                       H
                                    
                                    
                                       a
                                    
                                 
                               be that containing a. Let n be the outward normal of e on a inside 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                    
                                 
                              . Let 
                                 
                                    
                                       K
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                               be the ordered tuples of the canonical basis of 
                                 
                                    
                                       H
                                    
                                    
                                       a
                                    
                                 
                               and 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                    
                                 
                              . Then the 
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                       ,
                                       a
                                    
                                 
                               is 1 when 
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 n
                                 )
                               is oriented as 
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                              , −1 otherwise.

The linear operator 
                           
                              
                                 δ
                              
                              
                                 2
                              
                           
                         associates to an element of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         the element of 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         having in each internal edge the difference between the polynomials associated to the two adjacent rectangles. Similarly 
                           
                              
                                 δ
                              
                              
                                 1
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         gives at each vertex the sum of the differences between the polynomials associated to the vertical and horizontal edges.

Let consider again a partition of Ω in two rectangles 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         on the left and 
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                         on the right with 
                           a
                           =
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                        . In this case 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         contains a single edge a and 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         is isomorphic to 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                        . Given 
                           f
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         then 
                           
                              
                                 δ
                              
                              
                                 2
                              
                           
                           f
                         is
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       a
                                    
                                 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       a
                                    
                                 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 −
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Indeed since a is vertical we have to control the orientation of 
                           (
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           n
                           )
                        . The outward normal of 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         is 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         and thus 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 a
                              
                           
                           =
                           −
                           1
                         because 
                           (
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           )
                         has the opposite orientation of 
                           (
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           )
                        . The outward normal of 
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                         is instead 
                           −
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         and thus 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 a
                              
                           
                           =
                           1
                         because 
                           (
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           −
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           )
                         is oriented as 
                           (
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           )
                        . A complete description of the maps δ can be extrapolated from its definition on the following mesh.
                           
                              
                           
                         In this case they hold:
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ⊗
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 ⊗
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       3
                                    
                                 
                                 ⊗
                                 
                                    
                                       e
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 ⊗
                                 
                                    
                                       e
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊗
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ⊗
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ⊗
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⊗
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ⊗
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 ⊗
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       3
                                    
                                 
                                 ⊗
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 ⊗
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ψ
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 ⊗
                                 b
                                 .
                              
                           
                        
                     

An important property is that 
                           
                              
                                 δ
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ∘
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                           
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           =
                           {
                           0
                           }
                        , that is, the sequence of spaces 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         and maps 
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                         form a complex. The only non-trivial case is for 
                           i
                           =
                           2
                        , that is 
                           
                              
                                 δ
                              
                              
                                 1
                              
                           
                           ∘
                           
                              
                                 δ
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           =
                           {
                           0
                           }
                        . Consider a rectangle 
                           e
                           ∈
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         and a vertex 
                           b
                           ⊂
                           ∂
                           e
                        . Let a and g be the two edges contained in 
                           ∂
                           e
                         and containing b. Then
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 f
                                 ⊗
                                 e
                                 )
                                 
                                    
                                       |
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                       ,
                                       a
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       a
                                       ,
                                       b
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                       ,
                                       g
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       g
                                       ,
                                       b
                                    
                                 
                                 )
                                 f
                                 .
                              
                           
                         When a and g are aligned then 
                           
                              
                                 σ
                              
                              
                                 e
                                 ,
                                 a
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 e
                                 ,
                                 g
                              
                           
                        . Moreover 
                           
                              
                                 σ
                              
                              
                                 a
                                 ,
                                 b
                              
                           
                           =
                           −
                           
                              
                                 σ
                              
                              
                                 g
                                 ,
                                 b
                              
                           
                         and thus 
                           
                              
                                 δ
                              
                              
                                 1
                              
                           
                           ∘
                           
                              
                                 δ
                              
                              
                                 2
                              
                           
                           (
                           f
                           ⊗
                           e
                           )
                           
                              
                                 |
                              
                              
                                 b
                              
                           
                           =
                           0
                        . Otherwise b is a vertex of e and the four cases can be checked explicitly.

We adopt the standard notation:
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 …
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                                 …
                              
                           
                         where 
                           
                              
                                 R
                              
                              
                                 ⁎
                              
                           
                         denotes the whole complex. We associate the conditions expressed by 
                           J
                         to a subspace 
                           
                              
                                 J
                              
                              
                                 1
                              
                           
                         of 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        :
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 J
                                 (
                                 a
                                 )
                                 ⊗
                                 a
                                 .
                              
                           
                         We then build a sub-complex 
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                         of 
                           
                              
                                 R
                              
                              
                                 ⁎
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 …
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                                 …
                              
                           
                         where
                           
                              (12)
                              
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   a
                                                   ∈
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   )
                                                
                                             
                                             J
                                             (
                                             a
                                             )
                                             ⊗
                                             a
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   b
                                                   ∈
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      a
                                                      ∈
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            P
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      b
                                                      ⊂
                                                      a
                                                   
                                                
                                             
                                             J
                                             (
                                             a
                                             )
                                             ⊗
                                             b
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             {
                                             0
                                             }
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                         Since 
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                         is a sub-complex it is possible to take the quotient complex
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 …
                                 
                                    ⟶
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    ⟶
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                                 …
                              
                           
                         where
                           
                              (13)
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 /
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         is the map induced by 
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                         on the equivalence classes.

With this construction 
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                        , 
                           
                              
                                 R
                              
                              
                                 ⁎
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                         form a short exact sequence of complexes 
                           0
                           →
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 ⁎
                              
                           
                           →
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           →
                           0
                        . This means that the following diagram commutes and that for 
                           i
                           =
                           2
                           ,
                           1
                           ,
                           0
                         it holds 
                           ker
                           ⁡
                           
                              
                                 π
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 ι
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                           )
                        .
                           
                              
                           
                        
                     

Since 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ≅
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , we have the following important identifications
                           
                              (14)
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 ,
                                 J
                                 )
                                 ≅
                                 {
                                 g
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 :
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 g
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 }
                                 ≅
                                 ker
                                 ⁡
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≅
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           )
                         is the 2-th homology group for 
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                        , and in general the i-th homology group of a complex 
                           
                              
                                 C
                              
                              
                                 ⁎
                              
                           
                         is
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ker
                                       ⁡
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

From the commutative diagram above (with exact columns), a standard homology result is that the following long homology sequence is exact (see for example Spanier, 1981):
                           
                              (15)
                              
                           
                        
                     

Some of the homology groups in the long sequence are explicitly known: since 
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                           =
                           {
                           0
                           }
                        , then
                           
                              (16)
                              
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 {
                                 0
                                 }
                                 ;
                              
                           
                         moreover, the homology of 
                           
                              
                                 R
                              
                              
                                 ⁎
                              
                           
                         can be computed as in Dokken et al. (2013) (the assumption is that the domain Ω is simply connected, which is our case)
                           
                              (17)
                              
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       P
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 {
                                 0
                                 }
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 {
                                 0
                                 }
                                 .
                              
                           
                        
                     

From (15), and (18)–(19) we get 
                           {
                           0
                           }
                           →
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           )
                           →
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                           )
                           →
                           {
                           0
                           }
                        , that is,
                           
                              (20)
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ;
                              
                           
                         similarly, from (15) and (19) we have 
                           {
                           0
                           }
                           →
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 ⁎
                              
                           
                           )
                           →
                           {
                           0
                           }
                        , that is
                           
                              (21)
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 ≅
                                 {
                                 0
                                 }
                                 .
                              
                           
                         Another homological result is
                           
                              (22)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    2
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       i
                                    
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    2
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       i
                                    
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 .
                              
                           
                         In conclusion, using (14), (22) and then (20)–(21) we have
                           
                              (23)
                              
                                 
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    dim
                                    ⁡
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                              
                                 
                                    
                                       dim
                                       ⁡
                                       S
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       ,
                                       J
                                       )
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    dim
                                    ⁡
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           
                         In order to use (23) for computing 
                           dim
                           ⁡
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                         we need to evaluate 
                           dim
                           ⁡
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                           )
                        . We now prove that 
                           dim
                           ⁡
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                           )
                           =
                           0
                         when 
                           J
                         is defined as in Definition 4.4.

The homology group is by definition
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ker
                                       ⁡
                                       
                                          
                                             δ
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         and thus its elements are classes of elements of 
                           
                              
                                 J
                              
                              
                                 0
                              
                           
                         corresponding to the equivalence relation
                           
                              
                                 a
                                 ≈
                                 b
                                 ⇔
                                 a
                                 −
                                 b
                                 ∈
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

To prove that the homology is trivial (
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 J
                              
                              
                                 ⁎
                              
                           
                           )
                           =
                           {
                           0
                           }
                        ) we will use some relations between the polynomial spaces involved in the definition of 
                           
                              
                                 J
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 J
                              
                              
                                 0
                              
                           
                        . In order to unify the treatment for all type of vertexes (valence 4, 3 and 2) we define some generic symbols and extend the definition of 
                           J
                         to 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                           ∪
                           {
                           ∅
                           }
                         by setting 
                           J
                           (
                           ∅
                           )
                           =
                           {
                           0
                           }
                        .


                        
                           Definition 4.6
                           Given 
                                 b
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               let 
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               be respectively the edges in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               in the position described by the following scheme. If the corresponding edge does not exist in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                              , we define them to be ∅.
                                 
                                    
                                 
                              
                           

Remember from the definition of 
                           
                              
                                 J
                              
                              
                                 0
                              
                           
                         (Equation (12)) that
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       1
                                    
                                 
                                 )
                                 +
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       1
                                    
                                 
                                 )
                                 +
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                                 +
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                         The above can be refined as stated in the following proposition.


                        
                           Proposition 4.7
                           
                              For all 
                              
                                 b
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               
                              it holds
                              
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

The proof of this proposition for general AST-meshes is reported in Appendix A. Here we only show a simpler proof for AST-meshes without repeated lines i.e. such that 
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 Ξ
                              
                              
                                 y
                              
                           
                         are strictly monotone on the active region.


                        
                           Proof for AST-meshes without repeated lines
                           In this case there is a one-to-one correspondence between the boxes of the polynomial-mesh 
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                               and those of the extended mesh 
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                              . Let β be the preimage of b, for 
                                 i
                                 =
                                 1
                                 ,
                                 2
                               let 
                                 
                                    
                                       α
                                    
                                    
                                       β
                                       ,
                                       i
                                    
                                 
                               be the preimage of 
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       β
                                       ,
                                       i
                                    
                                 
                               be that of 
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       i
                                    
                                 
                              . Consider an 
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               and the corresponding 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       β
                                       ,
                                       2
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       β
                                       ,
                                       1
                                    
                                 
                                 )
                               that are subspaces of 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                              . From the description of 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                               as a restriction of a spline space (see Definition 4.2 and Equation (1)) it follows that
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             β
                                             ,
                                             1
                                          
                                       
                                       )
                                       ⊂
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             β
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       }
                                       .
                                    
                                 
                               Moreover since the lines are single lines then
                                 
                                    
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          (
                                          
                                             ∑
                                             
                                                ℓ
                                                ∈
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                ℓ
                                             
                                          
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                β
                                                ,
                                                2
                                             
                                          
                                          )
                                          )
                                       
                                       ⊗
                                       {
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       }
                                       .
                                    
                                 
                               Merging the two results above gives
                                 
                                    
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                       ⊂
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       }
                                       ,
                                    
                                 
                               and by symmetry
                                 
                                    
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                       ⊂
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       }
                                       .
                                    
                                 
                               From the fact that the mesh is analysis suitable it follows that either 
                                 
                                    
                                       α
                                    
                                    
                                       β
                                       ,
                                       2
                                    
                                 
                               or 
                                 
                                    
                                       γ
                                    
                                    
                                       β
                                       ,
                                       2
                                    
                                 
                               is not contained in any extension. Without loss of generality we can assume that 
                                 
                                    
                                       α
                                    
                                    
                                       β
                                       ,
                                       2
                                    
                                 
                               is not contained in any extension. This is equivalent to 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 }
                               and implies both of the following:
                                 
                                    •
                                    
                                       
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                1
                                             
                                          
                                          )
                                          ⊂
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                       ;


                                       
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          ∋
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                y
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                        and thus
                                          
                                             
                                                J
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                +
                                                J
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      b
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                ⊃
                                                J
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      b
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                +
                                                span
                                                {
                                                
                                                   
                                                      (
                                                      x
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      y
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                
                                                }
                                                ⊃
                                                J
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      b
                                                      ,
                                                      1
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    


                        
                           Theorem 4.8
                           
                              For all AST-mesh 
                              
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               
                              the homology of the 
                              
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                               
                              complex is
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       =
                                       {
                                       0
                                       }
                                    
                                 
                               
                              and thus the dimension formula in Equation 
                              (23) 
                              simplifies to
                              
                                 
                                    (24)
                                    
                                       dim
                                       ⁡
                                       S
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       ,
                                       J
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          
                                             (
                                             −
                                             1
                                             )
                                          
                                          
                                             i
                                          
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           The proof is inductive and based on an ordering of the vertexes of 
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                               from bottom to top and from left to right. Let 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               then we say that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ⪯
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                               when there exist 
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               such that
                                 
                                    •
                                    
                                       
                                          
                                             
                                                ⋃
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                        is a polygonal path with extremes 
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                        and 
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       ;

for 
                                          i
                                          <
                                          j
                                        and any two points 
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          ∈
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                       , 
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                        
                                       
                                          x
                                          ≤
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          ∧
                                          y
                                          ≤
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                       ; i.e. when going from 
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                        to 
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                        following the 
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                        the direction is always up or right.

Now, given 
                                 ρ
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                               let 
                                 Z
                                 (
                                 ρ
                                 )
                               be the set of internal vertexes on which ρ is null and that precede by the above relation the support of ρ:
                                 
                                    
                                       Z
                                       (
                                       ρ
                                       )
                                       =
                                       
                                          
                                             {
                                             b
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   0
                                                
                                                
                                                   I
                                                
                                             
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   P
                                                
                                             
                                             )
                                             :
                                             ρ
                                             |
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       0
                                       ∧
                                       ∄
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                       :
                                       ρ
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       ≠
                                       0
                                       ∧
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ≺
                                       b
                                       }
                                       .
                                    
                                 
                              
                           

Consider 
                                 ρ
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                               be given and let 
                                 b
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               be a minimal vertex for ⪯ such that 
                                 ρ
                                 
                                    
                                       |
                                    
                                    
                                       b
                                    
                                 
                                 ≠
                                 0
                              . By Lemma 4.7 there exist 
                                 
                                    
                                       ϕ
                                    
                                    
                                       a
                                    
                                 
                                 ∈
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       g
                                    
                                 
                                 ∈
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               such that
                                 
                                    
                                       ρ
                                       
                                          
                                             |
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             a
                                          
                                       
                                       +
                                       
                                          
                                             ϕ
                                          
                                          
                                             g
                                          
                                       
                                       .
                                    
                                 
                               Thus setting
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       ρ
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             a
                                          
                                       
                                       ⊗
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ϕ
                                          
                                          
                                             g
                                          
                                       
                                       ⊗
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                    
                                 
                               it follows
                                 
                                    
                                       Z
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⊃
                                       Z
                                       (
                                       ρ
                                       )
                                       ∪
                                       {
                                       b
                                       }
                                       .
                                    
                                 
                              
                           

We have shown that all 
                                 ρ
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                              , 
                                 ρ
                                 ≠
                                 0
                              , are equivalent to a 
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                               such that 
                                 Z
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊋
                                 Z
                                 (
                                 ρ
                                 )
                               and thus with 
                                 Z
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       ′
                                    
                                 
                                 )
                               containing more vertexes. Since the number of vertexes is finite and ≈ is transitive then all 
                                 ρ
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       0
                                    
                                 
                               are equivalent to 0 and thus 
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 {
                                 0
                                 }
                              . □

In this section we prove the main result of the paper. Namely the following characterization theorem.


                     
                        Theorem 5.1
                        
                           For all AST-meshes 
                           
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            
                           it holds
                           
                              
                                 (25)
                                 
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    ,
                                 
                              
                            
                           where 
                           
                              J
                            
                           is defined in 
                           
                              Definition 4.4
                           
                           .
                        

We begin by proving the following inclusion 
                        Lemma 5.2
                        
                           Let 
                           
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                            
                           be an AST-mesh, then
                           
                              
                                 (26)
                                 
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    ⊂
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        Consider an element 
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            of the basis of 
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                           , where η is the corresponding anchor. Let 
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              =
                              [
                              
                                 
                                    θ
                                 
                                 
                                    x
                                    ,
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    x
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    2
                                 
                              
                              ]
                            be the horizontal local-knot-vector of 
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            and 
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              =
                              [
                              
                                 
                                    θ
                                 
                                 
                                    y
                                    ,
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    y
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    2
                                 
                              
                              ]
                            be its vertical local-knot-vector. A vertical line 
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                            corresponds to each horizontal knot 
                              
                                 
                                    θ
                                 
                                 
                                    x
                                    ,
                                    i
                                 
                              
                            (see the definition of local index vector Definition 3.5). Since the T-mesh is analysis-suitable (Definition 3.12), using Beirão da Veiga et al. (2013, Lemma 3.2.(c)) we also have 
                              [
                              
                                 
                                    θ
                                 
                                 
                                    y
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    y
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    2
                                 
                              
                              ]
                              ⊂
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              (
                              
                                 ext
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                              )
                           . This is enough to conclude that for all the 
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                            and 
                              γ
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    I
                                    ,
                                    v
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                              )
                           , 
                              γ
                              ⊂
                              
                                 ext
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                            it holds
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    γ
                                    )
                                    ⊃
                                    span
                                    
                                    
                                       
                                          {
                                          B
                                          [
                                          
                                             
                                                θ
                                             
                                             
                                                y
                                                ,
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                y
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          ]
                                          |
                                       
                                       
                                          
                                             
                                                Ξ
                                             
                                             
                                                y
                                             
                                          
                                          (
                                          γ
                                          )
                                       
                                    
                                    }
                                    .
                                 
                              
                            This implies, counting the multiplicities, that for all 
                              g
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            contained in 
                              supp
                              
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            the jump of polynomial definition of 
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            through g is in 
                              J
                              (
                              g
                              )
                           . Since that holds for all vertical and (by symmetry) horizontal edges we conclude that 
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            is in 
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                           . Since it holds for all 
                              
                                 
                                    B
                                 
                                 
                                    η
                                 
                              
                            then the thesis holds. □

The proof of the characterization is completed by showing that
                        
                           (27)
                           
                              dim
                              ⁡
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                              =
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                              .
                           
                        
                      In order to prove that the two dimension are equal it is necessary to prove that
                        
                           (28)
                           
                              dim
                              ⁡
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                              =
                              #
                              A
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                              =
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 2
                              
                              
                                 
                                    (
                                    −
                                    1
                                    )
                                 
                                 
                                    i
                                 
                              
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      This is done in two steps by introducing a subset 
                        E
                        (
                        
                           
                              M
                           
                           
                              E
                           
                        
                        )
                      of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                        (
                        
                           
                              M
                           
                           
                              E
                           
                        
                        )
                      and proving the two following equalities
                        
                           (29)
                           
                              #
                              E
                              (
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                              )
                              =
                              #
                              A
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                           
                        
                      and
                        
                           (30)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 2
                              
                              
                                 
                                    (
                                    −
                                    1
                                    )
                                 
                                 
                                    i
                                 
                              
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              =
                              #
                              E
                              (
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                              )
                              .
                           
                        
                      A subsection is dedicated to each of the above equalities.


                     
                        Definition 5.3
                        We say that a vertex 
                              β
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                              )
                            is effective for a line 
                              ℓ
                              ∈
                              L
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            if
                              
                                 
                                    β
                                    ∈
                                    
                                       ext
                                    
                                    ℓ
                                    ∖
                                    end
                                    
                                    ℓ
                                    .
                                 
                              
                            We say that β is horizontally effective when there exists 
                              
                                 
                                    ℓ
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            such that β is effective for 
                              
                                 
                                    ℓ
                                 
                                 
                                    h
                                 
                              
                           . We say that β is vertically effective when there exists 
                              
                                 
                                    ℓ
                                 
                                 
                                    v
                                 
                              
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    v
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            such that β is effective for 
                              
                                 
                                    ℓ
                                 
                                 
                                    v
                                 
                              
                           . We say that β is effective when it is both horizontally and vertically effective and it is contained in 
                              [
                              1
                              ,
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              ]
                              ×
                              [
                              1
                              ,
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              ]
                           .

The condition of being contained in 
                        [
                        1
                        ,
                        
                           
                              n
                           
                           
                              x
                           
                        
                        −
                        
                           
                              p
                           
                           
                              x
                           
                        
                        ]
                        ×
                        [
                        1
                        ,
                        
                           
                              n
                           
                           
                              y
                           
                        
                        −
                        
                           
                              p
                           
                           
                              y
                           
                        
                        ]
                      is necessary because of the lack of a proper extensions of the lines outside the active region. Without this constrain there would be spurious effective vertexes near the corners.

Note that if 
                        β
                        ∈
                        
                           
                              F
                           
                           
                              0
                           
                        
                        (
                        
                           
                              M
                           
                           
                              E
                           
                        
                        )
                      is contained in a horizontal extension then it must be vertically effective because it cannot be contained in any vertical extension. Similarly if β is contained in a vertical extension it must be horizontally effective. As a consequence all vertexes are either horizontally or vertically effective and also the following holds
                        
                           (31)
                           
                              β
                              ∈
                              beg
                              
                              ℓ
                              ∖
                              end
                              
                              ℓ
                              ⇒
                              β
                               is effective
                              .
                           
                        
                     
                  


                     
                        Definition 5.4
                        We define the following set of effective vertexes:
                              
                                 (32)
                                 
                                    E
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          E
                                       
                                    
                                    )
                                    =
                                    {
                                    β
                                    ∈
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          E
                                       
                                    
                                    )
                                    :
                                    β
                                     is effective
                                    }
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    {
                                    β
                                    ∈
                                    E
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          E
                                       
                                    
                                    )
                                    :
                                    β
                                     is effective for 
                                    ℓ
                                    }
                                    .
                                 
                              
                           
                        


                        
                           Definition 5.5
                           To every anchor 
                                 η
                                 =
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 ×
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ]
                                 ∈
                                 A
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               we associate its bottom left corner
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             η
                                          
                                       
                                       =
                                       {
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       }
                                       .
                                    
                                 
                              
                           

Note that to different anchors 
                           
                              
                                 η
                              
                              
                                 1
                              
                           
                           ≠
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ∈
                           A
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         corresponds different vertexes 
                           
                              
                                 β
                              
                              
                                 
                                    
                                       η
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ≠
                           
                              
                                 β
                              
                              
                                 
                                    
                                       η
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . Using vertexes associated to anchors instead of the anchors allows us to write an argument that is independent of the degree p.


                        
                           Definition 5.6
                           We define the following two sets of vertexes associated to anchors:
                                 
                                    (34)
                                    
                                       B
                                       A
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       =
                                       {
                                       
                                          
                                             β
                                          
                                          
                                             η
                                          
                                       
                                       :
                                       η
                                       ∈
                                       A
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       }
                                    
                                 
                              
                              
                                 
                                    (35)
                                    
                                       B
                                       
                                          
                                             A
                                          
                                          
                                             ℓ
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             β
                                          
                                          
                                             η
                                          
                                       
                                       :
                                       η
                                       ∈
                                       A
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             β
                                          
                                          
                                             η
                                          
                                       
                                       ⊂
                                       ℓ
                                       }
                                       .
                                    
                                 
                              
                           

The two sets 
                           B
                           
                              
                                 A
                              
                              
                                 ℓ
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 ℓ
                              
                           
                         for a horizontal line ℓ and different degrees p are represented in Fig. 2
                        . The figure is designed in order to highlight the differences between the two sets.

A vertex 
                           
                              
                                 β
                              
                              
                                 η
                              
                           
                           ∈
                           B
                           A
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         is always contained in a unique line 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                        . Thus 
                           B
                           A
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         is the disjoint union on 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         of 
                           B
                           
                              
                                 A
                              
                              
                                 ℓ
                              
                           
                        . Similarly 
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         is the disjoint union on 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         of 
                           
                              
                                 E
                              
                              
                                 ℓ
                              
                           
                        . It is thus possible to write the difference in cardinality as a sum over the horizontal lines.
                           
                              (36)
                              
                                 #
                                 A
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 −
                                 #
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 #
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 −
                                 #
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 #
                                 (
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∖
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 −
                                 #
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∖
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 )
                              
                           
                        
                     

It is possible to decompose 
                           B
                           
                              
                                 A
                              
                              
                                 ℓ
                              
                           
                           ∖
                           
                              
                                 E
                              
                              
                                 ℓ
                              
                           
                         in two disjoint sets
                           
                              (37)
                              
                                 (
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∖
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 ∪
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 ∩
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 ∅
                                 ,
                              
                           
                         where 
                           
                              
                                 D
                              
                              
                                 end
                                 
                                 ℓ
                              
                              
                                 +
                              
                           
                         contains the vertexes contained in end
                        ℓ and 
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                              
                                 +
                              
                           
                         those that are effective for ℓ, but not effective
                           
                              (38)
                              
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 {
                                 β
                                 ∈
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 :
                                 β
                                 ⊂
                                 end
                                 
                                 ℓ
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 {
                                 β
                                 ∈
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 :
                                 β
                                 ⊄
                                 end
                                 
                                 ℓ
                                 ∧
                                 β
                                 ∉
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 }
                                 .
                              
                           
                         Similarly we split 
                           
                              
                                 E
                              
                              
                                 ℓ
                              
                           
                           ∖
                           B
                           
                              
                                 A
                              
                              
                                 ℓ
                              
                           
                         in two disjoint sets
                           
                              (40)
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∖
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 ∪
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 ∩
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 ∅
                                 ,
                              
                           
                         where
                           
                              (41)
                              
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 {
                                 β
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 :
                                 β
                                 ⊂
                                 beg
                                 
                                 ℓ
                                 ∖
                                 ℓ
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 {
                                 β
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                 
                                 :
                                 β
                                 ⊂
                                 ℓ
                                 ∧
                                 β
                                 ∉
                                 B
                                 
                                    
                                       A
                                    
                                    
                                       ℓ
                                    
                                 
                                 }
                                 .
                              
                           
                         Note for all 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         the vertexes in 
                           
                              
                                 D
                              
                              
                                 end
                                 
                                 ℓ
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 beg
                                 
                                 ℓ
                              
                              
                                 −
                              
                           
                         are in bijection: the leftmost vertex of 
                           
                              
                                 D
                              
                              
                                 beg
                                 
                                 ℓ
                              
                              
                                 −
                              
                           
                         is 
                           max
                           ⁡
                           {
                           k
                           +
                           (
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           
                           
                              mod
                           
                           
                           2
                           )
                           ,
                           
                              ⌈
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 2
                              
                              ⌉
                           
                           }
                         edges to the left of the leftmost vertex in 
                           
                              
                                 D
                              
                              
                                 end
                                 
                                 ℓ
                              
                              
                                 +
                              
                           
                        , where k is the number of edges of 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                         contained in ℓ. In particular
                           
                              (43)
                              
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 min
                                 ⁡
                                 
                                    {
                                    k
                                    +
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    
                                    
                                       mod
                                    
                                    
                                    2
                                    )
                                    ,
                                    
                                       ⌈
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          2
                                       
                                       ⌉
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Using Equations (36), (37), (40) and (43) we rewrite 
                           #
                           A
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                           −
                           #
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         as
                           
                              (44)
                              
                                 #
                                 A
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 −
                                 #
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 .
                              
                           
                         Since the 
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                              
                                 −
                              
                           
                         are disjoint, then
                           
                              
                                 #
                                 A
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 −
                                 #
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 =
                                 #
                                 
                                    (
                                    
                                       ⋃
                                       
                                          ℓ
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          ℓ
                                       
                                       
                                          +
                                       
                                    
                                    )
                                 
                                 −
                                 #
                                 
                                    (
                                    
                                       ⋃
                                       
                                          ℓ
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          ℓ
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Let 
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                           =
                           
                              
                                 ⋃
                              
                              
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                           =
                           
                              
                                 ⋃
                              
                              
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                              
                                 −
                              
                           
                        , we want to prove that 
                           #
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                           =
                           #
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                        . The vertexes in 
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                         can either be contained in the area near the corners
                           
                              (45)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 (
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 ]
                                 ∪
                                 [
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 ]
                                 )
                                 ×
                                 (
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                                 ]
                                 ∪
                                 [
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 )
                              
                           
                         or in the vertical stripe
                           
                              (46)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 1
                                 ]
                                 ×
                                 [
                                 1
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 .
                              
                           
                        
                     

The number of vertexes in 
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                         contained in 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         does not depend on the AST-mesh but only on the degree. The following table details the number of vertexes of 
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                         contained in the regions near the corners of Ω:
                           
                              
                                 
                                 
                                 
                                    
                                       Area
                                       
                                          
                                             #
                                             
                                                
                                                   D
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ]
                                             ×
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             ]
                                          
                                       
                                       0
                                    
                                    
                                       
                                          
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ]
                                             ×
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                             
                                                ⌊
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌋
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             ]
                                             ×
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                ⌊
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌋
                                             
                                             
                                                ⌊
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌋
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             ]
                                             ×
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                ⌊
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌋
                                             
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             )
                                             −
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The corresponding table for 
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                         is:
                           
                              
                                 
                                 
                                 
                                    
                                       Area
                                       
                                          
                                             #
                                             
                                                
                                                   D
                                                
                                                
                                                   −
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ]
                                             ×
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             ]
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             )
                                             −
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             ]
                                             ×
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             ]
                                          
                                       
                                       0
                                    
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             ]
                                             ×
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             ]
                                          
                                       
                                       0
                                    
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             ]
                                             ×
                                             [
                                             1
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             ]
                                          
                                       
                                       0
                                    
                                    
                                       
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             1
                                             )
                                             −
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It follows that
                           
                              
                                 #
                                 {
                                 β
                                 ∈
                                 
                                    
                                       D
                                    
                                    
                                       +
                                    
                                 
                                 :
                                 β
                                 ⊂
                                 
                                    
                                       Ω
                                    
                                    
                                       C
                                    
                                 
                                 }
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 
                                    
                                       D
                                    
                                    
                                       −
                                    
                                 
                                 :
                                 β
                                 ⊂
                                 
                                    
                                       Ω
                                    
                                    
                                       C
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

We group the vertexes of 
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                         contained in 
                           
                              
                                 Ω
                              
                              
                                 S
                              
                           
                         by their abscissa. Let
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 {
                                 β
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 y
                                 )
                                 }
                                 ∈
                                 
                                    
                                       D
                                    
                                    
                                       +
                                    
                                 
                                 }
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 {
                                 β
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 y
                                 )
                                 }
                                 ∈
                                 
                                    
                                       D
                                    
                                    
                                       −
                                    
                                 
                                 }
                                 .
                              
                           
                         We prove that for all 
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                           ∈
                           [
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           +
                           2
                           ,
                           
                              
                                 n
                              
                              
                                 x
                              
                           
                           −
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           −
                           1
                           ]
                         the sets 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 −
                              
                           
                         have the same cardinality:
                           
                              (47)
                              
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 .
                              
                           
                         From this it follows 
                           #
                           {
                           β
                           ∈
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                           :
                           β
                           ⊂
                           
                              
                                 Ω
                              
                              
                                 S
                              
                           
                           }
                           =
                           #
                           {
                           β
                           ∈
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                           :
                           β
                           ⊂
                           
                              
                                 Ω
                              
                              
                                 S
                              
                           
                           }
                         and thus 
                           #
                           
                              
                                 D
                              
                              
                                 +
                              
                           
                           =
                           #
                           
                              
                                 D
                              
                              
                                 −
                              
                           
                         and thus 
                           #
                           A
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                           =
                           #
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                        .

Our proof is based on the fact that all the vertexes in 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 −
                              
                           
                         are contained in vertical extensions (see Fig. 2). Let 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ℓ
                              
                              
                                 k
                              
                              
                                 v
                              
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         be the maximal vertical lines at 
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                        . 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 +
                              
                           
                         contains the vertexes associated to anchors that are not vertically effective. Thus it contains all the vertexes associated to the anchors that are contained in a vertical end extension, but not contained in any vertical begin extension:
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    ⋃
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          end
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                    ∖
                                    
                                       ⋃
                                       
                                          j
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          D
                                       
                                       
                                          beg
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          −
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The union inside the parenthesis is a disjoint union as a vertex can be vertically effective for a unique vertical line. Thus the cardinality of 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 +
                              
                           
                         is
                           
                              
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                       =
                                       1
                                    
                                    k
                                 
                                 #
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 ∩
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             j
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 .
                              
                           
                         Similarly 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 −
                              
                           
                         contains all the effective vertexes contained in vertical begin extensions but not contained in any vertical line (non-extended) and thus not in 
                           
                              
                                 D
                              
                              
                                 end
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 +
                              
                           
                         for any i:
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    ⋃
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          beg
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          −
                                       
                                    
                                    ∖
                                    
                                       ⋃
                                       
                                          j
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          D
                                       
                                       
                                          end
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Again the union inside the parenthesis is a disjoint union as a vertex can only be contained in a single vertical line. Thus remembering that 
                           #
                           
                              
                                 D
                              
                              
                                 beg
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 −
                              
                           
                           =
                           #
                           
                              
                                 D
                              
                              
                                 end
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 +
                              
                           
                         (Equation (43)) and setting 
                           I
                           =
                           {
                           1
                           ,
                           …
                           ,
                           k
                           }
                         it follows
                           
                              
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                       ∈
                                       I
                                    
                                 
                                 #
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 ∩
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             j
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                       ∈
                                       I
                                    
                                 
                                 #
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       beg
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       −
                                    
                                 
                                 ∩
                                 
                                    
                                       D
                                    
                                    
                                       end
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             j
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 #
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 .
                              
                           
                         This completes the proof of 
                           #
                           A
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                           =
                           #
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                        .

In order to understand the link between the dimension formula in Equation (24) and the effective vertexes of the extended mesh it is appropriate to rewrite the dimension formula as a sum over the internal vertexes of the polynomial-mesh. This is achieved by using the following three facts:
                           
                              1.
                              
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          e
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                             
                                                I
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                          )
                                       
                                    
                                    dim
                                    ⁡
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          e
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                             
                                                I
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          dim
                                          ⁡
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                       
                                          e
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 ;


                                 
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   b
                                                   ,
                                                   2
                                                
                                             
                                          
                                       
                                       ∩
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   b
                                                   ,
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                 ;


                                 
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    −
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    +
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    =
                                    1
                                 .

Using the aboves we can rewrite 
                           dim
                           ⁡
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                         as a sum of terms depending only on the dimensions of the components of 
                           
                              
                                 J
                              
                              
                                 1
                              
                           
                        .
                           
                              (48)
                              
                                 dim
                                 ⁡
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 ,
                                 J
                                 )
                                 =
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 )
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                                 )
                                 #
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                                 −
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                          
                                             I
                                             ,
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 
                                    [
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    1
                                    )
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          a
                                       
                                    
                                    ]
                                 
                                 −
                                 
                                    ∑
                                    
                                       g
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                          
                                             I
                                             ,
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 
                                    [
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    1
                                    )
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          g
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 
                                    [
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    1
                                    )
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    ]
                                 
                                 =
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 )
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                                 )
                                 
                                    (
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    −
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    +
                                    #
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    )
                                    )
                                 
                                 +
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 
                                    (
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                       ∖
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                       ∖
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                       
                                       )
                                    
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          )
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          1
                                          )
                                       
                                       ︸
                                    
                                    
                                       
                                          P
                                       
                                       
                                          v
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      I
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                          dim
                                          ⁡
                                          
                                             (
                                             
                                                
                                                   J
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         b
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                             
                                             ∩
                                             
                                                
                                                   J
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         b
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       ︸
                                    
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                ∖
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      I
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                          dim
                                          ⁡
                                          
                                             
                                                J
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    
                                       
                                          P
                                       
                                       
                                          a
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                                ∖
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      I
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                          dim
                                          ⁡
                                          
                                             
                                                J
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      b
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    
                                       
                                          P
                                       
                                       
                                          g
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Note that in 
                           
                              
                                 P
                              
                              
                                 a
                              
                           
                         we are actually considering only the internal horizontal edges that touch the left boundary of 
                           Ξ
                           (
                           Ω
                           )
                        . Similarly in 
                           
                              
                                 P
                              
                              
                                 g
                              
                           
                         we are considering the vertical edges that touch the bottom boundary of 
                           Ξ
                           (
                           Ω
                           )
                        .

We prove the following equalities
                           
                              (49)
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 ]
                                 ×
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                                 ]
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       P
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 ]
                                 ×
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (51)
                              
                                 
                                    
                                       P
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 ]
                                 ×
                                 [
                                 1
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 1
                                 ]
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                    
                                       P
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 ]
                                 ×
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 }
                                 ,
                              
                           
                         that together imply 
                           dim
                           ⁡
                           S
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           ,
                           J
                           )
                           =
                           
                              
                                 
                                    P
                                 
                                 
                                    v
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    a
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    g
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    b
                                 
                              
                           
                           =
                           #
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                        . Equation (49) follows from the fact that all vertexes in the area are effective. The proof of Equations (50) and (51) are in Lemma 5.7 and the proof of (52) is in Lemma 5.10.


                        
                           Lemma 5.7
                           
                              Equations 
                              (50) 
                              and 
                              (51) 
                              hold.
                           


                        
                           Proof
                           As usual we only detail the horizontal case: Equation (50). Recall Equation (10)
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       dim
                                       ⁡
                                       J
                                       (
                                       a
                                       )
                                       =
                                       
                                          ∑
                                          
                                             ℓ
                                             ,
                                             α
                                          
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                    
                                 
                               where 
                                 ℓ
                                 ∈
                                 L
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               and 
                                 α
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       I
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               is such that 
                                 Ξ
                                 (
                                 α
                                 )
                                 ⊃
                                 a
                              . It is thus sufficient to prove that for each ℓ
                              
                                 
                                    (53)
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                       =
                                       #
                                       {
                                       β
                                       ⊂
                                       [
                                       1
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       ]
                                       ×
                                       [
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       2
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             y
                                          
                                       
                                       ]
                                       :
                                       β
                                        is effective for 
                                       ℓ
                                       }
                                       .
                                    
                                 
                               From Equation (1) we deduce that 
                                 dim
                                 ⁡
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 α
                                 )
                               is 
                                 min
                                 ⁡
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 }
                                 +
                                 min
                                 ⁡
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 }
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                               where 
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                               is the number of vertexes in extℓ on the left of α and 
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                               the number of those on the right of α (including the extremes of α). Since a touches the left boundary of 
                                 Ξ
                                 (
                                 Ω
                                 )
                               then 
                                 α
                                 =
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 ,
                                 b
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 }
                               and thus
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                       =
                                       
                                          
                                             v
                                          
                                          
                                             l
                                          
                                       
                                       +
                                       min
                                       ⁡
                                       {
                                       
                                          
                                             v
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       }
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       .
                                    
                                 
                               On the other hand the leftmost 
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                               vertexes contained in extℓ are effective for ℓ and this proves the thesis. □

Before the proof of Equation (52) we recall Definition 4.4 and present an interesting case that simplifies it. Consider an edge 
                           a
                           =
                           [
                           a
                           ,
                           b
                           ]
                           ×
                           {
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           }
                         in 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         and let 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 n
                              
                           
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         be the edges in 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 I
                                 ,
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         such that 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           )
                           ⊃
                           a
                        . Let Ψ be the common basis associated to a and 
                           
                              
                                 Ψ
                              
                              
                                 k
                              
                           
                         as in Equation (6) be the subset of Ψ corresponding to the edge 
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                        :
                           
                              
                                 span
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       ℓ
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 .
                              
                           
                         Then according to Definition 4.4:
                           
                              
                                 J
                                 (
                                 a
                                 )
                                 =
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       ;
                                       
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       ≥
                                       t
                                       ≥
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       1
                                       −
                                       #
                                       {
                                       k
                                       :
                                       
                                          
                                             Ψ
                                          
                                          
                                             k
                                          
                                       
                                       ∋
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 .
                              
                           
                         When the 
                           
                              
                                 Ψ
                              
                              
                                 i
                              
                           
                         are ordered by inclusion, i.e.
                           
                              (54)
                              
                                 i
                                 ≥
                                 j
                                 
                                 ⇒
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       i
                                    
                                 
                                 ⊃
                                 
                                    
                                       Ψ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         we can rename 
                           
                              
                                 Ψ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Ψ
                              
                              
                                 n
                              
                           
                         to 
                           
                              
                                 Ψ
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Ψ
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                              
                           
                         (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                           +
                           1
                           −
                           n
                        ) and rewrite Definition 4.4 as
                           
                              (55)
                              
                                 J
                                 (
                                 a
                                 )
                                 =
                                 
                                    ∑
                                    
                                       t
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    (
                                    span
                                    
                                    
                                       
                                          Ψ
                                       
                                       
                                          t
                                       
                                    
                                    ⊗
                                    span
                                    {
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          t
                                       
                                    
                                    }
                                    )
                                 
                                 .
                              
                           
                         Our proof of Equation (52) relies on the validity of Equation (54) for both the 
                           
                              
                                 Ψ
                              
                              
                                 k
                              
                           
                         corresponding to 
                           
                              
                                 a
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                         and the 
                           
                              
                                 Φ
                              
                              
                                 k
                              
                           
                         corresponding to 
                           
                              
                                 g
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                        , where b is an internal vertex of 
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                        . This condition is not satisfied in general, but we will show that can be assumed for a vertex at a time.


                        
                           Definition 5.8
                           Let 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               be an AST-mesh, 
                                 b
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               be the edges in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               such that 
                                 Ξ
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               be the edges in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               such that 
                                 Ξ
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                              . Let Ψ be the common basis of 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               associated to a as in Lemma 4.3, Φ be the common basis associated to g, and 
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                              , 
                                 
                                    
                                       Φ
                                    
                                    
                                       k
                                    
                                 
                               as in Equations (6) and (7). Then 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               is said to be canonical for 
                              b when the following hold:
                                 
                                    1.
                                    
                                       
                                          i
                                          ≥
                                          j
                                          ⇒
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                             
                                          
                                          ⊃
                                          
                                             
                                                Ψ
                                             
                                             
                                                j
                                             
                                          
                                       , and thus 
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             span
                                             
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   t
                                                
                                             
                                             ⊗
                                             span
                                             {
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   t
                                                
                                             
                                             }
                                             )
                                          
                                       ;


                                       
                                          i
                                          ≥
                                          j
                                          ⇒
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          ⊃
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                          
                                       , and thus 
                                          J
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                s
                                                =
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             span
                                             {
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             }
                                             ⊗
                                             span
                                             
                                             
                                                
                                                   Φ
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                          
                                       .

A mesh is thus canonical for 
                           b
                           =
                           {
                           (
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           )
                           }
                           ∈
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         when the spaces associated to the edges 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 α
                              
                              
                                 n
                              
                           
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         such that 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           )
                           ⊃
                           
                              
                                 a
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                         correspond to the decomposition of 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                           )
                         based on the divisibility order with respect of 
                           (
                           y
                           −
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           )
                         and, at the same time, the spaces associated to the edges 
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 γ
                              
                              
                                 m
                              
                           
                           ∈
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                         such that 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           )
                           ⊃
                           
                              
                                 g
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                         correspond to the decomposition of 
                           J
                           (
                           
                              
                                 g
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                           )
                         based on the divisibility order with respect of 
                           (
                           x
                           −
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                           )
                        . In general an AST-mesh is not canonical for any vertex but given 
                           b
                           ∈
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                         we can modify 
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                         into a canonical mesh for b, while preserving 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                           )
                        , 
                           J
                           (
                           
                              
                                 g
                              
                              
                                 b
                                 ,
                                 2
                              
                           
                           )
                         and 
                           #
                           {
                           β
                           ∈
                           E
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                           :
                           β
                           ⊂
                           
                              
                                 Ξ
                              
                              
                                 −
                                 1
                              
                           
                           (
                           b
                           )
                           }
                        .


                        
                           Lemma 5.9
                           
                              For every AST-mesh 
                              
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 (
                                 Q
                                 ,
                                 Ξ
                                 )
                               
                              and vertex 
                              
                                 b
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               
                              there exists an AST-mesh 
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 Ξ
                                 )
                               
                              such that:
                              
                                 
                                    1.
                                    
                                       
                                          b
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                             
                                                I
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                        
                                       and 
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                        
                                       is canonical for b;
                                    


                                       
                                          J
                                          (
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                        
                                       for the mesh 
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                        
                                       equals 
                                       
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                        
                                       for 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                       
                                       ;
                                    


                                       
                                          J
                                          (
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                        
                                       for the mesh 
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                        
                                       equals 
                                       
                                          J
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                        
                                       for 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                       
                                       ;
                                    


                                       
                                          #
                                          {
                                          β
                                          ∈
                                          E
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                E
                                             
                                          
                                          )
                                          :
                                          β
                                          ⊂
                                          
                                             
                                                Ξ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          b
                                          )
                                          }
                                          =
                                          #
                                          {
                                          β
                                          ∈
                                          E
                                          (
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                E
                                             
                                          
                                          )
                                          :
                                          β
                                          ⊂
                                          
                                             
                                                Ξ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          b
                                          )
                                          }
                                       
                                       .
                                    


                        
                           Proof
                           We obtain 
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                               by a sequence of modification of 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                              . Both the number of effective vertexes contained in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               and the spaces 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               and 
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               depend on a subset of the maximal lines of 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                              . Thus the purpose of the first modifications is to simplify the mesh and allow the following modifications.


                              Step 1: Let 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                               the set of lines whose extension intersects 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               and 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                               be the set of lines not in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                               that intersect the extensions of the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                              :
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       {
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       :
                                       
                                          ext
                                       
                                       ℓ
                                       ∩
                                       
                                          
                                             Ξ
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       b
                                       )
                                       ≠
                                       ∅
                                       }
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       {
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       ∖
                                       
                                          
                                             L
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       :
                                       ∃
                                       
                                          
                                             ℓ
                                          
                                          
                                             ˆ
                                          
                                       
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             b
                                          
                                       
                                       :
                                       
                                          ext
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             ˆ
                                          
                                       
                                       ∩
                                       ℓ
                                       ≠
                                       ∅
                                       }
                                       .
                                    
                                 
                               We prolong the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                               till the span the whole domain. We can now remove all lines that are not in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                                 ∪
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                              . Equivalently we can start from the coarsest tensor product mesh whose skeleton contains the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                               and add the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                              . With these operations we obtain a mesh that have the same structure around 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                              , but that is simpler elsewhere. Note that the extension of the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                               can be modified, but only if the considered extension does not intersect 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                              , and thus the quantities in 2, 3, 4 are preserved.


                              Step 2: We simplify the mesh further by removing the lines 
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                               such that 
                                 Ξ
                                 (
                                 
                                    ext
                                 
                                 ℓ
                                 )
                                 ⊅
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 ∧
                                 Ξ
                                 (
                                 
                                    ext
                                 
                                 ℓ
                                 )
                                 ⊅
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                              . Indeed their intersection with 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               is contained in their end extension and thus no vertex can be effective for them, nor they do influence the spaces 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               and 
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                              .


                              Step 3: We prolong the remaining lines in order to reduce the number of extensions intersecting 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                              . If 
                                 ℓ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               and 
                                 Ξ
                                 (
                                 end
                                 
                                 ℓ
                                 )
                                 ⊅
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               then we can prolong ℓ to the right till 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    ⌈
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    ⌉
                                 
                              . If 
                                 Ξ
                                 (
                                 beg
                                 
                                 ℓ
                                 )
                                 ⊅
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               then beg
                              ℓ reach the left boundary of 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               and thus prolonging ℓ to the left till 
                                 1
                                 +
                                 
                                    ⌈
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    ⌉
                                 
                               does not change the set of vertexes contained in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               that are effective for ℓ. By doing the same to vertical lines we have thus reduced 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               to a simpler mesh where all the extensions are either contained in the preimage of the boundary or are such that their images contain either 
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               or 
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                              .


                              Step 4: We reorder the lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                              : move horizontal lines ℓ that contains a vertex in 
                                 (
                                 ℓ
                                 ∖
                                 (
                                 beg
                                 
                                 ℓ
                                 ∪
                                 end
                                 
                                 ℓ
                                 )
                                 )
                                 ∩
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               (and thus can intersect a vertical extensions) towards the top, similarly we move vertical lines that can intersect horizontal extensions toward the right. Let 
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               be the ordinates of the horizontal lines in 
                                 
                                    
                                       L
                                    
                                    
                                       b
                                    
                                 
                              . Let 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               be the abscissa of the rightmost vertex 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                                 ⊂
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               that is contained in an edge 
                                 α
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               that is not contained in any horizontal extensions; −∞ if such vertex does not exist. We can rearrange the horizontal lines in such a way that the map 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               is monotone non-decreasing. First moving to the bottom the lines at 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              , i such that 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 ∞
                               gives an AST-mesh that preserve the required quantities. Indeed the definition of 
                                 J
                               does not depend on the order, since 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 ∞
                               all the vertexes with ordinate 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                               are also contained in horizontal extensions and (consequently) all vertical extensions are contained in 
                                 {
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 :
                                 y
                                 >
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 }
                               thus the number of effective vertexes contained in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               does not change nor intersections between horizontal and vertical extensions are introduced. Second swapping the ordinates of two set of lines at different ordinates 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 <
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                              , 
                                 i
                                 ,
                                 j
                               such that 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                               also preserves the required quantities. Indeed all the vertical extensions reaching below 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                               are at an abscissa that is strictly less then 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              . Thus it is not possible to introduce intersections between horizontal and vertical extensions. The effectivity of vertexes 
                                 β
                                 =
                                 {
                                 (
                                 a
                                 ,
                                 b
                                 )
                                 }
                               with 
                                 a
                                 ≥
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               depends only on the horizontal effectivity as they cannot be contained in any vertical extension. Thus after the reordering they are swapped as the group of lines. The effectivity of vertexes 
                                 β
                                 =
                                 {
                                 (
                                 a
                                 ,
                                 b
                                 )
                                 }
                               with 
                                 a
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               is not altered by swapping the lines as it depends only on the vertical effectivity (they are not contained in horizontal extensions). We reorder vertical lines in a similar way.


                              Step 5: The last step is to modify the lines in order to obtain a canonical mesh for b. Let 
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               be the edges such that 
                                 Ξ
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               be their ordinate. Recalling Lemma 4.3 we can construct a basis 
                                 Ψ
                                 =
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 }
                               of 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               such that for all 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               and 
                                 ℓ
                                 ∈
                                 L
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               it holds 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 α
                                 )
                                 =
                                 span
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       ℓ
                                    
                                 
                               where 
                                 
                                    
                                       Ψ
                                    
                                    
                                       ℓ
                                    
                                 
                               is a subset of Ψ. The construction in Lemma 4.3 is to define 
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                               to be the restriction of 
                                 B
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                               to 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                               where 
                                 Θ
                                 =
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                               is a suitable knot vector such that 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ]
                               is the horizontal span of 
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                              . Here we define Θ to be the image by 
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                               of the abscissas of some of the vertical lines. The abscissas are denoted again 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              , but they are not related to those in Step 4. Let 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                               be the abscissa of the vertical lines that intersect 
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                               in a point outside of their extensions; 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       1
                                    
                                 
                               be those of the nearest vertical lines on the left of 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       2
                                    
                                 
                               those of the nearest vertical lines on the right of 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                              . By building Θ using only abscissas of vertical lines setting
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                               we obtain a canonical basis Ψ for which the following are equivalent
                                 
                                    (56)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ∋
                                       
                                          
                                             ψ
                                          
                                          
                                             k
                                          
                                       
                                       ⇔
                                       
                                          ext
                                       
                                       ℓ
                                       ⊃
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             k
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       ]
                                       ×
                                       {
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       }
                                       ⇔
                                       ℓ
                                       ⊃
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             k
                                             +
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             k
                                             +
                                             
                                                ⌈
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                                ⌉
                                             
                                          
                                       
                                       ]
                                       ×
                                       {
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       }
                                       ⇔
                                       {
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       }
                                        is horizontally effective for 
                                       ℓ
                                       .
                                    
                                 
                               Then the mesh is not canonical if and only if there are 
                                 i
                                 <
                                 j
                               and k such that
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         ψ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ψ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∉
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               By the above equivalences we can remedy this by replacing 
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                +
                                                1
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 }
                               with 
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                +
                                                1
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 }
                              . What remains to be checked is that this operation cannot introduce intersections between horizontal and vertical extensions nor change 
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                                 }
                              .

Consider first the case of 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                               even, i.e. when 
                                 k
                                 +
                                 
                                    ⌈
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    ⌉
                                 
                                 =
                                 k
                                 +
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    2
                                 
                               and 
                                 k
                                 +
                                 
                                    ⌈
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                       
                                       2
                                    
                                    ⌉
                                 
                                 =
                                 k
                                 +
                                 1
                                 +
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    2
                                 
                               so that the second line in Equation (56) is 
                                 ℓ
                                 ⊃
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          2
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                       +
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          2
                                       
                                    
                                 
                                 ]
                              . From 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 ∉
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                 
                                 )
                               we deduce that 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               is either contained in a horizontal end extension or it is not a vertex of the mesh and the horizontal lines at 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                               are contained in 
                                 {
                                 (
                                 x
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 :
                                 x
                                 >
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              .

When 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               is contained in a horizontal end extension all vertical extension reaching below 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                               must be contained in 
                                 {
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 :
                                 x
                                 <
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                               and thus the replacement cannot introduce intersections between vertical and horizontal extensions. Moreover the only vertexes whose effectivity can change are 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                               and 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                              . By the ordering and by the fact that 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       Ψ
                                    
                                    
                                       i
                                    
                                 
                               we deduce that also 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                               is contained in a horizontal extension. Thus both vertexes are vertically effective. This means that their effectivity is equivalent to their horizontal effectivity that is swapped by the replacement. Thus the total count of effective vertexes is unaltered.

When 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               is not a vertex in 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               then we deduce that from 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       Ψ
                                    
                                    
                                       i
                                    
                                 
                               that 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                               is a vertex contained in a horizontal begin extension. It follows (using the ordering from Step 4) that all vertical extension reaching 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                               must have an abscissa strictly less than 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                              . We can now conclude as before.

When 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                               is odd then replacing the vertex 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                               with 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               can possibly require the deletion and the insertion of additional edges in order to fulfill Assumption 3.4. In particular when removing 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    ⌈
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    ⌉
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                               also all the horizontal edges in 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               containing it must be removed, and when adding 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               the edges 
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 }
                               and 
                                 [
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ]
                                 ×
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 }
                               must be added depending on the presence in 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 )
                               of respectively 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                               and 
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          ⌈
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             2
                                          
                                          ⌉
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 }
                              . The preservation of the number of effective vertexes is the same as for the even case.

Applying the same procedure to vertical lines provides a canonical mesh. □

We remark that canonical mesh 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 T
                              
                           
                         constructed in the above proof is very different from 
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                        . In fact the only preserved properties are the domain Ω, the map Ξ and those stated in the lemma. Note for example that, for the mesh in Fig. 3, 
                           J
                           (
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 b
                                 ,
                                 1
                              
                           
                           )
                           ≠
                           J
                           (
                           
                              
                                 a
                              
                              
                                 b
                                 ,
                                 1
                              
                           
                           )
                        . This is not a problem as (52) is implied by 
                           ∀
                           b
                           ∈
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                        ,
                           
                              (57)
                              
                                 dim
                                 ⁡
                                 
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    ∩
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 #
                                 {
                                 β
                                 ∈
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                                 :
                                 β
                                 ⊂
                                 
                                    
                                       Ξ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 b
                                 )
                                 }
                                 .
                              
                           
                         Thus we can use a different canonical mesh 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 T
                              
                           
                         for each vertex 
                           b
                           ∈
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 I
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                           )
                        .


                        
                           Lemma 5.10
                           
                              Equation 
                              (52) 
                              holds.
                           


                        
                           Proof
                           Since all the 
                                 β
                                 ⊂
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 1
                                 ]
                                 ×
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 2
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 −
                                 1
                                 ]
                               are contained in the preimage of some 
                                 b
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       P
                                    
                                 
                                 )
                               then Equation (52) is implied by Equation (57). To prove Equation (57) for a vertex b we can assume that 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                               is canonical for b (see Definition 5.8 and Lemma 5.9). Let 
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               be the horizontal edges of 
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                               such that 
                                 Ξ
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                               be the ordinate of 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                              . Similarly let 
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               be the vertical edges such that 
                                 Ξ
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 ⊃
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       x
                                    
                                    
                                       s
                                    
                                 
                               be the abscissa of 
                                 
                                    
                                       γ
                                    
                                    
                                       s
                                    
                                 
                              . From the properties of canonical meshes we know
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   J
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         b
                                                         ,
                                                         2
                                                      
                                                   
                                                   )
                                                   ⊂
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   ⊗
                                                   span
                                                   
                                                   
                                                      
                                                         {
                                                         
                                                            
                                                               (
                                                               y
                                                               −
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ≤
                                                         t
                                                         ≤
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   J
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         b
                                                         ,
                                                         2
                                                      
                                                   
                                                   )
                                                   ⊂
                                                   span
                                                   
                                                   
                                                      
                                                         {
                                                         
                                                            
                                                               (
                                                               x
                                                               −
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ≤
                                                         t
                                                         ≤
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               and thus
                                 
                                    
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ∩
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       
                                       ⊂
                                       span
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   t
                                                
                                             
                                             }
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             ≤
                                             s
                                             ≤
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ;
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             ≤
                                             t
                                             ≤
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Let 
                                 I
                                 =
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       ≤
                                       s
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       ;
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       ≤
                                       t
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                              .

The proof is done in three steps:
                                 
                                    •
                                    we construct a basis 
                                          B
                                          =
                                          
                                             
                                                {
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      s
                                                      ,
                                                      t
                                                   
                                                
                                                }
                                             
                                             
                                                s
                                                =
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ;
                                                t
                                                =
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                        of 
                                          
                                             
                                                P
                                             
                                             
                                                p
                                             
                                          
                                        such that 
                                          I
                                          =
                                          span
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      s
                                                      ,
                                                      t
                                                   
                                                
                                                }
                                             
                                             
                                                s
                                                =
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ;
                                                t
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       ;

we show that 
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          ∩
                                          J
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                        is generated by a subset 
                                          
                                             
                                                B
                                             
                                             
                                                a
                                                ,
                                                b
                                             
                                          
                                          ⊂
                                          B
                                       ;

we show that 
                                          ∀
                                          s
                                          =
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       , 
                                          t
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                y
                                             
                                          
                                       , we have
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      s
                                                      ,
                                                      t
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      a
                                                      ,
                                                      b
                                                   
                                                
                                                ⇔
                                                {
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                                }
                                                ∈
                                                E
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      E
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    


                              Step 1 Let 
                                 Ψ
                                 =
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 }
                               be the common basis associated to 
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                               constructed in the proof of Lemma 5.9. This construction is required in order to have the equivalent of Equation (56). Let 
                                 
                                    
                                       m
                                    
                                    
                                       x
                                    
                                 
                               be
                                 
                                    
                                       min
                                       ⁡
                                       {
                                       s
                                       :
                                       ∃
                                       t
                                       :
                                       
                                          
                                             β
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       ∧
                                       
                                          
                                             β
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                        is contained in a horizontal extension
                                       }
                                    
                                 
                               or 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                               if no vertex is contained in a horizontal extension.

Choose a permutation σ of 
                                 (
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                                 )
                               such that
                                 
                                    •
                                    it fixes 
                                          {
                                          
                                             
                                                m
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          }
                                        i.e. 
                                          σ
                                          (
                                          i
                                          )
                                          =
                                          i
                                        for 
                                          i
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                       ;

let 
                                          
                                             
                                                c
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          #
                                          
                                             
                                                Ψ
                                             
                                             
                                                t
                                             
                                          
                                          ∩
                                          {
                                          
                                             
                                                ψ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ψ
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          }
                                        then for all 
                                          t
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      σ
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      σ
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                }
                                                =
                                                
                                                   
                                                      Ψ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ∩
                                                {
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                                }
                                                .
                                             
                                          
                                       
                                    


                              Step 2 The important consequence of the construction in Step 1 is that for all 
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                              
                              
                                 
                                    
                                       span
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       span
                                       {
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       }
                                       +
                                       span
                                       {
                                       
                                          
                                             ψ
                                          
                                          
                                             s
                                          
                                       
                                       ∈
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                       :
                                       s
                                       ≥
                                       
                                          
                                             m
                                          
                                          
                                             x
                                          
                                       
                                       }
                                       =
                                       span
                                       {
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       }
                                       +
                                       span
                                       {
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                          
                                       
                                       :
                                       
                                          
                                             ψ
                                          
                                          
                                             s
                                          
                                       
                                       ∈
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                       ∧
                                       s
                                       ≥
                                       
                                          
                                             m
                                          
                                          
                                             x
                                          
                                       
                                       }
                                       .
                                    
                                 
                               Let 
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                               be the set of the 
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                               that generates the same space as 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                              . Then 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               can be written as
                                 
                                    (60)
                                    
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             ≤
                                             t
                                             ≤
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       span
                                       
                                       
                                          
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       ⊗
                                       span
                                       {
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       }
                                    
                                 
                               From the order of the 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                               we deduce that
                                 
                                    
                                       i
                                       <
                                       j
                                       ⇒
                                       
                                          
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ⊂
                                       
                                          
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                               This means that
                                 
                                    (61)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ⇒
                                       ∀
                                       j
                                       =
                                       t
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ⇒
                                       ∀
                                       j
                                       =
                                       t
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             B
                                          
                                          
                                             s
                                             ,
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               Recalling Equations (58), (59) and (60) we deduce that it holds
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ⇒
                                       ∀
                                       j
                                       =
                                       t
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               It follows that 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               is generated by a subset 
                                 
                                    
                                       B
                                    
                                    
                                       a
                                    
                                 
                                 ⊂
                                 B
                              . From the symmetric result about the existence of 
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                                 ⊂
                                 B
                               that generates 
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               we deduce that 
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                                 ∩
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                                 =
                                 span
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       a
                                    
                                 
                                 ∩
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                                 )
                              . Thus the intersection is generated by a subset of 
                                 B
                              , contained in
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   B
                                                
                                                
                                                   s
                                                   ,
                                                   t
                                                
                                             
                                             }
                                          
                                          
                                             s
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             ;
                                             t
                                             =
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              Step 3 We now show that 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       a
                                    
                                 
                                 ∩
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                               if and only if 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 =
                                 {
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 }
                               is in 
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               and thus
                                 
                                    
                                       #
                                       {
                                       β
                                       ∈
                                       E
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       :
                                       β
                                       ⊂
                                       
                                          
                                             Ξ
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       b
                                       )
                                       }
                                       =
                                       #
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             g
                                          
                                       
                                       ∩
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       =
                                       dim
                                       ⁡
                                       
                                          (
                                          J
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          ∩
                                          J
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                          )
                                          )
                                       
                                       .
                                    
                                 
                              
                           

We start by showing that
                                 
                                    (62)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ∩
                                       
                                          
                                             B
                                          
                                          
                                             g
                                          
                                       
                                       ⇐
                                       
                                          
                                             β
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       ∈
                                       E
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                       .
                                    
                                 
                               If 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               is a horizontally effective vertex and 
                                 s
                                 ≥
                                 
                                    
                                       m
                                    
                                    
                                       x
                                    
                                 
                               then 
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 =
                                 C
                                 
                                    
                                       ψ
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                               with 
                                 C
                                 ∈
                                 R
                               and thus 
                                 
                                    
                                       ψ
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                                 ⇔
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              . By the construction of Ψ as in Lemma 5.9 it follows that the analogous of Equation (56) holds (with a shift by one in the indexes of the 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              ) and thus there is a relation between the horizontal effectivity of 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               and the span of the horizontal lines at 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                               and with the elements of 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                              . In particular we deduce that 
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              . Recalling Equations (60) and (61) we conclude that
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               If 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               is horizontally effective and 
                                 s
                                 <
                                 
                                    
                                       m
                                    
                                    
                                       x
                                    
                                 
                               then 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               is not contained in any extension and thus 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                               contains 
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                              . It follows from its definition in Step 1 that 
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 ∈
                                 span
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                              . Again by Equations (60) and (61)
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             s
                                             ,
                                             t
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ∈
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               Concluding for all 
                                 s
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                               it holds that the horizontal effectiveness of 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               implies that 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                              . Similarly for all 
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                               it holds that the vertical effectiveness of 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               implies that 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 J
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       b
                                       ,
                                       2
                                    
                                 
                                 )
                               and thus Equation (62) is proved.

Remember that all 
                                 β
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               are either horizontally or vertically effective, then if 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∉
                                 E
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                              , there are three cases:
                                 
                                    1.
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                s
                                                ,
                                                t
                                             
                                          
                                        is not horizontally effective, but it is vertically effective;


                                       
                                          
                                             
                                                β
                                             
                                             
                                                s
                                                ,
                                                t
                                             
                                          
                                        is not vertically effective, but it is horizontally effective;


                                       
                                          
                                             
                                                β
                                             
                                             
                                                s
                                                ,
                                                t
                                             
                                          
                                        is not a vertex in 
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                E
                                             
                                          
                                          )
                                       , and thus it is not horizontally nor vertically effective.

In the third case then either 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               is not contained in any extended horizontal line or it is not contained in any extended vertical line. If it is not contained in any horizontal line then 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                                 ⊂
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       s
                                       +
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                               and thus that 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∉
                                 
                                    
                                       B
                                    
                                    
                                       a
                                    
                                 
                              . Similarly if it is not contained in any vertical line 
                                 
                                    
                                       Φ
                                    
                                    
                                       s
                                    
                                 
                                 ⊂
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       t
                                       +
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                               ans thus 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∉
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                              . Concluding if 
                                 
                                    
                                       β
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                               is not in 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                 
                                 )
                               then 
                                 
                                    
                                       B
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 ∉
                                 
                                    
                                       B
                                    
                                    
                                       a
                                    
                                 
                                 ∩
                                 
                                    
                                       B
                                    
                                    
                                       g
                                    
                                 
                              . □

In this section we collect some examples that illustrate the polynomial spaces associated to edges of the polynomial-mesh. Since the definition of 
                        J
                      uses some information that is contained in the AST-mesh we will use a representation that mimics the polynomial-mesh while preserving the information of the index-T-mesh.

We decided to limit the examples to the case of bi-cubic AST-splines as this is the most commonly used degree. The examples are ordered by complexity. Example 1 is a simple tensor-mesh, but it is used to make the graphical representation and the method clear.

In this example we analyze a simple tensor-mesh consisting of three elements divided by a single and a double line. As usual 
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                         is 
                           (
                           Q
                           ,
                           Ξ
                           )
                         where 
                           Q
                         is a box-mesh of 
                           [
                           1
                           ,
                           8
                           ]
                           ×
                           [
                           1
                           ,
                           11
                           ]
                         with vertexes having integer coordinates. To 
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                         corresponds 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                         that is a finer partition where the line extensions are added. For AST-meshes the polynomial-mesh 
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                         is 
                           Ξ
                           (
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                           )
                        . In order to make the representation more compact we use a hybrid representation in the examples that shows the underlying structure of the extended mesh inside the polynomial-mesh. In Fig. 4
                         we show the extended mesh (left), the polynomial mesh (center) and the hybrid representation (right).

There are two internal edges in 
                           
                              
                                 M
                              
                              
                                 P
                              
                           
                        : 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                        . The edge 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         is contained in the image of two edges of 
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                        : 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                         while 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                         is contained only in the image of 
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                        . In this case each 
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                         is contained in a unique extended line, let it be 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 i
                              
                           
                           ∈
                           L
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                        .

In order to compute 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           )
                         it is necessary to compute 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                        . Since 
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                         is not contained in 
                           beg
                           
                           
                              
                                 ℓ
                              
                              
                                 3
                              
                           
                           ∪
                           end
                           
                           
                              
                                 ℓ
                              
                              
                                 3
                              
                           
                         it follows from Equation (3) that 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                           =
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         and thus
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                         This is the condition for 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity across 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                        .

Since 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         is contained in 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         and 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           )
                         then 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           )
                         depends on the values of 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         and 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           )
                        . Since neither 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         nor 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                         is contained in any extension the associated spaces are
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         In this case we can choose any basis 
                           Ψ
                           =
                           {
                           
                              
                                 ψ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ψ
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 1
                              
                           
                           }
                         of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         as a common basis. Then by definition
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 span
                                 
                                 
                                    
                                       {
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             5
                                             )
                                             )
                                          
                                          
                                             k
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       ;
                                       k
                                       =
                                       2
                                       ,
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                         This is 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity across 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                        .

This example is a simple AST-mesh that is not a tensor-mesh as there are three maximal lines 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 ℓ
                              
                              
                                 3
                              
                           
                         that are shorter then the horizontal span of the mesh. See Fig. 5
                        .

Reasoning as in Example 1 it is possible to compute
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       7
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

Since 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         is contained only in 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         it follows
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       7
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                         By definition 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                           =
                           
                              
                                 S
                              
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 6
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 7
                                 )
                                 ]
                              
                           
                         where 
                           
                              
                                 Θ
                              
                              
                                 1
                              
                           
                           =
                           [
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           5
                           )
                           ,
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           6
                           )
                           ,
                           …
                           ,
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           12
                           )
                           ]
                         (in this specific case all indexes are present). Using Equation (1) we can conclude that
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       [
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       7
                                       )
                                       ]
                                    
                                 
                                 =
                                 span
                                 {
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                              
                           
                         and thus
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       7
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 =
                                 span
                                 {
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       7
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       7
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

To compute 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                           )
                         we need 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           )
                         and 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 5
                              
                           
                           )
                        . Since 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                         and 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         contain vertexes at the same abscissa then the corresponding knot vector is the same and 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           )
                           =
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                        . Since 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                         is not contained in any extension then 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 5
                              
                           
                           )
                           =
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                        . The common basis 
                           Ψ
                           =
                           {
                           
                              
                                 ψ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ψ
                              
                              
                                 4
                              
                           
                           }
                         is obtained by restricting the canonical basis of 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         to 
                           [
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           6
                           )
                           ,
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           7
                           )
                           ]
                         where 
                           
                              
                                 Θ
                              
                              
                                 2
                              
                           
                         is
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 6
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 7
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ]
                                 .
                              
                           
                         It contains all the knots corresponding to vertexes in the extensions of 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 ℓ
                              
                              
                                 3
                              
                           
                         and, in this case, the first and the last knots are repeated in order to have a basis of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         (see Lemma 4.3).

Now 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           )
                           =
                           span
                           {
                           
                              
                                 ψ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ψ
                              
                              
                                 4
                              
                           
                           }
                         and thus
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 =
                                 span
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                ,
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         Using Equation (1) it is possible to rewrite 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                           )
                         as
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 +
                                 span
                                 {
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

The conditions expressed by 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           )
                         do not correspond to 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity across 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         nor do those expressed by 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                           )
                         correspond to 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        . In spite of this 
                           T
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         is the space of piecewise polynomials that are 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         on 
                           Ξ
                           (
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                           )
                           ∪
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         on 
                           Ξ
                           (
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                           )
                        . This will be discussed in more detail in the next section.

This example shows that different structures in the index-T-mesh can represent the same type of condition on the polynomial-mesh. In the mesh of Fig. 6
                         the edge 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         is contained in the image of a unique edge of the T-mesh, contrarily 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                         is contained in the image of two distinct edges, but the associated spaces differ only because of the different ordinate. For the reason discussed in the next session the gluing conditions corresponding to 
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                         are not equivalent to smoothness conditions. This trait is shared by those corresponding to 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                        .

Here 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         is contained in two extended horizontal lines: 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                         and 
                           
                              ext
                           
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        . Thus in order to compute 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           )
                         we need both 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         and 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                        . They are respectively
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       [
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       7
                                       )
                                       ]
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       [
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       7
                                       )
                                       ]
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ]
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 6
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 16
                                 )
                                 ]
                                 .
                              
                           
                         A common basis for 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         is 
                           Ψ
                           =
                           {
                           
                              
                                 ψ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ψ
                              
                              
                                 4
                              
                           
                           }
                         given by the restrictions of the canonical basis of 
                           
                              
                                 S
                              
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 6
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 7
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 9
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 9
                                 )
                                 ]
                              
                           
                        . It follows that
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 }
                                 ,
                              
                           
                         and thus
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 }
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       8
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

To compute 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           )
                         we need 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                         and 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           )
                        . The couple 
                           (
                           
                              
                                 ℓ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                         corresponds to 
                           (
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         by a vertical translation and thus 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                           =
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                        . Similarly 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           )
                           =
                           
                              
                                 J
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                         and thus
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ψ
                                    
                                    
                                       4
                                    
                                 
                                 }
                                 ⊗
                                 span
                                 {
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       6
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                         Note how the same type of continuity condition can be encoded with a different number of edges: one for 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           )
                         and two for 
                           J
                           (
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           )
                        .

The space associate to 
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                         is
                           
                              
                                 J
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 =
                                 span
                                 {
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       10
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       5
                                       )
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     

In all previous examples all the vertical extended lines span the whole mesh and correspond to 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         smoothness conditions. In this example we consider a more general case where both horizontal and vertical T-junctions are present. The mesh is in Fig. 7
                        .

Here a is contained in 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           )
                        , 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           )
                        , 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                         and 
                           Ξ
                           (
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           )
                        . To find a common basis for the spaces associated to 
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                         by the operators 
                           
                              
                                 J
                              
                              
                                 ℓ
                              
                           
                         with 
                           ℓ
                           ∈
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 T
                              
                           
                           )
                         we use the restriction of the basis of 
                           
                              
                                 S
                              
                              
                                 Θ
                              
                           
                         where Θ is
                           
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 5
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 6
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 8
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 9
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 10
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 11
                                 )
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 11
                                 )
                                 ]
                                 .
                              
                           
                         Note how 
                           
                              
                                 Ξ
                              
                              
                                 x
                              
                           
                           (
                           7
                           )
                         does not appear in Θ. Indeed there is a horizontal extension that does not intersect any line at 7. Let 
                           Ψ
                           =
                           {
                           
                              
                                 ψ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ψ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ψ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ψ
                              
                              
                                 4
                              
                           
                           }
                         be the common basis then by reasoning as in the previous examples we obtain
                           
                              
                                 J
                                 (
                                 a
                                 )
                                 =
                                 span
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                         Also g is contained in the image of four vertical edges: 
                           Ξ
                           (
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           )
                        , 
                           Ξ
                           (
                           
                              
                                 γ
                              
                              
                                 2
                              
                           
                           )
                        , 
                           Ξ
                           (
                           
                              
                                 γ
                              
                              
                                 3
                              
                           
                           )
                         and 
                           Ξ
                           (
                           
                              
                                 γ
                              
                              
                                 4
                              
                           
                           )
                        . In this case the common basis 
                           Φ
                           =
                           {
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 4
                              
                           
                           }
                         of 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                              
                           
                         is the canonical basis of
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       [
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       6
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       8
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       9
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       10
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       11
                                       )
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       11
                                       )
                                       ]
                                    
                                 
                              
                           
                         restricted to 
                           [
                           
                              
                                 Ξ
                              
                              
                                 y
                              
                           
                           (
                           8
                           )
                           ,
                           
                              
                                 Ξ
                              
                              
                                 y
                              
                           
                           (
                           9
                           )
                           ]
                        . The condition associated to g is
                           
                              
                                 J
                                 (
                                 g
                                 )
                                 =
                                 span
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   5
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

The characterization of the AST-spline space provided in Section 5 uses complex gluing conditions on the inter-element boundaries. In some cases the same piecewise polynomial space can be equivalently defined in terms of required smoothness on the internal edges. This is possible also when the two conditions are not equivalent on edge by edge basis. In this section we describe a subset of AST-meshes for which 
                        T
                      is characterized by smoothness condition. We then apply the content of this section to the examples from the previous section.


                     
                        Theorem 7.1
                        
                           If the preimage 
                           
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            
                           of every vertex 
                           
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            
                           intersect only extensions of the same type (i.e. horizontal begin extension or horizontal end extension or vertical begin extension or vertical end extension) and each extension intersects all the orthogonal segments contained in 
                           
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            
                           (see 
                           
                              Fig. 8
                           
                           
                           ) then 
                           
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            
                           is the space of all piece-wise bivariate polynomials of degree 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                            
                           on 
                           
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                            
                           with the same smoothness as the AST-spline functions at the mesh lines. More precisely, for 
                           
                              a
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            
                           let 
                           
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                              (
                              a
                              )
                            
                           be
                           
                              
                                 (63)
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    a
                                    )
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    ⊗
                                    span
                                    {
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          k
                                       
                                    
                                    :
                                    k
                                    =
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          a
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    }
                                 
                              
                            
                           where 
                           
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    a
                                 
                              
                              −
                              1
                            
                           is the minimal degree in 
                           
                              (
                              y
                              −
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                            
                           of the functions in 
                           
                              J
                              (
                              a
                              )
                           
                           , or equivalently 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    a
                                 
                              
                            
                           is the number of horizontal edges of 
                           
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                            
                           whose image contain a. Define 
                           
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                            
                           similarly for vertical edges. Then
                           
                              
                                 
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

Note that 
                        S
                        (
                        
                           
                              M
                           
                           
                              P
                           
                        
                        ,
                        
                           
                              J
                           
                           
                              ˜
                           
                        
                        )
                      is the smallest piecewise polynomial space defined by smoothness conditions and containing 
                        T
                        (
                        
                           
                              M
                           
                           
                              T
                           
                        
                        )
                     . In particular the condition in Equation (63) corresponds to 
                        
                           
                              C
                           
                           
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    a
                                 
                              
                              −
                              1
                           
                        
                      smoothness across a. Note also that 
                        
                           
                              J
                           
                           
                              ˜
                           
                        
                      can be defined as in Definition 4.4 by changing 
                        
                           
                              J
                           
                           
                              ℓ
                           
                        
                      to
                        
                           
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              α
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          {
                                          0
                                          }
                                       
                                       
                                          α
                                          ⊄
                                          
                                             ext
                                          
                                          ℓ
                                          ∨
                                          dim
                                          ⁡
                                          Ξ
                                          (
                                          α
                                          )
                                          <
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                       
                                          α
                                          =
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                          ∧
                                          dim
                                          ⁡
                                          Ξ
                                          (
                                          α
                                          )
                                          =
                                          1
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        Proof
                        The main idea is to compare the dimension of 
                              T
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            with that of 
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                              )
                           . In order to simplify the proofs it is convenient to introduce an intermediate step where only the conditions associated to horizontal edges are changed. Let
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    a
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                J
                                                (
                                                a
                                                )
                                             
                                             
                                                a
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      v
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                (
                                                a
                                                )
                                             
                                             
                                                a
                                                ∈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                           , 
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                            be the complexes associated to 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                           . We prove that 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                           ; the proof that 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                              )
                              =
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              )
                            is similar and is not detailed.

Both the dimension of 
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                            and 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              )
                            can be expressed with Equation (23) and their difference is:
                              
                                 (64)
                                 
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    −
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

First we prove that 
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              {
                              0
                              }
                           . We identify 
                              
                                 
                                    J
                                 
                                 
                                    ⁎
                                 
                              
                            with a sub-complex of 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                           . This is possible because 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              a
                              )
                              ⊃
                              J
                              (
                              a
                              )
                            for all 
                              a
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                           . Then we show that all 
                              ρ
                              ∈
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                            are equivalent to a 
                              
                                 
                                    ρ
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                            and thus, by Theorem 4.8, to 0. We can assume that for all 
                              ρ
                              ∈
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                            the following holds: for each 
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                           
                           
                              
                                 (65)
                                 
                                    ρ
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    ∈
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                            Indeed 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              =
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                              +
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           , but 
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                            is contained in 
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                            and thus it is equivalent to 0 (Theorem 4.8).

We decompose ρ in
                              
                                 
                                    ρ
                                    =
                                    
                                       ∑
                                       
                                          ℓ
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                            where for all 
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            not contained in ℓ 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              =
                              0
                           . Consider ℓ fixed and let 
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                            be its ordinate. We can further decompose 
                              
                                 
                                    ρ
                                 
                                 
                                    ℓ
                                 
                              
                            in
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                            where for each b, 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              ⊗
                              span
                              {
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                              }
                           . We prove that each 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                              ≈
                              0
                           .

To prove this we decompose 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    ℓ
                                 
                              
                            as
                              
                                 
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       ⨁
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                          ,
                                          k
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    e
                                 
                              
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              ⊗
                              span
                              {
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                              }
                            for each 
                              e
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                           . Let 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            be the subset of ℓ where the associated smoothness condition (in the vertical direction) is at least 
                              
                                 
                                    C
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           : i.e. 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            is a union of the edges 
                              a
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            contained in ℓ and such that 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    e
                                 
                              
                              ≠
                              {
                              0
                              }
                           . Let also 
                              
                                 
                                    V
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                              :
                              b
                              ⊂
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                              }
                            and 
                              
                                 
                                    E
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              a
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                              :
                              a
                              ⊂
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                              }
                           . Assume that 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            is connected, otherwise what follows applies to the restriction of 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                            to each connected component of 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                           . Since for each 
                              a
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              a
                              )
                              ⊃
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              ⊗
                              span
                              {
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    j
                                 
                              
                              :
                              k
                              ≤
                              j
                              ≤
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              }
                            the homology classes of 
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                    ,
                                    k
                                 
                              
                              )
                            are described by
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                    
                                    ≈
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    ⇔
                                    ∃
                                    θ
                                    ∈
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                          ,
                                          k
                                       
                                    
                                    :
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    θ
                                    ⇔
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    .
                                 
                              
                            Recalling Equation (1) and noting that each 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            contains at least the image of 
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                            edges of the extended mesh we deduce that for each 
                              q
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              ⊗
                              span
                              {
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    j
                                 
                              
                              :
                              k
                              ≤
                              j
                              ≤
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              }
                            there exists 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                            supported in 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            and such that 
                              
                                 
                                    ∑
                                 
                                 
                                    b
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              =
                              q
                           . Thus the restriction of 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                            to 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            is equivalent to 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                            and thus by Theorem 4.8 to 0. From Equation (65) we deduce that there is no vertexes 
                              b
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    k
                                 
                              
                            not included in 
                              
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                            for which 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                    ,
                                    k
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              ≠
                              {
                              0
                              }
                            and thus that 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                              ≈
                              0
                           . Since this applies to all 
                              
                                 
                                    ρ
                                 
                                 
                                    k
                                 
                              
                            then also 
                              ρ
                              
                                 
                                    |
                                 
                                 
                                    ℓ
                                 
                              
                              ≈
                              0
                            and in the same way 
                              ρ
                              ≈
                              0
                           . Concluding all 
                              ρ
                              ∈
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                            are in the same homology class and 
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              {
                              0
                              }
                           .

Second we check that 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              ,
                              J
                              )
                           . Expanding Equation (64) we get
                              
                                 (66)
                                 
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    −
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                             
                                                I
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          dim
                                          ⁡
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    −
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                             
                                                I
                                                ,
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          dim
                                          ⁡
                                          
                                             
                                                J
                                             
                                             
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          a
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

By our assumptions the preimage of each vertex 
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            intersects only extensions of the same type. When it does not intersect any extension then
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                    ;
                                    
                                    
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    ;
                                    
                                    
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    .
                                 
                              
                            When 
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            intersects horizontal begin extensions then
                              
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    ∩
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    )
                                 
                              
                            From the hypothesis that all horizontal extension intersect all vertical lines in 
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            and the fact that
                              
                                 
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          1
                                       
                                    
                                    )
                                    =
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    =
                                    span
                                    {
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          s
                                       
                                    
                                    :
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          y
                                       
                                    
                                    ≤
                                    s
                                    ≤
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    }
                                    ⊗
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    m
                                 
                                 
                                    y
                                 
                              
                            is the number of vertical lines, we deduce that
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    ∩
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          1
                                       
                                    
                                    )
                                    =
                                    span
                                    {
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          t
                                       
                                    
                                    :
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          y
                                       
                                    
                                    ≤
                                    s
                                    ≤
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    1
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          x
                                       
                                    
                                    ≤
                                    t
                                    ≤
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    }
                                    =
                                    J
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    ∩
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                            Thus 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                 
                              
                              ∩
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              =
                              
                                 
                                    J
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                 
                              
                            and
                              
                                 (67)
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Similarly if 
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            intersects horizontal end extensions then
                              
                                 (68)
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                    −
                                    dim
                                    ⁡
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            From Equations (67) and (68) we deduce that Equation (66) holds. Indeed while considering the horizontal edges and vertexes contained in the same maximal line ℓ there is a one-to-one correspondence between addenda of opposite sign. Thus
                              
                                 
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    .
                                 
                              
                           
                        

By the same argument with 
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                            in place of 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                           , 
                              
                                 
                                    J
                                 
                                 
                                    ˆ
                                 
                              
                            in place of 
                              J
                            and vertical lines in place of horizontal lines we conclude that
                              
                                 
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    
                                       
                                          J
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          P
                                       
                                    
                                    ,
                                    J
                                    )
                                    =
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    .
                                 
                              
                             □

We now return briefly to the examples in the previous section and discuss the applicability of Theorem 7.1. The hypothesis of the theorem hold true for the mesh in Example 2. In this case the double characterization means that for any piecewise polynomial that is 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      on 
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              2
                           
                        
                        )
                      it holds that the difference of the polynomial expressions in the rectangles above and below 
                        
                           
                              a
                           
                           
                              1
                           
                        
                      is not only contained in 
                        
                           
                              P
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                           
                        
                        ⊗
                        span
                        {
                        
                           
                              (
                              y
                              −
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              (
                              7
                              )
                              )
                           
                           
                              3
                           
                        
                        }
                     , but it is also contained in 
                        J
                        (
                        
                           
                              a
                           
                           
                              1
                           
                        
                        )
                     .

The mesh in Example 3 does not allow for an equivalent characterization. We can first note that the hypothesis of the theorem is not satisfied: indeed the preimages of 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        6
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        6
                        )
                        )
                     , 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        7
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        6
                        )
                        )
                     , 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        8
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        6
                        )
                        )
                      and 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        6
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        8
                        )
                        )
                     , 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        7
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        8
                        )
                        )
                     , 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        8
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        8
                        )
                        )
                      intersect extensions of different types (begin and end horizontal extensions). Moreover the preimage of 
                        (
                        
                           
                              Ξ
                           
                           
                              x
                           
                        
                        (
                        10
                        )
                        ,
                        
                           
                              Ξ
                           
                           
                              y
                           
                        
                        (
                        5
                        )
                        )
                      intersects an extension that does not intersect all vertical segments. This is not enough to conclude that a characterization based on smoothness condition is impossible, but we can analyze each of the three horizontal lines separately.

It is not possible to replace the gluing condition on 
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                        )
                        ∩
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              2
                           
                        
                        )
                      with a 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      condition. Indeed a 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      condition corresponds to replacing 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              ℓ
                           
                           
                              2
                           
                        
                      with a single line 
                        ℓ
                        =
                        [
                        3
                        ,
                        15
                        ]
                        ×
                        {
                        8
                        }
                     . With this change the vertex 
                        {
                        (
                        7
                        ,
                        8
                        )
                        }
                      becomes an anchor and thus the space dimension increases.

Similar considerations hold for the condition on 
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              3
                           
                        
                        )
                        ∩
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              4
                           
                        
                        )
                     . Indeed the 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      condition corresponds to replacing 
                        
                           
                              ℓ
                           
                           
                              4
                           
                        
                      with 
                        [
                        7
                        ,
                        15
                        ]
                        ×
                        {
                        7
                        }
                      or alternatively 
                        
                           
                              ℓ
                           
                           
                              3
                           
                        
                      with 
                        [
                        3
                        ,
                        7
                        ]
                        ×
                        {
                        6
                        }
                     . With both modification a new anchor is introduced: 
                        {
                        (
                        7
                        ,
                        7
                        )
                        }
                      or 
                        {
                        (
                        7
                        ,
                        6
                        )
                        }
                      respectively and thus also in this case the condition is more restrictive then 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuity. Remark that replacing 
                        
                           
                              ℓ
                           
                           
                              4
                           
                        
                      with 
                        [
                        7
                        ,
                        15
                        ]
                        ×
                        {
                        7
                        }
                      allows for an equivalent characterization with 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      smoothness conditions across 
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              3
                           
                        
                        )
                        ∩
                        Ξ
                        (
                        
                           ext
                        
                        
                           
                              ℓ
                           
                           
                              4
                           
                        
                        )
                      even if the modified mesh does not satisfy the hypothesis of Theorem 7.1.

Also the condition on the end extension of 
                        
                           
                              ℓ
                           
                           
                              5
                           
                        
                      is stricter that the 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      condition. Indeed by prolonging 
                        
                           
                              ℓ
                           
                           
                              5
                           
                        
                      to 
                        [
                        3
                        ,
                        11
                        ]
                        ×
                        {
                        5
                        }
                      the obtained conditions are still weaker than 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      smoothness across 
                        
                           
                              a
                           
                           
                              3
                           
                        
                     , but we obtain three new anchors (
                        {
                        (
                        9
                        ,
                        5
                        )
                        }
                     , 
                        {
                        (
                        10
                        ,
                        5
                        )
                        ,
                        {
                        (
                        11
                        ,
                        5
                        )
                        }
                        }
                     ) and thus a bigger space.

@&#ACKNOWLEDGEMENTS@&#

The authors were partially supported by the European Research Council through the Starting Grant GeoPDEs (ERC-2007-StG 205004) and through the Consolidator Grant HIgeoM (ERC-2013-CoG 616563) and by the Italian MIUR through the FIRB “Futuro in Ricerca” Grant RBFR08CZ0S. This support is gratefully acknowledged.

Before proving Proposition 4.7 we introduce some polynomial spaces related to the definition of 
                        J
                      and prove some of their properties.


                     
                        Definition Appendix A.1
                        To a 
                              b
                              =
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              }
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            we associate 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              ⊂
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                            defined by the following properties
                              
                                 1.
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                       =
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       }
                                     with 
                                       t
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                     and 
                                       s
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                          
                                             h
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             s
                                          
                                          
                                             0
                                             ,
                                             t
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       }
                                    ;


                                    
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                       ⊃
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                    ;


                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                     is minimal, that is if 
                                       E
                                       ⊂
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                     satisfies 1 and 2 then 
                                       E
                                       =
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                    
                                 


                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             v
                                          
                                       
                                       =
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             t
                                          
                                       
                                       }
                                     with 
                                       s
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                     and 
                                       t
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             s
                                          
                                          
                                             v
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             0
                                             ,
                                             s
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       }
                                    ;


                                    
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             v
                                          
                                       
                                       ⊃
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                    ;


                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             v
                                          
                                       
                                     is minimal.

Note that 
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              h
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              v
                           
                        
                      are well defined. Indeed 
                        J
                        (
                        
                           
                              a
                           
                           
                              b
                              ,
                              2
                           
                        
                        )
                     , 
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              h
                           
                        
                     , 
                        J
                        (
                        
                           
                              a
                           
                           
                              b
                              ,
                              1
                           
                        
                        )
                      can all be decomposed in a direct sum on the divisibility with respect to 
                        (
                        y
                        −
                        
                           
                              y
                           
                           
                              ¯
                           
                        
                        )
                     . For each order of divisibility the shape of 
                        
                           
                              I
                           
                           
                              t
                           
                           
                              h
                           
                        
                      and the minimality condition guarantee uniqueness. Similarly for 
                        J
                        (
                        
                           
                              g
                           
                           
                              b
                              ,
                              2
                           
                        
                        )
                        ,
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              v
                           
                        
                        ,
                        J
                        (
                        
                           
                              g
                           
                           
                              b
                              ,
                              1
                           
                        
                        )
                     .

To study 
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              h
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              b
                              ,
                              v
                           
                        
                      we first highlight the links between them and the vertexes contained in 
                        
                           
                              Ξ
                           
                           
                              −
                              1
                           
                        
                        (
                        b
                        )
                     .


                     
                        Lemma Appendix A.2
                        
                           Let 
                           
                              b
                              =
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              }
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            
                           and let k be the maximum number of vertexes 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ˜
                                 
                              
                              )
                              }
                              ⊂
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            
                           contained in the same horizontal extension. Then there exist 
                           
                              Φ
                              =
                              {
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                 
                              
                              }
                            
                           and 
                           
                              Ψ
                              =
                              {
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                 
                              
                              }
                            
                           basis of 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                            
                           such that
                           
                              
                                 •
                                 
                                    for all 
                                    
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    , 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                     
                                    such that 
                                    
                                       Ξ
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ⊃
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                     
                                    it holds 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             ℓ
                                          
                                       
                                     
                                    where 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⊂
                                       Φ
                                    
                                    ;
                                 


                                    for all 
                                    
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    , 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             E
                                          
                                       
                                       )
                                     
                                    such that 
                                    
                                       Ξ
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ⊃
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                     
                                    it holds 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       α
                                       )
                                       =
                                       span
                                       
                                       
                                          
                                             Ψ
                                          
                                          
                                             ℓ
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⊂
                                       Ψ
                                    
                                    ;
                                 


                                    
                                       ∀
                                       ℓ
                                       ∈
                                       L
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                     
                                    as above and at the same ordinate
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   ℓ
                                                
                                             
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ∋
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   j
                                                
                                             
                                             ⇔
                                             
                                                
                                                   J
                                                
                                                
                                                   ℓ
                                                
                                             
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ∋
                                             
                                                
                                                   ψ
                                                
                                                
                                                   j
                                                   −
                                                   k
                                                
                                             
                                          
                                       
                                     
                                    for 
                                    
                                       1
                                       +
                                       k
                                       ≤
                                       j
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                    ;
                                 


                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       span
                                       {
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                             −
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             −
                                             k
                                          
                                       
                                       }
                                     
                                    for 
                                    
                                       1
                                       +
                                       k
                                       ≤
                                       j
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                    ;
                                 


                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             −
                                             k
                                          
                                       
                                       }
                                     
                                    for 
                                    
                                       1
                                       ≤
                                       j
                                       ≤
                                       k
                                    
                                    ;
                                 


                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       span
                                       {
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             1
                                             −
                                             k
                                          
                                       
                                       }
                                     
                                    for 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       −
                                       k
                                       <
                                       j
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                    
                                    .
                                 


                     
                        Proof
                        This is a generalization of Lemma 4.3. The important difference here is the relation between the basis Φ and Ψ.

We show that it is possible to find a knot vector Θ of length 
                              2
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              2
                              +
                              k
                            such that the corresponding B-splines 
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                 
                              
                            restricted to 
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                            are a common basis in the sense of Lemma 4.3 for 
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                            and so are the restrictions of 
                              
                                 
                                    B
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              2
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              2
                              +
                              k
                            for 
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           . This is done by taking the two knot vectors from Lemma 4.3 and joining them in such a way that 
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                            appears k times in Θ. Then the restrictions of the spline spaces that appear in the definition of 
                              
                                 
                                    J
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              
                                 
                                    J
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              )
                            coincide with those of the spline space 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    Θ
                                 
                                 
                                    ℓ
                                 
                              
                            is an appropriate slice of Θ. From this we deduce the first two point. The other points are a consequence of the characterization of the restriction of spline spaces in Equation (1). □


                     
                        Lemma Appendix A.3
                        
                           For all 
                           
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            
                           the following hold
                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                       ⊂
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                       +
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ⊂
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             v
                                          
                                       
                                       +
                                       J
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                    
                                    ;
                                 


                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             v
                                          
                                       
                                       ⊂
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       )
                                       +
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                       ⊂
                                       
                                          
                                             Δ
                                          
                                          
                                             b
                                             ,
                                             h
                                          
                                       
                                       +
                                       J
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 


                     
                        Proof
                        We only prove the first inclusion of 1, the second is a consequence of the definition of 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                           . Let 
                              b
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                           . If 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              =
                              {
                              0
                              }
                            then the thesis is true. Otherwise let 
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                            be
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    min
                                    ⁡
                                    {
                                    s
                                    :
                                    ∃
                                    t
                                    :
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          t
                                       
                                    
                                    ∈
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          h
                                       
                                    
                                    }
                                    .
                                 
                              
                            Then it follows from the previous lemma that there are 
                              ℓ
                              ∈
                              L
                              (
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              )
                            and 
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                            vertexes 
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            contained in 
                              (
                              beg
                              
                              ℓ
                              ∪
                              end
                              
                              ℓ
                              )
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                           . Each vertex corresponds to a vertical line 
                              
                                 
                                    ℓ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ℓ
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    1
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            such that 
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              
                                 ext
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                              ∖
                              (
                              beg
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                              ∪
                              end
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                              )
                           . Since there are at most 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                            integers in 
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                            then in each 
                              
                                 ext
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    i
                                 
                              
                            there are two edges 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                    ,
                                    2
                                 
                              
                            such that 
                              Ξ
                              (
                              
                                 
                                    γ
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                              
                              )
                              ⊃
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                            and 
                              Ξ
                              (
                              
                                 
                                    γ
                                 
                                 
                                    i
                                    ,
                                    2
                                 
                              
                              )
                              ⊃
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                           .

From Lemma 4.3 and Equation (1) it follows that all the 
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                            contain a common subspace
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       ⋂
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          J
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                          ,
                                          1
                                       
                                    
                                    )
                                 
                              
                            of dimension greater than or equal to 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              #
                              {
                              y
                              ∈
                              Z
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              :
                              y
                              <
                              
                                 
                                    y
                                 
                                 
                                    ˜
                                 
                              
                              }
                           .

Similarly
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       ⋂
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          J
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    )
                                 
                              
                            has dimension at least 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              #
                              {
                              y
                              ∈
                              Z
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              :
                              y
                              >
                              
                                 
                                    y
                                 
                                 
                                    ˜
                                 
                              
                              }
                           .

The spaces 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                            can be written explicitly. Indeed 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                            contains the space generated by the first 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              #
                              {
                              y
                              ∈
                              Z
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              :
                              y
                              <
                              
                                 
                                    y
                                 
                                 
                                    ˜
                                 
                              
                              }
                            
                           
                              
                                 
                                    ψ
                                 
                                 
                                    j
                                 
                                 
                                    +
                                 
                              
                            of Equation (1) where the knot vector is taken from Lemma 4.3. Similarly 
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                            contains the space generated by the last 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              #
                              {
                              y
                              ∈
                              Z
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                              :
                              y
                              >
                              
                                 
                                    y
                                 
                                 
                                    ˜
                                 
                              
                              }
                            
                           
                              
                                 
                                    ψ
                                 
                                 
                                    j
                                 
                                 
                                    −
                                 
                              
                            of Equation (1) with the same knot vector. By linear independence it follows that 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                            and thus
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          h
                                       
                                    
                                    ⊂
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                          }
                                       
                                       
                                          s
                                          =
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    ⊗
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    =
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                          }
                                       
                                       
                                          s
                                          =
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    ⊗
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ⊂
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          1
                                       
                                    
                                    )
                                    +
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                             □


                     
                        Lemma Appendix A.4
                        
                           For all 
                           
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    P
                                 
                              
                              )
                            
                           it holds
                           
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          h
                                       
                                    
                                    ∩
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          v
                                       
                                    
                                    =
                                    {
                                    0
                                    }
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        Assume that the thesis is false and that 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              ∩
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                              ≠
                              ∅
                           . Then for some 
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            it holds 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              ∩
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                           . From Lemma Appendix A.2 we deduce that there is a horizontal line 
                              
                                 
                                    ℓ
                                 
                                 
                                    h
                                 
                              
                            such that there are at least 
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                            vertexes in 
                              (
                              beg
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    h
                                 
                              
                              ∪
                              end
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    h
                                 
                              
                              )
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                           . This means that the number 
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                            of extended vertical lines that contains a vertex outside vertical extensions in 
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                            is 
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              ≥
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                           . Similarly there is a vertical line 
                              
                                 
                                    ℓ
                                 
                                 
                                    v
                                 
                              
                            containing at least 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            vertexes in the extensions and thus there are at least 
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                              ≥
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            horizontal lines containing a vertex outside horizontal extensions. We now focus on this subset of the lines. Note that all the horizontal extension can only intersect the 
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                            lines we are considering and the same holds for vertical extensions.

If ℓ is one of the 
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                            horizontal lines described above and containing 
                              α
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                              )
                            such that 
                              Ξ
                              (
                              α
                              )
                              ⊃
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                            then we know from Equation (1) and the fact that these lines contain a vertex (contained in 
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                           ) outside horizontal extensions that
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    α
                                    )
                                    +
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                )
                                             
                                             
                                                s
                                             
                                          
                                          }
                                       
                                       
                                          s
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          −
                                          k
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where k is the number of vertexes in 
                              end
                              
                              ℓ
                              ∩
                              
                                 
                                    Ξ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              b
                              )
                           . In particular let Ψ the common basis of Lemma 4.3 for the horizontal lines then
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    α
                                    )
                                    ⊃
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                ψ
                                             
                                             
                                                j
                                             
                                          
                                          }
                                       
                                       
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          −
                                          k
                                       
                                    
                                    .
                                 
                              
                            Since 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              ∩
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                            then it follows that at least for 
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            of these horizontal lines
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    α
                                    )
                                    =
                                    span
                                    
                                    
                                       
                                          {
                                          
                                             
                                                ψ
                                             
                                             
                                                j
                                             
                                          
                                          }
                                       
                                       
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          −
                                          k
                                       
                                    
                                    ∌
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ¯
                                             
                                          
                                          +
                                          1
                                       
                                    
                                 
                              
                            and thus for these lines 
                              k
                              ≥
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                           . We conclude that there are at least 
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            horizontal lines containing 
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                            vertexes in horizontal extensions. Similarly there are at least 
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                            vertical lines containing 
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                            vertexes in vertical extensions. These two sets must be disjoint, but this is impossible because both sets are aligned in a rectangular grid and the dimensions of the grids are too big: 
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              )
                              +
                              (
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              +
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              +
                              1
                            and 
                              (
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              −
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              )
                              +
                              (
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    h
                                 
                              
                              +
                              1
                           . □


                     
                        Proof of Proposition 4.7
                        The thesis is that:
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    J
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    +
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

By definition 
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    b
                                 
                              
                              =
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    1
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                            and thus
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          b
                                       
                                    
                                    ⊂
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          h
                                       
                                    
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          b
                                          ,
                                          v
                                       
                                    
                                    +
                                    J
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    +
                                    J
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          b
                                          ,
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                            The thesis is proved if we show that 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                            and 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                            are contained in 
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           . We detail the proof that 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              ⊂
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           .

Let 
                              
                                 
                                    a
                                 
                                 
                                    Δ
                                 
                              
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                            then by Lemma Appendix A.3 there exist 
                              
                                 
                                    b
                                 
                                 
                                    Δ
                                 
                              
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                            and 
                              
                                 
                                    b
                                 
                                 
                                    g
                                 
                              
                              ∈
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                            such that
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          Δ
                                       
                                    
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          Δ
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          g
                                       
                                    
                                    .
                                 
                              
                            From the same lemma it follows that 
                              
                                 
                                    b
                                 
                                 
                                    Δ
                                 
                              
                            can be decomposed as
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          Δ
                                       
                                    
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          Δ
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                            with 
                              
                                 
                                    c
                                 
                                 
                                    Δ
                                 
                              
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                            and 
                              
                                 
                                    b
                                 
                                 
                                    a
                                 
                              
                              ∈
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           . Both decompositions are unique and thus the above define a map 
                              T
                              :
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                              →
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                            that to each 
                              
                                 
                                    a
                                 
                                 
                                    Δ
                                 
                              
                            associates 
                              
                                 
                                    c
                                 
                                 
                                    Δ
                                 
                              
                           .

From the above we deduce that for all 
                              a
                              ∈
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                            the polynomial 
                              a
                              −
                              T
                              a
                              =
                              
                                 
                                    b
                                 
                                 
                                    g
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                              
                            is in 
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           . Thus 
                              ker
                              ⁡
                              T
                              ⊂
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                            and more generally 
                              ker
                              ⁡
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              J
                              (
                              
                                 
                                    a
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                              +
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                           . From this it follows that if T is nihilpotent the thesis holds.

To show that T is nihilpotent we show that T increases the divisibility by 
                              (
                              y
                              −
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                           . Assume that 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                            is in 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    h
                                 
                              
                           . From Lemma Appendix A.4 it follows that 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                            contains only linear combinations of polynomials 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                            with 
                              k
                              >
                              t
                           . Moreover 
                              J
                              (
                              
                                 
                                    g
                                 
                                 
                                    b
                                    ,
                                    2
                                 
                              
                              )
                            and 
                              
                                 
                                    Δ
                                 
                                 
                                    b
                                    ,
                                    v
                                 
                              
                            have a tensor structure 
                              {
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              }
                              ⊗
                              Ψ
                            and thus it is possible to decompose 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                            as
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          ︸
                                       
                                       
                                          
                                             a
                                          
                                          
                                             Δ
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   Δ
                                                
                                             
                                             (
                                             y
                                             )
                                          
                                          ︸
                                       
                                       
                                          
                                             b
                                          
                                          
                                             Δ
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   g
                                                
                                             
                                             (
                                             y
                                             )
                                          
                                          ︸
                                       
                                       
                                          
                                             b
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    q
                                 
                                 
                                    Δ
                                 
                              
                              (
                              y
                              )
                            is divisible by 
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           . When decomposing 
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    Δ
                                 
                              
                              (
                              y
                              )
                            in 
                              
                                 
                                    c
                                 
                                 
                                    Δ
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                              
                            the divisibility by 
                              (
                              y
                              −
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                              )
                            cannot decrease because of the tensor product structure. Thus 
                              T
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                            must be divisible by 
                              
                                 
                                    (
                                    y
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           . This is enough to conclude that 
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    1
                                 
                              
                            is the null map. □

@&#REFERENCES@&#

