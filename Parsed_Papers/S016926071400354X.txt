@&#MAIN-TITLE@&#An enhanced method for registration of dental surfaces partially scanned by a 3D dental laser scanning

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method is proposed for the accurate registration of partially scanned dental surfaces.


                        
                        
                           
                           The results showed that our method accurately registered partially scanned dental surfaces.


                        
                        
                           
                           Our method and its application are useful for orthodontic and prosthodontic treatment.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Depth map

Depth map-based registration

Surface registration

Iterative closest point

3D dental laser scanning

@&#ABSTRACT@&#


               
               
                  In this paper, we propose the fast and accurate registration method of partially scanned dental surfaces in a 3D dental laser scanning. To overcome the multiple point correspondence problems of conventional surface registration methods, we propose the novel depth map-based registration method to register 3D surface models. First, we convert a partially scanned 3D dental surface into a 2D image by generating the 2D depth map image of the surface model by applying a 3D rigid transformation into this model. Then, the image-based registration method using 2D depth map images accurately estimates the initial transformation between two consequently acquired surface models. To further increase the computational efficiency, we decompose the 3D rigid transformation into out-of-plane (i.e. x-, y-rotation, and z-translation) and in-plane (i.e. x-, y-translation, and z-rotation) transformations. For the in-plane transformation, we accelerate the transformation process by transforming the 2D depth map image instead of transforming the 3D surface model. For the more accurate registration of 3D surface models, we enhance iterative closest point (ICP) method for the subsequent fine registration. Our initial depth map-based registration well aligns each surface model. Therefore, our subsequent ICP method can accurately register two surface models since it is highly probable that the closest point pairs are the exact corresponding point pairs. The experimental results demonstrated that our method accurately registered partially scanned dental surfaces. Regarding the computational performance, our method delivered about 1.5 times faster registration than the conventional method. Our method can be successfully applied to the accurate reconstruction of 3D dental objects for orthodontic and prosthodontic treatment.
               
            

@&#INTRODUCTION@&#

Dentistry requires the accurate reconstruction of 3D dental objects (e.g., whole teeth) for orthodontic and prosthodontic treatment [1]. The 3D surface model of dental objects could be reconstructed by the fabrication of plaster models [2]. The plaster models are fabricated by pouring impression. Instead of fabrication, oral radiology can provide the dentist with the detailed information of dental objects Whereas oral radiology has been widely used as a routine technique in dental clinical practice, the accurate segmentation of a 3D dental object for the reconstruction is very difficult due to similar intensities between nearby objects and noises in cone-beam computed tomography (CBCT) images [3–5]. Furthermore, the equipment for oral radiology (e.g., CBCT) is expensive and the radiation required to enhance both contrast and spatial resolution could be high [1].

For the alternative to oral radiology, in order to perceive the anatomical information of maxillofacial structure, a 3D dental laser scanning has been recently introduced to acquire the 3D geometry of the teeth robustly [6,7]. The equipment of laser scanning is usually simple and the scanning speed is fast. However, due to the limited field of view of the scanner, a single surface model acquired by the laser scanner cannot cover the whole teeth. In order to resolve this limitation of dental laser scanning, a set of surface models taken at different positions, which include partial information of one or two teeth are acquired and each surface model should share overlapped region with neighboring surface model. Then, they should be integrated to generate the unified surface model of the whole teeth. However, considering that each surface model is acquired at different position and orientation, the accurate registration method is required to integrate the set of surface models into the single surface model of the whole teeth with the minimization of the artifacts near the overlapped boundaries of each consecutive surface model.

Various kinds of surface-based registration methods have been proposed to find the optimal transformation between a set of surface models taken at different positions and orientations [8–20]. Maal et al. [8] proposed a surface-based registration based on iterative closest point algorithm (ICP)[9] to evaluate the treatment outcomes in oral and maxillofacial surgery. However, the surface overlap region of this method should be the whole surface. And this method cannot be applied to the surface registration between partially overlapped surfaces. Swennen et al. [10] proposed a point-based rigid registration to plan orthognathic and facial orthomorphic surgery by computing the rotation and translation from the surface information and searching the corresponding points and shapes. However, this method required the positional information of anatomical feature points. Albrecht et al. [11] introduced a 3D surface registration represented by signed distance function and registered surfaces by means of their distance images and a combination of feature images and curvature images. However, this method required a heavy computation for the generation of the signed distance function.

Surface-based registration methods can be mainly categorized into relational matching [12,13] and minimization techniques. The relational matching technique [12,13] is a method for finding the best correspondences between structural descriptions for the recognition of objects in digital images. It extracts and aligns local surface features to establish the point correspondences between two surfaces. Local surface features such as spin-images [14], splashes [15], point signatures [16], harmonic shape images [17], spherical attribute images [18], and tripod-operators [19] have been proposed. In order to register two surfaces using these local surface features, the corresponding point pairs between two surfaces should be determined in overlapping regions, which are shared in two surfaces to be registered. However, it is difficult to find the exact overlapping region without any prior knowledge. Furthermore, although the overlapping regions are correctly determined, a point on one surface is unfortunately corresponding to multiple similar points on the other surface (i.e., the multiple point correspondence problem) resulting in the increase of the registration error.

In the minimization techniques, a similarity metric between two surfaces is defined and optimized as a function of the unknown transformation. In ICP algorithm [9,20], the similarity metric is defined as the point-to-point distance between corresponding point pairs, which are established by finding the closest point in the other surface of each point in one surface. In [21], the similarity metric is based on the point-to-plane distance. These similarity metrics can accurately register two surfaces when two surfaces are relatively well aligned before registration since the closest point pairs might probably be equal to the exact corresponding point pairs. However, they are not adequate for the registration of initially ill-aligned surfaces since it is less probable that the closest point pairs are the exact corresponding point pairs. Moreover, the multiple point correspondence problem also occurs when a point on one surface has the multiple closest points on the other surface model.

In this paper, we propose the fast and accurate registration method of partially scanned dental surfaces in a 3D dental laser scanning. To overcome the multiple point correspondence problem for the accurate registration of 3D surface models, we propose the depth map-based registration method to initially register 3D surface models. First, we convert the 3D surface model into a 2D image by generating the 2D depth map image of each partially scanned surface model by applying a 3D rigid transformation into this model. The corresponding point pairs in each 3D surface model are converted into corresponding image pixels in each 2D depth image. Then, the image-based registration method using 2D depth map images accurately estimates the initial transformation between two surface models. Each pixel in one image corresponds to a pixel in the other image without the multiple correspondence, which guarantees one-to-one point correspondence. To increase the computational efficiency, we decompose the 3D rigid transformation into out-of-plane transformation (i.e., x-, y-rotation, and z-translation) and in-plane transformation (i.e., x-, y-translation, and z-rotation). For the in-plane transformation, we accelerate the transformation process by transforming the 2D depth map image instead of transforming the 3D surface model. For the accurate registration of 3D surface models, we enhance ICP method for the subsequent fine registration to align 3D surface models exactly. Our initial depth map-based registration well aligns each surface model. Therefore, our subsequent ICP method can accurately register two surface models since it is highly probable that the closest point pairs are the exact corresponding point pairs.

The remainder of this paper is organized as follows. Section 2 describes the proposed method of our registration method including coarse and fine registration. Section 3 presents the results of the application of the proposed method to clinical datasets along with a comparison to other previous methods. Finally, we summarize the results and discuss future work in Section 4.

The goal of surface registration is to find an optimal transformation such that the floating (i.e., moving) surface best matches the reference (i.e., fixed) surface. Our registration method is composed of the following steps, as shown in Fig. 1
                     . First, we perform coarse registration for global surface matching, which serves as an initial estimate for the next fine registration. In coarse registration, a 2D depth map image is generated from each 3D dental surface model, which is acquired by dental laser scanning and used for accurate initial matching. Then, we further align two surface models using our fine registration method.

For the accurate initial matching, our coarse registration is based on a 2D depth map image, which is computationally generated from a 3D dental surface model. To establish the correspondence between points, surface-based registration methods [14–19] usually compute local surface features around points and compare them between points from different surface models. When a point on one surface model has multiple similar points on the other surface model, the multiple point correspondence problem occurs. However, the multiple point correspondence problem usually does not occur in image-based registration methods. Therefore, in this paper, we propose a novel image-based registration method into the registration of surface models for preventing the multiple point correspondence problem. We convert a 3D surface model to an image by generating 2D depth map image of the surface model. For image-based registration methods, points from surface models are encoded into image pixels, which are the regular grids. The corresponding image pixel pairs, which represent the corresponding point pairs, are defined as the same pixel coordinate of images. Thus, a pixel on one image dose not correspond to multiple pixels on the other image in image-based registration methods, which guarantees one-to-one point correspondence.

The depth map image is generated by projecting the triangular mesh surface model along the z-axis. If we project only three vertices of each triangular surface model, holes in the depth map image can be generated due to the empty space between the vertices when they are not close enough. In order to remove the hole in the depth map image, the inner points in a triangle should be sampled and also projected to the depth map image as follows. With three triangular vertices v
                           1, v
                           2, and v
                           3, an inner point, p, can be computed by barycentric interpolation as follows:
                              
                                 (1)
                                 
                                    
                                       
                                          p
                                       
                                       =
                                       α
                                       
                                          
                                             v
                                          
                                          1
                                       
                                       +
                                       β
                                       
                                          
                                             v
                                          
                                          2
                                       
                                       +
                                       γ
                                       
                                          
                                             v
                                          
                                          3
                                       
                                       ,
                                        
                                       α
                                       +
                                       β
                                       +
                                       γ
                                       =
                                       1
                                       ,
                                        
                                       α
                                       ,
                                       β
                                       ,
                                       γ
                                       ≥
                                       0
                                    
                                 
                              
                           
                        

Then, we generate the set of sampled points which would be projected into the depth map image as follows:
                              
                                 (2)
                                 
                                    
                                       S
                                       P
                                       =
                                       
                                          ⋃
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      ,
                                                      2
                                                   
                                                
                                                ,
                                                ...
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                ,
                                                ...
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      ,
                                                      m
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where SP is the set of sampled points with n number of triangles, m(i) is the number of sampled points in the ith triangle, and p
                           
                              i,j
                            is a jth inner point in the ith triangle computed by Eq. (1). Before the projection of these sampled points, we compute the bounding box of a surface model and compute a width (w), a height (h), and the center position (c) of the bounding box. By projecting p
                           
                              i,j
                            in SP, the 2D depth map image (DM) with the size of m
                           ×
                           n is determined by:
                              
                                 (3)
                                 
                                    
                                       D
                                       M
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             arg
                                             min
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             ∈
                                             S
                                          
                                       
                                       
                                          
                                             p
                                          
                                          z
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       ,
                                       S
                                       =
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             
                                                
                                                   x
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  x
                                                                  
                                                                     i
                                                                     ,
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  x
                                                               
                                                            
                                                            w
                                                         
                                                         +
                                                         0.5
                                                      
                                                   
                                                   ×
                                                   m
                                                    
                                                   and
                                                    
                                                   y
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  y
                                                                  
                                                                     i
                                                                     ,
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  y
                                                               
                                                            
                                                            h
                                                         
                                                         +
                                                         0.5
                                                      
                                                   
                                                   ×
                                                   n
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where c
                           
                              x
                            and c
                           
                              y
                            are x- and y-coordinate of c, and 
                              
                                 
                                    
                                       p
                                    
                                    x
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       p
                                    
                                    y
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       p
                                    
                                    z
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                            are x-, y-, and z-coordinates of p
                           
                              i,j
                           . After the projection of all the points in SP, DM is finally generated. In Figs. 2 and 3
                           
                           , we generate the 2D depth map image (Fig. 3) from the partially scanned surface models in a 3D dental laser scanning (Fig. 2).

Our depth map-based registration method is composed of the following steps, as shown in Fig. 1(b) and (c). First, the reference depth map image (DM
                           
                              R
                           ) and the floating depth map image (DM
                           
                              F
                           ) are generated from the reference and floating surface model, respectively. Then, our registration method generates transformed floating depth map images (DM
                           
                              TF
                           ) by changing transformation parameters and finds the optimal DM
                           
                              TF
                            among them. Because DM is two-dimensional, DM
                           
                              TF
                           s should be generated by transforming the 3D surfaces model using the 3D rigid transformation.

Our registration method performs the optimization of transformation parameters in 6D space including three rotational and three translational parameters. To reduce the number of searches and the computational complexity, we decompose 3D rigid transformation into out-of-plane (i.e., x-, y-rotation, and z-translation) and in-plane transformations (i.e., x-, y-translation, and z-rotation). For out-of-plane transformation, the position of a transformed vertex, ν
                           
                              out-of-plane,i
                            is calculated by applying x-, y-rotation, and z-translation into the vertex of each surface model, 
                              
                                 
                                    v
                                    i
                                 
                              
                            in Eq. (4). For in-plane transformation, the position of a transformed vertex, 
                              
                                 
                                    v
                                    
                                       i
                                       n
                                       −
                                       p
                                       l
                                       a
                                       n
                                       e
                                       ,
                                       i
                                    
                                 
                              
                            is calculated by applying x-, y-translation, and z-rotation into the vertex of each surface model, 
                              
                                 
                                    v
                                    i
                                 
                              
                            in Eq. (5).
                              
                                 (4)
                                 
                                    
                                       
                                          v
                                          
                                             
                                                out-of-plane
                                             
                                             ,
                                             i
                                          
                                       
                                       =
                                       
                                          R
                                          x
                                       
                                       
                                          R
                                          y
                                       
                                       (
                                       
                                          v
                                          i
                                       
                                       −
                                       
                                          v
                                          c
                                       
                                       )
                                       +
                                       
                                          T
                                          z
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          v
                                          
                                             
                                                in-plane
                                             
                                             ,
                                             i
                                          
                                       
                                       =
                                       
                                          R
                                          z
                                       
                                       (
                                       
                                          v
                                          i
                                       
                                       −
                                       
                                          v
                                          c
                                       
                                       )
                                       +
                                       
                                          T
                                          x
                                       
                                       +
                                       
                                          T
                                          y
                                       
                                       ,
                                    
                                 
                              
                           where R
                           
                              x
                           , R
                           
                              y
                           , and R
                           
                              z
                            are the transformation matrix representing x-, y-, and z-rotation, respectively. T
                           
                              x
                           , T
                           
                              y
                           , and T
                           
                              z
                            are the transformation matrix representing x-, y-, and z-translation, respectively. 
                              
                                 
                                    v
                                    c
                                 
                              
                            is the rotational center position, which is the center of the mass of the surface model. For in-plane transformation, DM
                           
                              TF
                            can be generated by not transforming 3D surface model itself but transforming 2D DM
                           
                              F
                            resulting in the much decrease of transformation time. Using out-of-plane and in-plane transformations, our depth map-based registration method is also decomposed into out-of-plane and in-plane registrations.

In out-of-plane registration, DM
                           
                              TF
                            is generated after the out-of-plane transformation of the 3D floating surface model. Then, we find the optimal DM
                           
                              TF
                            and out-of-plane transformation parameters among DM
                           
                              TF
                           s. As the depth map image is generated by reflecting z-coordinate values of points of its corresponding surface model, it is possible to assume that each depth map image is acquired by the same modality. Image-based registration in the same modality generally uses the sum of squared difference (SSD) and the normalized cross correlation (NCC) as the similarity measure. However, if the z-position of the dental laser scanner is changed, the corresponding pixels have different z-coordinate values resulting in the intensity change of the depth image. Therefore, SSD is not directly applicable in our environmental setting. However, NCC can be used to measure the similarity for the corresponding pixels having not the same pixel values, but linearly correlated pixel values. We can assume that z-coordinate values are linearly correlated during the change of the z-position of the scanner. Thus, in this paper, we use NCC as the similarity measure as follows:
                              
                                 (6)
                                 
                                    
                                       N
                                       C
                                       C
                                       (
                                       D
                                       
                                          M
                                          R
                                       
                                       ,
                                       D
                                       
                                          M
                                          F
                                       
                                       ;
                                       
                                          T
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                                Ω
                                             
                                             
                                                (
                                                D
                                                
                                                   M
                                                   R
                                                
                                                (
                                                
                                                   x
                                                
                                                )
                                                −
                                                
                                                   
                                                      D
                                                      
                                                         M
                                                         R
                                                      
                                                   
                                                   ¯
                                                
                                                )
                                                (
                                                D
                                                
                                                   M
                                                   
                                                      T
                                                      F
                                                   
                                                
                                                (
                                                
                                                   x
                                                
                                                )
                                                −
                                                
                                                   
                                                      D
                                                      
                                                         M
                                                         
                                                            T
                                                            F
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      Ω
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            D
                                                            
                                                               M
                                                               R
                                                            
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                            −
                                                            
                                                               
                                                                  D
                                                                  
                                                                     M
                                                                     R
                                                                  
                                                               
                                                               ¯
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      ∑
                                                      Ω
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            D
                                                            
                                                               M
                                                               
                                                                  T
                                                                  F
                                                               
                                                            
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                            −
                                                            
                                                               
                                                                  D
                                                                  
                                                                     M
                                                                     
                                                                        T
                                                                        F
                                                                     
                                                                  
                                                               
                                                               ¯
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       D
                                       
                                          M
                                          R
                                       
                                    
                                    ¯
                                 
                              
                            is the mean of DM
                           
                              R
                           , and 
                              
                                 
                                    
                                       D
                                       
                                          M
                                          
                                             T
                                             F
                                          
                                       
                                    
                                    ¯
                                 
                              
                            is the mean of DM
                           
                              TF
                           . The optimization stage searches for the optimal DM
                           
                              TF
                            and out-of-plane transformation parameters by maximizing NCC. We use Powell's method with the optimization order of x-, y-rotation, and z-translation. To accelerate the processing speed and avoid the local maxima, a multi-resolution approach is applied. We use three-level Gaussian pyramid with a down-sampling factor of 2 in each dimension. Note that z-translation parameter can be computed by the subtraction between 
                              
                                 
                                    
                                       D
                                       
                                          M
                                          R
                                       
                                    
                                    ¯
                                 
                              
                            and 
                              
                                 
                                    
                                       D
                                       
                                          M
                                          
                                             T
                                             F
                                          
                                       
                                    
                                    ¯
                                 
                              
                            because the mean values of depth map images represent the mean z-coordinates of the corresponding surface models.

In-plane registration method generates the candidate DM
                           
                              TF
                           s by the in-plane transformation of the out-of-plane registered floating depth map image in the previous step. Then, we find the optimal DM
                           
                              TF
                            and the optimal in-plane transformation parameters among the DM
                           
                              TF
                           s by maximizing Eq. (6). We also use Powell's method with the optimization order of x-, y-translation, and z-rotation. To accelerate the processing speed and avoid the local maxima, a multi-resolution approach is applied as out-of-plane registration method. We use three-level Gaussian pyramid with a down-sampling factor of 2 in each dimension.

Subsequently, we perform the fine registration after the depth map-based registration (Fig. 1(d)). Although the depth map-based registration is accurate for coarse registration, its accuracy is not perfect because the generation of 2D depth map image involves projecting only surface point in the closest triangles from the view point and losing the information of surface points in the other triangles. To perform more accurate registration, our surface registration method computes the similarity metric for every surface point in overlapping region. We enhance iterative closest point (ICP) algorithm [9] for the fine surface registration. ICP algorithm is widely used for the alignment of 3D surfaces when the initial estimate of the relative pose is known. Since we compute the accurate initial estimate using depth map-based registration in the previous section, ICP algorithm is appropriate for our fine registration. ICP starts with the reference and floating surface models, and an initial guess for their relative rigid transformation. Then, the overlapping region between the reference and initially transformed floating surface models is determined by finding the common region in bounding boxes from both surface models. The fine registration iteratively refines the transformation by repeatedly generating corresponding point pairs on the reference and transformed floating surface models, and minimizing the following average surface distance (ASD), which is the surface distance in only the current overlapping region.
                           
                              (7)
                              
                                 
                                    A
                                    S
                                    D
                                    =
                                    
                                       1
                                       
                                          
                                             n
                                             
                                                O
                                                F
                                                
                                                   S
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             n
                                             
                                                O
                                                F
                                                
                                                   S
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       max
                                       (
                                       t
                                       h
                                       r
                                       e
                                       s
                                       h
                                       o
                                       l
                                       d
                                       −
                                       m
                                       d
                                       (
                                       
                                          
                                             
                                                P
                                                i
                                             
                                          
                                          
                                             O
                                             F
                                             
                                                S
                                                T
                                             
                                          
                                       
                                       ,
                                        
                                       O
                                       R
                                       S
                                       )
                                       ,
                                        
                                       0
                                       )
                                    
                                    ,
                                 
                              
                           
                        where ORS is the overlapped reference surface model that is the overlapping region in the reference surface model, OFS
                        
                           T
                         is the overlapped transformed floating surface model that is the overlapping region in the transformed floating surface model, n
                        
                           OFS
                           
                              T
                           
                         is the number of points in OFS
                        
                           T
                        , 
                           
                              
                                 
                                    p
                                 
                                 i
                                 
                                    O
                                    F
                                    
                                       S
                                       T
                                    
                                 
                              
                           
                         is the ith point in OFS
                        
                           T
                        , and md(P
                        
                           i
                        
                        
                           OFS
                           
                              T
                           
                        , ORS) is the minimum distance between 
                           
                              
                                 
                                    p
                                 
                                 i
                                 
                                    O
                                    F
                                    
                                       S
                                       T
                                    
                                 
                              
                           
                         and ORS, which is defined as follows:
                           
                              (8)
                              
                                 
                                    m
                                    d
                                    (
                                    
                                       
                                          
                                             P
                                             i
                                          
                                       
                                       
                                          O
                                          F
                                          
                                             S
                                             T
                                          
                                       
                                    
                                    ,
                                     
                                    O
                                    R
                                    S
                                    )
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          j
                                          ∈
                                          1,...
                                          
                                             n
                                             
                                                O
                                                R
                                                S
                                             
                                          
                                       
                                    
                                    d
                                    (
                                    
                                       
                                          
                                             P
                                             i
                                          
                                       
                                       
                                          O
                                          F
                                          
                                             S
                                             T
                                          
                                       
                                    
                                    ,
                                     
                                    
                                       
                                          
                                             P
                                             j
                                          
                                       
                                       
                                          O
                                          R
                                          S
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                        where n
                        
                           ORS
                         is the number of points in ORS and 
                           
                              
                                 
                                    p
                                 
                                 j
                                 
                                    O
                                    R
                                    S
                                 
                              
                           
                         is the jth point in ORS. As described in [22], our fine registration method is decomposed into the following stages. First, our fine registration selects the set of points on the reference surface model randomly, and the closest point for each randomly selected point is found in the transformed floating surface model using Eq. (8). Some point pairs are rejected with point-to-point distance greater than a threshold which is computed by over the 95% confidence interval of all point-to-point distance and the others are used for computing point-to-point error metric using Eq. (7).

For the error minimization, we employ the closed-form iterative minimization technique [23,24]. The closed-form iterative minimization consists of following steps. From the reference and transformed floating surface models, we compute the overlapping region using bounding boxes and a set of corresponding point pairs using the current transformation is generated using Eq. (8). Then, the mean square objective function parameterized by the 3D rigid transformation parameters (R,t) is minimized and the cross-covariance matrix H which can be decomposed by singular value decomposition.
                           
                              (9)
                              
                                 
                                    
                                       H
                                    
                                    =
                                    
                                       U
                                    
                                    
                                       Λ
                                    
                                    
                                       
                                          V
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

New rotation matrix R is VU
                        T and new translation vector t is 
                           
                              
                                 
                                    
                                       p
                                    
                                    ¯
                                 
                                 
                                    O
                                    F
                                    
                                       S
                                       T
                                    
                                 
                              
                              −
                              
                                 R
                              
                              ∘
                              
                                 
                                    
                                       p
                                    
                                    ¯
                                 
                                 
                                    O
                                    R
                                    S
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       p
                                    
                                    ¯
                                 
                                 
                                    O
                                    R
                                    S
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       p
                                    
                                    ¯
                                 
                                 
                                    O
                                    F
                                    
                                       S
                                       T
                                    
                                 
                              
                           
                         is the center of mass in P
                        
                           ORS
                         and P
                        
                           OFS
                           
                              T
                           
                         respectively. After updating rigid transformation parameters, the floating surface model is transformed by updated parameters. Then, the previous steps are revisited using newly transformed floating surface model until ASD from Eq. (7) is converged.

@&#EXPERIMENTAL RESULTS@&#

The proposed surface registration algorithm has been tested on 20 different patient datasets. Each dataset has a number of dental surface models acquired by prototype hardware of 3D dental laser scanner (DDS, Seoul, Korea) whose scanning resolution is 0.1mm. Data output type of this scanner is STL mesh data format. All datasets had no artifacts. The number of surface models per each dataset ranged from 10 to 15 (Table 1
                     ). The surface models were consecutively scanned with the overlapping region. The ratio of overlapping regions between two consecutive surface models was in the range of 17% and 25% surface areas of each surface model. Before the acquisition of laser and CT scans, we got the approval about the participation of our study from all the patients, whose datasets were used in our study. We compared the proposed surface registration algorithm (RProposed) with two methods: depth map-based registration method without ICP registration (RDepthMap) and conventional method based on surface distance minimization (RDistance) [22].

The registration accuracy was visually evaluated by counting the number of consistent surface registration results for each pair of consecutive surface models per a patient. Two dentists with eight years and ten years of clinical experience determined the number of consistent surface registration results, which meant that two consecutive surface models were visually well aligned. Our twenty datasets have 254 surface models and there are totally 234 pairs of consecutive surface models (Table 1). The numbers of consistent surface registration results for RDistance, RDepthMap, and RProposed was 184, 214, and 234, respectively. Two dentists agreed with the visual comparison result. The number of consistent surface registration results increased in order of RDistance, RDepthMap, and RProposed. Thus, RProposed was visually more accurate than RDistance, and RDepthMap whose failure ratios of the registration of consecutive surface models were about 21.4% (= 50/234) and 8.5% (= 20/234), respectively. For the third dataset, Fig. 4
                         showed surface registration results between all the surface models per one patient after applying three registration methods. And Fig. 5
                         showed the detailed view of registration results between some of surface models of the third dataset after applying three registration methods. RDistance failed the appropriate positioning of some consecutive surface models resulting in the failure of the reconstruction of the whole teeth surface (Figs. 4(a) and 5(a)). Although RDepthMap well aligned the overall teeth surfaces, RDepthMap also failed the appropriate positioning of some consecutive surface models (Fig. 4(b) and dashed rectangle in Fig. 5(b)). In contrast, RProposed showed that all the registered surface models were accurately positioned (Figs. 4(c) and 5(c)). And we showed the gold standard surface model acquired from CBCT images as the reference (Fig. 4(d)). For the third dataset, the numbers of consistent surface registration results for RDistance and RDepthMap were 10 and 11, respectively, whereas the number of consistent surface registration results for RProposed was 12. Thus, RProposed was visually more accurate than RDistance and RDepthMap.

The registration accuracy was quantitatively evaluated by computing the total average surface distance (TASD) between registered consecutive surface models of each dataset. TASD of each dataset was measured by averaging the distance values of each point between the reference surface and transformed floating models for all the registered consecutive surface models of each dataset. TASD was defined as follows:
                           
                              (10)
                              
                                 
                                    T
                                    A
                                    S
                                    D
                                    =
                                    
                                       1
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   O
                                                   F
                                                   
                                                      
                                                         
                                                            S
                                                            T
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                
                                                   O
                                                   F
                                                   
                                                      
                                                         
                                                            S
                                                            T
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          d
                                          (
                                          
                                             
                                                p
                                             
                                             j
                                             
                                                O
                                                F
                                                
                                                   
                                                      
                                                         S
                                                         T
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          O
                                          R
                                          
                                             S
                                             
                                                i
                                                ,
                                                i
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    ,
                                 
                              
                           
                        where N is the number of surface models of each patient, ORS
                        
                           i,i+1 and OFS
                        
                           T
                        
                        
                           i,i+1 are the overlapped reference surface model and the overlapped transformed floating surface model for the registration between ith and (i
                        +1)th surface models, and 
                           
                              
                                 n
                                 
                                    O
                                    F
                                    
                                       
                                          
                                             S
                                             T
                                          
                                       
                                       
                                          i
                                          ,
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                         is the number of points in OFS
                        
                           T
                        
                        
                           i,i+1. The function d is defined as the minimum distance between the point in the transformed floating surface model and the reference surface model.

And the mean surface distance error (MSDE) between the integrated surface model of a patient in 3D dental laser scan after the registration, and the gold standard surface model in CBCT scan was also measured. The integrated surface model was generated in the water-tight format by projecting all the surfaces along z-axis, performing the triangularization and removing overlapped points. The gold standard surface model was acquired by extracting the teeth surface using the semi-automatic segmentation of the whole teeth [25] in dental CBCT scans of the same patient, who took the 3D dental laser scanning. 3D CBCT image data was obtained using a dental CT scanner (PaX-Uni3D; VaTech Gyeonggi-do, Korea). Each CBCT image had a matrix size of 800×800. The pixel size was all 0.2 mm×0.2mm and the slice interval was all 0.2mm. We extracted teeth surface by detecting the jaw division plane, separating the individual teeth and modifying the teeth surface manually [25]. MSDE was defined as follows:
                           
                              (11)
                              
                                 
                                    M
                                    S
                                    D
                                    E
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       d
                                       (
                                       
                                          p
                                          i
                                          
                                             I
                                             S
                                          
                                       
                                       ,
                                       G
                                       S
                                       )
                                    
                                    ,
                                 
                              
                           
                        where N is the number of points in the integrated surface model (IS) of a patient, 
                           
                              
                                 
                                    p
                                 
                                 i
                                 
                                    I
                                    S
                                 
                              
                           
                         is the ith point in IS, and GS is the gold standard surface model. The function d is defined as the minimum distance between the point in IS and GS. GS is generated by the iso-surface extraction using the marching cube algorithm [26] from segmented teeth in CBCT images [25]. Then, MSDE was calculated by measuring the average distance using Eq. (11) after the accurate registration between IS and GS using ICP method [9].

In addition, the mean surface distance error (MSDE
                        
                           MRS
                        ) between the integrated surface model of a patient in 3D dental laser scan after the registration, and the manually registered surface model (MRS) in the same 3D dental laser scan was measured. IS was generated in the water-tight format by projecting all the surfaces along z-axis, performing the triangularization and removing overlapped points. MRS was generated by the following procedure. First, a dentist with ten years of clinical experience manually aligned dental surfaces partially scanned by 3D dental laser scanning. Then, manually aligned surfaces were automatically registered using ICP method [9]. Finally, the dentist minutely aligned the registered surface to generate the final MRS. MSDE
                        
                           MRS
                         was defined as follows:
                           
                              (12)
                              
                                 
                                    M
                                    S
                                    D
                                    
                                       E
                                       
                                          M
                                          R
                                          S
                                       
                                    
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       d
                                       (
                                       
                                          p
                                          i
                                          
                                             I
                                             S
                                          
                                       
                                       ,
                                       M
                                       R
                                       S
                                       )
                                    
                                    ,
                                 
                              
                           
                        where N is the number of points in the IS of a patient, 
                           
                              
                                 
                                    p
                                 
                                 i
                                 
                                    I
                                    S
                                 
                              
                           
                         is the ith point in IS. The function d is defined as the minimum distance between the point in IS and MRS.


                        TASDs of each patient for three registration methods are given in Table 1. The average values of TASD of RDistance, RDepthMap, and RProposed are 0.807±0.394, 0.527±0.248, and 0.192±0.098, respectively (Fig. 6
                        ). TASD of RProposed was significantly smaller than that of RDistance by the Student's t-test (p
                        <0.0001). TASD of RProposed was significantly smaller than that of RDepthMap by the Student's t-test (p
                        <0.0001). TASD decreased in order of RDistance, RDepthMap, and RProposed, which was consistent with comparison results in the previous visual assessment. Thus, with respect to TASD, RProposed was the most accurate method comparing with RDistance and RDepthMap. MSDEs of each patient for three registration methods are given in Table 1. The average values of MSDE of RDistance, RDepthMap, and RProposed are 5.422±1.989, 2.307±1.163, and 0.884±0.536, respectively (Fig. 6). MSDE of RProposed was significantly smaller than that of RDistance by the Student's t-test (p
                        <0.0001). MSDE of RProposed was significantly smaller than that of RDepthMap by the Student's t-test (p
                        <0.0001). MSDE decreased in order of RDistance, RDepthMap, and RProposed, which was consistent with comparison results in the previous visual assessment and TASD assessment. The average values of MSDE
                        
                           MRS
                         of RDistance, RDepthMap, and RProposed are 5.617±2.028, 2.533±1.205, and 0.951±0.559, respectively. MSDE
                        
                           MRS
                         of RProposed was significantly smaller than that of RDistance by the Student's t-test (p
                        <0.0001). MSDE
                        
                           MRS
                         of RProposed was significantly smaller than that of RDepthMap by the Student's t-test (p
                        <0.0001). MSDE
                        
                           MRS
                         decreased in order of RDistance, RDepthMap, and RProposed, which was consistent with comparison results in the previous visual assessment, TASD, and MSDE assessment. Thus, RProposed exhibited TASD, MSDE, and MSDE
                        
                           MRS
                         much smaller than those of RDistance and RDepthMap, indicating that RProposed was the most accurate method comparing with RDistance and RDepthMap.

To evaluate the computational performance, we measured the processing time of three registration methods. Table 1 showed the processing time of three methods for registering all the consecutive surface models of each patient. Also, Table 1 showed the processing time of each step of three methods including out-of-plane, in-plane, and fine registrations. The average values of the processing time of RProposed, RDepthMap, and RDistance are 17.151±2.904, 13.174±2.352, and 26.438±3.739, respectively (Fig. 6). The processing time of RProposed was significantly shorter than that of RDistance by the Student's t-test (p
                        <0.0001). The total processing time increased in order of RDepthMap, RProposed, and RDistance. RDepthMap was the fastest because it did not require any computation on 3D fine registration process. And RProposed was about 1.5 times faster than RDistance. Although depth map generation and registration requires additional processing time, the accurate initial estimate of registration parameters using depth map-based registration much reduced the computational time of the overall surface registration comparing with RDistance.


                        Table 2
                         showed the brief comparison of the commercially available dental scanners [27–33]. Each scanner used different technology for 3D model generation [27–33]. The scanners used light stripe projection and active triangulation [29], a parallel confocal imaging technique [30], and active wavefront sampling [31] to measure the distance from the scanner to the object for the generation of a 3D model. Lava COS [27] required teeth to be dusted with a titaniumoxide powder before the scanning. These powder particles on the teeth were used as markers for the registration of 3D surface patches [27]. However, the proposed method doesn’t require any particle (or marker) before the scanning. CEREC Bluecam and iTero scanners required 3D surfaces to be scanned with at least a one-third overlap of the adjoining surface [27]. However, the required overlap ratio of the proposed method is about one-fifth, which is smaller than that of CEREC Bluecam and iTero scanners.

This paper presented the fast and accurate registration method of partially scanned dental surfaces in a 3D dental laser scanning. First, we convert the 3D surface model into a 2D image by generating the 2D depth map image of the surface model by applying the 3D rigid transformation into this model. The corresponding point pairs in each 3D surface model are converted into corresponding image pixels in each 2D depth image. Then, the image-based registration method using 2D depth map images accurately estimates the initial transformation between two surface models. For the accurate registration of 3D surface models, we enhance ICP method for the subsequent fine registration to align 3D surface models exactly. Our initial depth map-based registration well aligns each surface model. Therefore, our subsequent ICP method can accurately register two surface models since it is highly probable that the closest point pairs are the exact corresponding point pairs. The experimental results demonstrated that our method accurately registered partially scanned dental surfaces. Regarding the computational performance, our method delivered about 1.5 times faster registration than the conventional method.

To overcome the multiple points correspondence problems for the conventional surface registration methods, we proposed the depth map-based registration method to initially register 3D surface models. Each pixel in one image corresponds to a pixel in the other image without the multiple correspondences, which guarantees one-to-one point correspondence. To increase the computational efficiency, we decomposed the 3D rigid transformation into out-of-plane transformation and in-plane transformation. For the in-plane transformation, we accelerated the transformation process by transforming 2D depth map image instead of transforming 3D surface model. In this way, our method improves the overall registration accuracy and the computational performance. However the proposed method has limitations. We assumed that our datasets had no artifacts, so that our method might not work successfully for the dataset with a lot of artifacts and if the ratio of overlapping regions between two consecutive surface models is very small (i.e., less than 10%), the proposed method might not work successfully due to the insufficient overlapping information.

In future work, we are planning to further optimize and accelerate the proposed method using a parallel computing architecture such as CUDA (compute unified device architecture) to make it more appropriate for clinical uses. In addition, our method can be extended to the accurate reconstruction of other 3D objects if a set of partial surface models of the object is taken at different positions with sharing overlapped regions.

@&#ACKNOWLEDGEMENTS@&#

This research was partly supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT and Future Planning (No. 2014R1A2A2A03002574). And this work was partly supported by the IT R&D program of MSIP/KEIT. [10044316, Mobile Authoring Platform for High Quality Stereoscopic contents] and this work was partly supported by the ICT R&D program of MSIP/IITP [10044910, Development of Multi-modality Imaging and 3D Simulation-Based Integrative Diagnosis-Treatment Support Software System for Cardiovascular Diseases].

@&#REFERENCES@&#

