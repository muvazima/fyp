@&#MAIN-TITLE@&#Security analysis on a color image encryption based on DNA encoding and chaos map

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The flaws of an image encryption algorithm based on DNA encoding and chaos are founded.


                        
                        
                           
                           According to the flaws, a known plaintext attack is presented to reveal the plain-image from the cipher-image.


                        
                        
                           
                           A remedy is suggested to enhance the security of the image encryption algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cryptanalysis

Image encryption

Chaos-based cipher

DNA encoding

@&#ABSTRACT@&#


               
               
                  Recently, several image encryption algorithms based on DNA encoding and chaotic maps have been proposed, which create a novel direction in image encryption. By a careful examination on most of these image cryptosystems, we find that DNA operators can only influence one DNA base, which leads to poor diffusion. A recent image encryption scheme based on DNA encoding and chaos is treated as a case study. The flaws of this algorithm are illustrated. By applying a known plaintext attack, we demonstrate that a hacker can determine the chaotic sequences used to confuse the image and reveal the plain-image. Finally, a suggestion is given to enhance the diffusion ability of image encryption scheme based on DNA encoding and chaos. The experiment results prove that the suggestion is effective.
               
            

@&#INTRODUCTION@&#

With the development of computer network technologies, secure transmission of confidential digital images has become one of the most important issues in modern communications. Image encryption is different from text encryption due to some intrinsic properties, such as bulky size and high redundancy, which are generally difficult to be handled by traditional techniques. Properties of chaotic systems such as ergodicity and sensitive dependence on initial conditions and system parameters are quite advantageous in information especially image encryption [1–6]. Nowadays, DNA computing is applied to cryptography. DNA cryptogram utilizes DNA as information carrier and takes advantage of biological technology to achieve encryption [7–9]. However, DNA encryption method has its disadvantages such as costly experimental equipment, complicated operations and difficult to grasp its biotechnology. Thus, it still cannot be broadly applied in the field of encryption. In order to overcome these weakness, some operations from DNA computing are employed to confuse information. Moreover, several image encryption algorithms combined DNA operations and chaotic maps are proposed [10–13], which open a new direction to secure image communications and have been attracting more and more researchers’ interests.

Recently, an image encryption algorithm is presented [14], which utilizes DNA addition to scramble pixel values of image and then mask the scrambled image with chaotic maps. The algorithm is simple to implement and its secret key space is large enough to resist exhaustive attack. This paper examines the security of the image encryption algorithm in Ref. [14], where a security problem of this algorithm is found. The problem leads to the algorithm’s vulnerability to attacks on block cipher, such as known plaintext and chosen plaintext attacks. By applying a known plaintext attack, we demonstrate that a hacker can determine the sequence of chaos, which is equivalent to the secret key, and exploit it to reveal the plain-image. Finally, we suggest a remedy to the loophole, which is important to the design of image encryption scheme based on DNA encoding and chaos.

The rest of the paper is organized as follows. Section 2 briefly introduces the image encryption algorithm in Ref. [14]. The flaws in the algorithm are illustrated and the related security problem is analyzed in Section 3. Section 4 demonstrates known plaintext attack on the image encryption algorithm. Some measures to remedy the loophole of this algorithm are suggested in Section 5. Finally, conclusion is drawn in Section 6.

The algorithm in Ref. [14] uses the encoded matrix of DNA sequence to carry out DNA addition operation. Then, the DNA encoded image is encrypted under the control of two chaotic maps which are shown in Eqs. (1) and (2).
                        
                           (1)
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                              x
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    y
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    n
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                              y
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                        
                     where 
                        
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           ∈
                           [
                           3.569945
                           ,
                           4
                           ]
                        
                      (i
                     =1, 2) is the control parameter of the logistic map. The keys of the image encryption algorithm include x
                     0, y
                     0, μ
                     1, μ
                     2, k
                     1 and k
                     2. 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                      are the initial values of Eqs. (1) and (2), respectively. k
                     1 and k
                     2 are two integer numbers, which are both in interval [1,8]. The image encryption algorithm is briefly described as follows and an illustration is given in Fig. 1
                     .


                     Step 1. Define m and n as the image dimension of rows and columns, respectively. According to RGB level of image A, decomposes A into three level matrices R, G, B with size (m, n). Transform R, G, B to the corresponding binary matrices Rb, Gb and Bb with size (m, n
                     ×8). According to the DNA encoding rules shown in Table 1
                     , Rb, Gb and Bb are encoded to the corresponding DNA matrices Ar, Ag and Ab with size (m, n
                     ×4) under the control of k
                     1.


                     Step 2. Perform the DNA addition operation on Ar, Ag and Ab as below:
                        
                           (3)
                           
                              
                                 
                                    Ar
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              Ar
                              (
                              i
                              ,
                              j
                              )
                              +
                              Ag
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ×
                              4
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    Ag
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              Ag
                              (
                              i
                              ,
                              j
                              )
                              +
                              Ab
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ×
                              4
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    Ab
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    Ag
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              Ab
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ×
                              4
                           
                        
                     
                  


                     Step 3. Generate a chaotic sequence xi
                      (i=
                     1, 2, …, l), by iterating Eq. (1), whose length is l
                     =
                     m
                     ×
                     n
                     ×4. Obtain a binary sequence zi
                      according to the threshold function shown in Eq. (6), whose length is also l. Then, transform the binary sequence zi
                     , i
                     =1, 2, …, l to a matrix Z with size (m, n
                     ×4).
                        
                           (6)
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                0
                                                <
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⩽
                                                0.5
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                0.5
                                                <
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Step 4. Repeat executing the following operation from i
                     =1 to m and j
                     =1 to n
                     ×4:

If Z(i, j)=1, do DNA complement on Ar′(i, j), Ag′(i, j) and Ab′(i, j).


                     Step 5. According to the DNA map rule selected by k
                     2, translate the DNA matrices Ar′, Ag′ and Ab′ to the binary matrices Rb′, Gb′ and Bb′, respectively. Note, Rb′, Gb′ and Bb′ have the same size (m, n
                     ×8). Then, translate Rb′, Gb′ and Bb′ to the corresponding byte matrices R′, G′ and B′ with size (m, n).


                     Step 6. Generate a sequence yi
                      (i
                     =1, 2, …, m
                     ×
                     n) by iterating Eq. (2) and map yi
                      from (0, 1) to {0, 1, 2, …, 255}. Finally, the integer matrix Y with size (m, n) is obtained.


                     Step 7. Do the XOR operation as below
                        
                           (7)
                           
                              
                                 
                                    R
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ⊕
                              Y
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    G
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ⊕
                              Y
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    B
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ⊕
                              Y
                              (
                              i
                              ,
                              j
                              )
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              ;
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                  


                     Step 8. Compose 
                        
                           
                              
                                 R
                              
                              
                                 ″
                              
                           
                        
                     , 
                        
                           
                              
                                 G
                              
                              
                                 ″
                              
                           
                        
                      and 
                        
                           
                              
                                 B
                              
                              
                                 ″
                              
                           
                        
                      to a RGB image, which is the encrypted color image.

For a detail explanation of this image encryption algorithm, it is highly recommended the thorough reading of Ref. [14].

In the process of the above image encryption, the DNA complement operation in Step 4 is solely controlled by matrix Z and the XOR operation in Step 7 is only determined by the matrix Y. Thus, the effect of Z and Y is identical to that of keys x
                     0, y
                     0, μ
                     1, μ
                     2. For attacker, obtaining Z and Y is similar to getting the keys. Moreover, the two matrices Z and Y are both independent of the plaintext. It is the flaw of the algorithm that the matrices Z and Y are only determined by x
                     0, μ
                     1 and y
                     0, μ
                     2, respectively. This flaw enables known plaintext attack. To demonstrate the security loophole caused by this flaw, we first encrypt two different images named Lena and Plane shown in Figs. 2 and 3
                     
                     . The secret keys are set to x
                     0
                     =0.501, y
                     0
                     =0.401, μ
                     1
                     =3.81, μ
                     2
                     =3.68, k
                     1
                     =1 and k
                     2
                     =7. We fill the first ten pixel values of the plain-images, the cipher-images, and the corresponding elements of Z and Y used to encrypt these ten pixels into Tables 2 and 3
                     
                     , respectively. From Tables 2 and 3, we observe that the elements in Z and Y are totally identical. This is not caused by coincidence, but resulted from the flaw mentioned above. Once x
                     0, μ
                     1 and y
                     0, μ
                     2 are determined, the matrices Z and Y are fixed too, regardless of the plaintext.

It is well known that confusion and diffusion are two basic design criteria for encryption algorithms. The confusion operation complicates the dependence of the statistics of ciphertext on that of the plaintext. Diffusion spreads out the influence of a single plaintext symbol over many ciphertext symbols so as to hide statistical structure of plaintext. In the process of the above image encryption, five main operations are needed from the plain-pixel to the cipher-pixel. They are: DNA coding, DNA addition, DNA complementation, DNA decoding and XOR operation. Although the XOR operation makes the masked values have uniform distribution, it has no contribution to the diffusion. Since one DNA base is expressed in two-bit number, the DNA operations, such as DNA addition and DNA complementation, can only influence two bits of one pixel. Thus, the diffusion ability of DNA operations is poor. Furthermore, the image pixels are encrypted one by one. The changes in one pixel cannot spread to other pixels, which leads to the poor diffusion of the image encryption algorithm described in Section 2. To verify this flaw, we change the R level value of the first pixel of image Lena from 226 to 225. Then, encrypt the changed image with the same key. The first ten pixel values of the plain-image and cipher-image are listed in Table 4
                     . Compared with the ciphertexts in Table 2, it can be seen that 1-bit change in plain-image only causes 1-bit change in the cipher-image, which shows that the diffusion effect is not apparent.

When cryptanalyzing an encryption algorithm, the general assumption is that the cryptanalyst knows all details of the algorithm except the key. Cryptanalysis is the study of taking encrypted data, and trying to decrypt it without use of the key. There are numerous techniques to perform cryptanalysis, depending on what access the cryptanalyst has to the plaintext, ciphertext, or other aspects of the cryptosystem. Here, the most common types of attacks are listed, ordered from the hardest type of attack to the easiest as follows:
                           
                              (i)
                              
                                 Ciphertext only attack: the cryptanalyst only possesses some pieces of ciphertexts. It is probably the most difficult type of cryptanalysis.


                                 Known plaintext attack: the cryptanalyst have some plaintexts and the corresponding ciphertexts.


                                 Chosen plaintext attack: the cryptanalyst owns the encryption machinery. Hence he can choose any plaintexts and obtain the corresponding ciphertexts.


                                 Chosen ciphertext attack: the cryptanalyst owns the decryption machinery. Hence he can choose any ciphertexts and obtain the corresponding plaintexts.

In each of these four attacks, the objective is to determine the key. As long as the key is figured out through one of the attacks mentioned above, the cryptosystem is considered as insecure.

From the above analysis, we know that five main operations, i.e. DNA coding, DNA addition, DNA complementation, DNA decoding and XOR operation, are needed when encrypting a plain-image pixel. DNA coding changes a two bit binary number to a DNA base under the control of k
                        1. DNA decoding performs the reverse change of DNA coding, that is, converting the DNA base to a two bit binary number under the control of k
                        2. Since k
                        1 and k
                        2 are usually different, the two bit binary number is probably converted to another two bit binary number after executing DNA coding and DNA decoding. Thus, DNA coding and DNA decoding can be replaced by a substitution operation of two bit binary number. According to the DNA map rules shown in Table 1, we construct eight 2×2 substitution boxes (S-boxes) shown in Table 5
                        . Undoubtedly, we can always find an S-box in Table 5 which has the equivalent effect to DNA coding and DNA decoding, no matter what values are set to k
                        1 and k
                        2.

Suppose ri
                        
                        ,
                        
                           j
                        , gi
                        
                        ,
                        
                           j
                         and bi
                        
                        ,
                        
                           j
                         are the R, G, B level value of the pixel (i, j). Expressing ri
                        
                        ,
                        
                           j
                        , gi
                        
                        ,
                        
                           j
                         and bi
                        
                        ,
                        
                           j
                         in binary representation, we have
                           
                              (10)
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ⋯
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ⋯
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ⋯
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                           
                        where function fi
                        (x) returns the ith bit of x.

Based on the algorithm and above analysis, the process of encrypting pixel (i, j) can be re-described as follows:


                        Step 1. Perform the DNA addition on pixel (i, j) and we have
                           
                              (13)
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 mod
                                 4
                                 
                                 k
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 mod
                                 4
                                 
                                 k
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 mod
                                 4
                                 
                                 k
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                              
                           
                        where r′
                           i
                        
                        ,
                        
                           j
                        , g′
                           i
                        
                        ,
                        
                           j
                         and b′
                           i
                        
                        ,
                        
                           j
                         are the R, G, B level value of pixel (i, j) after DNA addition is executed.


                        Step 2. Execute DNA complementation to r′
                           i
                        
                        ,
                        
                           j
                        , g′
                           i
                        
                        ,
                        
                           j
                         and b′
                           i
                        
                        ,
                        
                           j
                        . Suppose 
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              
                                 
                                    f
                                 
                                 
                                    3
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              
                                 
                                    f
                                 
                                 
                                    4
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                         is the control number of DNA complementation. Since the DNA base can be seen as a two bit binary number, DNA complementation is equivalent to a special XOR expression as below
                           
                              
                                 D
                                 ⊕
                                 F
                              
                           
                        where D is the two bit binary number mapped to the DNA base, F is also a two bit binary number composed only by 
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        , i.e. 
                           
                              F
                              =
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        . Thus, we can get the following expressions.
                           
                              (16)
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   
                                                   if
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                   otherwise
                                                
                                             
                                          
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          ,
                                          4
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   
                                                   if
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (18)
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                               k
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   
                                                   if
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                     


                        Step 3. Do the DNA decoding operation. According to the above analysis, the DNA decoding is equivalent to the substitution of two bit binary number. Suppose Sq
                         is the substitution box replacing DNA decoding. The outputs of this Step are listed as below:
                           
                              (19)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                     

Based on Table 5, we can see that if the two-bit number x is the complement of y, Sq
                        (x) is also the complement of Sq
                        (y). Thus, we have:
                           
                              (22)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ⊕
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                     

Juxtaposes all two-bit numbers from left to right to get an 8-bit number. Define 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                              ,
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                           
                         as the 8-bit juxtaposed number. Then, we have
                           
                              (25)
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       7
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 =
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ∘
                                 
                                    
                                       S
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       7
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 )
                                 ⊕
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           
                        where Di
                        
                        ,
                        
                           j
                        
                        =
                        f
                        1(zi
                        
                        ,
                        
                           j
                        )f
                        1(zi
                        
                        ,
                        
                           j
                        )f
                        2(zi
                        
                        ,
                        
                           j
                        )f
                        2(zi
                        
                        ,
                        
                           j
                        )f
                        3(zi
                        
                        ,
                        
                           j
                        )f
                        3(zi
                        
                        ,
                        
                           j
                        )f
                        4(zi
                        
                        ,
                        
                           j
                        )f
                        4(zi
                        
                        ,
                        
                           j
                        ), The operator ∘ means connecting the two-bit numbers; Function 
                           
                              
                                 
                                    SB
                                 
                                 
                                    q
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    S
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              ∘
                              
                                 
                                    S
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    4
                                 
                              
                              )
                              ∘
                              
                                 
                                    S
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    5
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    6
                                 
                              
                              )
                              ∘
                              
                                 
                                    S
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    7
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    8
                                 
                              
                              )
                           
                         and xi
                         is the ith bit of x.

Similarly, we get:
                           
                              (26)
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           
                        
                     


                        Step 4. Xor 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ″
                                 
                              
                           
                         with Y(i, j) and output the cipher-pixel. Suppose 
                           
                              
                                 
                                    Cr
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Cg
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Cb
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         are the R, G, B level value of the cipher-pixel, respectively. Thus, we have:
                           
                              (28)
                              
                                 
                                    
                                       Cr
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       Cg
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       Cb
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ″
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                        
                     

Although the image encryption algorithm proposed in Ref. [14] looks like a block cipher, it behaves as a stream cipher indeed. The operations of the above encryption scheme as a stream cipher can be explained as follows. The three sequences r′
                           i
                        
                        ,
                        
                           j
                        , g′
                           i
                        
                        ,
                        
                           j
                         and b′
                           i
                        
                        ,
                        
                           j
                        , i
                        =1,2, … m; j
                        =1,2, …, n are regarded as the plaintexts. The keys k
                        1 and k
                        2 are used to determine Sq
                        . The other keys x
                        0, y
                        0, μ
                        1, μ
                        2 and the two logistic maps are used to generate keystream K
                        
                        =
                        (D
                        1
                        
                           ,
                        
                        1 
                        Y(1,1))(D
                        1
                        
                           ,
                        
                        2 
                        Y(1,2)) … (D
                        1
                        
                           ,n Y(1,n))(D
                        2
                        
                           ,
                        
                        1 
                        Y(2,1)) … (Dm
                        
                        ,
                        
                           n Y(m,n)). This keystream is used to encrypt the plaintexts according to the following rules:
                           
                              (31)
                              
                                 Cr
                                 =
                                 
                                    
                                       Cr
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       Cr
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cr
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cr
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 1
                                 )
                                 )
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 2
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 m
                                 ,
                                 n
                                 )
                                 )
                              
                           
                        
                        
                           
                              (32)
                              
                                 Cg
                                 =
                                 
                                    
                                       Cg
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       Cg
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cg
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cg
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 1
                                 )
                                 )
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 2
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 m
                                 ,
                                 n
                                 )
                                 )
                              
                           
                        
                        
                           
                              (33)
                              
                                 Cb
                                 =
                                 
                                    
                                       Cb
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       Cb
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cb
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⋯
                                 
                                    
                                       Cb
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 1
                                 )
                                 )
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 1
                                 ,
                                 2
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 )
                                 ⋯
                                 (
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       m
                                       ,
                                       n
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 m
                                 ,
                                 n
                                 )
                                 )
                              
                           
                        
                     

Decrypting the ciphertext Cr, Cg and Cb can be accomplished by computing the keystream (Di,j Y(i,j)) and SBq
                        . Thus, (Di,j Y(i,j)) and SBq
                         are equivalent to the secrete keys. Moreover, Di
                        
                        ,
                        
                           j
                         is constructed according to the matrix Z. As the matrix Z, Di
                        
                        ,
                        
                           j
                         is independent of the plaintext and only determined by the key.

Suppose CI is a color cipher-image with size (u, v) needed to be broken. Color image A is a known plain-image which has the same size with CI, and CA is the corresponding cipher-image. Our known plaintext attack is described below and an illustration is given in Fig. 4
                        :


                        Step 1. Assume CIr, Ar and CAr are the R level values of CI, A and CA, respectively. The DNA addition result of Ar is defined as Ar′. According to Eq. (26), we have:
                           
                              (34)
                              
                                 
                                    
                                       CAr
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       SB
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 
                                    
                                       Ar
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⊕
                                 Y
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ,
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        
                     

Since Ar is known, we can calculate Ar′ according to Eq. (3). Since SBq
                         is unknown, the substitution value of 
                           
                              
                                 
                                    Ar
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                           
                         cannot be determined. However, there are only 8 different S-boxes in Table 5. It is very easy to enumerate all possible substitution results of SBq
                        . We perform Xor operation and obtain the following 8 sequences:
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        Obviously, SBq
                        (Ar′
                           i,j
                        ) must be one of {SB
                        1(Ar′
                           i,j
                        ), SB
                        2(Ar′
                           i,j
                        ), … , SB
                        8(Ar′
                           i,j
                        )}. Therefore, the keystream Di
                        
                        ,
                        
                           j
                        
                        ⊕
                        Y(i,
                        j) must be a sequence in the following set:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                CAr
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          ⊕
                                          
                                             
                                                SB
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                Ar
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                CAr
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          ⊕
                                          
                                             
                                                SB
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                Ar
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ,
                                          ⋯
                                          ,
                                          
                                             
                                                CAr
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          ⊕
                                          
                                             
                                                SB
                                             
                                             
                                                8
                                             
                                          
                                          (
                                          
                                             
                                                Ar
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Step 2. For k
                        =1, 2, …, 8, calculate the following Xor results of 
                           
                              
                                 
                                    CIr
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    CAr
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ⊕
                              
                                 
                                    SB
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    Ar
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         as below:
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        Owing to 
                           
                              
                                 
                                    CIr
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    SB
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    Ir
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                              )
                              ⊕
                              
                                 
                                    D
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ⊕
                              Y
                              (
                              i
                              ,
                              j
                              )
                           
                        , it is easy to deduce that 
                           
                              
                                 
                                    SB
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    Ir
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         must be a sequence in Expression (36). Suppose RSq
                         is the reverse S-box of SBq
                        . The sequence Ir′
                           i
                        
                        ,
                        
                           j
                         must be in Eq. (37).
                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         1
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         2
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         8
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAr
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ar
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        Similarly, Ig′
                           i
                        
                        ,
                        
                           j
                         and Ib′
                           i
                        
                        ,
                        
                           j
                         must be in Eqs. (38) and (39), respectively.
                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         1
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ag
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         2
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ag
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         8
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAg
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ag
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         1
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ab
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         1
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ab
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         1
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         RS
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         CIb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         CAb
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         SB
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ab
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 u
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 ν
                              
                           
                        
                     


                        Step 3. Recover all possible plain-images. Since the eight possible values of Ir′
                           i
                        
                        ,
                        
                           j
                        , Ig′
                           i
                        
                        ,
                        
                           j
                         and Ib′
                           i
                        
                        ,
                        
                           j
                         are determined. According to the reverse rule of DNA addition shown in Eqs. (40)–(42), the R, G, B level values of the plain-image pixel (i, j), i.e. Iri
                        
                        ,
                        
                           j
                        , Igi
                        
                        ,
                        
                           j
                         and Ibi
                        
                        ,
                        
                           j
                         can be calculated. With the same way, all possible R, G, B level values of plain-image are obtained. Finally, eight possible plain-images of CI are recovered. Making use of the redundancy and correlation of image data, it is easy to get the final plain-image I.
                        
                           
                              (40)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 mod
                                 4
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 mod
                                 4
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 mod
                                 4
                              
                           
                        where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                                 .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ir
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ig
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Ib
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                                 .
                              
                           
                        
                     

In our known plaintext attack, we need a plain-image A and its cipher-image CA. They have the same size as cipher-image CI that we want to attack. Suppose the time complexity of encrypting image A is O(Tencryption
                        ). To estimate the attack time, we defines O(T
                        1), O(T
                        2), O(T
                        3) and O(T
                        4) as the time complexity of processing one pixel by DNA coding, Xor operation, DNA addition and decomposing the pixel to its R, G, B components, respectively. Moreover, we can get that the time complexity of composing R, G, B components to a pixel is also O(T
                        4) and DNA decoding has the same time complexity with DNA coding. According to the description in Section 4.2, Di,j
                        , Y(i,j) and SBq
                         are equivalent to the secrete keys, which are used to decrypt CI(i, j). Since SBq
                         is hard to be determined, we try to obtain all possible Di,j
                         and Y(i,j). The time complexity of getting all possible Di,j
                         and Y(i,j) is denoted as O(T)
                           i
                        
                        ,
                        
                           j
                        . Based on Fig. 4, it can be calculated as below
                           
                              (43)
                              
                                 O
                                 
                                    
                                       (
                                       T
                                       )
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        For the encrypted image CI with size (m, n), the time complexity of getting all possible keystreams is shown in Eq. (44). Furthermore, according to the steps in Fig. 4, the time complexity of recovering the encrypt image CI is easy to be calculated and formulated in Eq. (45)
                        
                           
                              (44)
                              
                                 O
                                 (
                                 T
                                 )
                                 =
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       encryption
                                    
                                 
                                 )
                                 +
                                 m
                                 ×
                                 n
                                 ×
                                 (
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 )
                                 =
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       encryption
                                    
                                 
                                 )
                                 +
                                 m
                                 ×
                                 n
                                 ×
                                 (
                                 2
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 (
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 )
                                 )
                              
                           
                        
                        
                           
                              (45)
                              
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       encryption
                                    
                                 
                                 )
                                 +
                                 m
                                 ×
                                 n
                                 (
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 )
                                 +
                                 m
                                 ×
                                 n
                                 (
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 8
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 )
                                 =
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       encryption
                                    
                                 
                                 )
                                 +
                                 m
                                 ×
                                 n
                                 (
                                 16
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 16
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 9
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 11
                                 ×
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 )
                              
                           
                        From Eqs. (44) and (45), it can be concluded that the time complexity to get the key is low and our attack has high efficiency.

Without loss of generality, we encrypt a bitmap image named Lena with the scheme in Ref. [14] and break it by our approach of known plaintext attack. The plain-image and cipher-image of Lena are denoted as I and CI, respectively. The bitmap image named Plane and its cipher-image are both known, which are denoted as A and CA, respectively. The main process of attack is shown in Figs. 5–10
                        
                        
                        
                        
                        
                        .

The image Plane A is divided into three parts Ar, Ag and Ab. Then, Ar′, Ag′ and Ab′ are obtained, which is illustrated in Fig. 5. Fig. 6 shows the results of decomposing CI. The process of getting all possible images of Ir′ is shown in Fig. 7. Similarly, all possible images of Ig′ and Ib′ are given in Fig. 8. Based on Ir′, Ig′ and Ib′, all possible images of Ir, Ig and Ib are calculated, which are illustrated in Fig. 9. Finally, the eight possible color images are recovered and shown in Fig. 10.

For most DNA operators, they can only influence one DNA base. It means that the changes in one DNA base can be hardly transferred to the adjacent bases only by DNA operators. Thus, some special operations should be added to improve the diffusion ability of image encryption algorithm based on DNA encoding and chaos. Here, we give the following general measures.

Since chaotic sequences are sensitive to the control parameters and status values, the changes of one DNA base can be enlarged and diffused by using the DNA results as feedback to adjust the parameters, status values or iteration number. By the evolvement of chaotic map, the changes will become more and more remarkable.

Here, the image encryption algorithm proposed by Ref. [14] is used as a case to demonstrate our suggestion. We add two feedbacks to adjust the iteration number before extracting value from chaos. In the first feedback, the operations in Steps 3 and 4 are combined and modified as follows:

Set v
                     0
                     =0. For i
                     =1, 2, 3, …, m
                     ×
                     n
                     ×4, generate xi
                      by iterating Eq. (1) for vi
                     
                     −
                     1 times and obtain zi
                      according to Eq. (6). Calculate two integer values j and k according to Eqs. (46) and (47).
                        
                           (46)
                           
                              j
                              =
                              ⌈
                              i
                              /
                              (
                              n
                              ×
                              4
                              )
                              ⌉
                           
                        
                     
                     
                        
                           (47)
                           
                              k
                              =
                              mod
                              (
                              i
                              -
                              1
                              ,
                              n
                              ×
                              4
                              )
                              +
                              1
                           
                        
                     where function 
                        
                           ⌈
                           x
                           ⌉
                        
                      returns the smallest integer not less than x. If zi
                        
                     =1, do the DNA complement on Ar′(j, k), Ag′(j, k) and Ab′(j, k). Then, translate Ar′(j, k) to a two-bit number vi
                      under the control of k
                     1. In the second feedback, the operations in Steps 6 and 7 in Ref. [14] are merged as below:

Set w
                     0
                     =1. For i
                     =1, 2, 3, …, m
                     ×
                     n, generate yi
                      by iterating Eq. (2) for wk
                     
                     −1 times. Calculate two integer values j and k according to Eqs. (48) and (49).
                        
                           (48)
                           
                              j
                              =
                              ⌈
                              i
                              /
                              n
                              ⌉
                           
                        
                     
                     
                        
                           (49)
                           
                              k
                              =
                              mod
                              (
                              i
                              -
                              1
                              ,
                              n
                              )
                              +
                              1
                           
                        
                     Map yi
                      from (0, 1) to {0, 1, 2, …, 255} and get Yi
                     . Do the following XOR operation.
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              =
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              ⊕
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    R
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              -
                              1
                              )
                           
                        
                     
                     
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              =
                              
                                 
                                    G
                                 
                                 
                                    ′
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              ⊕
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              -
                              1
                              )
                           
                        
                     
                     
                        
                           
                              
                                 
                                    B
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              (
                              j
                              ,
                              k
                              )
                              ⊕
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              ⊕
                              
                                 
                                    B
                                 
                                 
                                    ″
                                 
                              
                              (
                              j
                              ,
                              k
                              -
                              1
                              )
                           
                        
                     Here, the initial values 
                        
                           
                              
                                 R
                              
                              
                                 ″
                              
                           
                           (
                           1
                           ,
                           0
                           )
                           =
                           0
                           ,
                           
                              
                                 G
                              
                              
                                 ″
                              
                           
                           (
                           1
                           ,
                           0
                           )
                           =
                           0
                           ,
                           
                              
                                 B
                              
                              
                                 ″
                              
                           
                           (
                           1
                           ,
                           0
                           )
                           =
                           0
                        
                     . Then, calculate wk
                      according to Eq. (50)
                     
                        
                           (50)
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              =
                              mod
                              (
                              
                                 
                                    R
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              +
                              
                                 
                                    B
                                 
                                 
                                    ″
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                              ,
                              256
                              )
                           
                        
                     From the analysis in Section 3, we know that the matrices Z and Y are independent of plaintext, which causes the encryption algorithm in Ref. [14] vulnerable to known plaintext attack. After employing our suggestion, we encrypt the images Lena and Plane again with the same secrete key, i.e. x
                     0
                     =0.501, y
                     0
                     =0.401, μ
                     1
                     =3.81, μ
                     2
                     =3.68, k
                     1
                     =1 and k
                     2
                     =7. Similarly, the first ten pixel values of the plain-images and cipher-images are listed in Tables 6 and 7
                     
                     . The corresponding elements of Z and Y used to encrypt these first ten pixels are also filled into Tables 6 and 7, respectively.

From Tables 6 and 7, it can be seen that different plain-images have different matrices Z and Y, which shows that the loophole is remedied. Moreover, we change the R level value of the tenth pixel of image Lena from 225 to 226 and encrypt the original and modified images with the algorithm in Ref. [14] and the method using the feedbacks, respectively. The comparisons of the first 512 pixels of the cipher-images are shown in Figs. 11 and 12
                     
                     . It is obvious that the diffusion is improved.

In order to improve the diffusion of image encryption scheme, Hamming distance of plain-image is used to set the initial value of chaotic map in Ref. [10]. Similarly, the image hash value is employed in Ref. [12]. These two measures also have apparent effect on enhancing diffusion. But the computation of these two measures is larger than that of our suggestion, which means that our suggestion has higher efficiency.

@&#CONCLUSION@&#

Owing to its merits in information processing, such as massive parallelism, huge storage and low power consumption, DNA computing becomes more and more popular in image encryption. After studying several image encryption algorithms based on DNA encoding and chaos, we find that DNA operations can eliminate the correlation between two adjacent image pixels, but they do not have enough diffusion ability. If DNA coding is not properly combined with diffusion operations, the loophole may exist in image encryption scheme. In this paper, the weakness of a color image encryption algorithm based on DNA coding and chaos is discovered. The main loophole is that the algorithm do not have enough diffusion ability. A special known plaintext attack on this algorithm is proposed based on the loophole. Simulation tests show that our attack is effective and has high efficiency.

As we know, confusion and diffusion are two basic design criteria for encryption algorithms. Since most DNA operations do not have enough diffusion to satisfy the need of information security, some special operations should be added to improve this ability when designing image encryption algorithm based on DNA coding. To remedy the vulnerability of the image encryption algorithm, an improved suggestion is presented which uses two feedbacks to adjust iteration number of chaotic system. With iterations of chaotic system, a tiny difference in two plain-images can cause substantial changes between the corresponding cipher-images, which prove the effectiveness of our remedy. Moreover, our remedy measure is easy to be implemented, has low computation quantity and keeps all excellent properties of the original algorithm. Therefore, the enhanced algorithm is more suitable for the secure transmission of confidential images over the Internet.

@&#ACKNOWLEDGEMENTS@&#

The work described in this paper was supported by the National Natural Science Foundation of China (Nos. 61472464, 61272400), the Natural Science Foundation of Chongqing Science and Technology Commission (Nos. cstc2013jcyjA40017, cstc2014jcyjA40047), the Scientific and Technological Research Program of Chongqing Municipal Education Commission (Nos. KJ120506, KJ1400403) and the Natural Science Foundation of CQUPT (A2011-20).

@&#REFERENCES@&#

