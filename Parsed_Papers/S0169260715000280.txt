@&#MAIN-TITLE@&#SplicingTypesAnno: Annotating and quantifying alternative splicing events for RNA-Seq data

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           User friendly R-package for identifcation, annotating and analyzing alternative splicing events from RNA-Seq.


                        
                        
                           
                           Provide annotation for major alternative splicing at exon/intron level and identifies novel alternative splicing events using the GTF/GFF file.


                        
                        
                           
                           Generates user-friendly web report and additional BED files for IGV visualization.


                        
                        
                           
                           Provides comprehensive genome scale analysis for users with High Performance Computing (HPC) and Gene-level analysis for memory efficient personal computers.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

R package

Genome-scale annotation

Gene-scale annotation

Splicing junction

@&#ABSTRACT@&#


               
               
                  Alternative splicing plays a key role in the regulation of the central dogma. Four major types of alternative splicing have been classified as intron retention, exon skipping, alternative 5 splice sites or alternative donor sites, and alternative 3 splice sites or alternative acceptor sites. A few algorithms have been developed to detect splice junctions from RNA-Seq reads. However, there are few tools targeting at the major alternative splicing types at the exon/intron level. This type of analysis may reveal subtle, yet important events of alternative splicing, and thus help gain deeper understanding of the mechanism of alternative splicing. This paper describes a user-friendly R package, extracting, annotating and analyzing alternative splicing types for sequence alignment files from RNA-Seq. SplicingTypesAnno can: (1) provide annotation for major alternative splicing at exon/intron level. By comparing the annotation from GTF/GFF file, it identifies the novel alternative splicing sites; (2) offer a convenient two-level analysis: genome-scale annotation for users with high performance computing environment, and gene-scale annotation for users with personal computers; (3) generate a user-friendly web report and additional BED files for IGV visualization. SplicingTypesAnno is a user-friendly R package for extracting, annotating and analyzing alternative splicing types at exon/intron level for sequence alignment files from RNA-Seq. It is publically available at https://sourceforge.net/projects/splicingtypes/files/ or http://genome.sdau.edu.cn/research/software/SplicingTypesAnno.html.
               
            

@&#BACKGROUND@&#

Alternative splicing plays a key role in the central dogma. By skipping introns and linking the selective exons together, it acts as the essential component of the transcription and enables production of various transcripts. This process may generate different isoforms which may lead to different protein products, thus impacting the final phenotype. During this process, many epigenetic features have been proved to function as supplementary mechanisms, including DNA methylation, nucleosome occupancy, histone modifications [1]. Also, alternative splicing has been proven to be highly related to tissue and developmental stages [2–4]. The final transcript structure directly affects the protein production. It has been found that 15% mutations result in irregular function of alternative splicing, causing hereditary disease [5]. In addition, nonsense or missense mutations may also modify the alternative splicing, and in turn lead to diverse diseases [6].

Alternative splicing has four main types: intron retention, exon skipping, alternative 5 splice sites or alternative donor sites, and alternative 3 splice sites or alternative acceptor sites [7,8]. Intron retention is the major type found in plants [9–12], yeast [13] as well as fungus [14]. It is confirmed that intron retention is not spurious and has significant biological functions [7,15]. Another type of alternative splicing, exon skipping, is proved to be most dominant type in the human and mouse [16,17]. Kim et al. compared eight eukaryotes species with expressed sequence tag (EST) data, and they found the percentage of exon skipping in alternative splicing grows slightly from invertebrates to vertebrates [18]. Through protein shifting, exon skipping changes the protein structure completely.

RNA-Seq, as a cutting-edge technology, can help researchers to investigate RNA with single-base resolution, including detection of novel isoforms [19–23]. Many tools have been developed to address diverse genomic features [24–26]. Specifically, a lot of software have been developed to detect splice junctions from RNA-Seq reads, including tophat [27], HMMsplicer [28] and spliceGrapher [29]. These tools are based on different algorithms to predict splicing junction sites. SwitchSeq [35] is a perl-based tool specifically designed for identifying the extreme cases of the alternative splicing. By comparing the expression levels from two isoforms, it provides a platform to screen, identify and visualize those special events. AltAnalyze [36] is a python tool originally designed for detecting alternative splicing in microarray. Recently it is extended to analyze RNA-Seq data and detect junction sites based on some statistical methods such as ASPIRE. Also, MISO provides isoform-level analysis to compare expression levels across samples [2] and utilizes Bayesian method to infer isoforms for the major splicing types from current known annotation. Alt Event Finder [37] and spliceR [38] are two similar tools to MISO, which take a different approach to identify the novel splicing events. Using the results from some transcript assembly tools (Cufflinks and Scripture), they help users to identify the novel transcripts, and generate de novo annotation for alternative splicing. However, they heavily depend on the results from those assembly tools, which were developed to quantify different isoforms based on some probability framework. This may overlook some fine, yet important novel splicing in the low-expression transcripts such as long non-coding RNAs [39].

SplicingTypesAnno is an R package that takes an event-based approach to detect the novel splicing directly from the aligned raw reads. By pinpointing the difference of the splicing junction at exon-level, it targets the individual splicing events with much higher resolution than any other software. Using this direct support from alignment file, it can easily discover any novel features instead of overlooking those splicing structures because of low coverage. Specially, it takes the alignment file, i.e., the bam file as input, and analyzes the raw reads through the pipeline with searching algorithms, and defines the related alternative splicing types, finally generates a user-friendly web report for users. In addition, it provides high flexibility for users to handle large set of data by genome-scale and gene-scale functions. In the genome-scale annotation, users can make use of computer clusters with parallel computing feature to speed up the multiple sample analysis. In the gene-scale annotation, users can conveniently extract the related alternative splicing events with a single laptop. The output also includes BED format in the web report, which can be easily imported to Integrative Genomics Viewer (IGV) [30] for visualization. SplicingTypesAnno can be applied to diverse species with the GTF files.

@&#METHODS@&#

Alternative splicing includes exon skipping, intron retention, alternative donor sites, alternative acceptor sites, and both 5′ and 3′ alternative sites. There are also some other forms with small percentage, which is not discussed in this software. For EST data, researchers define these alternative splicing events based on two alternative isoforms [31,32]. For RNA-Seq data with large quantities of short reads, the definition for these events is adapted to capture these biological features. Katz et al. [33] have discussed the alternative splicing events within the framework of RNA-Seq. Based on these concepts, we design our algorithms completely based on the structural properties of junction reads to define alternative splicing types. In addition, we use the known splicing sites as reference set. If the splicing sites derived from junction reads match the reference set, we consider them as “known sites”; otherwise as “novel sites”. If the splicing sites are known, but the link between two sites is not reported from the annotation file, it is marked as “novel splicing link”. The detailed algorithms for extracting alternative splicing events are as follows,


                           
                              
                                 •
                                 Junction reads: the reads that have gaps when they are aligned to the reference genome. Generally they span across the splicing junctions. One part of the read matches one exon, and the other part matches the following exon.

Non-junction reads: the reads that do not have any gaps when they are aligned to the reference genome.

The description of the major splicing types is shown in Fig. 1
                           .


                           
                              
                                 •
                                 Intron retention: (1) junction reads: there must be enough junction reads (> minimum number of required reads); (2) non-junction reads: there must be enough non-junction reads within the junction reads discussed above (> minimum number of required reads). In addition, the sequence contig collapsed from these non-junction reads must be more than specified percentage.

Exon skipping: (1) junction reads: there must be three types of junction reads: one junction-read type with long gap and the other two junction-read types with short gap. These two short junction-read types are mutually exclusive and both fully contained in the long junction read type. The number of junction reads must be more than minimum number of required reads; (2) non-junction reads: there must be enough non-junction reads overlapping with the interval between two short junction-read types.

Alternative donor sites: there are two types of junction reads, which have the same 5′ junction sites, but are different in the 3′ junction sites.

Alternative acceptor sites: there are two types of junction reads, which have the same 5′ junction sites, but are different in the 3′ junction sites.

We further divide these alternative splicing types to two different subtypes: type I and type II (Fig. 2
                           ) by comparing read information with the annotation files. Generally type I only consists of one intron or exon structure; type II consists of more than one intron or exon structures. More specifically, type I of exon skipping describes the alternative splicing events that only one exon is skipped; type II of exon skipping describes the events that multiple exons are skipped. Type I of intron retention defines the events that only one intron is retained; type II defines those that more than one intron is retained. Type I of the alternative donor or acceptor sites covers the events across only one intron; while type II defines other cases.

SplicingTypesAnno is designed specifically for RNA-Seq data. To help users achieve more flexibility, SplicingTypesAnno provides two level analysis: genome-scale annotation and gene-scale annotation. The genome-scale annotation processes the RNA-Seq data for all samples, and generates a user-friendly summary report. On the other hand, the gene-scale analysis only explores the RNA-Seq data for one gene or a few genes. The advantage of this analysis is that it helps users to explore the events with deeper resolution with limited computing resources. To visualize the results, the web report from both analyses provides BED file for importing into Integrative Genomic Browser (IGV).

SplicingTypesAnno identifies both novel and known splicing sites (Fig. 3
                        ). This process includes two steps: (1) the first step identifies all related alternative splicing events and extracts proper splicing sites; (2) the second step marks those novel splicing sites, including novel donor sites, novel acceptor sites and novel splicing links of two sites (exon skipping does not have novel splicing links). This step is achieved by comparing the splicing sites from the first step to the boundaries of exons extracted from the GTF/GFF file.

We modify RPKM (Reads per kilobase per million mapped reads) as follows,


                           
                              
                                 (1)
                                 
                                    
                                       rpkm
                                       
                                          non
                                          -
                                          junctionReads
                                       
                                    
                                    =
                                    
                                       readCounts
                                       eventLength
                                    
                                    *
                                    
                                       
                                          
                                             10
                                             6
                                          
                                       
                                       totalReads
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       rpkm
                                       junctionReads
                                    
                                    =
                                    
                                       readCounts
                                       
                                          readLength
                                          *
                                          2
                                       
                                    
                                    *
                                    
                                       
                                          
                                             10
                                             6
                                          
                                       
                                       totalReads
                                    
                                 
                              
                           
                        

Specifically, for intron retention, the eventLength is the width of the intron inferred from the junction reads; for exon skipping, the eventLength is the width of the exon inferred from the junction reads; for alternative donor/acceptor site, only junction reads are utilized to identify these events, so eventLength is not calculated.

We estimate the isoform percentage using the read counts at exon/intron level:
                              
                                 (3)
                                 
                                    isoformpercentage
                                    =
                                    
                                       
                                          isoform
                                          1
                                       
                                       
                                          isoform
                                          1
                                          +
                                          isoform
                                          2
                                       
                                    
                                 
                              
                           Specifically,
                              
                                 •
                                 for intron retention,
                                       
                                          (4)
                                          
                                             isoform
                                             1
                                             =
                                             
                                                rpkm
                                                
                                                   non
                                                   -
                                                   junctionReads
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          (5)
                                          
                                             isoform
                                             2
                                             =
                                             
                                                rpkm
                                                junctionReads
                                             
                                          
                                       
                                    
                                 

for exon skipping,
                                       
                                          (6)
                                          
                                             isoform
                                             1
                                             =
                                             
                                                rpkm
                                                junctionReads
                                             
                                          
                                       
                                    
                                    
                                       
                                          (7)
                                          
                                             isoform
                                             2
                                             =
                                             
                                                rpkm
                                                
                                                   non
                                                   -
                                                   junctionReads
                                                
                                             
                                          
                                       
                                    
                                 

for alternative donor/acceptor sites:
                                       
                                          (8)
                                          
                                             isoform
                                             1
                                             =
                                             
                                                rpkm
                                                
                                                   alterSite
                                                   1
                                                   _
                                                   junctionReads
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          (9)
                                          
                                             isoform
                                             2
                                             =
                                             
                                                rpkm
                                                
                                                   alterSite
                                                   2
                                                   _
                                                   junctionReads
                                                
                                             
                                          
                                       
                                    
                                 

Since the equation uses the percentage approach, the ratio is not biased toward most abundant transcripts. As a matter of fact, this approach can identify the finest difference of the two isoforms. For example, the ratio of isoform 1 with 10 reads to the isoform 2 with 10 reads is equal to that of isoform 1 with 10,000 reads to the isoform 2 with 10,000 reads.

@&#IMPLEMENTATION@&#

SplicingTypesAnno is an easy to use and customized pipeline, which is capable of processing RNA-Seq read alignment files from single sample or multiple samples or multiple time points for the identification, accurate calling and annotation of the novel alternative splicing sites (Fig. 4
                     ). The implemented workflow in the R-package consists of three main steps: (1) the first step deals with the filtering of the data using the following criteria: (a) there should be at least two junction reads with the same beginning or ending gap boundary; (b) the junction reads with one gap, i.e., one “N” in cigar string, are considered as quality reads; (2) searching the alternative splicing events; (3) generating user-friendly web report, summarizing the following descriptive information: sample description, read summary, splicing summary, alternative donor sites (type I), alternative donor sites (type II), alternative acceptor sites (type I), alternative acceptor sites (type II), BED files for visualization. To make the algorithm usable on multiple platform and High Performance Computing (HPC) SplicingTypesAnno supports parallel computing based on R package “snowfall”. This configuration helps to facilitate process multiple samples when users have access to HPC environment.

To speed up the analysis, SplicingTypesAnno supports parallel computing based on R package snowfall. This configuration helps to facilitate process multiple samples when users have access to high-computing environment.

The main features of this package (Table 1
                     ) include: (1) translating GTF/GFF file to exon/intron structure; (2) counting the reads for exon/intron structure; (3) calculating and annotating the major splicing types. The first feature is implemented by translateGTF; the second feature requires two functions: splicingCount and combineCount and the last feature calls two functions: splicingGene and splicingReport to generate final conclusive reports.

@&#RESULTS@&#

To illustrate how to use this package, one data set from NCBI (SRA, GSE26561) was downloaded and aligned to mouse genome (mm9) with tophat [27]. This research studied the alternative splicing in nonsense-mediated mRNA decay-deficient mouse tissues. We selected two samples: SRR094623 (wild type sample) and SRR094624 (knockout sample) for the following demonstration.

The main function for managing GTF/GFF file is translateGTF. This function takes GTF/GFF file as input, extracts all exon information, and produces gene, exon, and intron information as the GRanges objects.

Currently SplicingTypesAnno supports both GTF and GFF file formats, which include exon, gene or mRNA information. SplicingTypesAnno only utilizes exon information to generate exon, intron and gene annotation. To reduce ambiguity, all overlapping exons are reduced to contigs, and these contigs are used to generate genome-scale intron annotation. These intron annotations are only imported as a reference set to identify subtypes of major splicing types.

Some genes may overlap with each other in the chromosome, i.e. they share some genomic regions in the same strand. It is reported in human, mouse, rat, flies and fish [34]. Since these genes are only small percentage of all genes, we setup a parameter called “geneOverlap to control this status. In the genome-scale annotation, to reduce ambiguity, gene overlapping status is configured as “no, i.e., the overlapping genes are overlooked. In gene-scale annotation, users can determine the gene overlapping status based on specific research goals, and the following analysis is processed for each gene sequentially.

To convert the GTF/GFF file to proper gene/exon/intron objects, the following scripts are utilized,


                        
                           
                        
                     

Gene-scale annotation is a handy tool for users who would like to check some genes quickly or do not have access to high-computing environments. It only processes the selected genes one by one, and thus does not have high requirement for hardware. Also, since it works with one gene at one time, more comprehensive analysis is provided, including determining the novel splicing links, quantifying the overlapping genes, etc.

This type of analysis includes two steps: (1) converting GTF/GFF file to gene/exon/intron structure; (2) quantifying and annotating reads at the gene-scale. The first step has been described in case study 1. The second step consists of three separate features: (1) calculating raw reads for gene, exon and intron; (2) annotating alternative splicing for single gene; (3) generating web-report for a few selected genes. The first two features are for exploratory analysis while the third feature is to generate a user-friendly and comprehensive profile hosting summary and visualization information. This web report is convenient for storage, transfer and archives.

The first feature targets quantification for gene, exon and intron. There are two functions (splicingCount, combineCount) specifically designed for this analysis. Based on the gene/exon/intron structure from translateGTF, splicingCount calculates the raw reads within gene, exon and intron respectively for single sample.


                        
                           
                        
                     


                        
                           
                        
                     


                        combineCount combines the output from splicingCount and generates the count data for all samples.


                        
                           
                        
                     

The second feature is for annotating alternative splicing for single gene. This feature is achieved by splicingGene function. By specifying certain alternative splicing types, splicingGene searches, quantifies and extracts all related information for single sample and single gene.


                        
                           
                        
                     


                        combineGene combines the output from splicingGene and generates alternative splicing information for all samples.


                        
                           
                        
                     

The last feature generates web-report for a few selected genes. splicingReport utilizes splicingGene to process selected genes one by one and then generates the summary report.


                        
                           
                        
                     

Based on parallel computing provided by R package snowfall, genome-scale annotation is designed for multiple samples. Users can configure the number of cpu available for this type of analysis. SplicingTypesAnno takes full advantage of the vector operation, and the memory requirement increases when users deal with the alignment files with large physical sizes.


                        
                           
                        
                     


                        
                           
                        
                     

The output includes a folder containing one index.html and other subfolders. Index.html is the main webpage for the final report (Fig. 5
                        ), which consists of sample information (Fig. 6
                        ), read summary, splicing summary, intron retention – type I and II, exon skipping – type I and II, alternative donor sites – type I and II, alternative acceptor sites type I and II (Fig. 7
                        ), IGV visualization. splicingShowReport helps user to open the web report, and splicingCleanReport deletes the related report in the current working directory. In addition, the parameters (“mergeID”, “nonjun”, “jun”, “ratio”, etc) in the output have been explained in the vignettes attached in the package. Some results (“nonjun”, “jun”, etc) are available only in the report as csv format because of the size constraints of web format.

The visualization summary consists of a list of BED files (Fig. 8
                        ), which can be imported into IGV. Each record in the BED file is one alternative splicing event, represented by a block in the IGV. Specifically, for intron retention, the block is the real retained intron(s) inferred from the gapped reads; for exon skipping, the block is the real skipped exon(s); for alternative donor/acceptor sites, there are a few blocks matching each alternative splicing event while one block represents a real intron with one alternative site. Additional information (isoform percentage, sample name, etc) for the alternative splicing event is also available for users by enabling popup text in data panels of IGV.

@&#CONCLUSIONS@&#

In this paper, we present a new R package for annotating and quantifying alternative splicing events at exon/intron level in RNA-Seq data. It can be applied to diverse species with the GTF files. The main purpose of this software is to function as the post-processing tool after RNA-Seq alignment. The main advantages of this package are as follows: (1) it provides annotation for major alternative splicing at exon/intron level. By comparing with the annotation from GTF/GFF file, it identifies the novel alternative splicing sites. In particular, since this tool uses the ratio of two isoforms, the results are not biased toward most abundant transcripts. (2) It offers a convenient two-level analysis: genome-scale annotation and gene-scale annotation. Users can analyze alternative splicing events with rather low computing requirements. A simple laptop enables users to explore alternative splicing for multiple samples. On the other hand, this package is also designed to support parallel computing, which helps speed up analysis for multiple samples at global scale. (3) It generates a user-friendly web report and additional BED files for IGV visualization.

There are some limitations of this work. The exon annotation is directly from the user input (GTF file). As a result, it does not recognize the exon structure in the novel genomic features. In addition, the software supports only exon-level annotation for alternative splicing. It does not address the isoform identification. Finally, instead of functioning as a statistical tool, it is an annotating tool for alternative splicing in RNA-Seq data. This package serves as a handy and convenient middleware between alignment software and end users.


                     
                        
                           •
                           Project name: SplicingTypesAnno.

Project home page: http://sourceforge.net/projects/splicingtypes/.

Operating systems: platform independent.

Programming language: R.

other requirements: R 2.15.0.

License: GNU GPL.

Any restrictions to use by non-academics: license needed.

The authors declare that they have no competing interests.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by Shandong Agricultural University (start-up grant to X.S.). We thank three anonymous reviewers for their constructive advices. We also thank National Supercomputing Center in Jinan for computing assistance and Nanjing Genmart Biotech Corporation for technical support.

@&#REFERENCES@&#

