@&#MAIN-TITLE@&#A smartphone-driven methodology for estimating physical activities and energy expenditure in free living conditions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A smartphone use for physical activity evaluation in free living conditions.


                        
                        
                           
                           The smartphone algorithm competes with sensors for energy expenditure.


                        
                        
                           
                           The algorithm takes advantages of the smartphone accelerometers without extra sensors.


                        
                        
                           
                           The performance does not require knowing the initial phone position.


                        
                        
                           
                           Evaluation and monitoring of physical activity in large and distant populations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Energy expenditure estimation

Physical activity

Smartphone accelerometers

Normal-weight subjects

Actiheart

Armband

@&#ABSTRACT@&#


               
               
                  This paper introduces a function dedicated to the estimation of total energy expenditure (TEE) of daily activities based on data from accelerometers integrated into smartphones. The use of mass-market sensors such as accelerometers offers a promising solution for the general public due to the growing smartphone market over the last decade. The TEE estimation function quality was evaluated using data from intensive numerical experiments based, first, on 12 volunteers equipped with a smartphone and two research sensors (Armband and Actiheart) in controlled conditions (CC) and, then, on 30 other volunteers in free-living conditions (FLC). The TEE given by these two sensors in both conditions and estimated from the metabolic equivalent tasks (MET) in CC served as references during the creation and evaluation of the function. The TEE mean gap in absolute value between the function and the three references was 7.0%, 16.4% and 2.7% in CC, and 17.0% and 23.7% according to Armband and Actiheart, respectively, in FLC. This is the first step in the definition of a new feedback mechanism that promotes self-management and daily-efficiency evaluation of physical activity as part of an information system dedicated to the prevention of chronic diseases.
               
            

@&#INTRODUCTION@&#

In recent years, obesity and type 2 diabetes have become emergent epidemics in Western countries. One of the main reasons is the imbalance between energy intake and TEE, which is the consequence of poor dietary habits and lack of physical activity.

Knowledge of TEE and, in particular, quantification of daily physical activity, could improve personal health through better management of energy balance and thus weight. That is why the estimation of TEE variations in free-living conditions over one day and on a day-to-day basis is of major interest in clinical trials as well as for individual use. This paper aims to introduce a predictive function for the estimation of total energy expenditure under current living conditions using dedicated mass-market sensors similar to those found in widespread smartphones and tablets.

There are two reference methods to measure TEE: indirect calorimetry based on gas exchange (IC), and doubly-labeled water (DLW). In the first one, the TEE is calculated from Weir’s equation, taking oxygen consumption and carbon dioxide production into account [1]. This method requires sophisticated laboratory equipment in controlled measurement conditions (calorimetric rooms or facemasks for short periods). The second method requires a biochemical technique that involves the intake of two tracers (18O and 2H), followed by the collection of urine samples for 10–14days. The disappearance of those tracers makes it possible to evaluate the CO2 production and thus provides an evaluation of the TEE. This method is well-designed for TEE evaluation in FLC.

Both methods have the potential to be used for accurate non-invasive routines but they involve costly medical material, and biochemical analyses are not feasible in the context of epidemiological studies. Mellone et al. therefore focused on mass-market sensors, similar to the smartphone sensor [2], as a second research priority. The authors reported that measurement systems could use mobile phones that are the most ubiquitous consumer electronic device in the world.

Some recent dedicated electronic devices have obtained good results for estimating TEE by using several sensors for monitoring variables such as heart rate, body acceleration, body temperature, heat flux and impedance. Thus, Actiheart and Armband have received a great deal of attention in various experimental conditions. However, Actiheart was evaluated and compared to the DLW method only three times in free-living conditions [3–5]. The gap between TEE estimation and DLW was −9.1±5.1kJkg−1
                        day−1, −6.8±26.3kJkg−1
                        day−1 and −5.0±16.2kJkg−1
                        day−1 when the group calibration was used in the studies [3–5], respectively. Armband sensors are commonly used in free-living conditions and provide appropriate estimation of TEE (−0.4kJkg−1
                        day−1 
                        [6], −0.6±4.1kJkg−1
                        day−1 
                        [4]), except in the case of some intensive physical activities performed by athletes [7]. Other sensor devices such as Actigraph, Actical and RT3 that predict TEE from accelerometers only have emerged since the 1990s. They are older, simpler and cheaper than Armband and Actiheart. However, accelerometry results did not yield accurate estimations of TEE across a range of activities. Indeed, Lyden et al. showed that devices using accelerometer signals averaged over a one-minute-period may obtain similar results for two different activities such as walking and boxing [8]. The technology of accelerometry devices that estimate TEE has changed since then. Some of them use additional sensors. For all these recent or older devices, the experimental data collection generates strong constraints on the population size and on the location of volunteers who have to come to the laboratory to be equipped. An alternative device to these research sensors could be developed in the perspective of studying the physical activity of cohorts at a low cost.

Since smartphones are basically mobile computers and are widespread among the general population, they offer a convenient alternative to standard data gathering systems and promote new approaches that contribute to redefining medical education and information distribution, especially if we consider the variety of medical domains covered by publications over the last five years. As stressed by Mellone [2], smartphones are attractive for delivering health information for the following reasons: (1) the widespread adoption of phones with increasingly powerful capabilities; (2) the fact that people tend to carry their phones everywhere; (3) people’s attachment to their phones; and (4) context awareness features that are enabled through sensing and phone-based personal information [9]. Smartphones now encompass but are not limited to: a camera, altitude and three-dimensional coordinates provided by the GPS and accelerometers [10]. However, as stressed by numerous authors [10], since long-term monitoring using a smartphone is wireless, it could require periodic power supply. Nevertheless, smartphone applications have received a considerable amount of attention in medical science.

To estimate physical activity TEE, it is necessary to recognize activity intensities. Several recent studies deal with physical activity recognition from accelerometry data collected by smartphones [11–14]. Activity recognition rates were phone-position-dependent in [11,12]. This methodology induced a strong constraint for the accurate smartphone position that could affect the results if the phone is not correctly worn. Thus, the initial fixed smartphone position is a major disadvantage in free-living conditions. Anjum and Ilyas collected data with a phone placed in the hand, pants pocket, shirt pocket and handbag [11]. This sophisticated method to measure the periodicity of movements was used for short periods. This method of calculation used by [12] would quickly consume not only the battery power but the mobile CPU as well when applied for long recording periods (12h).

Our research encompasses the definition of a function using a smartphone’s accelerometer without any assumption about its initial position in the X–Y–Z framework because its information is the major constraint for its use in free-living conditions. When people wear a smartphone in a pants pocket, its position cannot be known with certainty. However, in some previous research on this topic, the TEE estimation depended on the phone’s position.

The performance of the proposed function was compared to the TEE calculated from the sum of the metabolic equivalent tasks (MET) in controlled conditions (CC) [15], and the TEE provided by the Armband and the Actiheart in both CC and FLC. The experiments were carried out with 12 volunteers in CC (3.5h) and 30 volunteers in FLC for approximately 12h.

@&#METHOD@&#

The large number of applicants allowed us to make two groups referred to as CC and FLC that were similar in age (from 18 to 60years old), weight, height and body mass index (BMI). Healthy volunteers of different heights have been included in order to determine the impact of leg length on activity recognition. They were chosen with varying heights and weights in the normal range of the body mass index (18.5–25kgm−2) and were free of cardiovascular or locomotion diseases. During the preliminary visit, they signed an informed consent form and passed a resting electrocardiogram validated by a cardiologist.

The protocol was approved by the French Committee for the Protection of Human Subjects (Sud-Est VI). It was registered under the references 2012-A00809-34 and 2013-A00188-37 in the ANSM system, and under the references NCT01995253 and NCT01995162 in Clinical Trials. Detailed characteristics of the volunteers are presented in Table 1
                        .

The volunteers in the first group performed each of the nine activities several times according to the activity scenario: sitting, slow, normal and brisk walking, climbing and descending stairs (eight floors), standing, slow running and taking public transportation (tramway). The duration of each activity varied from 2 to 20min. Volunteers were informed by the researcher of the beginning and the end of each activity. Volunteers simultaneously wore a smartphone (Samsung Galaxy xCover or LG Nexus 4) that collects data in the left front pants pocket, the Actiheart (Cambridge Technology Ltd., Papworth, UK) and the Pro3 SenseWear Armband (Bodymedia version 6.0) monitors. Researchers recorded the start and the duration of each activity. Controlled condition experiments were composed of ordered sets of activities of long enough duration to be clearly identifiable.

Volunteers in the second group wore the same devices as those in the first group for a full day selected either during the week or the weekend. They performed spontaneous activities either at home, at work or outdoors, depending on volunteers’ lifestyles and wishes. The volunteers wore the devices during the daytime and recorded their activities themselves.


                        Fig. 1
                         provides a schematic representation of the methodology workflow for the design of the proposed smartphone-based system. The process starts with a state-of-the-art of TEE evaluation and with the demand of researchers in biology to create a promising new methodology dedicated to free-living conditions without intrusive sensors.

Key program features are stressed during the problem analysis stage and encompass the following steps:
                           
                              •
                              Preliminary study: analysis of the problems related to TEE estimation using accelerometry data, and state-of-the-art.

Development of a prototype:
                                    
                                       
                                          Design of a prototype that permits testing and project-specific data collection from a set of volunteers, leading to the proposal of a TEE estimation function.


                                          TEE estimation function definition based on a specific statistical analysis of data gathered in controlled and free-living conditions and compared with the activity scenario/MET values and Armband TEE estimation.


                                 Assessment: the results of the function based on accelerometry data acquired in free-living conditions were compared to TEE estimations performed by Actiheart and Armband, leading to the development of a prototype that permits project-specific data collection from a set of volunteers and the proposal of a TEE estimation function based on 18 datasets gathered in controlled (12) and free-living conditions (6). TEE estimation was compared to the activity scenario METs values in CC, Armband and Actiheart TEE estimation in both CC and FLC.

This project can be seen as a team-based project and represents research at the crossroads of biology, statistics, computer science and optimization.

The eMouve project uses a client–server architecture where the smartphone collects accelerometry data and a server (https://activcollector.clermont.inra.fr/) computes TEE estimation after reception of data in quasi real time [16].

The project was developed using Java with a relational database. The smartphone application was developed for Android and includes specific knowledge in REST web services for the communication between the smartphone and the server.

The goal of this research was to obtain a statistically useful predictive TEE function using only the native accelerometer of the smartphone.

We consider the TEE predictive function:
                           
                              (1)
                              
                                 f
                                 (
                                 η
                                 ,
                                 d
                                 )
                                 =
                                 g
                                 (
                                 η
                                 ,
                                 d
                                 )
                                 ×
                                 ε
                                 (
                                 d
                                 )
                              
                           
                        
                     

where g is a recognition trend function of activities for TEE evaluation (Section 2.8). For convenience, we designate η as the dataset collected at 6Hz by the accelerometer, and ηt
                        
                        =(xt
                        ,
                        yt
                        ,
                        zt
                        ) as the accelerometry values on the three axes at instant t; ɛ is the stationary correction term that depends on the total duration d of the experiment.

First, 44 data files were collected using a smartphone on 42 volunteers divided into two groups:
                           
                              •
                              12 accelerometry data files encompassing ηt
                                 
                                 =(xt
                                 ,
                                 yt
                                 ,
                                 zt
                                 ) for approximately 3.5h in controlled conditions.

32 data files encompassing ηt
                                 
                                 =(xt
                                 ,
                                 yt
                                 ,
                                 zt
                                 ) for 12h in free-living conditions, collected on 30 volunteers (two volunteers collected datasets on two different days). Second, the volunteers wore Armband and Actiheart sensors. Both of them generated a file with all measurements, as well as the estimation of TEE and/or MET values for each elapsed time period.


                        Fig. 2
                         represents the workflow of the function g. The first step consists in splitting the recording into segments of type MA (that contain mobile activities) or IA (that contain immobile activities) from the accelerometer viewpoint, i.e., data segmentation (Section 2.8.1).

Each segment is then analyzed using mathematical variables detailed in Sections 2.8.2 and 2.8.3. More precisely, MA segments encompass activities a from AM
                        
                        ={normal walking, brisk walking, running, unrecognized mobile activity}, whereas IA segments encompass an activity a from AI
                        
                        ={sitting, standing still, taking public transportation, unrecognized immobile activity}. We designate A
                        =
                        AM
                        
                        ∪
                        AI
                         as the set of activities the algorithm can label. Activities can be discontinuous; this is why each MA segment contains a set of sub-segments. Once the recording is fully analyzed, the duration da
                         of each activity a is computed.

TEE estimation (Section 2.10) is calculated for each activity identified by g(η,
                        d), its duration and the MET values [15]. MET values can be transformed into kilocalories using a prediction equation of rest metabolic rate [17–19].

The aim of data segmentation is to split the recording into IA and MA segments. To do so, we first search for IA segments. The rest of the data then constitutes MA segments.

Recognition of an IA segment is performed using a linear correlation coefficient and the standard deviation of the signal energy on the current IA segment S, designated as ρt
                            and σS
                           , respectively, where t is the current time.

We designate the energy of the signal at time t as σt
                           
                           =
                           σ(Γ) with 
                              
                                 Γ
                                 =
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 t
                                 -
                                 6
                                 ⩽
                                 i
                                 ⩽
                                 t
                                 +
                                 6
                                 }
                              
                            where γi
                            is the norm of ηi
                           . That way, the standard deviation of the signal energy on a segment S is designated as σS
                           
                           =
                           σ(Λ) where 
                              
                                 Λ
                                 =
                                 {
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ⩽
                                 i
                                 ⩽
                                 
                                    
                                       t
                                    
                                    
                                       ″
                                    
                                 
                                 }
                              
                            and t′ and t″ are the beginning and the end of S, respectively.

The beginning of S is detected at time t′ when 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ⩽
                                 -
                                 0.5
                              
                           , and its end t″ is reached when ρt
                           
                           ″
                           >−0.5 or σS
                           
                           >0.1.


                           Fig. 3
                            represents a test recording where the volunteer was sitting, walking, going upstairs, etc. One can note that each activity has its own template and can be visually distinguished from others.

It was considered that each IA segment represents only one activity a
                           ∊
                           AI
                           . In fact, a change in the immobile activity implies a fluctuation in accelerometry data that separates them.

The method chosen to determine the immobile activities is based on density, which is the percentage of signal energy values that are higher than an empirically-defined threshold (σt
                           
                           =0.15). The density intervals we used are presented in Table 2
                           .

Once all the IA segments are identified using the above method, they are processed one by one to remove those that are less than 8s long. These very short segments can be considered to be mobile activities.

Each MA segment can be composed of several sub-segments of various mobile activities if they are detected for at least 8 continuous seconds. The activities of a shorter duration are aggregated with the previous activity.

Sub-segments are identified using a Fourier transform and analysis that makes it possible to assign one classified activity at
                            for each given moment t. It is based on a sliding window on module values:
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    {
                                    
                                       
                                          γ
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    t
                                    ⩽
                                    i
                                    ⩽
                                    t
                                    +
                                    Δ
                                    }
                                 
                              
                           
                        


                           
                              
                                 (a)
                                 The Fourier transform for detection of non-stationary signals

The Fourier transform consists in defining 
                              
                                 
                                    
                                       e
                                    
                                    
                                       γ
                                    
                                 
                                 :
                                 x
                                 →
                                 
                                    ∫
                                    
                                       R
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       i
                                       2
                                       π
                                       xt
                                       
                                          
                                             γ
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 dt
                              
                           , which can also be rewritten as:
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          γ
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∫
                                       
                                          R
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          t
                                       
                                    
                                    ·
                                    cos
                                    (
                                    2
                                    π
                                    xt
                                    )
                                    dt
                                    -
                                    i
                                    ·
                                    
                                       ∫
                                       
                                          R
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          t
                                       
                                    
                                    ·
                                    sin
                                    (
                                    2
                                    π
                                    xt
                                    )
                                    dt
                                 
                              
                           
                        

In suitable conditions, it is possible to define 
                              
                                 
                                    
                                       e
                                    
                                    
                                       γ
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                            by: 
                              
                                 
                                    
                                       e
                                    
                                    
                                       γ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∫
                                    
                                       R
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       2
                                       π
                                       xt
                                    
                                 
                                 dt
                              
                            or:
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          γ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∫
                                       
                                          R
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          γ
                                       
                                    
                                    cos
                                    (
                                    2
                                    π
                                    xt
                                    )
                                    dt
                                    +
                                    i
                                    
                                       ∫
                                       
                                          R
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          γ
                                       
                                    
                                    sin
                                    (
                                    2
                                    π
                                    xt
                                    )
                                    dt
                                 
                              
                           
                        

One major key feature of the Fourier transform [20] is to offer the possibility of detecting non-stationary signals using the theory of distributions, developed by [21]. For discrete values,
                              
                                 
                                    F
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          j
                                       
                                    
                                    cos
                                    (
                                    2
                                    π
                                    xj
                                    )
                                    -
                                    
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          j
                                       
                                    
                                    sin
                                    (
                                    2
                                    π
                                    xj
                                    )
                                 
                              
                           is a periodic function and:
                              
                                 
                                    P
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      -
                                                      i
                                                      2
                                                      π
                                                      xj
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    T
                                    |
                                    F
                                    (
                                    x
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           is a function with a significant peak centered at frequency 
                              
                                 f
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                       π
                                    
                                 
                              
                           . Because the period of a pendulum is 
                              
                                 T
                                 =
                                 2
                                 π
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                              
                            with L the length of the massless rod, and g
                           ≈9.81ms−2, it is possible to estimate the period at about 2s for L
                           =1m [22], which is quite representative of the average adult leg length. Hence, the duration of one step is about 1s.

Let f
                           * be the frequency corresponding to the main peak in P(x). The Fourier transform and the periodic function are evaluated for each time window [Ti
                           ;
                           Ti
                           
                           +
                           
                              k
                           ] (where k is the length of the time window).

Typically, for a person of average height of about 1.80m, f
                           *
                           =0.25 is representative of a normal walking period and is clearly identified by a peak similar to the peak of Fig. 4
                           (a), whereas f
                           *
                           =0.36 is representative of a brisk walking period, as shown in Fig. 4(b).

A Fourier analysis is used to recognize normal/brisk walking and running activities. It provides a computationally convenient numerical summary of shapes whose utility in classification and pattern recognition has been well documented. Davis and Beecher were the first authors to stress that harmonics can be considerably affected by the process of digitizing the curve and that extracting information about variability in shape would require more than was required in classical applications [23].
                              
                                 (b)
                                 Activity identification using the periodic function peak


                           Fig. 4(c) stressed a typical curve of a running time period where three peaks appear in the periodic function P(x).

A statistical analysis based on a population of 12 volunteers makes it possible to identify the mean frequencies of the main activities (normal walking: peak 1=0.156, peak 2=0.297; brisk walking: peak 1=0.188, peak 2=0.360; running: peak 1=0.120, peak 2=0.250 and peak 3=0.470). When there is no peak or it is outside the interval [0.1; 0.5], the activity was declared ‘unrecognized’.

The quality of activity recognition can be evaluated in controlled conditions since the activities of each volunteer were accurately recorded by an employee.

For each activity a, the gap ɛa
                         between the duration estimated by g(η,
                        d) and the actual recorded duration is computed using: 
                           
                              
                                 
                                    ε
                                 
                                 
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          a
                                       
                                       
                                          g
                                          (
                                          η
                                          ,
                                          d
                                          )
                                       
                                    
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          a
                                       
                                       
                                          scenario
                                       
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          a
                                       
                                       
                                          scenario
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                 
                                 
                                    g
                                    (
                                    η
                                    ,
                                    d
                                    )
                                 
                              
                           
                         is the duration of activity a estimated by g(η,
                        d) and 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                 
                                 
                                    scenario
                                 
                              
                           
                         the duration measure recorded by the employee.
                           
                              (2)
                              
                                 The overall recognition can be computed using
                                 
                                 R
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                       (
                                       |
                                       
                                          
                                             ε
                                          
                                          
                                             a
                                          
                                       
                                       |
                                       ×
                                       
                                          
                                             d
                                          
                                          
                                             a
                                          
                                          
                                             scenario
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             a
                                          
                                          
                                             scenario
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Each physical activity a is associated with a general MET value mg
                        (a) [15].

It is possible to correct the general MET values by taking the individual characteristics into account: sex, age, weight and height. The best MET approximation can be obtained using:
                           
                              (3)
                              
                                 
                                    
                                       m
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 a
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             g
                                          
                                       
                                       (
                                       a
                                       )
                                       ×
                                       3.5
                                    
                                    
                                       REE
                                    
                                 
                              
                           
                        where mg
                        (a) is the general MET value of activity a provided by the compendium (see Table 3
                        ), 3.5 is the mean volume of O2 consumed for the rest period in mlkg−1
                        min−1, mp
                        (a) is the personalized MET value, and REE is the rest energy expenditure computed using Harris and Benedict’s proposal, in mlkg−1
                        min−1 
                        [18].

Total energy expenditure TEE
                           a
                         during each activity a can then be computed using the formula:
                           
                              (4)
                              
                                 
                                    
                                       TEE
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 1.1
                                 ×
                                 
                                    
                                       m
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 a
                                 )
                                 ×
                                 
                                    
                                       d
                                    
                                    
                                       a
                                    
                                 
                                 ×
                                 REE
                              
                           
                        where da
                         is the recording duration in minutes and REE is the rest energy expenditure in kcalmin−1. The coefficient 1.1 represents the food thermogenesis, which is about 10% of TEE.

Finally, the TEE of the recording is TEE
                           f
                        
                        (
                        
                           η
                        
                        ,
                        
                           d
                        
                        )
                        =∑
                        
                           a
                        
                        ∊
                        
                           A
                        TEE
                           a
                        .

The predictive function Eq. (1) is composed of two parts: a trend function previously described in Section 2.8; and a stationary correction term.

The correction term depends on the recording duration d (in seconds) shorter than 24h, and on two coefficients α and β:
                           
                              (5)
                              
                                 ε
                                 (
                                 d
                                 )
                                 =
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                24
                                                ×
                                                3600
                                             
                                          
                                          ×
                                          α
                                       
                                    
                                 
                                 ×
                                 β
                              
                           
                        
                     

Those two coefficients were determined from the 12 volunteers in controlled conditions and from a subset of the first six volunteers in free-living conditions. The values α
                        ≈0.747 and β
                        ≈1.132 were determined by minimizing the sum of square errors compared to Armband TEE estimations:
                           
                              (6)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             TEE
                                          
                                          
                                             i
                                          
                                          
                                             Armband
                                          
                                       
                                       -
                                       
                                          
                                             TEE
                                          
                                          
                                             i
                                          
                                          
                                             f
                                             (
                                             η
                                             ,
                                             d
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where n
                        =18 is the number of volunteers, 
                           
                              
                                 
                                    TEE
                                 
                                 
                                    i
                                 
                                 
                                    Armband
                                 
                              
                           
                         is the TEE estimation provided by Armband for the volunteer i, and 
                           
                              
                                 
                                    TEE
                                 
                                 
                                    i
                                 
                                 
                                    f
                                    (
                                    η
                                    ,
                                    d
                                    )
                                 
                              
                           
                         is the TEE estimation provided by our function on the volunteer i. Among the three references (Armband, Actiheart and MET values), Armband was chosen as the main reference of TEE because it provided a very close estimation of TEE to the gold standards IC or DLW on normal-weight adults [4].

To conclude, the predictive function is:
                           
                              (7)
                              
                                 f
                                 (
                                 η
                                 ,
                                 d
                                 )
                                 =
                                 g
                                 (
                                 η
                                 ,
                                 d
                                 )
                                 ×
                                 (
                                 1.132
                                 -
                                 9.787
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       6
                                    
                                 
                                 d
                                 )
                              
                           
                        
                     

The TEE estimation function was compared to the three references (TEE calculated from the sum of the MET values, TEE given by Armband and Actiheart). First, the gaps between the TEE estimation function and the references are calculated using the following formula:
                           
                              (8)
                              
                                 gap
                                 
                                 (
                                 %
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             TEE
                                          
                                          
                                             f
                                             (
                                             η
                                             ,
                                             d
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             TEE
                                          
                                          
                                             ref
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             TEE
                                          
                                          
                                             ref
                                          
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     

Secondly, t-tests and paired t-tests were performed on absolute values of gaps to determine if the gaps are different or not from 0, and to compare the gap levels between them. SAS 9.4 software was used to perform the t-tests.

@&#RESULTS@&#

In the activity scenario, the best recognized activities were walking and sitting, which obtained the smallest gaps (ɛ
                        =-0.7% and ɛ
                        =1.0%, respectively). The worst recognized ones were brisk walking and standing (ɛ
                        =53.3% and ɛ
                        =-43.8%, respectively).

For the 12 volunteers in controlled conditions, the mean recognition of all the activities was 73.3±10.3%. Thus, 26.7% of the activities were incorrectly classified.

In free-living conditions many activity records completed by the volunteers themselves are not sufficiently accurate to be compared with the activities identified by the smartphone (g(η,
                        d)). In fact, scenario accuracy was very heterogeneous: some volunteers provided many details about their daily activities while others provided very little information.

All results about activity recognition can be found on ActivCollector at https://activcollector.clermont.inra.fr/home/publications/aedes.


                        Table 4
                         shows that in controlled conditions, the gaps were small between f(η,
                        d) and Armband or the scenario, but doubled between f(η,
                        d) and Actiheart. Thus, the function provided relative TEE results similar to the TEE estimated from MET values of scenario activities. Moreover, it slightly underestimated TEE compared to Armband and overestimated TEE compared to Actiheart. The t-tests show that absolute values of all gaps between TEE estimated by f(η,
                        d) (TEEf) and calculated from MET values of scenario (TEE
                           scenario
                        ) by Armband (TEE
                           armband
                        ) and Actiheart (TEE
                           actiheart
                        ) were significantly different from 0 (p
                        =0.02, 0.0009 and 0.0006, respectively). Moreover, the gaps differed between TEE
                           armband
                         and TEE
                           scenario
                         (p
                        =0.01), between TEE
                           armband
                         and TEE
                           actiheart
                        , (p
                        =0.01), and between TEE
                           actiheart
                         and TEE
                           scenario
                         (p
                        =0.0002).

In free-living conditions, the relative mean gaps were similar to those obtained in controlled conditions but the standard deviations increased and exceeded 20%. All the mean absolute values of gaps were significantly different from 0 (p
                        <0.0001) and higher than in controlled conditions. However, the difference between TEE
                           armband
                         and TEE
                           actiheart
                         was not significant (p
                        =0.16).

@&#DISCUSSION@&#

The proposed function of TEE prediction was developed from the activity recognition and compared to three references: TEE calculated from MET values of the scenario activities (only in the case of CC) and TEE provided by two research devices used in both CC and FLC.

At present, few studies have been conducted to link the accelerometry data collected by smartphones to physical activity recognition. In [12], 85% of the time, activities such as jogging, climbing stairs, sitting and standing were recognized by using 43 variables computed from the acceleration data collected at a 20Hz sampling rate. The high accuracy was phone-position dependent. Yang explored orientation-independent features extracted from magnitudes, as well as vertical and horizontal components in acceleration [14]. After the application of simple tree models, the accuracy was approximately 66–69%. Anjum and Ilyas developed an Android application while the cell phone was maintained in different positions for walking, running, climbing stairs, going down stairs, driving, cycling and inactive [11]. The rate of activity recognition was 95%. However, in this study, nine variables, a complex method to analyze movement periodicity (15Hz) and a decision tree classification were required to recognize seven activities. Xia et al. also developed an application on iOS to recognize four activities (walking, lying, sitting and standing) for 6min with an iPhone fixed at the waist [13]. Their application achieved a recognition rate of 90%.

The performances of some smartphone applications described above can seem better than the recognition rate of g(η,
                     d) (73.6%). However, they are not exactly comparable with the present study because the constraints related to the experiment and/or the development of the algorithm (studied activities, number of volunteers, number of variables introduced in the model, sampling rate, phone position, controlled or spontaneous activities, computation method of error rates) differ and affect the accuracy of the recognition. Thus, if the phone position is decisive for predicting activities, this constraint is strong and difficult to control in free-living conditions. For this reason, the algorithm developed in this study was phone-position independent. We used only three variables analyzed at 6Hz, which may be less time-consuming than treatments developed in the other studies.

Using activity recognition, the function f(η,
                     d) provided TEE estimations with a gap lower than 10% in CC (compared to TEE calculated from MET values or Armband). Moreover, the standard deviations were low. The mean gap between TEE prediction and Actiheart was larger. It resulted from a large difference in TEE evaluation for one volunteer. The TEE estimated by Actiheart was taken from the group calibration model. This general model is known to be less accurate than the individual model, which takes the individual curve of TEE into account according to the heart rate measured for a step test [24,25]. The latter information was not available in this study. Moreover, both Actiheart and Armband have been compared to reference methods (indirect calorimetry and doubly-labeled water) in CC and FLC [26]. The Armband assessed TEE with the smallest error (less than 10%). For this reason and because of the effectiveness of Armband, we chose Armband as the main Refs. [4,6].

The TEE estimation in free-living conditions is far-removed from the two references. We assume that the difference in performance could be due to the nature of the spontaneous activities performed that are likely to be more varied, shorter and discontinuous in free-living than in controlled conditions. Very short activities cannot be recognized by the algorithm. Thus, when they are shorter than 8s, they are aggregated with the others. This fact was a limiting factor of the present algorithm. The comparison between activity recognition by g(η,
                     d) and activities recorded by the volunteers themselves in free-living conditions was not obvious because some volunteers filled in the form with more details than others.

Another limitation of the present study is that the results were obtained on normal-weight and young volunteers and should not be generalized to overweight people or to young children or elderly people, because these populations probably behave differently while doing many activities, such as walking.

@&#CONCLUSION@&#

In this paper, we have presented a new smartphone based approach for estimating energy expenditure from the recognition of physical activities in free-living conditions. The strength of our algorithm was to transform efficiently accelerometry data into physical activities and energy expenditure through all phone positions. In order to estimate the intensity of activities and energy expenditure of overweight and obese people, another study is currently being carried out on volunteers with a body mass index between 28 and 42.

This article is the first step towards the definition of a new smartphone-based application dedicated to energy expenditure estimation of daily light-intensity activities currently carried out in free-living conditions. The real-time treatment by the server is also an advantage to inform instantaneously a large community of smartphone users on their personalized physical activity. It provides also a new monitoring method for medical staff and their patients suffering from excessive sedentary behavior to encourage better practices related to daily physical activity. This approach is a crucial advantage over unreliable traditional questionnaires or expense research monitors for estimating physical activity and energy expenditure.

@&#ACKNOWLEDGMENTS@&#

Special thanks to the students (T. Cournollet, S. Fobis, J. Besson, J. Michel, A. Ramilijaona, S. Fatnassi and A. Rajerison) for their participation in the preliminary study carried out in 2011. Thanks also to LIMOS for providing support and assistance, especially for smartphone loans in the early stages of this research.

@&#REFERENCES@&#

