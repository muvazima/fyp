@&#MAIN-TITLE@&#Robust color image segmentation using fuzzy c-means with weighted hue and intensity

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Two more important image color components used to avoid redundant computation.


                        
                        
                           
                           The impact of each color component is controlled by tuned weights.


                        
                        
                           
                           Pixel statistics used in initialization to produce proper initial cluster centers.


                        
                        
                           
                           Tuned weights and proper initialization provide better FCM convergence.


                        
                        
                           
                           Our method leads to improved and more rapid performance compared with others.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image segmentation

Fuzzy c-means

Weight tuning

Noise

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Image segmentation is defined as grouping image pixels with similar features into homogeneous partitions. Image segmentation has a critical role in image analysis as it makes the image more comprehensible for computer systems. Results of image segmentation are very useful in applications such as object recognition, medical image processing, face recognition as well as other computer vision applications. As yet there has been no method for image segmentation that could produce suitable results in all kinds of images. In recent decades various algorithms have been proposed for image segmentation that can roughly be divided into these main groups: thresholding methods, region growth methods, graph theory methods and neural network-based clustering methods [1].

Thresholding techniques work on the histogram of image while spatial information of image pixels are ignored, making this approach noise sensitive. Some recent works have tried to improve its performance by means of evolutionary algorithms. Furthermore, this method is mainly for gray-level images and has not been found much suitable for multi-dimensional histograms of color images. Region growing based algorithms over-segment the image into small regions at first and then recursively merge similar regions until a stop criterion is reached. This family has shown good performance generally, but suffers high mathematical and computational complexity as well as high possibility of adding wrong boundaries. Graph based algorithms consider image pixels as graph nodes. Graph edges are some measure of consistency of two pixels connected by the edge. Then, in the next step, this graph is partitioned. Ncut [2] is a well-known method of this family. In this algorithm an optimal manner to perform cut operation on the graph was proposed and named normalized cuts. Neural network based segmentation algorithms can deal with fairly complex images. However, certain design procedures in this family lack theoretical basis, such as network layer design. Furthermore, training time for the neural network is usually long.

Feature space clustering is another family of segmentation approaches. k-means is a famous algorithm of hard clustering type, while fuzzy clustering algorithms include GK (Gustafson–Kessel), GMD (Gaussian Mixture Decomposition), FCV (Fuzzy C Varieties), FCM (Fuzzy C Means) etc. Fuzzy C-means algorithm is the most conventional, among fuzzy clustering approaches, for the reason that it can extract much more information from data than other fuzzy approaches. Also, because of its implementation simplicity, it has been more practical than the majority of other image segmentation methods. Essentially, FCM is an iterative procedure that tends to minimize a cost function of distances of the pixels to their corresponding cluster centers. The standard FCM algorithm ignores the spatial information of pixels which weakens its performance when images are degraded by noise. A number of modified FCM algorithms have proposed making use of spatial information, especially the neighboring information of pixels, which resulted in more homogeneous segments, such as FCM_S [3]. However, this led to high computational overheads. Szilágyi et al. [4] suggested enhanced FCM (EnFCM) to speed up the clustering process, based on gray-level histogram. Cai et al. [5] proposed a powerful method called Fast Generalized FCM (FGFCM), which combines both the spatial information and the local gray-level relationships. It utilizes the SUSAN filter idea[6] for noise reduction and image reconstruction. In [7], a robust FCM-based method was proposed, by altering the fuzzy membership according to inherent high inter-pixel correlations. Zaixin et al. [8] proposed a new FCM-based algorithm with a novel distance criterion. To measure the pixel consistency, they introduce a new weight function integrating both image patch dissimilarity and local statistics called neighborhood weighted (NW) distance. The proposed distance criterion, compared to the Euclidean distance, gives a more exact and more robust distance measure. Therefore, this approach could lead to better results compared to other segmentation methods. While all the mentioned FCM segmentation papers are for gray level images, they can also be extended and modified for color spaces to segment color images.

In this paper we propose a new adaptive robust FCM color image segmentation with an emphasis on the noise issue as well as problem dimension reduction. In fact we only use two color components: hue and intensity, and combine them with appropriate weights for robust image segmentation. In Section 2 we will review prerequisites for our algorithm. In Section 3 the proposed method will be explained. In Section 4 we will illustrate the implementation results of our method on an example. Section 5 involves a comparison of the proposed method with similar methods through experiments and Section 6 will conclude the paper.

@&#BACKGROUND@&#

Fuzzy c-means clustering algorithms were first suggested by [7] and enhanced by [9,10]. Despite hard clustering methods, like k-means, fuzzy methods allows a data to belong to more than one cluster. Let 
                           X
                           =
                           {
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           }
                         stand for a data set with n data which must be clustered into C clusters (
                           1
                           <
                           C
                           ≤
                           n
                        ) where 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         
                        
                           (
                           1
                           ≤
                           k
                           ≤
                           n
                           )
                         denotes a data point. The conventional FCM, through an iterative process, tries to minimize the cost function
                           
                              (1)
                              
                                 
                                    
                                       J
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    ∑
                                    
                                       c
                                       =
                                       1
                                    
                                    C
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       c
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             c
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         with constrains of
                           
                              (2)
                              
                                 
                                    ∑
                                    
                                       c
                                       =
                                       1
                                    
                                    C
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       c
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       c
                                    
                                 
                                 ≤
                                 1
                                 ,
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                         is the centroid of the cth cluster, 
                           
                              
                                 u
                              
                              
                                 k
                                 c
                              
                           
                         denotes the fuzzy membership of nth data point to the cth cluster, m 
                        
                           (
                           m
                           ≥
                           1
                           )
                         represents the fuzziness of algorithm, i.e. smaller m implies crisper clustering and 
                           ‖
                           .
                           ‖
                         stands for any norm. However, the majority of papers have considered it as second norm, which is the Euclidean distance. By means of Lagrange multipliers optimization method we have
                           
                              (3)
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   c
                                                
                                             
                                             ‖
                                          
                                          
                                             −
                                             2
                                             /
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                C
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                             
                                             
                                                −
                                                2
                                                /
                                                m
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                                c
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                                c
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         Thus matrix 
                           U
                           =
                           [
                           
                              
                                 u
                              
                              
                                 k
                                 c
                              
                           
                           ]
                         and vector 
                           V
                           =
                           [
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           ]
                         must be updated according to (3) and (4) until reaching the stop criterion, which usually is
                           
                              (5)
                              
                                 
                                    ‖
                                    U
                                    (
                                    t
                                    )
                                    −
                                    U
                                    (
                                    t
                                    −
                                    1
                                    )
                                    ‖
                                 
                                 ≤
                                 ε
                                 .
                              
                           
                        
                     

As mentioned earlier, Zaixin et al. [8] proposed a new FCM method which uses Neighborhood weighted (NW) distance to concurrently perform clustering and denoising. This NW distance is defined as:
                           
                              (6)
                              
                                 
                                    
                                       d
                                    
                                    
                                       N
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 v
                                 )
                                 =
                                 
                                    ∑
                                    
                                       r
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                       r
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       v
                                    
                                 
                              
                           
                         Where 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         is a pixel of image and 
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                         is the neighbor pixel for 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 v
                              
                           
                         is calculated by 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 v
                              
                           
                           =
                           ∑
                           |
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                           (
                           l
                           )
                           −
                           v
                           (
                           l
                           )
                           |
                         where 
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                           (
                           l
                           )
                         and 
                           v
                           (
                           l
                           )
                         denote the lth element of arrays 
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                         and v. In (6), 
                           
                              
                                 ω
                              
                              
                                 k
                                 r
                              
                           
                         is similarity weight between pixel k and its adjacent pixel, pixel r. By considering 
                           
                              
                                 N
                              
                              
                                 k
                              
                           
                         as predefined subset of the kth pixel neighbors and 
                           W
                           (
                           
                              
                                 N
                              
                              
                                 k
                              
                           
                           )
                         as the neighborhood window of pixel k, then 
                           
                              
                                 ω
                              
                              
                                 k
                                 r
                              
                           
                         is obtained according to
                           
                              (7)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       exp
                                       ⁡
                                       (
                                       −
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   ×
                                                   (
                                                   W
                                                   (
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   −
                                                   W
                                                   (
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   )
                                                   )
                                                   ‖
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       exp
                                       ⁡
                                       (
                                       −
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   ×
                                                   (
                                                   W
                                                   (
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   −
                                                   W
                                                   (
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   )
                                                   )
                                                   ‖
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 ,
                                 
                                 r
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         Where 
                           
                              
                                 G
                              
                              
                                 σ
                              
                           
                         is the window of Gaussian weights, assuming that 
                           ‖
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           ‖
                           /
                           ‖
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           ‖
                           ≅
                           1
                         (this assumption is true except for very high noise density). Then the iterative equation of fuzzy membership and cluster centroids will be
                           
                              (8)
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                                r
                                             
                                          
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          
                                             
                                                v
                                             
                                             
                                                c
                                             
                                          
                                          
                                             
                                                ‖
                                                )
                                             
                                             
                                                −
                                                2
                                                /
                                                (
                                                m
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                C
                                             
                                          
                                          (
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                                r
                                             
                                          
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                ‖
                                                )
                                             
                                             
                                                −
                                                2
                                                /
                                                (
                                                m
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                                c
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                k
                                                c
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 ξ
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              
                                 ω
                              
                              
                                 k
                                 r
                              
                           
                           
                              
                                 x
                              
                              
                                 r
                              
                           
                        .

The first problem is choosing appropriate color components for performing segmentation. The most conventional color space is RGB, but Euclidean distance in RGB space may not signify dissimilarity between colors seen in human eye [11], while the HSI space is close to human visual scene [11–16]. Also the components of HSI are highly independent, but RGB components are highly correlated [11,12,17]. Therefore many segmentation algorithms have used the HSI color space [11–21]. However these methods are not based on FCM clustering. According to expressed reasons selecting two components of HSI is more convenient than two components of RGB. Among HSI components, Intensity carries the utmost information of image [13] and the second important component is hue [17]. Hence we pick out Intensity and Hue components of Image for performing segmentation. Intensity and Hue are obtained from the RGB space by
                           
                              (10)
                              
                                 
                                    {
                                    
                                       
                                          
                                             I
                                             =
                                             
                                                
                                                   R
                                                   +
                                                   G
                                                   +
                                                   B
                                                
                                                3
                                             
                                          
                                       
                                       
                                          
                                             H
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         θ
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         B
                                                         ≤
                                                         G
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                         π
                                                         −
                                                         θ
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         B
                                                         >
                                                         G
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             where
                                             
                                             θ
                                             =
                                             
                                                
                                                   cos
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ⁡
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                      [
                                                      (
                                                      R
                                                      −
                                                      G
                                                      )
                                                      +
                                                      (
                                                      R
                                                      −
                                                      B
                                                      )
                                                      ]
                                                   
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               (
                                                               R
                                                               −
                                                               G
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         (
                                                         R
                                                         −
                                                         B
                                                         )
                                                         (
                                                         G
                                                         −
                                                         B
                                                         )
                                                         ]
                                                      
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We define our objective function as
                           
                              (11)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          WHIFCM
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    ∑
                                    
                                       c
                                       =
                                       1
                                    
                                    C
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       c
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          I
                                       
                                    
                                    ⋅
                                    
                                       
                                          doI
                                       
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          H
                                       
                                    
                                    ⋅
                                    
                                       
                                          doH
                                       
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 doI
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                         denotes neighborhood weighed distance of Intensity and 
                           
                              
                                 doH
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                         stands for neighborhood weighted distance of the hue component of 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                        . 
                           
                              
                                 doH
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                         and 
                           
                              
                                 doI
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                         will be discussed later. In the proposed cost function we have combined Hue and Intensity distances with different weights that are 
                           
                              
                                 w
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 H
                              
                           
                        . Experiments show that the ratio of these weights has high effect on the convergence speed of segmentation and accuracy of final segmentation result. Hence the weights must be tuned carefully and intelligently to adequate values, which will be described in the next section.

Hue and Intensity global weights must be tuned in such a way that the value of each weight implies the importance and effect of its corresponding component, e.g. if a component (Hue or Intensity) is approximately constant, its weight value must be low. Also, if a component has a high variation caused by noise, its weight value must be low.

By considering these rules we have proposed a weight tuning algorithm. By assuming 
                           
                              
                                 L
                              
                              
                                 x
                              
                           
                         is the maximum level for intensity or hue values (x could be intensity or hue), the following steps must be performed.
                           
                              1)
                              Calculate the correct number of each component's histogram peaks. For every one of hue and intensity components do the following:
                                    
                                       a.
                                       Calculate color component's histogram 
                                             
                                                
                                                   H
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             j
                                             )
                                             (
                                             0
                                             ≤
                                             j
                                             ≤
                                             
                                                
                                                   L
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                          , where x is substituted by Hue and Intensity, and normalize these histograms by 
                                             
                                                
                                                   h
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             j
                                             )
                                             =
                                             
                                                
                                                   H
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             j
                                             )
                                             /
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   x
                                                
                                             
                                             (
                                             l
                                             )
                                          .

Determine the minimum peak value. For this, two important points must be considered: first, minimum peak height varies by image size, so minimum peak height must have direct relationship with image size in pixels (we considered this issue by normalizing histogram in previous step). Second, this height threshold must be added by a bias value; this bias value implies the floor of the histogram. For noiseless images this floor value is almost always near zero. However for noisy image this variable usually has positive values depending on the type and density of noise. The peak finding algorithm proposed in [22] has the big drawback that does not consider these two points and utilizes a constant number of 20 as the value of minimum peak height, which fails for different image sizes and noisy images (refer to Appendix B for comparison between the performance of our peak finding algorithm with that of [22]).

Regarding the above two mentioned points, we have proposed two quantities, histogram floor (HF) and minimum height above floor (MHAF). We applied Gaussian, speckle, Poisson, localvar and salt and pepper noises on several images and observed their hue and intensity histogram changes with the focus on a quantity for representing the floor of histograms. Except salt and pepper noise, other noise types increased almost all the zero bins of the histograms to positive values. Consequently the most frequent value of the histogram bins did not remain zero. These experiments show that the most frequent value of the histogram bins is a good value for representing the floor. We call this value bin_mode, i.e.
                                             
                                                (12)
                                                
                                                   
                                                      HF
                                                   
                                                   =
                                                   bin
                                                   
                                                   _
                                                   mode
                                                   .
                                                
                                             
                                           As mentioned, for noisy image, this variable takes a positive value depending on the type and density of the noise with the exception of intensity histogram of image degraded by salt and pepper noise. In this special case the noise does not affect all bins of the intensity histogram and the bins remain approximately unchanged except the first and last bins that are increased. Hence the histogram floor remains zero like noiseless intensity histogram of the image. Minimum height above floor should imply minimum segmented size. Both of the following definitions would be reasonable:
                                             
                                                (13)
                                                
                                                   
                                                      
                                                         
                                                            
                                                               MHAF
                                                            
                                                            =
                                                            (
                                                         
                                                         
                                                            ratio of minimum segment size to
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            maximum segment size
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                           or
                                             
                                                (14)
                                                
                                                   
                                                      MHAF
                                                   
                                                   =
                                                   (
                                                   ratio of minimum segment size to image size
                                                   )
                                                
                                             
                                           Then the value of minimum peak height (MPH) is obtained as 
                                             MPH
                                             =
                                             HF
                                             +
                                             MHAF
                                          .

Find the peak locations 
                                             (
                                             
                                                
                                                   Pl
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                           and peak values 
                                             (
                                             
                                                
                                                   Pv
                                                
                                                
                                                   x
                                                
                                             
                                             )
                                           by the following procedure:
                                             
                                                i.
                                                Set 
                                                      m
                                                      =
                                                      0
                                                    and 
                                                      j
                                                      =
                                                      0
                                                   .

if 
                                                      (
                                                      h
                                                      (
                                                      j
                                                      )
                                                      <
                                                      maximum
                                                      (
                                                      h
                                                      (
                                                      j
                                                      −
                                                      δ
                                                      )
                                                      ,
                                                      h
                                                      (
                                                      j
                                                      −
                                                      δ
                                                      +
                                                      1
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      h
                                                      (
                                                      j
                                                      +
                                                      δ
                                                      )
                                                      )
                                                      )
                                                    go to step iv.


                                                   
                                                      m
                                                      =
                                                      m
                                                      +
                                                      1
                                                      ,
                                                      
                                                         
                                                            Pl
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      (
                                                      m
                                                      )
                                                      =
                                                      j
                                                      ,
                                                      
                                                         
                                                            Pv
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      (
                                                      m
                                                      )
                                                      =
                                                      h
                                                      (
                                                      j
                                                      )
                                                   .


                                                   
                                                      j
                                                      =
                                                      j
                                                      +
                                                      1
                                                   .

if 
                                                      (
                                                      j
                                                      ≤
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      )
                                                    go to step ii.

Obtain the number of dominating peaks.
                                             
                                                i.
                                                Filter the peaks to delete false peaks by following fuzzy rules:
                                                      
                                                         (15)
                                                         
                                                            
                                                               
                                                                  
                                                                  
                                                                     
                                                                        IF
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              Pv
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        (
                                                                        m
                                                                        )
                                                                        =
                                                                        =
                                                                        
                                                                           
                                                                              Pv
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        (
                                                                        m
                                                                        +
                                                                        1
                                                                        )
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                  
                                                                     AND
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              Pl
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        (
                                                                        m
                                                                        +
                                                                        1
                                                                        )
                                                                        −
                                                                        
                                                                           
                                                                              Pl
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        (
                                                                        m
                                                                        )
                                                                        <
                                                                        δ
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                  
                                                                     
                                                                        THEN
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           delete
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 Pl
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                           
                                                                           (
                                                                           m
                                                                           +
                                                                           1
                                                                           )
                                                                           ,
                                                                           
                                                                              
                                                                                 Pv
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                           
                                                                           (
                                                                           m
                                                                           +
                                                                           1
                                                                           )
                                                                           )
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                  
                                                                     
                                                                        IF
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              Pv
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                        
                                                                        (
                                                                        m
                                                                        )
                                                                        ≤
                                                                        
                                                                           MPH
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                  
                                                                     
                                                                        THEN
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           delete
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 Pl
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                           
                                                                           (
                                                                           m
                                                                           )
                                                                           ,
                                                                           
                                                                              
                                                                                 Pv
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                           
                                                                           (
                                                                           m
                                                                           )
                                                                           )
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                

For the first fuzzy rule, it must be noted that because of the circularity property of hue component, additional comparisons between the earliest peaks and latest peaks are needed.

Obtain the number of intensity peaks (IPN) and the number of hue peaks (HPN).

Build a table of intensity and hue value densities. We have used the idea of R-table of Hough transform in such a way that:
                                    
                                       a.
                                       Build a table in which rows denote hue and columns denote intensity in such a way that the number of rows is HPN and the distance of rows are identical. Also the number of columns is IPN and the distances of columns are identical.

Fill every table cell by frequency of pixels which satisfy intensity and hue of that table cell.

Calculate the entropy of hue and intensity as a criterion of the amount of information these components have. This is done by means of applying two dimensional conditional entropy formula [23] on the table, i.e.
                                    
                                       (16)
                                       
                                          
                                             
                                                
                                                
                                                   H
                                                   (
                                                   X
                                                   |
                                                   Y
                                                   )
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   log
                                                   ⁡
                                                   
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   H
                                                   (
                                                   Y
                                                   |
                                                   X
                                                   )
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   log
                                                   ⁡
                                                   
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                  where X and Y are intensity and hue and 
                                    p
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                  obtained from hue and intensity density table cells. Because hue and intensity are highly independent (16) becomes
                                    
                                       (17)
                                       
                                          
                                             
                                                
                                                
                                                   I
                                                   _
                                                   
                                                      entropy
                                                   
                                                   =
                                                   H
                                                   (
                                                   X
                                                   )
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   log
                                                   ⁡
                                                   
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   H
                                                   _
                                                   
                                                      entropy
                                                   
                                                   =
                                                   H
                                                   (
                                                   Y
                                                   )
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   log
                                                   ⁡
                                                   
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                  which is entropy of hue and intensity components.

Calculate contrast measure for hue and intensity of image. Since noisy color components usually have high entropy, which is not desired, the entropy measure alone is not enough to describe the hue or intensity information. Hence another image statistic is used, namely image contrast [24,25]. High value of image contrast measure implies that the image is seriously noisy. We apply this idea to the intensity component by
                                    
                                       (18)
                                       
                                          I
                                          _
                                          
                                             Contrast
                                          
                                          =
                                          
                                             ∑
                                             i
                                          
                                          
                                             ∑
                                             j
                                          
                                          
                                             
                                                (
                                                i
                                                −
                                                j
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                I
                                             
                                          
                                          [
                                          i
                                          ,
                                          j
                                          ]
                                       
                                    
                                  where i and j are two intensity levels and 
                                    
                                       
                                          P
                                       
                                       
                                          I
                                       
                                    
                                    [
                                    i
                                    ,
                                    j
                                    ]
                                  is the intensity level co-occurrence matrix. Again we should be aware that hue has a circular nature. Therefore, for hue component, (18) must be modified to (19) and this is applied to the hue component of the image to obtain its contrast measure.
                                    
                                       (19)
                                       
                                          
                                             
                                                
                                                
                                                   H
                                                   _
                                                   
                                                      Contrast
                                                   
                                                   =
                                                   
                                                      ∑
                                                      i
                                                   
                                                   
                                                      ∑
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  H
                                                               
                                                            
                                                            2
                                                         
                                                         −
                                                         
                                                            |
                                                            |
                                                            i
                                                            −
                                                            j
                                                            |
                                                            −
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     H
                                                                  
                                                               
                                                               2
                                                            
                                                            |
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   [
                                                   i
                                                   ,
                                                   j
                                                   ]
                                                
                                             
                                             
                                                
                                                
                                                   
                                                   (
                                                   0
                                                   ≤
                                                   
                                                      hue
                                                   
                                                   ≤
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   ,
                                                   
                                                      hue
                                                   
                                                   ∈
                                                   Z
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              

Finally we obtain the proper weights by
                                    
                                       (20)
                                       
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         I
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         H
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         I
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         H
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                         +
                                                         (
                                                         H
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         I
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         H
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         I
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         I
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         H
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                         +
                                                         (
                                                         H
                                                         _
                                                         
                                                            entropy
                                                         
                                                         )
                                                         (
                                                         I
                                                         _
                                                         
                                                            Contrast
                                                         
                                                         )
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              

After tuning global weights, we must specify the distance measure and perform iterative minimization of the objective function (11). In [11,14,15] different distance measures for HSI space were proposed. For example, [15] proposed local weights for the HSI component. We use NW distance and a local weight for our distance measure. Here, cluster centers and image pixels are vectors with length 2, as 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           =
                           (
                           
                              
                                 x
                              
                              
                                 k
                                 I
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 k
                                 H
                              
                           
                           )
                         and 
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 c
                                 I
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                                 H
                              
                           
                           )
                        . In order to calculate the distance of intensity components (
                           
                              
                                 doI
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                        ), similar to (6), we use
                           
                              (21)
                              
                                 
                                    
                                       doI
                                    
                                    
                                       N
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       r
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                       r
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       I
                                    
                                 
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       c
                                       I
                                    
                                 
                                 |
                                 .
                              
                           
                         It is notable that for calculating each pixel's intensity distance to a cluster center, its neighbors' intensities are involved. Also, in calculating the distance of hue components (
                           
                              
                                 doH
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                        ), it should be noted that hue is a circular variable. Thus 
                           
                              
                                 doH
                              
                              
                                 N
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 c
                              
                           
                           )
                         is defined as
                           
                              (22)
                              
                                 
                                    
                                       doH
                                    
                                    
                                       N
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 =
                                 e
                                 w
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                    ∑
                                    
                                       r
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             L
                                          
                                          
                                             H
                                          
                                       
                                       2
                                    
                                    −
                                    
                                       |
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             r
                                             H
                                          
                                       
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             c
                                             H
                                          
                                       
                                       |
                                       −
                                       
                                          
                                             
                                                L
                                             
                                             
                                                H
                                             
                                          
                                          2
                                       
                                       |
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           e
                           w
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                         is a weight that implies the importance of hue. At high or low intensities, saturation has a low value and hue values become unstable and irrelevant which is considered by this weight. We call this efficacy weight (ew). In fact this local weight is a function of intensity value of 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        , defined in (23) and plotted in Fig. 1
                        . s controls the slope of the function and is empirically set to 20.
                           
                              (23)
                              
                                 
                                    
                                       
                                       
                                          e
                                          w
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                1
                                                −
                                                exp
                                                ⁡
                                                (
                                                −
                                                (
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   2
                                                
                                                −
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                      I
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   2
                                                
                                                |
                                                )
                                                /
                                                s
                                                )
                                             
                                             
                                                1
                                                −
                                                exp
                                                ⁡
                                                (
                                                −
                                                (
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   2
                                                
                                                )
                                                /
                                                s
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          (
                                          0
                                          ≤
                                          
                                             intensity
                                          
                                          ≤
                                          
                                             
                                                L
                                             
                                             
                                                I
                                             
                                          
                                          ,
                                          
                                          
                                             intensiy
                                          
                                          ∈
                                          Z
                                          )
                                       
                                    
                                 
                              
                           
                         Now by means of Lagrange multipliers, the fuzzy membership is obtained by
                           
                              (24)
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                H
                                             
                                          
                                          .
                                          
                                             
                                                doH
                                             
                                             
                                                N
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                c
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                I
                                             
                                          
                                          .
                                          
                                             
                                                doI
                                             
                                             
                                                N
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                c
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          −
                                          2
                                          /
                                          (
                                          m
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             C
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   H
                                                
                                             
                                             .
                                             
                                                
                                                   doH
                                                
                                                
                                                   N
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   I
                                                
                                             
                                             .
                                             
                                                
                                                   doI
                                                
                                                
                                                   N
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             −
                                             2
                                             /
                                             (
                                             m
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                           
                         Also for cluster centers, by assuming that 
                           |
                           
                              
                                 x
                              
                              
                                 k
                                 I
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                                 I
                              
                           
                           |
                           ≅
                           |
                           
                              
                                 x
                              
                              
                                 r
                                 I
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                                 I
                              
                           
                           |
                         and 
                           |
                           
                              
                                 x
                              
                              
                                 k
                                 H
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                                 H
                              
                           
                           |
                           ≅
                           |
                           
                              
                                 x
                              
                              
                                 r
                                 H
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 c
                                 H
                              
                           
                           |
                         which is true except for very high noise density, we will have
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          =
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                c
                                                I
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                c
                                                H
                                             
                                          
                                          )
                                          →
                                          
                                             
                                                v
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               k
                                                               c
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               r
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ω
                                                            
                                                            
                                                               k
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               r
                                                               I
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  H
                                                               
                                                            
                                                            
                                                               2
                                                               π
                                                            
                                                         
                                                         (
                                                         arg
                                                         ⁡
                                                         (
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               k
                                                               c
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               r
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ω
                                                            
                                                            
                                                               k
                                                               r
                                                            
                                                         
                                                         (
                                                         exp
                                                         ⁡
                                                         (
                                                         
                                                            
                                                               2
                                                               π
                                                               j
                                                               ×
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     r
                                                                     H
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  H
                                                               
                                                            
                                                         
                                                         )
                                                         )
                                                         )
                                                         )
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               k
                                                               c
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           j
                           =
                           
                              
                                 −
                                 1
                              
                           
                         and 
                           arg
                           (
                           x
                           )
                         represents the phase of a complex number x, in the range 
                           [
                           0
                           
                           2
                           π
                           ]
                        .

Initial values of the cluster centers have an important effect on the result. Hence we have proposed a proper initialization scheme for the cluster centers as follows, assuming a desired segment number of C:
                           
                              1)
                              Assume that the table obtained in Section 3.3 has 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                  cells. Construct 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                  cluster centers from table cells. Each cluster center has the hue and intensity value of its corresponding cell.

To avoid redundant computation and wasting time, if 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                  is more than 3C, then only keep 3C clusters that have the most population and set 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                  to 3C.

Update cluster centers by performing one iteration of (24) and (25) consecutively.

Calculate the population of clusters.

Find two cluster centers that have the smallest distance to each other. Then merge these two clusters and calculate new cluster center and set 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    1
                                 .

Repeat steps 4 and 5 until C clusters remain. These are the main initial cluster centers, 
                                    
                                       
                                          V
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    ]
                                 .

Together with the algorithm definitions of weight tuning in Section 3.3, objective function minimization in Section 3.4 and initialization in Section 3.5, the weighted hue and Intensity FCM image segmentation algorithm can be stated as follows:
                           
                              1)
                              Read the image data and set the desired number of segments C.

Calculate the hue and intensity components of the image by (10).

Obtain the proper weights for hue and intensity by the algorithm presented in Section 3.3.

Initialize the clusters by the scheme in Section 3.5 to obtain initial cluster centers 
                                    
                                       
                                          V
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    ]
                                 , next obtain 
                                    
                                       
                                          U
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          c
                                       
                                    
                                    ]
                                  by (24).

Update 
                                    U
                                    =
                                    [
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          c
                                       
                                    
                                    ]
                                  and 
                                    V
                                    =
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                    
                                    ]
                                  by (24) and (25) consecutively until stop condition in Section 2.1 is met.

Any pixel k is assigned to segment c according to
                                    
                                       (26)
                                       
                                          
                                             
                                                Seg
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                arg
                                             
                                             
                                                c
                                             
                                          
                                          ⁡
                                          
                                             {
                                             max
                                             ⁡
                                             {
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                   c
                                                
                                             
                                             }
                                             }
                                          
                                          ,
                                          
                                          c
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          C
                                       
                                    
                                 
                              

In this section we apply our algorithm on a test noisy image. The test image is a 
                        193
                        ⁎
                        283
                      airplane image [27], shown in Fig. 3
                     , which is degraded by noise.

In Fig. 4
                     , normalized histograms of hue and intensity and their peaks are shown for Fig. 3b, for the purpose of peak finding, with 
                        δ
                        =
                        10
                      (refer to Appendix B for derivation of δ value) and 
                        
                           MHAF
                        
                        =
                        0.0008
                      as convenient experimental values. As can be seen MPH plays an important role in removing false peaks. Table 1
                      lists the frequencies of hue and intensity values. Also the obtained values of our algorithm quantities for this example are shown in Table 2
                     .

We have set 
                        C
                        =
                        3
                      for this example. In the initialization stage, the algorithm produces 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                        =
                        8
                      initial clusters and only 
                        C
                        =
                        3
                      clusters remain. These are shown in Fig. 5
                     . Fig. 6
                      shows the segmentation results after a number of iterations.

To show the effect of weight tuning we have depicted segmentation results without weight tuning in Fig. 7
                     . As can be seen, many pixels are segmented wrong in the 8th iteration.

@&#EXPERIMENTAL RESULTS@&#

We carried out our experiments on Berkeley Segmentation Dataset [26], to show the capability of our algorithm. Berkeley Segmentation Dataset is provided by University of California, Berkeley computer vision group. The goal of their work is to provide an empirical basis for research on image segmentation and boundary detection. We name our method WHIFCM briefly (weighted hue and intensity FCM). Also we implemented some related works to compare our algorithm performance against other related FCM methods. These include NWFCM_rgb (extended version of the scheme in [8] for RGB space), FGFCM_rgb (extended version of the scheme in [5] for RGB space), extended version of the scheme proposed in [27] for the RGB space and HTFCM [22]. All methods are implemented by MATLAB on a computer with a Pentium dual core 2.60 GHz CPU and 2.00 GB of RAM.

For the purpose of comparing the performance of algorithms visually, only a portion of experiments are shown in Fig. 11 in Appendix A. Also, a small portion of experiments in presence of noise are shown in Fig. 12 in Appendix A.

In order to demonstrate the robustness of our algorithm, the two most important noise types are considered, i.e. salt&pepper and Gaussian noises. The segmentation accuracy (SA) [28] is adopted to quantitatively measure the performance of methods. This is calculated by
                        
                           (27)
                           
                              
                                 SA
                              
                              =
                              
                                 Number of correctly segmented pixels
                                 Total number of pixels
                              
                              
                              0
                              ≤
                              
                                 SA
                              
                              ≤
                              1
                           
                        
                      Where the number of correctly segmented pixels is determined according to the ground truth of segmentation. The corresponding SA values for the segmentations in Fig. 11 and Fig. 12 are tabulated in Table 3
                      and Table 4
                      respectively. Fig. 8
                      shows the average SA criterion for competing algorithms versus different Gaussian noise variances. The average SA for each method at a certain noise variance is obtained by applying that segmentation method on the noisy images and taking the mean of SAs. As mentioned before all images in the experiments are from Berkeley Segmentation Dataset. Also quantitative measure of performance of the methods for noiseless conditions can be observed in Fig. 8, where variance is zero. This condition is specified by arrow in the figure. Fig. 9
                      is similar to Fig. 8, but for different salt & pepper noise densities. Fig. 8 and Fig. 9 are derived from evaluating of the methods on 108 images. One of the reasons of higher robustness of our algorithm is that it initializes cluster centers by appropriate values which have higher importance in noisy images. Another very important reason is the tuned weights. Note that untuned weights, even after proper initialization, may lead to wrong cluster centers, like what was seen in Fig. 7. Also as can been seen in Fig. 8 and 9, HTFCM performs weaker than the other methods. The reason is that unlike other methods, this method does not utilize the local spatial information of pixels.

Computation times of these 5 methods vary substantially for different images with different noises. Therefore, while on average our approach is the fastest, it may not be so for a certain image. The average computation time of the methods over experiments are reported in Fig. 10
                     . Note that for these results the number of iterations of all algorithms is equal to 8. Also note that the computation time not only depends on the hardware specifications, but also is dependent on other factors like other computer processes and programming language used in the implementation. The current implementation is on Matlab. Implementations in a lower-level language, such as C, or using VHDL on FPGA, are expected to reach speeds more than 100 times faster than the current one.

According to Figs. 8–10, our proposed approach outperforms other mentioned methods in both accuracy of segmentation and computation time.

@&#CONCLUSION@&#

In this paper we proposed a novel color image segmentation based on FCM. This method uses only the two most important image components, namely intensity and hue. Consequently the memory needed and computation complexity is reduced in comparison with methods based on 3 color components, like the mentioned competing methods. Also we have considered weights for combining these two components in the cost function. These weights cause faster convergence speed. Furthermore, proper weights prevent creation of wrong cluster centers. Moreover, our algorithm has a fast and noise-robust initialization for cluster centers that reduces the number of iterations severely.
                        1
                     
                     
                        1
                        The Matlab code of our algorithm is available for researchers upon request. Please contact the first author.
                     
                  

All these together made our method's performance superior to the mentioned methods in segmentation accuracy and speed.

A small sample of experimental results is provided in Fig. 11
                      (noiseless images) and Fig. 12
                      (noisy images). Also the corresponding SA values for the segmentations in these figure are listed in Table 3 and Table 4 respectively.

In our peak finding algorithm the minimum peak width is specified by 2δ. This parameter controls the sensitivity of peak detection. As the value of δ decreases peak detection algorithm becomes more sensitive to local variations such as spurious peaks. For larger δ the algorithm only detects the wider peaks such as peak clusters (groups of adjacent and possibly adjacent peaks) and global peaks. Hence very high or very low values would not be suitable for this parameter. It should have a value that only filters out noisy and spurious peaks.

We considered the peaks narrower than 
                        
                           1
                           12
                        
                      of histogram length to be filtered out. Thus we have chosen δ equal to 
                        
                           1
                           
                              2
                              ×
                              12
                           
                        
                      of histogram length. Since in our implementation hue and intensity had 8 bit integer format, our histogram had 
                        
                           
                              2
                           
                           
                              8
                           
                        
                        =
                        256
                      bins. Therefore we have 
                        δ
                        ≅
                        
                           256
                           
                              2
                              (
                              12
                              )
                           
                        
                        ≅
                        10
                     .

To show the effect of δ on peak finding, we have applied our peak finding algorithm on hue and intensity histograms of a test image with different values of δ. The test image in Fig. 13
                      is from Berkeley Dataset with a size of 
                        481
                        ×
                        321
                      pixels. The output of our peak finding algorithm on the hue histogram of the test image is shown in Fig. 14
                      with the delta values of 10 and 50. Clearly, with the large value of delta (50) an authentic peak has not been detected. As another example, the effect of small δ is evaluated. The values of δ in this experiment is chosen 3, and 10. As can be seen in Fig. 15
                      with small δ some spurious peaks are detected as authentic peaks.

A notable point is the effect of delta value on algorithm performance. A small value of delta may lead to incorrect initial cluster centroids, especially when spurious peaks have large heights, and consequently decrease of SA. Another effect is that a small delta increases 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      (refer to Section 3.5) and consequently increases the total algorithm possessing time. Also, a large value of delta may lead to missing of authentic peaks and consequently possible incorrect cluster centroids. Also a large value of delta rarely leads to a 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                      smaller than C, which causes a decrease in SA value.

We have compared the peak finding algorithm of [22] with ours. The peak fining method in [22] does not considers peak width and minimum peak distance. Therefore this method is sensitive to small variations and some spurious peaks are detected. Furthermore this method fails in face of flat peaks. Hence, as expected, in Fig. 16
                      some spurious peaks were detected and a flat peak was not detected. Note that the histogram shape in Fig. 16 is not equal to Fig. 15(a) exactly since according to the peak finding algorithm of [22], some smoothing operations must be done on the initial histogram. Also in the peak finding algorithm of Fig. 16 the histogram is not normalized to the range 
                        [
                        0
                        
                        1
                        ]
                     .

@&#REFERENCES@&#

