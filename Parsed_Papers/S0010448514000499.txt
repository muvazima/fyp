@&#MAIN-TITLE@&#Shape optimization for human-centric products with standardized components

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A mixed-integer shape optimization framework.


                        
                        
                           
                           The ability of design transfer with standardized components.


                        
                        
                           
                           An approach using standardized components in the customization of freeform objects.


                        
                        
                           
                           Design automation of customized products for fitting human bodies.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human-centric

Product design

Shape optimization

Mixed-integer

Standardized components

@&#ABSTRACT@&#


               
               
                  In this paper, we present an optimization framework for automating the shape customization of human-centric products, which can be mounted on or embedded in human body (such as exoskeletal devices and implants). This kind of products needs to be customized to fit the body shapes of users. At present, the design customization for freeform objects is often taken in an interactive manner that is inefficient. We investigate a method to automate the procedure of customization. Major difficulty in solving this problem is caused by the not freely changed shape of components. They should be selected from a series of standardized shapes. Different from the existing approaches that allow fabricating all components by customized production, we develop a new method to generate customized products by using as-many-as-possible standardized components. Our work is based on a mixed-integer shape optimization framework.
               
            

@&#INTRODUCTION@&#

Human-centric products start to be widely used in many medical and sport applications, and the shape of these products must be adaptive to the shape of human bodies. Three-dimensional (3D) shape of human bodies can be obtained by 3D scanners. After establishing the correspondences among different human bodies [1,2], the product originally designed for a specific body can be warped to a shape to fit another body [3]. In this way, the product can be reused and customized for another person. It is good enough for transferring the design of some products such as clothes, shoes, and furniture as all components in these products can be fabricated in a low cost. However, it does not apply to electronic or mechanical products. Some of their components, e.g., nuts, chipsets, or joints, cannot be freely varied. Instead, these components are usually fabricated in a standard way—i.e., each of them has a series of variations that are manufactured by mass production. These components are called standardized components, and the series of variations is called element library in the rest of this paper. Note that, as fabricated by mass production, shape variations of these components are in a stepwise manner. For example, the wheels of bicycles as standardized components can only be either 24 or 26 inch but can never be 24.3 inch.The classification of components into standardized series is mainly based on the procedure of manufacturing, which is beyond the scope of this paper. At present, the customization of products with standardized components is often conducted by designers in an interactive manner. The shape optimization step becomes the bottleneck of designing human-centric products. The major challenge comes from the lack of an effective shape optimization method that allows a component to be varied in a stepwise manner. The problem becomes more challenging when the shape variation is driven by human bodies and the product’s shape is required to well fit the human body’s shape. In this paper, we investigate techniques to automate the step of customization.

A Mixed-Integer As-Rigid-As-Possible (MI-ARAP) shape optimization framework is developed in this paper. The shape optimization is formulated as an as-rigid-as-possible deformation problem that is computed on volumetric meshes. During the optimization, some components are restricted to be one of the pre-defined shapes in the element library, which is actually a variational formulation with integer variables. It means that the component is not allowed to deform continuously from one shape to another shape. To keep the spatial relationship between a product and human bodies, we may use continuous deformation methods [4,3] to warp the shape of a product designed for one human body into a shape fit another human body. This shape obtained by continuous deformation is called the initial shape, which is the input of our optimization. After obtaining the initial shape by warping a product from one human body to another one, the standardized components are warped into a non-standard shape (e.g., see the middle of Fig. 1
                     ). These distorted components will be replaced by the most suitable shapes in the element libraries. Unfortunately, if all the standardized components are simply replaced at the same time, the nearby components could become incompatible. An iterative rounding algorithm is investigated in this paper to solve this problem. An example to illustrate the function of our approach is shown in Fig. 1. As-many-as-possible standardized components are used during the shape optimization, so that an economical solution is developed to realize the customization. This is because the cost of fabricating standardized components by mass production is much lower than the cost of customized production for non-standard shapes.

@&#RELATED WORKS@&#

The related techniques of deformation, structure preserved shape processing and mixed-integer optimization are reviewed as follows.


                        Deformation techniques
                     

Tremendous efforts have been made in the CAD and graphics communities to develop user-friendly deformation tools for the computation of 3D natural deformation. Generally, the existing methods can be classified into surface-based or volume-based approaches (details can be found in the book of Botsch et al.  [5]). Surface-based methods [6–13] usually compute the displacement functions attached on the original surface 
                           S
                         to transfer the original surface into a new shape 
                           
                              
                                 S
                              
                              
                                 ′
                              
                           
                        . A high degree of control can be provided by these methods. On the other hand, the robustness and efficiency of these methods are strongly affected by the mesh complexity and the quality of triangles on 
                           S
                        . In a large literature of surface-based deformation methods, the recent methods based on the as-rigid-as-possible (ARAP) strategy (Ref.  [13,14]) try to reduce the total elasticity of all triangular elements, which can generate very natural deformation results when bending and twisting elastic objects. The main problem of these methods is that the ARAP energy is only evaluated on the surface, which does not intrinsically preserve the volume of the original model. Volume-based methods  [15–17] can solve these problems quite well. In our shape optimization framework, the volume-based ARAP energy is employed to evaluate the elasticity of components. However, none of prior volume-based deformation approaches consider the problem of deformation with stepwise shapes.

All above approaches focus on the shape manipulation of surface 
                           S
                         itself. To reuse the designs on new models, we need a deformation method that is able to transform the objects located around a human body 
                           H
                         to the space around another human body 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                        . By using the freeform deformation technique [4,18], triangles on the surface of 
                           H
                         can be used as handles to deform models around 
                           H
                         to a new shape around 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         if the mapping from 
                           H
                         to 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         is available  [19,20,2,1,21]. Similar shape transformations can also be realized by building cages around the surfaces of 
                           H
                         and 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                           [22,23] or by formulating a spatial warping function  [3,24]. The recent development focuses on how to preserve the shape preference of the original design around 
                           H
                         when transforming it to the product around 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         (Ref. [25,26]). The shape transformation approach developed by Brouet et al.  [26] is based on the idea of ARAP surface modeling[13,14] and the deformation transfer approaches  [27–30]. However, the ARAP formulation is nonlinear, Sorkine et al.  [31] and Igarashi et al.  [13] designed a two-step editing process for this optimization. Similarly, Schaefer et al.  [32] implemented a moving least squares framework for 2D space warping. Later, these so-called local/global approaches  [14,33] have been extended to work on volumetric meshes  [34,35]. Specifically, in a local phase, the transformation matrix of each element is first evaluated and manipulated to indicate the deformation preferences. This is followed by a global phase to ensure that the transformations applied to the elements around each vertex are compatible, i.e., corresponding vertices in different elements are in consistent positions. A recent study [36] shows that such a local/global computation converges very fast. Our shape optimization framework will adopt this strategy of local/global computation.


                        Structure-aware shape processing
                     

The recent development of shape processing techniques in the community of geometric modeling extends the concept of parametric modeling in CAD/CAM systems to objects with complex geometry. As the input models of these approaches are piecewise linear surfaces without any structural information, two phases are conducted: (1) shape analysis to find out structural constraints and (2) shape manipulation that preserves the constraints.

Following the idea of feature-preserving in image warping, Kraevoy et al.  [37] proposed a method to resize geometric models, meanwhile preserve the structures by computing a non-homogeneous volumetric mapping on grids. A more flexible method is presented in the work of Gal et al.  [38] to preserve structures on man-made models by using a few special 1D wires. This work is extended by Zheng et al.  [39] to manipulate the shape of models by their constituent components. As a result, users have easier control over the shape of models by using component-wise controllers. Another recent work presented by Bokeloh et al. [40] can detect continuous and discrete regular patterns. These patterns are preserved in a variational deformation framework by integrating a discrete algorithm that adaptively inserts or removes repeated elements in regular patterns. Our method for computing customized products will integrate discrete algorithms into variational optimization framework to progressively preserve the shape of standardized components. Structure preservation is also formulated as a constrained modification in image-based modeling of architectures [41]. The recent work in image-based modeling  [42] tries to solve such constrained editing problems by first determining a minimal set of vertices to be updated and then computing actual position updates to satisfy all constraints. However, the above structure-aware shape processing approaches consider neither the shape adaptation on human bodies nor the constraints of standardized components.


                        Mixed-integer optimization
                     

Solving a mixed-integer optimization problem that has both continuous and discrete unknowns is NP-hard  [43]. Different from optimization problems only have continuous unknowns, the computational domain of mixed-integer optimization is formed by many isolated sub-regions, and the discrete unknowns can only be changed in a jump from one sub-region to another one. As a result, solving such problems may need to test all discrete possibilities. However, this is not practical when the number of discrete unknowns is large. A more practical scheme was introduced by Bommes et al.  [44]. Their approach adopts a greedy strategy to first solve the relaxed problems by treating the discrete unknowns as continuous variables, and then projects the solution by rounding the discrete unknown with smallest rounding error into integer incrementally. The nature of using standardized components in the customization of products is similar to the mixed-integer optimization—the variation of standardized components can only jump from one pre-defined shape to another shape. In other words, the optimization domain is also discretized. An iterative greedy rounding scheme is investigated in our shape optimization framework.

The contributions of research work presented in this paper are twofold. 
                           
                              1.
                              
                                 Mixed-integer shape optimization:

The shape optimization of products is formulated as an as-rigid-as-possible deformation problem that is computed on volumetric meshes. Specifically, some sub-domains of a deformed object are restricted to a series of pre-defined shapes, which is a variational formulation with integer variables. An iterative rounding algorithm is developed to solve this mixed-integer optimization problem.


                                 Design transfer with standardized components:

After obtaining the initial shape of a product with assembled components based on the mapping between spaces around human bodies, the components are replaced by standardized components progressively. As-many-as-possible standardized components are used meanwhile the elastic energy is minimized for other components. Shapes of the standardized components are selected from their corresponding element libraries, and the best-fit shapes are found automatically.

The rest of the paper is organized as follows. The basic MI-ARAP framework is first introduced in Section  2, and it is further extended for standardized components in Section  3. After that, the formulation of adding hard constraints into the optimization is presented in Section  4. In Section  5, a flexible encoding is described to formulate the relationship between assembled components. Finally, different examples are shown in Section  6, and our paper ends with the conclusion section.

Shape optimization is formulated under an ARAP framework with mixed-integer variables. Specifically, the standardized components can only jump from a pre-defined shape to another one rather than a continuous deformation in 
                        
                           
                              E
                           
                           
                              3
                           
                        
                     . Without loss of generality, we assume that the components to be deformed have been tessellated into tetrahedral meshes. Four vertices of a tetrahedron 
                        t
                      have their rest positions 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 4
                              
                           
                           }
                        
                      before deformation and the current positions 
                        
                           {
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 4
                              
                           
                           }
                        
                      in the deformation. The current positions at the beginning of optimization can be obtained by spatial warping functions [3], and the current positions in the later steps of iteration will be updated during the optimization. Given the current positions and the rest positions of 
                        t
                     , a linear transformation between the rest and the current shapes can be defined by a transformation matrix 
                        
                           T
                        
                      and a displacement vector 
                        
                           d
                        
                      as
                        
                           (1)
                           
                              
                                 T
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 d
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              4
                              .
                           
                        
                     
                     
                        
                           d
                        
                      can be eliminated by subtracting the last equation from the others, such that the formulation is invariant to translation. Then, we can have 
                        
                           T
                        
                        
                           P
                        
                        =
                        
                           
                              
                                 P
                              
                           
                           
                              ̃
                           
                        
                      with 
                        
                           
                              
                                 
                                    P
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                      As a result, the transformation matrix 
                        
                           T
                        
                      can be obtained by 
                        
                           T
                        
                        =
                        
                           
                              
                                 P
                              
                           
                           
                              ̃
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              −
                              1
                           
                        
                     , which includes both the scaling and the rotation. In the ARAP formulation, it will be enforced to a rigid-body transformation only has rotation. According to the discussion in the paper of Liu et al.  [33], the scaling matrix and the rotational matrix can be decoupled by the “signed version” of singular value decomposition (SVD) into 
                        
                           T
                        
                        =
                        
                           U
                        
                        Σ
                        
                           
                              
                                 V
                              
                           
                           
                              T
                           
                        
                     . Due to the reason that 
                        
                           T
                        
                      is a square matrix with positive determinant, 
                        
                           U
                        
                      and 
                        
                           V
                        
                      are the rotational matrices, and 
                        Σ
                      is a scaling matrix written as 
                        Σ
                        =
                        d
                        i
                        a
                        g
                        
                           {
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                           }
                        
                     . 
                        
                           
                              σ
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              3
                           
                        
                      are the scaling factors of 
                        
                           T
                        
                      in three orthogonal directions. Then, a pure rotational matrix can be derived from 
                        
                           T
                        
                      as 
                        
                           (2)
                           
                              
                                 L
                              
                              =
                              
                                 U
                              
                              
                                 
                                    
                                       V
                                    
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     
                  

The optimization targets on minimizing the difference between 
                        
                           T
                        
                      and 
                        
                           L
                        
                     . Therefore, the optimization energy that is going to be minimized can be written as
                        
                           (3)
                           
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    …
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             t
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                           
                           
                              F
                           
                        
                      is the Frobenius norm, and 
                        
                           
                              Δ
                           
                           
                              t
                           
                        
                     s are the volumes of tetrahedra serving as weights of the systems. As 
                        
                           T
                        
                      is in a linear form of 
                        t
                     ’s vertices, Eq. (3) can be reformulated into the form of 
                        
                           (4)
                           
                              
                                 
                                    min
                                 
                                 
                                    
                                       x
                                    
                                 
                              
                              ∑
                              
                                 
                                    
                                       ‖
                                       
                                          A
                                       
                                       
                                          x
                                       
                                       −
                                       
                                          b
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                      with 
                        
                           x
                        
                      being the vertex positions. Details of the reformulation can be found in the Appendix. The positions under ARAP deformation can be determined by computing the least-square solution of 
                        
                           A
                        
                        
                           x
                        
                        =
                        
                           b
                        
                     . After that, this procedure is iterated to compute new transformation matrices 
                        
                           
                              
                                 L
                              
                           
                           
                              t
                           
                        
                      by using the new vertex positions, and then update the positions of vertices by these newly determined matrices. The iteration is stopped when the ARAP energy in Eq. (3) converges.

Different from the above continuous ARAP deformation, for the mixed-integer shape optimization problem, some tetrahedra (e.g.,  
                           r
                        ) must be deformed to one of the 
                           k
                         pre-defined shapes: 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 j
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        , (
                           j
                           =
                           1
                           ,
                           …
                           ,
                           k
                        )—i.e., the pre-defined shapes are served as the discrete variables here. These tetrahedra are called integer tetrahedra, and 
                           r
                         must be projected to one of these 
                           k
                         shapes in optimization. An iterative rounding algorithm is developed as follows (see the flow chart in Fig. 2
                         as well). 
                           
                              1.
                              All the integer tetrahedra that have not been rounded are stored in a list, 
                                    I
                                    n
                                    t
                                    L
                                    i
                                    s
                                    t
                                 . For each tetrahedron 
                                    r
                                    ∈
                                    I
                                    n
                                    t
                                    L
                                    i
                                    s
                                    t
                                 , the shape similarities between it and its corresponding pre-defined shapes are computed.

In the set of pre-defined shapes for 
                                    r
                                 , the shape, 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          r
                                       
                                       
                                          j
                                       
                                    
                                 , that is the most similar to 
                                    r
                                  is selected to generate a score of similarity as 
                                    S
                                    I
                                    
                                       
                                          M
                                       
                                       
                                          r
                                       
                                    
                                 ;

Among all the pairs for different integer tetrahedra, the one having the highest similarity (i.e.,  
                                    
                                       
                                          max
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          {
                                          S
                                          I
                                          
                                             
                                                M
                                             
                                             
                                                r
                                             
                                          
                                          }
                                       
                                       )
                                    
                                 ) is selected: (
                                    
                                       
                                          r
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                 ).

The selected integer tetrahedron, 
                                    
                                       
                                          r
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                 , is rounded by setting its rest position to be 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                 ,

i.e., 
                                    
                                       P
                                    
                                    ←
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             1
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             4
                                          
                                          
                                             j
                                          
                                       
                                       
                                       
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             2
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             4
                                          
                                          
                                             j
                                          
                                       
                                       
                                       
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             3
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             4
                                          
                                          
                                             j
                                          
                                       
                                       ]
                                    
                                 .

Computing 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       U
                                    
                                    
                                       V
                                    
                                  from 
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       U
                                    
                                    Σ
                                    
                                       V
                                    
                                 .

Adding 
                                    
                                       
                                          r
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                  to the set of rounded tetrahedra, 
                                    R
                                 , and converting 
                                    
                                       
                                          r
                                       
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                  to hard constraints with 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                  in the rest steps of shape optimization as 
                                    
                                       (5)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                …
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          
                                          s
                                          .
                                          t
                                          .
                                          ,
                                          ∀
                                          r
                                          ∈
                                          R
                                          ,
                                          
                                             
                                                
                                                   T
                                                
                                             
                                             
                                                r
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Optimization with hard constraints (in Eq. (5)) is employed to update the positions of vertices. Details will be discussed in Section  4.

Go back to step 2 until all integer tetrahedra have been rounded (i.e.,  
                                    I
                                    n
                                    t
                                    L
                                    i
                                    s
                                    t
                                  is empty).

This is a bare form of the MI-ARAP shape optimization framework. A more sophisticated approach will be discussed in Section  3 to round all tetrahedra belonging to the same component together. Before that, we discuss the method to compute shape similarities on tetrahedra.

Assume having an element library of pre-defined shapes {
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 k
                              
                           
                        } for an integer tetrahedron 
                           r
                        , we need to find out the best-fit to define the target shape of 
                           r
                        . To evaluate the shape similarity, ARAP energy defined in Eq. (3) can be used. Specifically, ARAP energy is computed for each of these shapes in element library by setting the rest position of 
                           r
                         to be 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 j
                              
                           
                        , i.e.,  
                           
                              P
                           
                           ←
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              [
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              
                              
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              
                              
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              ]
                           
                        . For a pre-defined shape, a transformation matrix can be obtained from 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 
                                    P
                                 
                              
                              
                                 ̃
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                        . 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 j
                              
                           
                         is then decomposed to 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 
                                    U
                                 
                              
                              
                                 j
                              
                           
                           
                              
                                 Σ
                              
                              
                                 j
                              
                           
                           
                              
                                 
                                    V
                                 
                              
                              
                                 j
                              
                           
                         where 
                           
                              
                                 Σ
                              
                              
                                 j
                              
                           
                           =
                           d
                           i
                           a
                           g
                           
                              {
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        . As a result, the ARAP energy for the shape 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 j
                              
                           
                         is defined as
                           
                              (6)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          r
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         The smaller the ARAP energy is, the higher the shape similarity is given (i.e.,  
                           S
                           I
                           M
                           ∝
                           1
                           /
                           E
                        ). The optimal case gives 
                           E
                           
                              (
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           =
                           0
                         under which condition the pre-defined shape 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                              
                              
                                 j
                              
                           
                         has the same shape of 
                           r
                        .

In our iterative rounding algorithm, Eq. (6) is employed to measure the shape similarity. It can be easily extended to measure the shape similarity for a group of tetrahedra.

Different from the bare form of MI-ARAP presented in the above section, we need to process components in design transfer. A component usually consists of a group of tetrahedra. As a result, we have to process the tetrahedra in a group all together.

Given a product 
                           Υ
                         that has a set of components, the components can be classified into non-standardized and standardized. Each standardized component 
                           
                              (
                              
                                 
                                    ω
                                 
                                 
                                    l
                                 
                              
                              ∈
                              Υ
                              :
                              l
                              =
                              1
                              ,
                              …
                              ,
                              L
                              )
                           
                         is associated with an element library having 
                           k
                         pre-defined shapes—denoted by 
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    l
                                 
                                 
                                    j
                                 
                              
                              }
                           
                           :
                           j
                           =
                           1
                           ,
                           …
                           ,
                           k
                        . A standardized component is composed of a set of integer tetrahedra, and its shape is defined as
                           
                              
                                 
                                    
                                       ω
                                    
                                    
                                       l
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       r
                                       ,
                                       l
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                                 ,
                                 l
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 ω
                              
                              
                                 l
                              
                              
                                 j
                              
                           
                         is the shape of an integer tetrahedron 
                           r
                        . Rounding a standardized component 
                           
                              
                                 ω
                              
                              
                                 l
                              
                           
                         into a shape 
                           
                              
                                 ω
                              
                              
                                 l
                              
                              
                                 j
                              
                           
                         can be realized by rounding each tetrahedron 
                           r
                         of 
                           
                              
                                 ω
                              
                              
                                 l
                              
                           
                         to a pre-defined shape 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 r
                                 ,
                                 l
                              
                              
                                 j
                              
                           
                        . Furthermore, measuring the shape similarity between a component and the pre-defined shapes stored in the element library is based on measuring the shape similarity of all tetrahedra constituting the component, i.e.,  
                           
                              (7)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          l
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          |
                                          
                                             
                                                ω
                                             
                                             
                                                l
                                             
                                          
                                          |
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             ω
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 E
                                 
                                    (
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          r
                                          ,
                                          l
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              |
                              
                                 
                                    ω
                                 
                                 
                                    l
                                 
                              
                              |
                           
                         is the number of tetrahedra in 
                           
                              
                                 ω
                              
                              
                                 l
                              
                           
                        .

Assuming the shape of a product 
                           Υ
                         is originally designed for a human body 
                           H
                        , it is transferred to another body 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         by a warping function such as t-FFD  [4,18] to give an initial shape 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                        . As t-FFD tends to preserve the spatial relationship between points, the shape of 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                         will fit the body shape 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         (as shown in the middle of Fig. 1). However, the warping result deforms all components in 
                           Υ
                         including those standardized components, and this should be corrected through the MI-ARAP shape optimization. To prepare for the shape optimization with standardized components, volumetric cross-parameterization [45] is computed for the standardized components, {
                           
                              
                                 ω
                              
                              
                                 l
                              
                              
                                 j
                              
                           
                        }, in the same series (e.g., among the bolts from M4 to M7 in Fig. 5).

We start the design automation by warping all tetrahedra of 
                           Υ
                         to a shape 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                         around 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                         by t-FFD. Therefore, the current positions of tetrahedra used in the MI-ARAP framework can be obtained. Without loss of generality, we assume 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                         is the optimal shape for 
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                        , so that the shapes of tetrahedra in 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                         are used as rest shapes while applying the MI-ARAP shape optimization. The tetrahedra do not belong to any standardized components are called flexible—the target transformation matrix for them will be obtained from their shape in 
                           
                              
                                 Υ
                              
                              
                                 ′
                              
                           
                         as the rest positions. Moreover, some vertices can be specified by users to serve as pins in the process. Their positions are fixed during the optimization.

To verify the performance of our MI-ARAP optimization framework, the following experiments are taken. Three tests are conducted to study the optimization behavior by scaling, blending or shearing a template domain. First, a standardized component is embedded in the domain (see Fig. 3
                        ), and the component is enforced to deform back to its original shape by the MI-ARAP shape optimization when letting the element library have only one element. This test is used to check if the optimization can converge. Second, we take a similar test but having multiple standardized components (as shown in Fig. 4
                        ), and the components are put close to each other. We aim at showing the behavior of MI-ARAP optimization when dealing with interaction between components. Third, we embed different standardized components in a domain, and each of the components has its own element library (see Fig. 5
                        ). This is to test whether the shape matching algorithm can successfully select a shape from the element library to well-fit the target domain.

The first experiment is shown in Fig. 3. The standardized component is a bolt embedded in a rectangular domain. Integer tetrahedra, which form the standardized component, are shown in yellow color. When the domain is deformed, the component is warped together with the domain. The shape optimization algorithm is expected to deform the component back to its original shape (but may result in different position and orientation). The deformed shape is input as the current position, and the original shape serves as the rest position. Our MI-ARAP framework can successfully deform the component to its original shape. The cross-section of computational domain in volumetric mesh is also shown to illustrate the distortion.

The second experiment is shown in Fig. 4. Multiple bolts are embedded in a domain, and they need to be deformed back to their original shapes. Although they are very close to each other, the computation of our optimization approach can still converge to the original shape and generate no intersection. In short, the framework has no difficulty to handle multiple components.

In the third experiment shown in Fig. 5, four components are embedded into the template domain, including a cube (
                           
                              
                                 ω
                              
                              
                                 1
                              
                           
                        ), a bolt (
                           
                              
                                 ω
                              
                              
                                 2
                              
                           
                        ), a nut (
                           
                              
                                 ω
                              
                              
                                 3
                              
                           
                        ), and an I-beam (
                           
                              
                                 ω
                              
                              
                                 4
                              
                           
                        ). The cube, the bolt and the nut have four different standardized shapes in their element libraries, and the I-beam has only one shape, i.e.,  
                           
                              •
                              Cube (
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                    
                                 ): 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       C
                                    
                                    1
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       C
                                    
                                    2
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       C
                                    
                                    3
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       C
                                    
                                    4
                                 ;

Bolt (
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                 ): 
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       M
                                    
                                    4
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       M
                                    
                                    5
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       M
                                    
                                    6
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       M
                                    
                                    7
                                 ;

Nut (
                                    
                                       
                                          ω
                                       
                                       
                                          3
                                       
                                    
                                 ): 
                                    
                                       
                                          ω
                                       
                                       
                                          3
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       N
                                    
                                    4
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       N
                                    
                                    5
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          3
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       N
                                    
                                    6
                                 , 
                                    
                                       
                                          ω
                                       
                                       
                                          3
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       N
                                    
                                    7
                                 ;

I-beam (
                                    
                                       
                                          ω
                                       
                                       
                                          4
                                       
                                    
                                 ) is rigid.

For the rounding procedure, we need to optimize the objective function meanwhile enforcing hard constraints in step 7. Simply giving a higher weight for the integer tetrahedra is not able to deform a component to a pre-defined shape exactly. In our implementation, once the ARAP energy is minimized, a further step is applied to project and lock the positions of corresponding vertices to enforce the pre-defined shapes. Locking the positions of vertices can be realized by moving all the known values (locked positions) to the right hand side of the linear system, which avoids adding equations into the system for hard constraints. The equation system processed in this way is stable during the optimization, and the pre-defined shape can be exactly preserved.

The ARAP shape optimization in Eq. (3) is reformulated to 
                           
                              (8)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       …
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   T
                                                
                                             
                                             
                                                t
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         by using different weights as 
                           
                              
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 min
                                 
                                    (
                                    
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    δ
                                    )
                                 
                              
                           
                         with 
                           
                              
                                 Δ
                              
                              
                                 m
                                 a
                                 x
                              
                           
                         being the maximal value of {
                           
                              
                                 Δ
                              
                              
                                 t
                              
                           
                        }. In our implementation, 
                           δ
                           =
                           5
                         works well for all examples. The weight 
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                         is assigned as 500 for an integer tetrahedron, and 
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           =
                           1
                         is employed for the rest tetrahedra.

The weights are set in this way because of the following reasons. First, the integer tetrahedra should have a higher priority to ensure that the shape is as-close-as-possible to the pre-defined shape. Second, distortion is introduced when the integer tetrahedra are changed. This distortion is disturbed to the whole mesh, and a larger tetrahedron should have larger room to absorb the distortion. This formulation is different from the general ARAP deformation, in which a larger tetrahedron is set to be more rigid in order to sustain the overall rigidity. Inversely, a tetrahedron with larger volume is expected to absorb more distortion here. The maximal volume, 
                           
                              
                                 Δ
                              
                              
                                 
                                    max
                                 
                              
                           
                        , is used to prevent extremely large weights that may lead to instable numerical systems.

The optimization will be iterated until the ARAP energy converges, which can be detected by the change of ARAP energy in successive iterations. After that, a further projection step is applied to finalize the shapes of the integer tetrahedra and fix their vertices’ positions as the hard constraints. This iterative rounding process has two phases. The first phase is to round the components to their pre-defined shapes and assign them with higher weights in Eq. (8). The second phase projects the components’ vertices. Again, the greedy rounding approach is based on the measurement of shape similarity.

Assume a component has 
                           m
                         vertices, the rest positions of a pre-defined shape are 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         (
                           i
                           ∈
                           1
                           …
                           m
                        ). Their corresponding current positions are 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                         (
                           i
                           ∈
                           1
                           …
                           m
                        ). As 
                           m
                           >
                           4
                        , we can determine 
                           
                              T
                           
                         and 
                           
                              d
                           
                         in 
                           
                              T
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              d
                           
                           =
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                         by a least square solution. After that, the exact positions for all the vertices in a component can be computed by 
                           
                              L
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              d
                           
                        , where 
                           
                              L
                           
                         is the rigid transformation derived from 
                           
                              T
                           
                         (e.g., by Eq. (2)). These positions are the projected positions, which are fixed as hard constraints in the later iterations of optimization.

The basic assumption of our method discussed in above sections is that the components are meshed together with the domain consists of flexible tetrahedra. In other words, we assume that a compatible mesh can be generated for all the components as well as the domain of computation (see the middle of Fig. 6
                     ). However, it relies too much on the quality of meshing results. In many cases, it is hard to generate a compatible mesh to embed all the components. A more flexible method is to encode the relationship between components in the numerical system.

Given two components 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                      as what is shown in Fig. 6 (left), the contact surfaces must be deformed together when 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                      are contacted in the original design. This relationship can be formulated as hard constraints. Instead of generating a compatible mesh for the components, we encode the 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                     ’s vertices near the contact surfaces onto 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      (see the right of Fig. 6). Specifically, the vertices in red which belong to 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                      are represented by the barycentric coordinate of the tetrahedra that they are encoded to. In other words, they are not variables anymore. For instance, if a vertex 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                      is encoded to a tetrahedron having vertices 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 a
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 b
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 c
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 d
                              
                           
                           }
                        
                      with the barycentric coordinates 
                        
                           {
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                           }
                        
                      (
                        
                           
                              u
                           
                           
                              0
                           
                        
                        +
                        
                           
                              u
                           
                           
                              1
                           
                        
                        +
                        
                           
                              u
                           
                           
                              2
                           
                        
                        +
                        
                           
                              u
                           
                           
                              3
                           
                        
                        =
                        1
                     ), 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                      can be expressed by 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        =
                        
                           
                              u
                           
                           
                              0
                           
                        
                        
                           
                              
                                 p
                              
                           
                           
                              a
                           
                        
                        +
                        
                           
                              u
                           
                           
                              1
                           
                        
                        
                           
                              
                                 p
                              
                           
                           
                              b
                           
                        
                        +
                        
                           
                              u
                           
                           
                              2
                           
                        
                        
                           
                              
                                 p
                              
                           
                           
                              c
                           
                        
                        +
                        
                           
                              u
                           
                           
                              3
                           
                        
                        
                           
                              
                                 p
                              
                           
                           
                              d
                           
                        
                      in the formulation. As a result, each component of a product can be tessellated independently. This encoding method can also be applied to constrain the relationship between fully overlapped meshes, e.g., domain 
                        →
                      component.

In this paper, we present a MI-ARAP shape optimization framework. This framework supports design transfer of products with standardized components. This feature is important because many mechanical and electronic components have a high cost in customization. Making use of standardized components, which are manufactured by mass production, can reduce the cost of building customized products. Examples are shown in this section.

Our implementation is written in C++ code and the results are generated on an Intel®  Core
                        
                           
                           
                              T
                              M
                           
                        
                      i7-3770S CPU at 3.10 GHz with 8 GB RAM. The shape optimization can be computed efficiently on our program. For example, the bicycle model that has eight components results in 182,509 tetrahedra with 45,379 vertices in total. This leads to a least-square system having the matrix 
                        
                           A
                        
                      (see Eq. (4)) with dimension: 
                        547
                        ,
                        627
                        ×
                        45
                        ,
                        379
                      at the beginning of optimization. The size of linear system is reduced after converting rounded components into hard constraints in terms of positions. In our experimental tests, the result of a bicycle example can be obtained in 78 s on the above platform.


                     Exoskeleton
                  

An exoskeleton is designed to help paralyzed people to walk again. As the exoskeleton is mounted on a human body (see Fig. 1), it should be customized so that the person wearing it will not feel uncomfortable. Most of the components in the exoskeleton are non-standardized. However, the controllers (see the pink blocks in Fig. 1) need to be rigid as they are electronic components. The joints (in red) that are mechanical components need to be rigid too. After specifying these constraints in our MI-ARAP framework, the optimization will preserve the shape of the mechanical and electronic components while determining how the shapes of other non-standardized components should be.


                     Circuit Board
                  

For human-centric electronic products, i.e., hair dryer or mouse, there are many electrical parts inside. Circuit board is an essential part. A circuit board is usually integrated with a lot of electronic components (e.g., DSP chips and sockets). The shapes of these components are standardized, and our method can help to realize customization by using such components. See the example shown in Fig. 7
                     , there are a DSP, a DIP16, and a ram socket on a printed circuit board (PCB). The PCB can be customized based on different applications, and the examples of scaling and blending the template domain are shown in Fig. 7. Freeform deformations can also be taken in other applications. As shown in Fig. 7, the MI-ARAP framework can produce customized results while keeping the components in standard shapes. More importantly, our method can ensure an intersection-free mapping. It means that the conductive traces will not have interference with each other. As a result, the customized PCB can be directly manufactured, and the components can be installed on the circuit board without any difficulty.


                     Bicycle
                  

A bicycle is composed of many components (see Fig. 8
                     ). Some of them are not allowed to change (e.g., belt and adjusters). Some of them are unchangeable (e.g., pedals, seat saddle and gears), which are required to be rigid. Some of them are standardized components (e.g., wheels, handlebar and frame), where each of them is accompanied with an element library. The components are embedded in a design domain in terms of volumetric mesh that covers all the components of a bicycle. For simplicity, the complicated components (e.g., pedals, gears and wheels) are replaced by their convex hull in the optimization.

Given this configuration, the lists of components {
                        
                           
                              ω
                           
                           
                              l
                           
                           
                              k
                           
                        
                     } in element libraries are summarized as follows:
                        
                           •
                           Wheels (
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                 
                              ): 
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       0
                                    
                                    
                                       ″
                                    
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       2
                                    
                                    
                                       ″
                                    
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       4
                                    
                                    
                                       ″
                                    
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       6
                                    
                                    
                                       ″
                                    
                                 
                              ;

Handlebar (
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                 
                              ): 
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    B1
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    B2
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    B3
                                 
                              ;

Frame (
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                 
                              ): 
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    F1
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    F2
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    F3
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    F4
                                 
                              , 
                                 
                                    
                                       ω
                                    
                                    
                                       3
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    F5
                                 
                              ;

Pedal (
                                 
                                    
                                       ω
                                    
                                    
                                       4
                                    
                                 
                              ), seat saddle (
                                 
                                    
                                       ω
                                    
                                    
                                       5
                                    
                                 
                              ), and gear (
                                 
                                    
                                       ω
                                    
                                    
                                       6
                                    
                                 
                              ) are rigid.

First, the selection of combinations is driven by applying global scaling. The domain is scaled in Y and XY directions, and the scaling results are used as the target domain. After that, our shape optimization algorithm is applied to find out the best-fit components and the overall mapping. Our method can suggest the best combination and successfully find out the relationship between them. For example, for scaling 1.5 times in the Y direction, the combination {
                        2
                        
                           
                              0
                           
                           
                              ″
                           
                        
                     , 
                        2
                        
                           
                              4
                           
                           
                              ″
                           
                        
                     , B1, F1} is selected; and {
                        2
                        
                           
                              6
                           
                           
                              ″
                           
                        
                     , 
                        2
                        
                           
                              6
                           
                           
                              ″
                           
                        
                     , B1, F4} is selected for scaling in both X and Y directions by a factor of 1.5. The results can be found at the middle row of Fig. 8.

Second, the customization is driven by human skeletons, which can be generated by Kinect  [46]. First of all, the joints of a template skeleton are captured for a new customer. The new positions of points are used as handles to deform the template domain and the components to get the initial shapes. In our implementation, ARAP deformation driven by position-handles is employed. Once the initial shapes are ready, they are passed to our framework to work out the optimized solution that is the best combination for the new design. Note that, for example in the bottom row on the left of Fig. 8, the handlebar cannot exactly fit to the hand of the skeletons. It is due to the reason that handlebar is a standardized component, so that the system can only output an as-close-as-possible result. This is the tradeoff in using standardized components when the shapes defined in element library are not sufficient. Otherwise, the handlebar needs to be fabricated in a customized manner.

With the help of Kinect, we can quickly capture the skeleton of a new customer. By our approach, the best combination and configuration for different customers can be formed automatically. Customized bicycles with standardized components can be produced thereafter.

We verify the functionality of our approach on the example of customized bicycles by experimental tests. On the template designed for a well-fitting bicycle, the closest points to five joints–hip, right hand, left hand, right ankle, left ankle–are measured and used as benchmarks for verifying the quality of a new design. For a better design, the distances between the joints and these benchmarks should be shorter. Therefore, these distances are used as fitness-metrics for quality measurement in our experimental tests.

We first try to fit three conventional combinations of bicycles with standard wheel sizes as 
                           2
                           
                              
                                 0
                              
                              
                                 ″
                              
                           
                        , 
                           2
                           
                              
                                 4
                              
                              
                                 ″
                              
                           
                         and 
                           2
                           
                              
                                 6
                              
                              
                                 ″
                              
                           
                         (see Fig. 9
                        ) onto two users that have been shown in Fig. 8(d). Rigid body registration by using the joints and their corresponding points on the bicycles is employed to determine the best position/orientation of the standard bicycles. Specifically, a rigid transformation centered at the average position of all joints is determined to transfer the standard bicycles onto an ‘optimal’ position/orientation according to the users. Details about this anchor points-based rigid body transformation can be found in  [3]. Note that, when computing the rigid transformation, all joints (not only the five joints mentioned above) of user’s skeleton are used to determine an optimal solution. These results are compared with the results obtained by our optimization framework. The distances between the five joints and the benchmarks on the bicycles are measured and shown in Fig. 10
                        . It is easy to find that our results present much less errors on the fitness-metrics. These tests verify that our shape optimization approach can improve the fitness of customized design while still using standardized components. A more practical verification can only be taken by collaborating with the industrial manufacturing companies.

In this paper, a shape optimization framework is presented for the design automation of human-centric products. This framework solves a mixed-integer shape optimization problem, and provides a function to generate customized product by using standardized components. As-Rigid-As-Possible (ARAP) energy is reformulated for this purpose, and hard constraints on transformation matrices are included by a projection-based approach. A shape matching algorithm is proposed to find out the best-fit combination for the standardized components.

@&#LIMITATIONS@&#

The experimental tests are encouraging. However, there are also some limitations. First, the weights in ARAP energy are based on the volume of tetrahedron. If the mesh quality is poor, the weight must be carefully handled; otherwise, it may make the linear equation system unstable. Second, this approach includes the meshes of all components in the same system of numerical optimization. When the size of mesh is very large, it may cause memory consumption problems.

Although self-intersection rarely occurs when testing the examples shown in this paper, it is hard to guarantee intersection-free when extreme cases are processed. Self-intersection happens when any tetrahedron becomes a void. However, it can be easily checked during the deformation of tetrahedra. Actually, in our current implementation, we have already checked this singularity. If there is any tetrahedron becoming singular, the positions of its vertices will be locked to prevent self-intersection.

On the other aspect, the convergence of our shape optimization depends on the number of standardized components stored in the element library. When there are too few components, the shape optimization may be stuck and introduces large error on the results of computation. Moreover, we expect that the volumetric meshes of all components stored in the same element library have the same connectivity. Although they can be obtained by the surface cross-parameterization  [1,2] plus spatial warping  [3], a self-intersection free volumetric mesh may still hard to obtain when the components in an element library have tremendous shape-variation.

@&#FUTURE WORK@&#

In the near future, we plan to work on a few extensions of this approach. First, we will consider how to handle the models with large size of tetrahedra. Second, the framework is planned to use in real products design to further verify its robustness in practical usage. Lastly, the series of standardized components are currently determined according to the manufacturing process. A possible future work is to analyze the demanded best-fit components and develop an algorithm to generate the classification automatically from the statistical data.

We reformulate the global optimization problem of ARAP in Eq. (3) into a form of least-square minimization. First of all, let 
                        
                           T
                        
                      and 
                        
                           L
                        
                      in Eq. (3) be
                        
                           
                              
                                 T
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                02
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                11
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                20
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                21
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                              
                              
                                 L
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                02
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                11
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                20
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                21
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      and the minimization problem of Eq. (3) can be rewritten as 
                        
                           
                              min
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             l
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      Recall that the transformation matrix 
                        
                           T
                        
                        =
                        
                           
                              
                                 P
                              
                           
                           
                              ̃
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              −
                              1
                           
                        
                     . As 
                        
                           
                              
                                 P
                              
                           
                           
                              −
                              1
                           
                        
                      is computed by the original position of a tetrahedron that is known, we can assume that 
                        
                           
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                02
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                11
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                20
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                21
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     Therefore, 
                        
                           
                              
                                 T
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                3
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                3
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                4
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                02
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                11
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                20
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                21
                                             
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                22
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     with 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                    
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                    
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                     . As a result, the elements in 
                        
                           T
                        
                      can be expanded as 
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    0
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    1
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    2
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    3
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                       j
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    4
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      The minimization problem can then be rewritten in matrix form that yields 
                        
                           
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    …
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          Ax
                                       
                                       −
                                       
                                          b
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           x
                        
                      is a vector containing 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              1
                           
                        
                        …
                        
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              n
                           
                        
                     , 
                        
                           b
                        
                      is a vector containing entries from 
                        
                           L
                        
                     , and 
                        
                           A
                        
                      is a sparse matrix with coefficients obtained from 
                        
                           
                              
                                 P
                              
                           
                           
                              −
                              1
                           
                        
                     .

@&#REFERENCES@&#

